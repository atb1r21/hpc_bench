[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12.0  |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2023     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 12-01-2023 15:58 (-0000)
 
Reading parameters from file "4088.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 4 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 4
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 20 MPI processes.
   There are 10 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
               4 threads for loops over batched FFT box operations.
               4 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.
... done

Reading geometry and species blocks from file "4088.dat" ...
  Reading POSITIONS geometry from 4088.xyz
    
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task : singlepoint                                                              
timings_level 3                                                                 
output_detail VERBOSE                                                           
xc_functional OPTPBE                                                            
cutoff_energy 830 eV                                                            
paw T                                                                           
MAXIT_NGWF_CG 2                                                                 
minit_lnv 8                                                                     
maxit_lnv 8                                                                     
write_tightbox_ngwfs F                                                          
write_denskern F                                                                
%BLOCK SPECIES                                                                  
C1 C 6 4 9.0                                                                    
H1 H 1 1 9.0                                                                    
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
C1 "c_pbe_abinit.paw"                                                           
H1 "h_pbe_abinit.paw"                                                           
%ENDBLOCK SPECIES_POT                                                           
%BLOCK SPECIES_ATOMIC_SET                                                       
C1 "SOLVE conf=2s2 2p2"                                                         
H1 "SOLVE conf=1s1"                                                             
%ENDBLOCK SPECIES_ATOMIC_SET                                                    
%BLOCK SPECIES_LDOS_GROUPS                                                      
C1                                                                              
H1                                                                              
%ENDBLOCK SPECIES_LDOS_GROUPS                                                   
%BLOCK LATTICE_CART                                                             
113.383578780000     0.000000000000       0.000000000000                        
0.000000000000       113.383578780000     0.000000000000                        
0.000000000000       0.000000000000       143.8123051                           
%ENDBLOCK LATTICE_CART                                                          
positions_xyz_file 4088.xyz                                                     
     Hash =  -000002130319080441064013

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<<<< PAW Dataset information >>>>>>>>>>>>>>>>>>>>>>>>>>>
File: c_pbe_abinit.paw; rc = 1.25 bohr; shape type =  3; rshape = 1.25 bohr;
  Atomic number:  6;  ionic charge:  4.000000
    Partial Wave 1: l = 0
    Partial Wave 2: l = 0
    Partial Wave 3: l = 1
    Partial Wave 4: l = 1
  Core charge supplied for Nonlinear Core Corrections
File: h_pbe_abinit.paw; rc = 0.90 bohr; shape type =  3; rshape = 0.90 bohr;
  Atomic number:  1;  ionic charge:  1.000000
    Partial Wave 1: l = 0
    Partial Wave 2: l = 0
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C       3542     14168     28336
  H        546       546      1092
.......   ......    ......    ......
Totals:   4088     14714     29428
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:  231 x 231 x 288
                              FFT-box:  117 x 117 x 117
                                  PPD:    7 x   7 x   1
Grid space d1=  0.490838003377a0 (KE cutoff=  31.53027Eh = 857.98221eV)
Grid space d2=  0.490838003377a0 (KE cutoff=  31.53027Eh = 857.98221eV)
Grid space d3=  0.499348281597a0 (KE cutoff=  30.46470Eh = 828.98662eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:    231   231   288
          Real-space ('12') slabs/proc (min max mean):     14    15    14
         Recip-space ('23') slabs/proc (min max mean):      5     6     5
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    462   462   576
          Real-space ('12') slabs/proc (min max mean):     28    29    28
         Recip-space ('23') slabs/proc (min max mean):     11    12    11
********************************************************************************

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String: 2s2 2p2
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1377    0.0065406977    9.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    2  183.0116354500
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.4795186097   -1.3252230651    4.5135247139   -1.6370402178
  2         -5.4480873667   -1.4027986130    4.4305957006   -1.6109824140
  3         -5.4553175168   -1.4212842775    4.4102621601   -1.6059044058
  4         -5.4627851864   -1.4247099971    4.4065125496   -1.6052912254
  5         -5.4662317525   -1.4266823431    4.4043718731   -1.6049357348
  6         -5.4679531179   -1.4277361345    4.4032352159   -1.6047498153
  7         -5.4688370531   -1.4282876632    4.4026436340   -1.6046546171
  8         -5.4692962224   -1.4285743132    4.4023378281   -1.6046060967
  9         -5.4695360875   -1.4287229388    4.4021801230   -1.6045813828
 10         -5.4696617783   -1.4287999625    4.4020988354   -1.6045687883
 11         -5.4697277645   -1.4288398966    4.4020569195   -1.6045623641
 12         -5.4697624500   -1.4288606199    4.4020352864   -1.6045590836
 13         -5.4697806994   -1.4288713865    4.4020241086   -1.6045574064
 14         -5.4697903086   -1.4288769875    4.4020183254   -1.6045565478
 15         -5.4697953717   -1.4288799052    4.4020153292   -1.6045561077
 16         -5.4697980412   -1.4288814272    4.4020137746   -1.6045558818
 17         -5.4697994496   -1.4288822223    4.4020129668   -1.6045557657
 18         -5.4698001930   -1.4288826382    4.4020125465   -1.6045557059
 19         -5.4698005858   -1.4288828561    4.4020123274   -1.6045556751
 20         -5.4698007933   -1.4288829704    4.4020122131   -1.6045556592
 21         -5.4698009031   -1.4288830304    4.4020121533   -1.6045556509
 22         -5.4698009612   -1.4288830620    4.4020121220   -1.6045556467
Atom SCF converged after  22 iterations to a total energy of     -5.46980096

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String: 1s1
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1377    0.0065406977    9.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  183.0116354500
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3687944832   -0.2607687933    0.2820952946   -0.2613406499
  2         -0.4328656062   -0.2590521405    0.2895573663   -0.2701762133
  3         -0.4633856573   -0.2560091938    0.2934204754   -0.2757429988
  4         -0.4750266404   -0.2549676794    0.2946557510   -0.2779015032
  5         -0.4793045155   -0.2546870695    0.2949704774   -0.2786577123
  6         -0.4808919118   -0.2546234645    0.2950332622   -0.2789201171
  7         -0.4814942533   -0.2546130669    0.2950388368   -0.2790132353
  8         -0.4817280090   -0.2546133926    0.2950352123   -0.2790473458
  9         -0.4818204053   -0.2546148712    0.2950319888   -0.2790602287
 10         -0.4818574273   -0.2546158825    0.2950301416   -0.2790652181
 11         -0.4818724050   -0.2546164247    0.2950292178   -0.2790671871
 12         -0.4818785049   -0.2546166894    0.2950287833   -0.2790679748
 13         -0.4818810009   -0.2546168128    0.2950285855   -0.2790682928
 14         -0.4818820255   -0.2546168689    0.2950284970   -0.2790684221
 15         -0.4818824471   -0.2546168940    0.2950284580   -0.2790684748
 16         -0.4818826210   -0.2546169051    0.2950284408   -0.2790684964
 17         -0.4818826928   -0.2546169100    0.2950284333   -0.2790685053
Atom SCF converged after  17 iterations to a total energy of     -0.48188269

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max    736;  min    735;  average    736
... Projector load balancing: max   1472;  min   1470;  average   1471
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       323097.995517
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ideal mu1:      -0.448560723044
             Q0:      -20692.528974234116
             G0:      -0.014963864173
   RMS gradient:       0.000008307129
     Trial step:       0.537297855697
             Q1:      -20692.534764435641
 Quadratic coef:       0.002249850608
 Linear coef   :      -0.008040052133
           Qmin:      -20692.536157204184
Quadratic minimum step length (  0.960042136971) accepted
    Initial Ne1:   14714.00007569
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    4        -2.069252897423E+04     8.3071E-06     8.3071E-06    -1.8754E-02
      ideal mu1:      -0.448501716241
             Q0:      -20692.536157903323
             G0:      -0.010574376148
   RMS gradient:       0.000006988392
     Trial step:       0.718212072840
             Q1:      -20692.539647902751
 Quadratic coef:       0.004104645184
 Linear coef   :      -0.007594644612
           Qmin:      -20692.539670912622
Quadratic minimum step length (  0.664438118843) accepted
    Initial Ne1:   14714.00006390
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.069253615790E+04     6.9884E-06     6.9884E-06    -7.1837E-03
      ideal mu1:      -0.448964619553
             Q0:      -20692.539672101677
             G0:      -0.005652478487
   RMS gradient:       0.000005113439
     Trial step:       0.690802054578
             Q1:      -20692.541515953442
 Quadratic coef:       0.002060891988
 Linear coef   :      -0.003904743752
           Qmin:      -20692.541521667772
Quadratic minimum step length (  0.654426583945) accepted
    Initial Ne1:   14714.00006390
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.069253967210E+04     5.1134E-06     5.1134E-06    -3.5142E-03
      ideal mu1:      -0.448168684803
             Q0:      -20692.541522282056
             G0:      -0.002378974571
   RMS gradient:       0.000003314852
     Trial step:       0.672368372813
             Q1:      -20692.542103909971
 Quadratic coef:       0.001017919345
 Linear coef   :      -0.001599547261
           Qmin:      -20692.542150659800
Quadratic minimum step length (  0.528276132403) accepted
    Initial Ne1:   14714.00001650
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.069254152228E+04     3.3149E-06     3.3149E-06    -1.8502E-03
      ideal mu1:      -0.448907808543
    8        -2.069254215021E+04     2.6133E-06     2.6133E-06    -6.2793E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.06925421502113E+04  Eh
     Estimated bandgap           =   1.1553E-02  Eh
     RMS occupancy error         =   1.0706E-12
     [H,K] commutator            =   2.6133E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1775E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16439691E+00     0.13200863E-02
               2       0.32361234E-03     0.21973575E-05
               3       0.21255043E-08     0.98582253E-11
               4       0.28000058E-12     0.85487173E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.43560521E+00     0.41841648E-02
               2       0.23302090E-02     0.19763983E-04
               3       0.93315293E-07     0.55281946E-09
               4       0.34563530E-12     0.84376950E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00031774739783
Trial step length           =               0.357634
Gradient along search dir.  =        -37.91023534775
Functional at step 0        =  -20692.54215021134951
Functional at step 1        =  -20703.96552242280814
Functional predicted        =  -20714.07039955591972
Selected quadratic step     =               1.135749
Conjugate gradients coeff.  =               0.106639
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:   14751.96319514
     Final electron number for spin 1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001694 (step -0.4964 Ne1=  14714.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.422029676411
             Q0:      -20714.123245944375
             G0:      -0.191048312585
   RMS gradient:       0.000029705773
     Trial step:       0.595983358442
             Q1:      -20714.177808016091
 Quadratic coef:       0.059299543242
 Linear coef   :      -0.113861614959
           Qmin:      -20714.177902635860
Quadratic minimum step length (  0.572176647334) accepted
    Initial Ne1:   14713.99998364
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.071412324594E+04     2.9706E-05     2.9706E-05
      ideal mu1:      -0.426025802947
             Q0:      -20714.177901558720
             G0:      -0.012822951262
   RMS gradient:       0.000007690008
     Trial step:       0.583958697084
             Q1:      -20714.181250656326
 Quadratic coef:       0.004138976306
 Linear coef   :      -0.007488073912
           Qmin:      -20714.181288341268
Quadratic minimum step length (  0.528237607750) accepted
    Initial Ne1:   14714.00000255
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -2.071417790156E+04     7.6900E-06     7.6900E-06    -5.4656E-02
      ideal mu1:      -0.424962849364
             Q0:      -20714.181287675656
             G0:      -0.003512724531
   RMS gradient:       0.000004024079
     Trial step:       0.555399806601
             Q1:      -20714.182309522370
 Quadratic coef:       0.000929119811
 Linear coef   :      -0.001950966525
           Qmin:      -20714.182311835924
Quadratic minimum step length (  0.583114479780) accepted
    Initial Ne1:   14714.00000046
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -2.071418128768E+04     4.0241E-06     4.0241E-06    -3.3861E-03
      ideal mu1:      -0.425415914511
             Q0:      -20714.182311756758
             G0:      -0.002003710997
   RMS gradient:       0.000003044674
     Trial step:       0.569088454720
             Q1:      -20714.183143558181
 Quadratic coef:       0.000308487372
 Linear coef   :      -0.001140288795
           Qmin:      -20714.183365494006
Quadratic minimum step length (  1.051785661828) accepted
    Initial Ne1:   14714.00000027
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -2.071418231176E+04     3.0447E-06     3.0447E-06    -1.0241E-03
      ideal mu1:      -0.425433211365
             Q0:      -20714.183359363607
             G0:      -0.001748731648
   RMS gradient:       0.000002860187
     Trial step:       0.773665998339
             Q1:      -20714.184273005685
 Quadratic coef:       0.000439292140
 Linear coef   :      -0.001352934216
           Qmin:      -20714.184401057064
Quadratic minimum step length (  1.191370281365) accepted
    Initial Ne1:   14713.99999729
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000008 (step -0.4998 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.071418335936E+04     2.8602E-06     2.8602E-06    -1.0476E-03
      ideal mu1:      -0.425622700241
             Q0:      -20714.184401950613
             G0:      -0.001285877193
   RMS gradient:       0.000002434359
     Trial step:       0.960063892730
             Q1:      -20714.184909343840
 Quadratic coef:       0.000727131039
 Linear coef   :      -0.001234524263
           Qmin:      -20714.184925944941
Quadratic minimum step length (  0.814999021303) accepted
    Initial Ne1:   14714.00003660
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.4998 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.071418440195E+04     2.4344E-06     2.4344E-06    -1.0426E-03
      ideal mu1:      -0.425156741355
             Q0:      -20714.184926031474
             G0:      -0.000841652800
   RMS gradient:       0.000001971677
     Trial step:       0.884562678934
             Q1:      -20714.184928431514
 Quadratic coef:       0.000742094617
 Linear coef   :      -0.000744494656
           Qmin:      -20714.185112757088
Quadratic minimum step length (  0.443711739883) accepted
    Initial Ne1:   14714.00001362
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.071418492603E+04     1.9717E-06     1.9717E-06    -5.2408E-04
      ideal mu1:      -0.425666787812
    8        -2.071418511304E+04     1.3815E-06     1.3815E-06    -1.8700E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.07141851130364E+04  Eh
     Estimated bandgap           =   1.1412E-02  Eh
     RMS occupancy error         =   4.7023E-14
     [H,K] commutator            =   1.3815E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :    12362.53359647072648 |
           | Core Hartree               : -2135695.21508340956643 |
           | CoreHart (non-coul chg cor):        0.00000000000000
           | Hartree                    :  1061333.62470021587797 |
           | Exchange-correlation       :    -6901.22293896107658 |
           | Ewald                      :  1045115.32994729280472 |
           | Dij0                       :     3267.52943722562304 |
           | Dijhartree                 :       -3.63074881515417 |
           | Exc [AE core]              :   -16592.55574171000626 |
           | Exc DC [AE core]           :    -5021.22941111283035 |
           | Exc [PS core]              :    -3795.65280563129591 |
           | Exc DC [PS core]           :    -4631.99029658741983 |
           | Exc [Core]                 :   -12603.76891302654622 |
           | Total [Sphere]             :     3070.76466535830514 |
           | Total                      :   -20714.18511303274136 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Core Hartree               : -2135695.21508346591145 |
           | Hartree (Valence)          :  1061333.62470024731010 |
           --------------------------------------------------------
           Integrated compensation chrg.:      449.76982612811173
           Integrated density           :    14713.99999999082502
           Integrated density tr(KS)    :    14714.00000000000364
================================================================================

WARNING: maximum number of NGWF CG iterations (   2) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00097302297759 -20507.37582279943672   1.044318 -20692.01166587287298        
   1     0.00031774739783 -20714.18511303644846  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:   31424.296s on     20 proc(s)                                    
TOTAL TIME:     31424.407s on     20 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.01s   0.000%  ------ ||
|| sparse_set_to_garbage                :    27        0.06s   0.000%  ------ ||
|| paw_dij_hartree                      :    51        0.07s   0.000%  ------ ||
|| basis_extract_function_from_box      :  2942        0.16s   0.001%  ------ ||
|| paw_tcore_density                    :     1        0.35s   0.001%  ------ ||
|| paw_tcore_hartree_on_grid            :     1        0.36s   0.001%  ------ ||
|| paw_dataset_init                     :     2        0.49s   0.002%  ------ ||
|| paw_species_calc_proj_prec_mat       :     1        1.03s   0.003%  ------ ||
|| ngwfs_initialise_from_radial         :     1        1.05s   0.003%  ------ ||
|| energy_and_force_init_cell           :     1        1.21s   0.004%  ------ ||
|| density_init_guess_real              :     1        1.96s   0.006%  ------ ||
|| hartree_on_grid                      :    49       19.66s   0.063%  ------ ||
|| augmentation_screen_dij              :    51       21.71s   0.069%  ------ ||
|| pseudo_make_structure_factor         :     1       34.42s   0.110%  ------ ||
|| paw_dij_xc                           :    51       37.52s   0.119%  ------ ||
|| sparse_init                          :     1       40.97s   0.130%  ------ ||
|| projectors_init_fftbox_recip         :   190       42.16s   0.134%  ------ ||
|| aug_nonlocal_mat                     :    49       56.12s   0.179%  ------ ||
|| fourier_apply_box_pair               :  4782       56.98s   0.181% 277.088 ||
|| basis_copy_function_to_box           : 58856       67.11s   0.214%  ------ ||
|| function_ops_brappd_ketppd           :     5      120.45s   0.383%  ------ ||
|| ewald_calculate_energy               :     1      129.16s   0.411%  ------ ||
|| ngwf_gradient_coeffs                 :     2      182.39s   0.580%  ------ ||
|| cell_grid_extract_box_real           : 31799      182.69s   0.581%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     5      248.77s   0.792%  ------ ||
|| fourier_apply_cell_forward           :  1421      249.65s   0.794%  47.152 ||
|| projectors_func_ovlp_box             :     5      251.74s   0.801%  ------ ||
|| fourier_apply_cell_backward          :  1520      255.22s   0.812%  49.334 ||
|| integrals_kinetic                    :     5      352.40s   1.121%  ------ ||
|| cell_grid_deposit_box_real           : 75098      354.01s   1.127%  ------ ||
|| sparse_trace                         :  1061      383.60s   1.221%  ------ ||
|| palser_mano_kernel_optimise          :     1      464.26s   1.477%  ------ ||
|| augmentation_density_on_grid         :    48      568.93s   1.810%  ------ ||
|| kernel_purify                        :    73      589.95s   1.877%  ------ ||
|| hamiltonian_energy_components        :     1      658.00s   2.094%  ------ ||
|| density_fftbox_deposit_to_cell       : 35328      685.40s   2.181%  ------ ||
|| xc_energy_potential                  :    49      751.51s   2.391%  ------ ||
|| basis_dot_function_with_box          : 27.60M     863.77s   2.749%  ------ ||
|| lnv_gradient_norm                    :    24      917.25s   2.919%  ------ ||
|| kernel_fix                           :    24     1129.25s   3.594%  ------ ||
|| nlxc_vdw_energy                      :    98     1245.49s   3.963%  ------ ||
|| basis_add_function_to_box            : 48.47M    1608.34s   5.118%  ------ ||
|| integrals_locpot_mat_els_batch       :  1242     1987.80s   6.326%  ------ ||
|| projectors_gradient_batch            :    92     2370.22s   7.543%  ------ ||
|| density_batch_row_sums               :  2208     3172.84s  10.097%  ------ ||
|| potential_apply_to_ngwf_batch        :  1242     3600.71s  11.458%  ------ ||
|| projectors_grad_precond_batch        :    92     3822.11s  12.163%  ------ ||
|| density_fftbox_interpolate_multiply  : 35328     4905.37s  15.610%  ------ ||
|| fourier_apply_box                    : 182.7k    4976.54s  15.837% 402.930 ||
|| sparse_product                       :  1403     5317.85s  16.923%  ------ ||
|| integrals_locpot_dbl_grid            :    27     5592.76s  17.798%  ------ ||
|| density_batch_interp_deposit         :  2208     6153.66s  19.582%  ------ ||
|| ngwf_gradient_build_batch            :    92     6719.39s  21.383%  ------ ||
|| ngwf_gradient_batch                  :    92     7318.09s  23.288%  ------ ||
|| ngwf_gradient_lnv                    :     2     8468.93s  26.950%  ------ ||
|| density_on_dbl_grid                  :    48     9635.82s  30.664%  ------ ||
|| hamiltonian_lhxc_calculate           :    47    10785.76s  34.323%  ------ ||
|| lnv_denskernel_optimise_cg           :     3    19542.17s  62.188%  ------ ||
|| ngwf_cg_optimise                     :     1    30233.14s  96.209%  ------ ||
|| energy_and_forces                    :     1    31422.33s  99.994%  ------ ||
|| total_time                           :     1    31424.30s 100.000%  ------ ||
================================================================================
==================== AVERAGE TIMINGS FROM ALL PROCS (SELF) =====================
++ TAG                                    #calls    cpu time   %total  Gflops ++
++ onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ++
++ onetep.F90 main loop imbalance       :     1        0.01s   0.000%  ------ ++
++ sparse_set_to_garbage                :    27        0.06s   0.000%  ------ ++
++ paw_dij_hartree                      :    51        0.07s   0.000%  ------ ++
++ basis_extract_function_from_box      :  2942        0.16s   0.001%  ------ ++
++ paw_tcore_hartree_on_grid            :     1        0.17s   0.001%  ------ ++
++ paw_tcore_density                    :     1        0.28s   0.001%  ------ ++
++ hartree_on_grid                      :    49        0.46s   0.001%  ------ ++
++ paw_dataset_init                     :     2        0.49s   0.002%  ------ ++
++ energy_and_force_init_cell           :     1        0.72s   0.002%  ------ ++
++ main_program_(onetep.F90)            :     1        0.75s   0.002%  ------ ++
++ paw_species_calc_proj_prec_mat       :     1        0.84s   0.003%  ------ ++
++ ngwfs_initialise_from_radial         :     1        1.05s   0.003%  ------ ++
++ density_init_guess_real              :     1        1.70s   0.005%  ------ ++
++ hamiltonian_energy_components        :     1        1.76s   0.006%  ------ ++
++ aug_nonlocal_mat                     :    49        2.43s   0.008%  ------ ++
++ energy_and_forces                    :     1        2.51s   0.008%  ------ ++
++ integrals_locpot_dbl_grid            :    27        4.25s   0.014%  ------ ++
++ ngwf_gradient_coeffs                 :     2        4.55s   0.014%  ------ ++
++ sparse_embed_hotelling_invert_embed  :     5        5.39s   0.017%  ------ ++
++ palser_mano_kernel_optimise          :     1       15.77s   0.050%  ------ ++
++ augmentation_screen_dij              :    51       18.67s   0.059%  ------ ++
++ kernel_purify                        :    73       22.91s   0.073%  ------ ++
++ kernel_fix                           :    24       27.07s   0.086%  ------ ++
++ hamiltonian_lhxc_calculate           :    47       33.87s   0.108%  ------ ++
++ pseudo_make_structure_factor         :     1       34.42s   0.110%  ------ ++
++ paw_dij_xc                           :    51       37.52s   0.119%  ------ ++
++ sparse_init                          :     1       40.97s   0.130%  ------ ++
++ projectors_init_fftbox_recip         :   190       42.16s   0.134%  ------ ++
++ augmentation_density_on_grid         :    48       42.77s   0.136%  ------ ++
++ fourier_apply_box_pair               :  4782       56.98s   0.181% 277.088 ++
++ lnv_denskernel_optimise_cg           :     3       59.71s   0.190%  ------ ++
++ xc_energy_potential                  :    49       62.49s   0.199%  ------ ++
++ basis_copy_function_to_box           : 58856       67.11s   0.214%  ------ ++
++ ngwf_cg_optimise                     :     1       73.70s   0.235%  ------ ++
++ projectors_func_ovlp_box             :     5      112.62s   0.358%  ------ ++
++ function_ops_brappd_ketppd           :     5      120.45s   0.383%  ------ ++
++ ewald_calculate_energy               :     1      129.16s   0.411%  ------ ++
++ lnv_gradient_norm                    :    24      141.37s   0.450%  ------ ++
++ cell_grid_extract_box_real           : 31799      182.69s   0.581%  ------ ++
++ ngwf_gradient_build_batch            :    92      196.87s   0.626%  ------ ++
++ nlxc_vdw_energy                      :    98      203.54s   0.648%  ------ ++
++ integrals_kinetic                    :     5      242.15s   0.771%  ------ ++
++ fourier_apply_cell_forward           :  1421      249.65s   0.794%  47.152 ++
++ fourier_apply_cell_backward          :  1520      255.22s   0.812%  49.334 ++
++ ngwf_gradient_batch                  :    92      285.82s   0.910%  ------ ++
++ density_on_dbl_grid                  :    48      309.32s   0.984%  ------ ++
++ density_fftbox_deposit_to_cell       : 35328      338.21s   1.076%  ------ ++
++ cell_grid_deposit_box_real           : 75098      354.01s   1.127%  ------ ++
++ sparse_trace                         :  1061      383.60s   1.221%  ------ ++
++ density_batch_interp_deposit         :  2208      581.50s   1.850%  ------ ++
++ basis_dot_function_with_box          : 27.60M     863.77s   2.749%  ------ ++ (!) overhead: ~   4.0%
++ ngwf_gradient_lnv                    :     2      968.45s   3.082%  ------ ++
++ integrals_locpot_mat_els_batch       :  1242     1253.91s   3.990%  ------ ++
++ basis_add_function_to_box            : 48.47M    1608.34s   5.118%  ------ ++ (!) overhead: ~   3.8%
++ potential_apply_to_ngwf_batch        :  1242     1770.37s   5.634%  ------ ++
++ density_batch_row_sums               :  2208     1860.58s   5.921%  ------ ++
++ density_fftbox_interpolate_multiply  : 35328     1946.01s   6.193%  ------ ++
++ projectors_gradient_batch            :    92     2333.23s   7.425%  ------ ++
++ projectors_grad_precond_batch        :    92     3776.85s  12.019%  ------ ++
++ fourier_apply_box                    : 182.7k    4976.54s  15.837% 402.930 ++
++ sparse_product                       :  1403     5317.85s  16.923%  ------ ++
================================================================================
(!) WARNING: You're wasting precious cycles calling timer. 
             Each pair of timer_clock calls itself cost   1.25 microseconds!
Overhead of generating timer report: 
- 1 ms averaging over threads,
- 2 ms ensuring consistency across MPI ranks,
- 6 ms printing in order.

Job completed: 12-01-2023 20:20 (-0000)

