==================================================================================
It's Thu Jan 12 16:36:38 GMT 2023.
*** Starting onetep_launcher (node red388.cluster.local, PIDs 41640 41641 41642 41643 41644 41645 41646 41647 41648 41649)...
    - ONETEP arguments: 4088.dat
    - Current directory: /home/hpc/benchmarks-2022/ONETEP/data_input/8_nodes/testcase1
    - Launcher executable directory: /mainfs/home/hpc/benchmarks-2022/ONETEP/source/utils
    - (-e) ONETEP executable specified through command-line: /home/hpc/benchmarks-2022/ONETEP/source/bin/onetep.iridis5.intel21.omp.scalapack
      ... trying /home/hpc/benchmarks-2022/ONETEP/source/bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 4
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /home/hpc/benchmarks-2022/ONETEP/source/bin/onetep.iridis5.intel21.omp.scalapack 4088.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12.0  |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2023     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 12-01-2023 16:36 (-0000)
 
Reading parameters from file "4088.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 4 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 4
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 80 MPI processes.
   There are 10 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
               4 threads for loops over batched FFT box operations.
               4 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.
... done

Reading geometry and species blocks from file "4088.dat" ...
  Reading POSITIONS geometry from 4088.xyz
    
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task : singlepoint                                                              
timings_level 3                                                                 
output_detail VERBOSE                                                           
xc_functional OPTPBE                                                            
cutoff_energy 830 eV                                                            
paw T                                                                           
MAXIT_NGWF_CG 2                                                                 
minit_lnv 8                                                                     
maxit_lnv 8                                                                     
write_tightbox_ngwfs F                                                          
write_denskern F                                                                
%BLOCK SPECIES                                                                  
C1 C 6 4 9.0                                                                    
H1 H 1 1 9.0                                                                    
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
C1 "c_pbe_abinit.paw"                                                           
H1 "h_pbe_abinit.paw"                                                           
%ENDBLOCK SPECIES_POT                                                           
%BLOCK SPECIES_ATOMIC_SET                                                       
C1 "SOLVE conf=2s2 2p2"                                                         
H1 "SOLVE conf=1s1"                                                             
%ENDBLOCK SPECIES_ATOMIC_SET                                                    
%BLOCK SPECIES_LDOS_GROUPS                                                      
C1                                                                              
H1                                                                              
%ENDBLOCK SPECIES_LDOS_GROUPS                                                   
%BLOCK LATTICE_CART                                                             
113.383578780000     0.000000000000       0.000000000000                        
0.000000000000       113.383578780000     0.000000000000                        
0.000000000000       0.000000000000       143.8123051                           
%ENDBLOCK LATTICE_CART                                                          
positions_xyz_file 4088.xyz                                                     
     Hash =  -000002130319080441064013

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<<<< PAW Dataset information >>>>>>>>>>>>>>>>>>>>>>>>>>>
File: c_pbe_abinit.paw; rc = 1.25 bohr; shape type =  3; rshape = 1.25 bohr;
  Atomic number:  6;  ionic charge:  4.000000
    Partial Wave 1: l = 0
    Partial Wave 2: l = 0
    Partial Wave 3: l = 1
    Partial Wave 4: l = 1
  Core charge supplied for Nonlinear Core Corrections
File: h_pbe_abinit.paw; rc = 0.90 bohr; shape type =  3; rshape = 0.90 bohr;
  Atomic number:  1;  ionic charge:  1.000000
    Partial Wave 1: l = 0
    Partial Wave 2: l = 0
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C       3542     14168     28336
  H        546       546      1092
.......   ......    ......    ......
Totals:   4088     14714     29428
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:  231 x 231 x 288
                              FFT-box:  117 x 117 x 117
                                  PPD:    7 x   7 x   1
Grid space d1=  0.490838003377a0 (KE cutoff=  31.53027Eh = 857.98221eV)
Grid space d2=  0.490838003377a0 (KE cutoff=  31.53027Eh = 857.98221eV)
Grid space d3=  0.499348281597a0 (KE cutoff=  30.46470Eh = 828.98662eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:    231   231   288
          Real-space ('12') slabs/proc (min max mean):      3     4     3
         Recip-space ('23') slabs/proc (min max mean):      1     2     1
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    462   462   576
          Real-space ('12') slabs/proc (min max mean):      7     8     7
         Recip-space ('23') slabs/proc (min max mean):      2     3     2
********************************************************************************

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String: 2s2 2p2
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1377    0.0065406977    9.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    2  183.0116354500
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.4795186097   -1.3252230651    4.5135247139   -1.6370402178
  2         -5.4480873667   -1.4027986130    4.4305957006   -1.6109824140
  3         -5.4553175168   -1.4212842775    4.4102621601   -1.6059044058
  4         -5.4627851864   -1.4247099971    4.4065125496   -1.6052912254
  5         -5.4662317525   -1.4266823431    4.4043718731   -1.6049357348
  6         -5.4679531179   -1.4277361345    4.4032352159   -1.6047498153
  7         -5.4688370531   -1.4282876632    4.4026436340   -1.6046546171
  8         -5.4692962224   -1.4285743132    4.4023378281   -1.6046060967
  9         -5.4695360875   -1.4287229388    4.4021801230   -1.6045813828
 10         -5.4696617783   -1.4287999625    4.4020988354   -1.6045687883
 11         -5.4697277645   -1.4288398966    4.4020569195   -1.6045623641
 12         -5.4697624500   -1.4288606199    4.4020352864   -1.6045590836
 13         -5.4697806994   -1.4288713865    4.4020241086   -1.6045574064
 14         -5.4697903086   -1.4288769875    4.4020183254   -1.6045565478
 15         -5.4697953717   -1.4288799052    4.4020153292   -1.6045561077
 16         -5.4697980412   -1.4288814272    4.4020137746   -1.6045558818
 17         -5.4697994496   -1.4288822223    4.4020129668   -1.6045557657
 18         -5.4698001930   -1.4288826382    4.4020125465   -1.6045557059
 19         -5.4698005858   -1.4288828561    4.4020123274   -1.6045556751
 20         -5.4698007933   -1.4288829704    4.4020122131   -1.6045556592
 21         -5.4698009031   -1.4288830304    4.4020121533   -1.6045556509
 22         -5.4698009612   -1.4288830620    4.4020121220   -1.6045556467
Atom SCF converged after  22 iterations to a total energy of     -5.46980096

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String: 1s1
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1377    0.0065406977    9.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  183.0116354500
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3687944832   -0.2607687933    0.2820952946   -0.2613406499
  2         -0.4328656062   -0.2590521405    0.2895573663   -0.2701762133
  3         -0.4633856573   -0.2560091938    0.2934204754   -0.2757429988
  4         -0.4750266404   -0.2549676794    0.2946557510   -0.2779015032
  5         -0.4793045155   -0.2546870695    0.2949704774   -0.2786577123
  6         -0.4808919118   -0.2546234645    0.2950332622   -0.2789201171
  7         -0.4814942533   -0.2546130669    0.2950388368   -0.2790132353
  8         -0.4817280090   -0.2546133926    0.2950352123   -0.2790473458
  9         -0.4818204053   -0.2546148712    0.2950319888   -0.2790602287
 10         -0.4818574273   -0.2546158825    0.2950301416   -0.2790652181
 11         -0.4818724050   -0.2546164247    0.2950292178   -0.2790671871
 12         -0.4818785049   -0.2546166894    0.2950287833   -0.2790679748
 13         -0.4818810009   -0.2546168128    0.2950285855   -0.2790682928
 14         -0.4818820255   -0.2546168689    0.2950284970   -0.2790684221
 15         -0.4818824471   -0.2546168940    0.2950284580   -0.2790684748
 16         -0.4818826210   -0.2546169051    0.2950284408   -0.2790684964
 17         -0.4818826928   -0.2546169100    0.2950284333   -0.2790685053
Atom SCF converged after  17 iterations to a total energy of     -0.48188269

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max    184;  min    183;  average    184
... Projector load balancing: max    368;  min    366;  average    368
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       323097.995517
        Ewald: reciprocal-space energy =       779042.118883
         Ewald: (sum_charge)**2 energy =        55160.613665
         Ewald: (sum_charge**2) energy =         1864.170788
                          Ewald energy =      1045115.329947
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Projector tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       2459060    196940214
... PAW projector initialisation
... done

============================= Charge Augmentation ==============================
                           Aug box size:   13 x  13 x  13
================================================================================

========================== Sparse matrix information ===========================
                        Overlap matrix filling:   8.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling:   1.91%
                    Aug Overlap matrix filling:   9.15%
                    Hamiltonian matrix filling:   9.15%
                  NGWF diagonal matrix filling:   0.03%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11790782E+03     0.98035989E+00
               2       0.11513195E+03     0.96161427E+00
               3       0.11085712E+03     0.92653618E+00
               4       0.10516196E+03     0.86450762E+00
               5       0.98300308E+02     0.76791673E+00
               6       0.90366441E+02     0.68642725E+00
               7       0.82037045E+02     0.63659600E+00
               8       0.74075949E+02     0.59917999E+00
               9       0.65678814E+02     0.55691692E+00
              10       0.55055843E+02     0.48977372E+00
              11       0.41087465E+02     0.38220332E+00
              12       0.24797068E+02     0.24026804E+00
              13       0.10387116E+02     0.10068673E+00
              14       0.22342232E+01     0.20180765E-01
              15       0.12579150E+00     0.10061756E-02
              16       0.49179247E-03     0.32341407E-05
              17       0.10876176E-07     0.50947913E-10
              18       0.24256589E-12     0.68833828E-14
================================================================================
Calculating core density ...
================================= Core Density =================================
               Core den box size:   21 x  21 x  21
================================================================================
 ... done
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1       -3098.99694034688719    0.5063231
               2       -3513.64825382111712    0.5149639
               3       -3829.17350408337825    0.5352217
               4       -4020.10048608347506    0.5674461
               5       -4110.96142537349806    0.5870509
               6       -4151.39591611761261    0.5766943
               7       -4172.95384073596051    0.5629534
               8       -4183.81434796838585    0.5607727
               9       -4188.22824738824602    0.5634949
              10       -4189.77974391041062    0.5536469
              11       -4190.37158873555381    0.5386448
              12       -4190.61903069437358    0.5323875
              13       -4190.72406425439567    0.5456146
              14       -4190.76540090303843    0.5759749
              15       -4190.77858027054390    0.5751674
              16       -4190.78319613181338    0.5232109
              17       -4190.78537691300426    0.4566978
              18       -4190.78606366372605    0.4275302
              19       -4190.78633787622221    0.4397370
              20       -4190.78658695557624    0.4634387
              21       -4190.78681612491346    0.4860741
              22       -4190.78695362463623    0.4979933
              23       -4190.78698769235962    0.4999616
              24       -4190.78698931347481    0.5000048
              25       -4190.78698931693907    0.5000048
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:   14714.00000000
     Final electron number for spin 1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.464856046947
             Q0:      -20505.654590848775
             G0:      -8.435674477280
   RMS gradient:       0.000197391821
     Trial step:       0.500000000000
             Q1:      -20507.199396611381
 Quadratic coef:       2.673031476035
 Linear coef   :      -4.217837238640
           Qmin:      -20507.318446206555
Quadratic minimum step length (  0.394480693218) accepted
    Initial Ne1:   14714.00000000
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000303 (step -0.4983 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.050565459085E+04     1.9739E-04     1.9739E-04
      ideal mu1:      -0.526041159825
             Q0:      -20507.322774944943
             G0:      -0.207594791336
   RMS gradient:       0.000030942653
     Trial step:       0.444117491897
             Q1:      -20507.360121473401
 Quadratic coef:       0.054849949600
 Linear coef   :      -0.092196478059
           Qmin:      -20507.361517872825
Quadratic minimum step length (  0.373255298282) accepted
    Initial Ne1:   14714.00140706
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -2.050732277494E+04     3.0943E-05     3.0943E-05    -1.6682E+00
      ideal mu1:      -0.521201609772
             Q0:      -20507.361530627990
             G0:      -0.031410527544
   RMS gradient:       0.000012047317
     Trial step:       0.407147647556
             Q1:      -20507.369533141551
 Quadratic coef:       0.004786208836
 Linear coef   :      -0.012788722398
           Qmin:      -20507.370073476108
Quadratic minimum step length (  0.543948082729) accepted
    Initial Ne1:   14714.00032873
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    3        -2.050736153063E+04     1.2047E-05     1.2047E-05    -3.8756E-02
      ideal mu1:      -0.523590458248
             Q0:      -20507.370076382140
             G0:      -0.006069836658
   RMS gradient:       0.000005291961
     Trial step:       0.470602998583
             Q1:      -20507.371952354908
 Quadratic coef:       0.000980510566
 Linear coef   :      -0.002856483332
           Qmin:      -20507.372156802616
Quadratic minimum step length (  0.685494715048) accepted
    Initial Ne1:   14714.00008420
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -2.050737007638E+04     5.2920E-06     5.2920E-06    -8.5458E-03
      ideal mu1:      -0.523161320370
             Q0:      -20507.372157507940
             G0:      -0.004196583991
   RMS gradient:       0.000004400380
     Trial step:       0.567975235741
             Q1:      -20507.373714441812
 Quadratic coef:       0.000826621908
 Linear coef   :      -0.002383555781
           Qmin:      -20507.373875747591
Quadratic minimum step length (  0.818875378951) accepted
    Initial Ne1:   14714.00006660
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4995 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.050737215751E+04     4.4004E-06     4.4004E-06    -2.0811E-03
      ideal mu1:      -0.524344941588
             Q0:      -20507.373875384925
             G0:      -0.003184406321
   RMS gradient:       0.000003836336
     Trial step:       0.681983090994
             Q1:      -20507.375212194020
 Quadratic coef:       0.000834902170
 Linear coef   :      -0.002171711266
           Qmin:      -20507.375287625182
Quadratic minimum step length (  0.886972399194) accepted
    Initial Ne1:   14714.00020491
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000019 (step -0.4987 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.050737387538E+04     3.8363E-06     3.8363E-06    -1.7179E-03
      ideal mu1:      -0.524516247369
             Q0:      -20507.375287394425
             G0:      -0.002221686612
   RMS gradient:       0.000003203396
     Trial step:       0.777753288922
             Q1:      -20507.375623138425
 Quadratic coef:       0.001392180071
 Linear coef   :      -0.001727924069
           Qmin:      -20507.375823553801
Quadratic minimum step length (  0.482659770762) accepted
    Initial Ne1:   14714.00024781
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.050737528739E+04     3.2034E-06     3.2034E-06    -1.4120E-03
      ideal mu1:      -0.524697090660
    8        -2.050737582325E+04     2.2277E-06     2.2277E-06    -5.3586E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.05073758232500E+04  Eh
     Estimated bandgap           =   1.2739E-02  Eh
     RMS occupancy error         =   6.2956E-12
     [H,K] commutator            =   2.2277E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.7302E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56774233E-01     0.35838895E-03
               2       0.31959727E-04     0.18079627E-06
               3       0.24768764E-10     0.10125234E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.68218884E+00     0.74278867E-02
               2       0.59585958E-02     0.59208525E-04
               3       0.53152030E-06     0.43506574E-08
               4       0.29694959E-12     0.91038288E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00097302297756
Trial step length           =               0.122474
Gradient along search dir.  =       -353.60073553717
Functional at step 0        =  -20507.37582324997493
Functional at step 1        =  -20548.14343084062421
Functional predicted        =  -20692.01166669678059
Selected quadratic step     =               1.044318
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:   14774.49905667
     Final electron number for spin 1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002840 (step -0.4932 Ne1=  14714.0000)
 RMS occupancy error at iteration   2:  0.000017 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.421960417815
             Q0:      -20691.942795215720
             G0:      -2.516649925470
   RMS gradient:       0.000107815364
     Trial step:       0.612690969527
             Q1:      -20692.326800823772
 Quadratic coef:       1.157923074745
 Linear coef   :      -1.541928682797
           Qmin:      -20692.456116030091
Quadratic minimum step length (  0.407939784693) accepted
    Initial Ne1:   14713.99993921
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000061 (step -0.4997 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.069194279522E+04     1.0782E-04     1.0782E-04
      ideal mu1:      -0.452490009629
             Q0:      -20692.456835559649
             G0:      -0.249822515250
   RMS gradient:       0.000033972153
     Trial step:       0.499941018714
             Q1:      -20692.508664443660
 Quadratic coef:       0.073067638761
 Linear coef   :      -0.124896522772
           Qmin:      -20692.510207824256
Quadratic minimum step length (  0.427281460623) accepted
    Initial Ne1:   14714.00027854
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000017 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -2.069245683556E+04     3.3972E-05     3.3972E-05    -5.1404E-01
      ideal mu1:      -0.448741822656
             Q0:      -20692.510220989279
             G0:      -0.060018765195
   RMS gradient:       0.000016655939
     Trial step:       0.462185599842
             Q1:      -20692.527697771722
 Quadratic coef:       0.010263026550
 Linear coef   :      -0.027739808994
           Qmin:      -20692.528965386929
Quadratic minimum step length (  0.624617903726) accepted
    Initial Ne1:   14714.00013348
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000011 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    3        -2.069251022099E+04     1.6656E-05     1.6656E-05    -5.3385E-02
      ideal mu1:      -0.448560720650
             Q0:      -20692.528974698740
             G0:      -0.014963854267
   RMS gradient:       0.000008307125
     Trial step:       0.537298241674
             Q1:      -20692.534764916440
 Quadratic coef:       0.002249834888
 Linear coef   :      -0.008040052586
           Qmin:      -20692.536157719805
Quadratic minimum step length (  0.960049588615) accepted
    Initial Ne1:   14714.00007569
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    4        -2.069252897470E+04     8.3071E-06     8.3071E-06    -1.8754E-02
      ideal mu1:      -0.448501713382
             Q0:      -20692.536158365067
             G0:      -0.010574450892
   RMS gradient:       0.000006988442
     Trial step:       0.718215118110
             Q1:      -20692.539648366539
 Quadratic coef:       0.004104729025
 Linear coef   :      -0.007594730497
           Qmin:      -20692.539671382063
Quadratic minimum step length (  0.664434878313) accepted
    Initial Ne1:   14714.00006390
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.069253615837E+04     6.9884E-06     6.9884E-06    -7.1837E-03
      ideal mu1:      -0.448964616908
             Q0:      -20692.539672566971
             G0:      -0.005652491896
   RMS gradient:       0.000005113451
     Trial step:       0.690801834540
             Q1:      -20692.541516397650
 Quadratic coef:       0.002060921091
 Linear coef   :      -0.003904751771
           Qmin:      -20692.541522114541
Quadratic minimum step length (  0.654418477767) accepted
    Initial Ne1:   14714.00006390
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.069253967257E+04     5.1135E-06     5.1135E-06    -3.5142E-03
      ideal mu1:      -0.448168691178
             Q0:      -20692.541522741310
             G0:      -0.002378925662
   RMS gradient:       0.000003314818
     Trial step:       0.672364101509
             Q1:      -20692.542104381406
 Quadratic coef:       0.001017864121
 Linear coef   :      -0.001599504215
           Qmin:      -20692.542151119324
Quadratic minimum step length (  0.528287220600) accepted
    Initial Ne1:   14714.00001650
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.069254152274E+04     3.3148E-06     3.3148E-06    -1.8502E-03
      ideal mu1:      -0.448907814019
    8        -2.069254215069E+04     2.6133E-06     2.6133E-06    -6.2794E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.06925421506862E+04  Eh
     Estimated bandgap           =   1.1590E-02  Eh
     RMS occupancy error         =   1.0706E-12
     [H,K] commutator            =   2.6133E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1775E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16439690E+00     0.13200861E-02
               2       0.32361233E-03     0.21973606E-05
               3       0.21255053E-08     0.98604458E-11
               4       0.24824640E-12     0.72164497E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.43560519E+00     0.41841636E-02
               2       0.23302087E-02     0.19764003E-04
               3       0.93315278E-07     0.55281490E-09
               4       0.29068733E-12     0.84376950E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00031774739861
Trial step length           =               0.357634
Gradient along search dir.  =        -37.91023547582
Functional at step 0        =  -20692.54215068620397
Functional at step 1        =  -20703.96552290725958
Functional predicted        =  -20714.07039971324048
Selected quadratic step     =               1.135749
Conjugate gradients coeff.  =               0.106639
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:   14751.96319441
     Final electron number for spin 1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001694 (step -0.4964 Ne1=  14714.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.422029677326
             Q0:      -20714.123246365321
             G0:      -0.191048245256
   RMS gradient:       0.000029705767
     Trial step:       0.595987720022
             Q1:      -20714.177808389213
 Quadratic coef:       0.059300384211
 Linear coef   :      -0.113862408105
           Qmin:      -20714.177903043150
Quadratic minimum step length (  0.572176705977) accepted
    Initial Ne1:   14713.99998364
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.071412324637E+04     2.9706E-05     2.9706E-05
      ideal mu1:      -0.426025801433
             Q0:      -20714.177901960502
             G0:      -0.012822949905
   RMS gradient:       0.000007690008
     Trial step:       0.583960863796
             Q1:      -20714.181251023343
 Quadratic coef:       0.004139038061
 Linear coef   :      -0.007488100903
           Qmin:      -20714.181288716936
Quadratic minimum step length (  0.528233590395) accepted
    Initial Ne1:   14714.00000255
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -2.071417790196E+04     7.6900E-06     7.6900E-06    -5.4656E-02
      ideal mu1:      -0.424962857336
             Q0:      -20714.181288074593
             G0:      -0.003512698757
   RMS gradient:       0.000004024050
     Trial step:       0.555398725001
             Q1:      -20714.182309911725
 Quadratic coef:       0.000929111280
 Linear coef   :      -0.001950948411
           Qmin:      -20714.182312225246
Quadratic minimum step length (  0.583113284326) accepted
    Initial Ne1:   14714.00000046
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -2.071418128807E+04     4.0240E-06     4.0240E-06    -3.3861E-03
      ideal mu1:      -0.425415908376
             Q0:      -20714.182312157965
             G0:      -0.002003691691
   RMS gradient:       0.000003044645
     Trial step:       0.569087317242
             Q1:      -20714.183143951785
 Quadratic coef:       0.000308481711
 Linear coef   :      -0.001140275529
           Qmin:      -20714.183365890032
Quadratic minimum step length (  1.051790623003) accepted
    Initial Ne1:   14714.00000027
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -2.071418231216E+04     3.0446E-06     3.0446E-06    -1.0241E-03
      ideal mu1:      -0.425433207997
             Q0:      -20714.183359751507
             G0:      -0.001748722554
   RMS gradient:       0.000002860173
     Trial step:       0.773667049799
             Q1:      -20714.184273417362
 Quadratic coef:       0.000439263164
 Linear coef   :      -0.001352929019
           Qmin:      -20714.184401505678
Quadratic minimum step length (  1.191445914258) accepted
    Initial Ne1:   14713.99999729
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000008 (step -0.4998 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.071418335975E+04     2.8602E-06     2.8602E-06    -1.0476E-03
      ideal mu1:      -0.425622716945
             Q0:      -20714.184402358398
             G0:      -0.001285951728
   RMS gradient:       0.000002434501
     Trial step:       0.960095018985
             Q1:      -20714.184909713185
 Quadratic coef:       0.000727281062
 Linear coef   :      -0.001234635848
           Qmin:      -20714.184926339345
Quadratic minimum step length (  0.814930974131) accepted
    Initial Ne1:   14714.00003660
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.4998 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.071418440236E+04     2.4345E-06     2.4345E-06    -1.0426E-03
      ideal mu1:      -0.425156762538
             Q0:      -20714.184926425594
             G0:      -0.000841613122
   RMS gradient:       0.000001971630
     Trial step:       0.884540089018
             Q1:      -20714.184928921582
 Quadratic coef:       0.000741944557
 Linear coef   :      -0.000744440546
           Qmin:      -20714.185113161828
Quadratic minimum step length (  0.443757892828) accepted
    Initial Ne1:   14714.00001363
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.071418492643E+04     1.9716E-06     1.9716E-06    -5.2407E-04
      ideal mu1:      -0.425666835411
    8        -2.071418511344E+04     1.3816E-06     1.3816E-06    -1.8701E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.07141851134359E+04  Eh
     Estimated bandgap           =   9.6888E-03  Eh
     RMS occupancy error         =   4.7035E-14
     [H,K] commutator            =   1.3816E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :    12362.53358618280981 |
           | Core Hartree               : -2135695.21437231125310 |
           | CoreHart (non-coul chg cor):        0.00000000000000
           | Hartree                    :  1061333.62399896699935 |
           | Exchange-correlation       :    -6901.22293548715061 |
           | Ewald                      :  1045115.32994693215005 |
           | Dij0                       :     3267.52943365877627 |
           | Dijhartree                 :       -3.63074882848181 |
           | Exc [AE core]              :   -16592.55573786820605 |
           | Exc DC [AE core]           :    -5021.22940624032799 |
           | Exc [PS core]              :    -3795.65280229458403 |
           | Exc DC [PS core]           :    -4631.99029219050954 |
           | Exc [Core]                 :   -12603.76891302654258 |
           | Total [Sphere]             :     3070.76466228321442 |
           | Total                      :   -20714.18511343330829 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Core Hartree               : -2135695.21437229495496 |
           | Hartree (Valence)          :  1061333.62399896001443 |
           --------------------------------------------------------
           Integrated compensation chrg.:      449.76982651127429
           Integrated density           :    14713.99999999767897
           Integrated density tr(KS)    :    14713.99999999999818
================================================================================

WARNING: maximum number of NGWF CG iterations (   2) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00097302297756 -20507.37582324997493   1.044318 -20692.01166669678059        
   1     0.00031774739861 -20714.18511343590944  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    8597.753s on     80 proc(s)                                    
TOTAL TIME:      8597.845s on     80 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.01s   0.000%  ------ ||
|| paw_dij_hartree                      :    51        0.02s   0.000%  ------ ||
|| sparse_set_to_garbage                :    27        0.03s   0.000%  ------ ||
|| basis_extract_function_from_box      :   735        0.04s   0.000%  ------ ||
|| paw_tcore_density                    :     1        0.04s   0.001%  ------ ||
|| paw_tcore_hartree_on_grid            :     1        0.11s   0.001%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.26s   0.003%  ------ ||
|| density_init_guess_real              :     1        0.89s   0.010%  ------ ||
|| paw_species_calc_proj_prec_mat       :     1        1.04s   0.012%  ------ ||
|| paw_dataset_init                     :     2        1.06s   0.012%  ------ ||
|| energy_and_force_init_cell           :     1        1.92s   0.022%  ------ ||
|| hartree_on_grid                      :    49        6.18s   0.072%  ------ ||
|| augmentation_screen_dij              :    51        6.27s   0.073%  ------ ||
|| paw_dij_xc                           :    51        9.59s   0.112%  ------ ||
|| pseudo_make_structure_factor         :     1       10.28s   0.120%  ------ ||
|| projectors_init_fftbox_recip         :    54       11.65s   0.135%  ------ ||
|| fourier_apply_box_pair               :  1195       14.28s   0.166%  1.105k ||
|| aug_nonlocal_mat                     :    49       16.07s   0.187%  ------ ||
|| basis_copy_function_to_box           : 14714       16.18s   0.188%  ------ ||
|| sparse_init                          :     1       27.05s   0.315%  ------ ||
|| ewald_calculate_energy               :     1       35.10s   0.408%  ------ ||
|| function_ops_brappd_ketppd           :     5       36.56s   0.425%  ------ ||
|| ngwf_gradient_coeffs                 :     2       45.42s   0.528%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     5       58.33s   0.678%  ------ ||
|| projectors_func_ovlp_box             :     5       68.81s   0.800%  ------ ||
|| fourier_apply_cell_backward          :  1520       72.37s   0.842% 173.985 ||
|| fourier_apply_cell_forward           :  1421       77.38s   0.900% 152.128 ||
|| cell_grid_extract_box_real           :  7988       84.71s   0.985%  ------ ||
|| sparse_trace                         :  1061      103.65s   1.206%  ------ ||
|| integrals_kinetic                    :     5      103.91s   1.209%  ------ ||
|| palser_mano_kernel_optimise          :     1      114.01s   1.326%  ------ ||
|| kernel_purify                        :    73      147.99s   1.721%  ------ ||
|| cell_grid_deposit_box_real           : 18920      157.03s   1.826%  ------ ||
|| augmentation_density_on_grid         :    48      175.41s   2.040%  ------ ||
|| hamiltonian_energy_components        :     1      182.95s   2.128%  ------ ||
|| basis_dot_function_with_box          : 6.901M     217.78s   2.533%  ------ ||
|| xc_energy_potential                  :    49      220.08s   2.560%  ------ ||
|| lnv_gradient_norm                    :    24      229.96s   2.675%  ------ ||
|| kernel_fix                           :    24      285.43s   3.320%  ------ ||
|| density_fftbox_deposit_to_cell       :  8832      310.23s   3.608%  ------ ||
|| nlxc_vdw_energy                      :    98      350.44s   4.076%  ------ ||
|| basis_add_function_to_box            : 12.12M     402.72s   4.684%  ------ ||
|| integrals_locpot_mat_els_batch       :   324      544.03s   6.328%  ------ ||
|| projectors_gradient_batch            :    24      588.15s   6.841%  ------ ||
|| density_batch_row_sums               :   576      912.98s  10.619%  ------ ||
|| projectors_grad_precond_batch        :    24      985.93s  11.467%  ------ ||
|| potential_apply_to_ngwf_batch        :   324      990.62s  11.522%  ------ ||
|| density_fftbox_interpolate_multiply  :  8832     1182.42s  13.753%  ------ ||
|| fourier_apply_box                    : 45664     1233.47s  14.346%  1.626k ||
|| sparse_product                       :  1403     1347.81s  15.676%  ------ ||
|| integrals_locpot_dbl_grid            :    27     1537.22s  17.879%  ------ ||
|| density_batch_interp_deposit         :   576     1675.96s  19.493%  ------ ||
|| ngwf_gradient_build_batch            :    24     1710.53s  19.895%  ------ ||
|| ngwf_gradient_batch                  :    24     1869.34s  21.742%  ------ ||
|| ngwf_gradient_lnv                    :     2     2305.62s  26.816%  ------ ||
|| density_on_dbl_grid                  :    48     2670.42s  31.059%  ------ ||
|| hamiltonian_lhxc_calculate           :    47     3016.97s  35.090%  ------ ||
|| lnv_denskernel_optimise_cg           :     3     5334.49s  62.045%  ------ ||
|| ngwf_cg_optimise                     :     1     8263.53s  96.113%  ------ ||
|| energy_and_forces                    :     1     8594.99s  99.968%  ------ ||
|| total_time                           :     1     8597.75s 100.000%  ------ ||
================================================================================
==================== AVERAGE TIMINGS FROM ALL PROCS (SELF) =====================
++ TAG                                    #calls    cpu time   %total  Gflops ++
++ onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ++
++ onetep.F90 final imbalance           :     1        0.01s   0.000%  ------ ++
++ paw_dij_hartree                      :    51        0.02s   0.000%  ------ ++
++ sparse_set_to_garbage                :    27        0.03s   0.000%  ------ ++
++ paw_tcore_density                    :     1        0.03s   0.000%  ------ ++
++ basis_extract_function_from_box      :   735        0.04s   0.000%  ------ ++
++ paw_tcore_hartree_on_grid            :     1        0.05s   0.001%  ------ ++
++ hartree_on_grid                      :    49        0.12s   0.001%  ------ ++
++ ngwfs_initialise_from_radial         :     1        0.26s   0.003%  ------ ++
++ hamiltonian_energy_components        :     1        0.55s   0.006%  ------ ++
++ density_init_guess_real              :     1        0.68s   0.008%  ------ ++
++ energy_and_forces                    :     1        0.69s   0.008%  ------ ++
++ main_program_(onetep.F90)            :     1        0.83s   0.010%  ------ ++
++ paw_species_calc_proj_prec_mat       :     1        0.84s   0.010%  ------ ++
++ energy_and_force_init_cell           :     1        0.85s   0.010%  ------ ++
++ aug_nonlocal_mat                     :    49        0.89s   0.010%  ------ ++
++ paw_dataset_init                     :     2        1.06s   0.012%  ------ ++
++ ngwf_gradient_coeffs                 :     2        1.10s   0.013%  ------ ++
++ sparse_embed_hotelling_invert_embed  :     5        1.30s   0.015%  ------ ++
++ integrals_locpot_dbl_grid            :    27        2.58s   0.030%  ------ ++
++ palser_mano_kernel_optimise          :     1        4.92s   0.057%  ------ ++
++ augmentation_screen_dij              :    51        5.42s   0.063%  ------ ++
++ kernel_fix                           :    24        6.72s   0.078%  ------ ++
++ kernel_purify                        :    73        7.18s   0.084%  ------ ++
++ paw_dij_xc                           :    51        9.59s   0.112%  ------ ++
++ pseudo_make_structure_factor         :     1       10.28s   0.120%  ------ ++
++ hamiltonian_lhxc_calculate           :    47       11.15s   0.130%  ------ ++
++ projectors_init_fftbox_recip         :    54       11.65s   0.135%  ------ ++
++ fourier_apply_box_pair               :  1195       14.28s   0.166%  1.105k ++
++ lnv_denskernel_optimise_cg           :     3       15.96s   0.186%  ------ ++
++ basis_copy_function_to_box           : 14714       16.18s   0.188%  ------ ++
++ augmentation_density_on_grid         :    48       19.39s   0.226%  ------ ++
++ xc_energy_potential                  :    49       25.49s   0.296%  ------ ++
++ sparse_init                          :     1       27.05s   0.315%  ------ ++
++ projectors_func_ovlp_box             :     5       33.55s   0.390%  ------ ++
++ ewald_calculate_energy               :     1       35.10s   0.408%  ------ ++
++ lnv_gradient_norm                    :    24       36.23s   0.421%  ------ ++
++ function_ops_brappd_ketppd           :     5       36.56s   0.425%  ------ ++
++ ngwf_cg_optimise                     :     1       38.56s   0.448%  ------ ++
++ nlxc_vdw_energy                      :    98       50.97s   0.593%  ------ ++
++ ngwf_gradient_build_batch            :    24       51.09s   0.594%  ------ ++
++ fourier_apply_cell_backward          :  1520       72.37s   0.842% 173.985 ++
++ integrals_kinetic                    :     5       76.35s   0.888%  ------ ++
++ fourier_apply_cell_forward           :  1421       77.38s   0.900% 152.128 ++
++ ngwf_gradient_batch                  :    24       79.96s   0.930%  ------ ++
++ density_on_dbl_grid                  :    48       81.48s   0.948%  ------ ++
++ cell_grid_extract_box_real           :  7988       84.71s   0.985%  ------ ++
++ sparse_trace                         :  1061      103.65s   1.206%  ------ ++
++ cell_grid_deposit_box_real           : 18920      157.03s   1.826%  ------ ++
++ density_fftbox_deposit_to_cell       :  8832      158.22s   1.840%  ------ ++
++ density_batch_interp_deposit         :   576      187.14s   2.177%  ------ ++
++ basis_dot_function_with_box          : 6.901M     217.78s   2.533%  ------ ++ (!) overhead: ~   4.0%
++ integrals_locpot_mat_els_batch       :   324      357.79s   4.161%  ------ ++
++ ngwf_gradient_lnv                    :     2      390.86s   4.546%  ------ ++
++ basis_add_function_to_box            : 12.12M     402.72s   4.684%  ------ ++ (!) overhead: ~   3.8%
++ density_fftbox_interpolate_multiply  :  8832      449.64s   5.230%  ------ ++
++ potential_apply_to_ngwf_batch        :   324      500.51s   5.821%  ------ ++
++ projectors_gradient_batch            :    24      578.77s   6.732%  ------ ++
++ density_batch_row_sums               :   576      584.50s   6.798%  ------ ++
++ projectors_grad_precond_batch        :    24      974.43s  11.334%  ------ ++
++ fourier_apply_box                    : 45664     1233.47s  14.346%  1.626k ++
++ sparse_product                       :  1403     1347.81s  15.676%  ------ ++
================================================================================
(!) WARNING: You're wasting precious cycles calling timer. 
             Each pair of timer_clock calls itself cost   1.25 microseconds!
Overhead of generating timer report: 
- 13 ms averaging over threads,
- 22 ms ensuring consistency across MPI ranks,
- 29 ms printing in order.

Job completed: 12-01-2023 18:59 (-0000)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
