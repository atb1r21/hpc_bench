==================================================================================
It's Thu Jan 12 19:48:02 GMT 2023.
*** Starting onetep_launcher (node red381.cluster.local, PIDs 214449 214450 214451 214452 214453 214454 214455 214456 214457 214458)...
    - ONETEP arguments: 4088.dat
    - Current directory: /home/hpc/benchmarks-2022/ONETEP/data_input/16_nodes/testcase1
    - Launcher executable directory: /mainfs/home/hpc/benchmarks-2022/ONETEP/source/utils
    - (-e) ONETEP executable specified through command-line: /home/hpc/benchmarks-2022/ONETEP/source/bin/onetep.iridis5.intel21.omp.scalapack
      ... trying /home/hpc/benchmarks-2022/ONETEP/source/bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 4
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /home/hpc/benchmarks-2022/ONETEP/source/bin/onetep.iridis5.intel21.omp.scalapack 4088.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12.0  |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2023     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 12-01-2023 19:48 (-0000)
 
Reading parameters from file "4088.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 4 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 4
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 160 MPI processes.
   There are 10 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
               4 threads for loops over batched FFT box operations.
               4 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.
... done

Reading geometry and species blocks from file "4088.dat" ...
  Reading POSITIONS geometry from 4088.xyz
    
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task : singlepoint                                                              
timings_level 3                                                                 
output_detail VERBOSE                                                           
xc_functional OPTPBE                                                            
cutoff_energy 830 eV                                                            
paw T                                                                           
MAXIT_NGWF_CG 2                                                                 
minit_lnv 8                                                                     
maxit_lnv 8                                                                     
write_tightbox_ngwfs F                                                          
write_denskern F                                                                
%BLOCK SPECIES                                                                  
C1 C 6 4 9.0                                                                    
H1 H 1 1 9.0                                                                    
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
C1 "c_pbe_abinit.paw"                                                           
H1 "h_pbe_abinit.paw"                                                           
%ENDBLOCK SPECIES_POT                                                           
%BLOCK SPECIES_ATOMIC_SET                                                       
C1 "SOLVE conf=2s2 2p2"                                                         
H1 "SOLVE conf=1s1"                                                             
%ENDBLOCK SPECIES_ATOMIC_SET                                                    
%BLOCK SPECIES_LDOS_GROUPS                                                      
C1                                                                              
H1                                                                              
%ENDBLOCK SPECIES_LDOS_GROUPS                                                   
%BLOCK LATTICE_CART                                                             
113.383578780000     0.000000000000       0.000000000000                        
0.000000000000       113.383578780000     0.000000000000                        
0.000000000000       0.000000000000       143.8123051                           
%ENDBLOCK LATTICE_CART                                                          
positions_xyz_file 4088.xyz                                                     
     Hash =  -000002130319080441064013

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<<<< PAW Dataset information >>>>>>>>>>>>>>>>>>>>>>>>>>>
File: c_pbe_abinit.paw; rc = 1.25 bohr; shape type =  3; rshape = 1.25 bohr;
  Atomic number:  6;  ionic charge:  4.000000
    Partial Wave 1: l = 0
    Partial Wave 2: l = 0
    Partial Wave 3: l = 1
    Partial Wave 4: l = 1
  Core charge supplied for Nonlinear Core Corrections
File: h_pbe_abinit.paw; rc = 0.90 bohr; shape type =  3; rshape = 0.90 bohr;
  Atomic number:  1;  ionic charge:  1.000000
    Partial Wave 1: l = 0
    Partial Wave 2: l = 0
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C       3542     14168     28336
  H        546       546      1092
.......   ......    ......    ......
Totals:   4088     14714     29428
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:  231 x 231 x 288
                              FFT-box:  117 x 117 x 117
                                  PPD:    7 x   7 x   1
Grid space d1=  0.490838003377a0 (KE cutoff=  31.53027Eh = 857.98221eV)
Grid space d2=  0.490838003377a0 (KE cutoff=  31.53027Eh = 857.98221eV)
Grid space d3=  0.499348281597a0 (KE cutoff=  30.46470Eh = 828.98662eV)
================================================================================
  
WARNING in cell_grid_distribute:
Average of less than one 23-slab per proc, so workload cannot be
equally balanced between procs.

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:    231   231   288
          Real-space ('12') slabs/proc (min max mean):      1     2     1
         Recip-space ('23') slabs/proc (min max mean):      0     1     0
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    462   462   576
          Real-space ('12') slabs/proc (min max mean):      3     4     3
         Recip-space ('23') slabs/proc (min max mean):      1     2     1
********************************************************************************

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String: 2s2 2p2
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1377    0.0065406977    9.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    2  183.0116354500
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.4795186097   -1.3252230651    4.5135247139   -1.6370402178
  2         -5.4480873667   -1.4027986130    4.4305957006   -1.6109824140
  3         -5.4553175168   -1.4212842775    4.4102621601   -1.6059044058
  4         -5.4627851864   -1.4247099971    4.4065125496   -1.6052912254
  5         -5.4662317525   -1.4266823431    4.4043718731   -1.6049357348
  6         -5.4679531179   -1.4277361345    4.4032352159   -1.6047498153
  7         -5.4688370531   -1.4282876632    4.4026436340   -1.6046546171
  8         -5.4692962224   -1.4285743132    4.4023378281   -1.6046060967
  9         -5.4695360875   -1.4287229388    4.4021801230   -1.6045813828
 10         -5.4696617783   -1.4287999625    4.4020988354   -1.6045687883
 11         -5.4697277645   -1.4288398966    4.4020569195   -1.6045623641
 12         -5.4697624500   -1.4288606199    4.4020352864   -1.6045590836
 13         -5.4697806994   -1.4288713865    4.4020241086   -1.6045574064
 14         -5.4697903086   -1.4288769875    4.4020183254   -1.6045565478
 15         -5.4697953717   -1.4288799052    4.4020153292   -1.6045561077
 16         -5.4697980412   -1.4288814272    4.4020137746   -1.6045558818
 17         -5.4697994496   -1.4288822223    4.4020129668   -1.6045557657
 18         -5.4698001930   -1.4288826382    4.4020125465   -1.6045557059
 19         -5.4698005858   -1.4288828561    4.4020123274   -1.6045556751
 20         -5.4698007933   -1.4288829704    4.4020122131   -1.6045556592
 21         -5.4698009031   -1.4288830304    4.4020121533   -1.6045556509
 22         -5.4698009612   -1.4288830620    4.4020121220   -1.6045556467
Atom SCF converged after  22 iterations to a total energy of     -5.46980096

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String: 1s1
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1377    0.0065406977    9.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  183.0116354500
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3687944832   -0.2607687933    0.2820952946   -0.2613406499
  2         -0.4328656062   -0.2590521405    0.2895573663   -0.2701762133
  3         -0.4633856573   -0.2560091938    0.2934204754   -0.2757429988
  4         -0.4750266404   -0.2549676794    0.2946557510   -0.2779015032
  5         -0.4793045155   -0.2546870695    0.2949704774   -0.2786577123
  6         -0.4808919118   -0.2546234645    0.2950332622   -0.2789201171
  7         -0.4814942533   -0.2546130669    0.2950388368   -0.2790132353
  8         -0.4817280090   -0.2546133926    0.2950352123   -0.2790473458
  9         -0.4818204053   -0.2546148712    0.2950319888   -0.2790602287
 10         -0.4818574273   -0.2546158825    0.2950301416   -0.2790652181
 11         -0.4818724050   -0.2546164247    0.2950292178   -0.2790671871
 12         -0.4818785049   -0.2546166894    0.2950287833   -0.2790679748
 13         -0.4818810009   -0.2546168128    0.2950285855   -0.2790682928
 14         -0.4818820255   -0.2546168689    0.2950284970   -0.2790684221
 15         -0.4818824471   -0.2546168940    0.2950284580   -0.2790684748
 16         -0.4818826210   -0.2546169051    0.2950284408   -0.2790684964
 17         -0.4818826928   -0.2546169100    0.2950284333   -0.2790685053
Atom SCF converged after  17 iterations to a total energy of     -0.48188269

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max     93;  min     90;  average     92
... Projector load balancing: max    186;  min    180;  average    184
... done
Calculating Ewald energy ...
              Ewald: real-space energy =       323097.995517
        Ewald: reciprocal-space energy =       779042.118884
         Ewald: (sum_charge)**2 energy =        55160.613665
         Ewald: (sum_charge**2) energy =         1864.170788
                          Ewald energy =      1045115.329948
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Projector tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):       1864560    298592374
... PAW projector initialisation
... done

============================= Charge Augmentation ==============================
                           Aug box size:   13 x  13 x  13
================================================================================

========================== Sparse matrix information ===========================
                        Overlap matrix filling:   8.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling:   1.91%
                    Aug Overlap matrix filling:   9.15%
                    Hamiltonian matrix filling:   9.15%
                  NGWF diagonal matrix filling:   0.03%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11790782E+03     0.98035989E+00
               2       0.11513195E+03     0.96161427E+00
               3       0.11085712E+03     0.92653618E+00
               4       0.10516196E+03     0.86450762E+00
               5       0.98300308E+02     0.76791673E+00
               6       0.90366441E+02     0.68642725E+00
               7       0.82037045E+02     0.63659600E+00
               8       0.74075949E+02     0.59917999E+00
               9       0.65678814E+02     0.55691692E+00
              10       0.55055843E+02     0.48977372E+00
              11       0.41087465E+02     0.38220332E+00
              12       0.24797068E+02     0.24026804E+00
              13       0.10387116E+02     0.10068673E+00
              14       0.22342232E+01     0.20180765E-01
              15       0.12579150E+00     0.10061756E-02
              16       0.49179247E-03     0.32341407E-05
              17       0.10876177E-07     0.50948579E-10
              18       0.20760349E-12     0.53290705E-14
================================================================================
Calculating core density ...
================================= Core Density =================================
               Core den box size:   21 x  21 x  21
================================================================================
 ... done
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1       -3098.99694035792118    0.5063231
               2       -3513.64825383369634    0.5149639
               3       -3829.17350409736173    0.5352217
               4       -4020.10048609846126    0.5674461
               5       -4110.96142538904314    0.5870509
               6       -4151.39591613335324    0.5766943
               7       -4172.95384075181573    0.5629534
               8       -4183.81434798430746    0.5607727
               9       -4188.22824740418764    0.5634949
              10       -4189.77974392637771    0.5536469
              11       -4190.37158875151181    0.5386448
              12       -4190.61903071032611    0.5323875
              13       -4190.72406427034366    0.5456146
              14       -4190.76540091898278    0.5759749
              15       -4190.77858028649734    0.5751674
              16       -4190.78319614776319    0.5232109
              17       -4190.78537692894679    0.4566978
              18       -4190.78606367966859    0.4275302
              19       -4190.78633789216838    0.4397370
              20       -4190.78658697152241    0.4634387
              21       -4190.78681614086145    0.4860741
              22       -4190.78695364058149    0.4979933
              23       -4190.78698770830579    0.4999615
              24       -4190.78698932942279    0.5000007
              25       -4190.78698933288979    0.5000007
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:   14714.00000000
     Final electron number for spin 1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.464856046938
             Q0:      -20505.654590260419
             G0:      -8.435674476908
   RMS gradient:       0.000197391821
     Trial step:       0.500000000000
             Q1:      -20507.199396024975
 Quadratic coef:       2.673031473900
 Linear coef   :      -4.217837238454
           Qmin:      -20507.318445619381
Quadratic minimum step length (  0.394480693516) accepted
    Initial Ne1:   14714.00000000
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000303 (step -0.4983 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.050565459026E+04     1.9739E-04     1.9739E-04
      ideal mu1:      -0.526041159875
             Q0:      -20507.322774357526
             G0:      -0.207594791559
   RMS gradient:       0.000030942653
     Trial step:       0.444117492065
             Q1:      -20507.360120887759
 Quadratic coef:       0.054849947959
 Linear coef   :      -0.092196478193
           Qmin:      -20507.361517286678
Quadratic minimum step length (  0.373255310130) accepted
    Initial Ne1:   14714.00140706
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -2.050732277436E+04     3.0943E-05     3.0943E-05    -1.6682E+00
      ideal mu1:      -0.521201609613
             Q0:      -20507.361530044684
             G0:      -0.031410528572
   RMS gradient:       0.000012047317
     Trial step:       0.407147654095
             Q1:      -20507.369532552606
 Quadratic coef:       0.004786215100
 Linear coef   :      -0.012788723022
           Qmin:      -20507.370072882451
Quadratic minimum step length (  0.543947406039) accepted
    Initial Ne1:   14714.00032873
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    3        -2.050736153004E+04     1.2047E-05     1.2047E-05    -3.8756E-02
      ideal mu1:      -0.523590455448
             Q0:      -20507.370075792642
             G0:      -0.006069829445
   RMS gradient:       0.000005291954
     Trial step:       0.470602709639
             Q1:      -20507.371951763416
 Quadratic coef:       0.000980507408
 Linear coef   :      -0.002856478184
           Qmin:      -20507.372156212317
Quadratic minimum step length (  0.685495266316) accepted
    Initial Ne1:   14714.00008420
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -2.050737007579E+04     5.2920E-06     5.2920E-06    -8.5457E-03
      ideal mu1:      -0.523161322145
             Q0:      -20507.372156916565
             G0:      -0.004196582351
   RMS gradient:       0.000004400379
     Trial step:       0.567975289756
             Q1:      -20507.373713849105
 Quadratic coef:       0.000826622538
 Linear coef   :      -0.002383555077
           Qmin:      -20507.373875153891
Quadratic minimum step length (  0.818874591170) accepted
    Initial Ne1:   14714.00006660
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4995 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.050737215692E+04     4.4004E-06     4.4004E-06    -2.0811E-03
      ideal mu1:      -0.524344938269
             Q0:      -20507.373874797420
             G0:      -0.003184402031
   RMS gradient:       0.000003836330
     Trial step:       0.681982795379
             Q1:      -20507.375211606246
 Quadratic coef:       0.000834898572
 Linear coef   :      -0.002171707398
           Qmin:      -20507.375287038732
Quadratic minimum step length (  0.886974257634) accepted
    Initial Ne1:   14714.00020490
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000019 (step -0.4987 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.050737387480E+04     3.8363E-06     3.8363E-06    -1.7179E-03
      ideal mu1:      -0.524516250037
             Q0:      -20507.375286798502
             G0:      -0.002221689887
   RMS gradient:       0.000003203398
     Trial step:       0.777753935156
             Q1:      -20507.375622550397
 Quadratic coef:       0.001392176157
 Linear coef   :      -0.001727928052
           Qmin:      -20507.375822961858
Quadratic minimum step length (  0.482662641445) accepted
    Initial Ne1:   14714.00024781
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.050737528680E+04     3.2034E-06     3.2034E-06    -1.4120E-03
      ideal mu1:      -0.524697091086
    8        -2.050737582266E+04     2.2277E-06     2.2277E-06    -5.3586E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.05073758226579E+04  Eh
     Estimated bandgap           =   1.2679E-02  Eh
     RMS occupancy error         =   6.2957E-12
     [H,K] commutator            =   2.2277E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.7302E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56774233E-01     0.35838901E-03
               2       0.31959727E-04     0.18079628E-06
               3       0.24767915E-10     0.99809050E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.68218884E+00     0.74278868E-02
               2       0.59585958E-02     0.59208526E-04
               3       0.53152030E-06     0.43506582E-08
               4       0.24591406E-12     0.59952043E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00097302297750
Trial step length           =               0.122474
Gradient along search dir.  =       -353.60073549392
Functional at step 0        =  -20507.37582265793753
Functional at step 1        =  -20548.14343025218113
Functional predicted        =  -20692.01166670603561
Selected quadratic step     =               1.044318
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:   14774.49905715
     Final electron number for spin 1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002840 (step -0.4932 Ne1=  14714.0000)
 RMS occupancy error at iteration   2:  0.000017 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.421960417786
             Q0:      -20691.942794621798
             G0:      -2.516649981312
   RMS gradient:       0.000107815365
     Trial step:       0.612693046098
             Q1:      -20692.326797598442
 Quadratic coef:       1.157930966368
 Linear coef   :      -1.541933943012
           Qmin:      -20692.456115440065
Quadratic minimum step length (  0.407939778737) accepted
    Initial Ne1:   14713.99993921
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000061 (step -0.4997 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.069194279462E+04     1.0782E-04     1.0782E-04
      ideal mu1:      -0.452490009238
             Q0:      -20692.456834970202
             G0:      -0.249822520091
   RMS gradient:       0.000033972153
     Trial step:       0.499941862279
             Q1:      -20692.508663823857
 Quadratic coef:       0.073067882280
 Linear coef   :      -0.124896735934
           Qmin:      -20692.510207239113
Quadratic minimum step length (  0.427281486795) accepted
    Initial Ne1:   14714.00027854
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000017 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -2.069245683497E+04     3.3972E-05     3.3972E-05    -5.1404E-01
      ideal mu1:      -0.448741822699
             Q0:      -20692.510220399206
             G0:      -0.060018769116
   RMS gradient:       0.000016655940
     Trial step:       0.462186003926
             Q1:      -20692.527697191988
 Quadratic coef:       0.010263042277
 Linear coef   :      -0.027739835058
           Qmin:      -20692.528964803358
Quadratic minimum step length (  0.624618079559) accepted
    Initial Ne1:   14714.00013348
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000011 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    3        -2.069251022040E+04     1.6656E-05     1.6656E-05    -5.3385E-02
      ideal mu1:      -0.448560721021
             Q0:      -20692.528974113346
             G0:      -0.014963858384
   RMS gradient:       0.000008307127
     Trial step:       0.537298552177
             Q1:      -20692.534764332486
 Quadratic coef:       0.002249840305
 Linear coef   :      -0.008040059445
           Qmin:      -20692.536157129372
Quadratic minimum step length (  0.960048650891) accepted
    Initial Ne1:   14714.00007569
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    4        -2.069252897411E+04     8.3071E-06     8.3071E-06    -1.8754E-02
      ideal mu1:      -0.448501712555
             Q0:      -20692.536157775598
             G0:      -0.010574443226
   RMS gradient:       0.000006988437
     Trial step:       0.718214974881
             Q1:      -20692.539647780024
 Quadratic coef:       0.004104719050
 Linear coef   :      -0.007594723476
           Qmin:      -20692.539670794635
Quadratic minimum step length (  0.664435746328) accepted
    Initial Ne1:   14714.00006390
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.069253615778E+04     6.9884E-06     6.9884E-06    -7.1837E-03
      ideal mu1:      -0.448964618634
             Q0:      -20692.539671980550
             G0:      -0.005652495049
   RMS gradient:       0.000005113454
     Trial step:       0.690802216889
             Q1:      -20692.541515817815
 Quadratic coef:       0.002060918847
 Linear coef   :      -0.003904756111
           Qmin:      -20692.541521534247
Quadratic minimum step length (  0.654420280042) accepted
    Initial Ne1:   14714.00006390
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.4999 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.069253967198E+04     5.1135E-06     5.1135E-06    -3.5142E-03
      ideal mu1:      -0.448168688161
             Q0:      -20692.541522156695
             G0:      -0.002378941492
   RMS gradient:       0.000003314829
     Trial step:       0.672365213430
             Q1:      -20692.542103792039
 Quadratic coef:       0.001017882161
 Linear coef   :      -0.001599517504
           Qmin:      -20692.542150534013
Quadratic minimum step length (  0.528283120014) accepted
    Initial Ne1:   14714.00001650
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.069254152216E+04     3.3148E-06     3.3148E-06    -1.8502E-03
      ideal mu1:      -0.448907811429
    8        -2.069254215010E+04     2.6133E-06     2.6133E-06    -6.2794E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.06925421500998E+04  Eh
     Estimated bandgap           =   1.1529E-02  Eh
     RMS occupancy error         =   1.0706E-12
     [H,K] commutator            =   2.6133E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1775E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16439691E+00     0.13200861E-02
               2       0.32361234E-03     0.21973597E-05
               3       0.21255048E-08     0.98567821E-11
               4       0.21372570E-12     0.65503158E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.43560519E+00     0.41841639E-02
               2       0.23302088E-02     0.19763997E-04
               3       0.93315277E-07     0.55281868E-09
               4       0.24146952E-12     0.51070259E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00031774739957
Trial step length           =               0.357634
Gradient along search dir.  =        -37.91023558254
Functional at step 0        =  -20692.54215009982727
Functional at step 1        =  -20703.96552236618300
Functional predicted        =  -20714.07039916174836
Selected quadratic step     =               1.135749
Conjugate gradients coeff.  =               0.106639
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:   14751.96319475
     Final electron number for spin 1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001694 (step -0.4964 Ne1=  14714.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.422029676806
             Q0:      -20714.123245764342
             G0:      -0.191048262803
   RMS gradient:       0.000029705769
     Trial step:       0.595985899783
             Q1:      -20714.177807807479
 Quadratic coef:       0.059300027671
 Linear coef   :      -0.113862070809
           Qmin:      -20714.177902446969
Quadratic minimum step length (  0.572176703679) accepted
    Initial Ne1:   14713.99998364
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.071412324576E+04     2.9706E-05     2.9706E-05
      ideal mu1:      -0.426025802168
             Q0:      -20714.177901365081
             G0:      -0.012822947311
   RMS gradient:       0.000007690007
     Trial step:       0.583959970868
             Q1:      -20714.181250426554
 Quadratic coef:       0.004139026467
 Linear coef   :      -0.007488087938
           Qmin:      -20714.181288119275
Quadratic minimum step length (  0.528233347793) accepted
    Initial Ne1:   14714.00000255
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -2.071417790137E+04     7.6900E-06     7.6900E-06    -5.4656E-02
      ideal mu1:      -0.424962857409
             Q0:      -20714.181287474086
             G0:      -0.003512694697
   RMS gradient:       0.000004024046
     Trial step:       0.555398172835
             Q1:      -20714.182309317344
 Quadratic coef:       0.000929100959
 Linear coef   :      -0.001950944217
           Qmin:      -20714.182311631714
Quadratic minimum step length (  0.583117928442) accepted
    Initial Ne1:   14714.00000046
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -2.071418128747E+04     4.0240E-06     4.0240E-06    -3.3861E-03
      ideal mu1:      -0.425415912523
             Q0:      -20714.182311560056
             G0:      -0.002003705305
   RMS gradient:       0.000003044668
     Trial step:       0.569089300553
             Q1:      -20714.183143354872
 Quadratic coef:       0.000308492436
 Linear coef   :      -0.001140287251
           Qmin:      -20714.183365277153
Quadratic minimum step length (  1.051768534657) accepted
    Initial Ne1:   14714.00000027
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -2.071418231156E+04     3.0447E-06     3.0447E-06    -1.0241E-03
      ideal mu1:      -0.425433203746
             Q0:      -20714.183359151095
             G0:      -0.001748698817
   RMS gradient:       0.000002860134
     Trial step:       0.773660274107
             Q1:      -20714.184272803534
 Quadratic coef:       0.000439246367
 Linear coef   :      -0.001352898806
           Qmin:      -20714.184400898572
Quadratic minimum step length (  1.191454431452) accepted
    Initial Ne1:   14713.99999729
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000008 (step -0.4998 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    5        -2.071418335915E+04     2.8601E-06     2.8601E-06    -1.0476E-03
      ideal mu1:      -0.425622714548
             Q0:      -20714.184401764724
             G0:      -0.001285942485
   RMS gradient:       0.000002434483
     Trial step:       0.960094246427
             Q1:      -20714.184909120624
 Quadratic coef:       0.000727270082
 Linear coef   :      -0.001234625981
           Qmin:      -20714.184925745205
Quadratic minimum step length (  0.814936108182) accepted
    Initial Ne1:   14714.00003660
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.4998 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    6        -2.071418440176E+04     2.4345E-06     2.4345E-06    -1.0426E-03
      ideal mu1:      -0.425156762595
             Q0:      -20714.184925822185
             G0:      -0.000841614097
   RMS gradient:       0.000001971632
     Trial step:       0.884542519425
             Q1:      -20714.184928310118
 Quadratic coef:       0.000741955519
 Linear coef   :      -0.000744443454
           Qmin:      -20714.185112557119
Quadratic minimum step length (  0.443754289715) accepted
    Initial Ne1:   14714.00001363
      Final Ne1:   14714.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=  14714.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=  14714.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7        -2.071418492582E+04     1.9716E-06     1.9716E-06    -5.2406E-04
      ideal mu1:      -0.425666829494
    8        -2.071418511283E+04     1.3816E-06     1.3816E-06    -1.8701E-04
Finished density kernel iterations (   8)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.07141851128297E+04  Eh
     Estimated bandgap           =   9.4974E-03  Eh
     RMS occupancy error         =   4.7028E-14
     [H,K] commutator            =   1.3816E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :    12362.53358994072005 |
           | Core Hartree               : -2135695.21446224814281 |
           | CoreHart (non-coul chg cor):        0.00000000000000
           | Hartree                    :  1061333.62408627546392 |
           | Exchange-correlation       :    -6901.22293633793470 |
           | Ewald                      :  1045115.32994753122330 |
           | Dij0                       :     3267.52943329662594 |
           | Dijhartree                 :       -3.63074885305619 |
           | Exc [AE core]              :   -16592.55573849916254 |
           | Exc DC [AE core]           :    -5021.22940703621043 |
           | Exc [PS core]              :    -3795.65280303602503 |
           | Exc DC [PS core]           :    -4631.99029311210325 |
           | Exc [Core]                 :   -12603.76891302654258 |
           | Total [Sphere]             :     3070.76466200697541 |
           | Total                      :   -20714.18511283200860 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Core Hartree               : -2135695.21446223137900 |
           | Hartree (Valence)          :  1061333.62408626591787 |
           --------------------------------------------------------
           Integrated compensation chrg.:      449.76982723896913
           Integrated density           :    14713.99999999884312
           Integrated density tr(KS)    :    14714.00000000000182
================================================================================

WARNING: maximum number of NGWF CG iterations (   2) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00097302297750 -20507.37582265793753   1.044318 -20692.01166670603561        
   1     0.00031774739957 -20714.18511282970576  <-- CG                                 

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:    4914.756s on    160 proc(s)                                    
TOTAL TIME:      4914.788s on    160 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| paw_dij_hartree                      :    51        0.01s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.01s   0.000%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.01s   0.000%  ------ ||
|| sparse_set_to_garbage                :    27        0.02s   0.000%  ------ ||
|| basis_extract_function_from_box      :   367        0.02s   0.000%  ------ ||
|| paw_tcore_density                    :     1        0.10s   0.002%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.13s   0.003%  ------ ||
|| paw_tcore_hartree_on_grid            :     1        0.21s   0.004%  ------ ||
|| paw_dataset_init                     :     2        0.23s   0.005%  ------ ||
|| density_init_guess_real              :     1        0.55s   0.011%  ------ ||
|| paw_species_calc_proj_prec_mat       :     1        1.04s   0.021%  ------ ||
|| energy_and_force_init_cell           :     1        1.20s   0.024%  ------ ||
|| augmentation_screen_dij              :    51        4.74s   0.096%  ------ ||
|| paw_dij_xc                           :    51        4.96s   0.101%  ------ ||
|| hartree_on_grid                      :    49        5.18s   0.105%  ------ ||
|| pseudo_make_structure_factor         :     1        6.48s   0.132%  ------ ||
|| projectors_init_fftbox_recip         :    30        6.48s   0.132%  ------ ||
|| fourier_apply_box_pair               :   597        7.10s   0.144%  2.223k ||
|| basis_copy_function_to_box           :  7357        8.13s   0.165%  ------ ||
|| aug_nonlocal_mat                     :    49       11.14s   0.227%  ------ ||
|| ewald_calculate_energy               :     1       16.83s   0.342%  ------ ||
|| ngwf_gradient_coeffs                 :     2       25.24s   0.514%  ------ ||
|| sparse_init                          :     1       25.87s   0.526%  ------ ||
|| function_ops_brappd_ketppd           :     5       26.01s   0.529%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     5       35.64s   0.725%  ------ ||
|| projectors_func_ovlp_box             :     5       41.38s   0.842%  ------ ||
|| cell_grid_extract_box_real           :  4050       49.98s   1.017%  ------ ||
|| fourier_apply_cell_forward           :  1421       50.30s   1.023% 234.039 ||
|| fourier_apply_cell_backward          :  1520       51.07s   1.039% 246.569 ||
|| sparse_trace                         :  1061       64.14s   1.305%  ------ ||
|| integrals_kinetic                    :     5       66.74s   1.358%  ------ ||
|| palser_mano_kernel_optimise          :     1       68.69s   1.398%  ------ ||
|| kernel_purify                        :    73       96.90s   1.972%  ------ ||
|| augmentation_density_on_grid         :    48       98.50s   2.004%  ------ ||
|| cell_grid_deposit_box_real           :  9508      102.38s   2.083%  ------ ||
|| basis_dot_function_with_box          : 3.451M     104.29s   2.122%  ------ ||
|| hamiltonian_energy_components        :     1      105.45s   2.146%  ------ ||
|| xc_energy_potential                  :    49      139.18s   2.832%  ------ ||
|| lnv_gradient_norm                    :    24      150.41s   3.060%  ------ ||
|| kernel_fix                           :    24      185.77s   3.780%  ------ ||
|| basis_add_function_to_box            : 6.059M     190.15s   3.869%  ------ ||
|| density_fftbox_deposit_to_cell       :  4464      193.49s   3.937%  ------ ||
|| nlxc_vdw_energy                      :    98      216.25s   4.400%  ------ ||
|| projectors_gradient_batch            :    12      298.89s   6.081%  ------ ||
|| integrals_locpot_mat_els_batch       :   162      372.82s   7.586%  ------ ||
|| projectors_grad_precond_batch        :    12      506.29s  10.301%  ------ ||
|| potential_apply_to_ngwf_batch        :   162      509.34s  10.364%  ------ ||
|| density_fftbox_interpolate_multiply  :  4464      574.35s  11.686%  ------ ||
|| fourier_apply_box                    : 22831      604.17s  12.293%  3.319k ||
|| density_batch_row_sums               :   288      613.29s  12.479%  ------ ||
|| sparse_product                       :  1403      803.77s  16.354%  ------ ||
|| density_batch_interp_deposit         :   288      865.50s  17.610%  ------ ||
|| ngwf_gradient_build_batch            :    12      875.59s  17.816%  ------ ||
|| integrals_locpot_dbl_grid            :    27      884.14s  17.990%  ------ ||
|| ngwf_gradient_batch                  :    12      972.98s  19.797%  ------ ||
|| ngwf_gradient_lnv                    :     2     1199.53s  24.407%  ------ ||
|| density_on_dbl_grid                  :    48     1521.72s  30.962%  ------ ||
|| hamiltonian_lhxc_calculate           :    47     1737.18s  35.346%  ------ ||
|| lnv_denskernel_optimise_cg           :     3     3122.19s  63.527%  ------ ||
|| ngwf_cg_optimise                     :     1     4709.71s  95.828%  ------ ||
|| energy_and_forces                    :     1     4912.66s  99.957%  ------ ||
|| total_time                           :     1     4914.76s 100.000%  ------ ||
================================================================================
==================== AVERAGE TIMINGS FROM ALL PROCS (SELF) =====================
++ TAG                                    #calls    cpu time   %total  Gflops ++
++ paw_dij_hartree                      :    51        0.01s   0.000%  ------ ++
++ onetep.F90 final imbalance           :     1        0.01s   0.000%  ------ ++
++ onetep.F90 main loop imbalance       :     1        0.01s   0.000%  ------ ++
++ sparse_set_to_garbage                :    27        0.02s   0.000%  ------ ++
++ basis_extract_function_from_box      :   367        0.02s   0.000%  ------ ++
++ paw_tcore_hartree_on_grid            :     1        0.03s   0.001%  ------ ++
++ paw_tcore_density                    :     1        0.07s   0.001%  ------ ++
++ hartree_on_grid                      :    49        0.10s   0.002%  ------ ++
++ ngwfs_initialise_from_radial         :     1        0.13s   0.003%  ------ ++
++ paw_dataset_init                     :     2        0.23s   0.005%  ------ ++
++ hamiltonian_energy_components        :     1        0.37s   0.007%  ------ ++
++ density_init_guess_real              :     1        0.39s   0.008%  ------ ++
++ energy_and_forces                    :     1        0.40s   0.008%  ------ ++
++ ngwf_gradient_coeffs                 :     2        0.67s   0.014%  ------ ++
++ aug_nonlocal_mat                     :    49        0.67s   0.014%  ------ ++
++ sparse_embed_hotelling_invert_embed  :     5        0.76s   0.015%  ------ ++
++ paw_species_calc_proj_prec_mat       :     1        0.84s   0.017%  ------ ++
++ main_program_(onetep.F90)            :     1        0.87s   0.018%  ------ ++
++ energy_and_force_init_cell           :     1        0.97s   0.020%  ------ ++
++ integrals_locpot_dbl_grid            :    27        1.98s   0.040%  ------ ++
++ palser_mano_kernel_optimise          :     1        3.13s   0.064%  ------ ++
++ augmentation_screen_dij              :    51        3.71s   0.076%  ------ ++
++ kernel_fix                           :    24        4.45s   0.091%  ------ ++
++ paw_dij_xc                           :    51        4.96s   0.101%  ------ ++
++ kernel_purify                        :    73        5.81s   0.118%  ------ ++
++ pseudo_make_structure_factor         :     1        6.48s   0.132%  ------ ++
++ projectors_init_fftbox_recip         :    30        6.48s   0.132%  ------ ++
++ fourier_apply_box_pair               :   597        7.10s   0.144%  2.223k ++
++ basis_copy_function_to_box           :  7357        8.13s   0.165%  ------ ++
++ hamiltonian_lhxc_calculate           :    47       10.72s   0.218%  ------ ++
++ lnv_denskernel_optimise_cg           :     3       12.53s   0.255%  ------ ++
++ ewald_calculate_energy               :     1       16.83s   0.342%  ------ ++
++ augmentation_density_on_grid         :    48       17.35s   0.353%  ------ ++
++ xc_energy_potential                  :    49       18.46s   0.376%  ------ ++
++ projectors_func_ovlp_box             :     5       23.37s   0.476%  ------ ++
++ nlxc_vdw_energy                      :    98       24.62s   0.501%  ------ ++
++ sparse_init                          :     1       25.87s   0.526%  ------ ++
++ ngwf_gradient_build_batch            :    12       25.93s   0.528%  ------ ++
++ function_ops_brappd_ketppd           :     5       26.01s   0.529%  ------ ++
++ lnv_gradient_norm                    :    24       27.34s   0.556%  ------ ++
++ ngwf_cg_optimise                     :     1       35.37s   0.720%  ------ ++
++ density_on_dbl_grid                  :    48       42.92s   0.873%  ------ ++
++ cell_grid_extract_box_real           :  4050       49.98s   1.017%  ------ ++
++ fourier_apply_cell_forward           :  1421       50.30s   1.023% 234.039 ++
++ fourier_apply_cell_backward          :  1520       51.07s   1.039% 246.569 ++
++ integrals_kinetic                    :     5       53.06s   1.080%  ------ ++
++ ngwf_gradient_batch                  :    12       61.70s   1.255%  ------ ++
++ sparse_trace                         :  1061       64.14s   1.305%  ------ ++
++ density_fftbox_deposit_to_cell       :  4464       96.25s   1.958%  ------ ++
++ density_batch_interp_deposit         :   288      100.15s   2.038%  ------ ++
++ cell_grid_deposit_box_real           :  9508      102.38s   2.083%  ------ ++
++ basis_dot_function_with_box          : 3.451M     104.29s   2.122%  ------ ++ (!) overhead: ~   4.1%
++ basis_add_function_to_box            : 6.059M     190.15s   3.869%  ------ ++ (!) overhead: ~   4.0%
++ ngwf_gradient_lnv                    :     2      201.30s   4.096%  ------ ++
++ density_fftbox_interpolate_multiply  :  4464      214.37s   4.362%  ------ ++
++ potential_apply_to_ngwf_batch        :   162      254.83s   5.185%  ------ ++
++ integrals_locpot_mat_els_batch       :   162      283.84s   5.775%  ------ ++
++ projectors_gradient_batch            :    12      294.19s   5.986%  ------ ++
++ density_batch_row_sums               :   288      456.62s   9.291%  ------ ++
++ projectors_grad_precond_batch        :    12      500.51s  10.184%  ------ ++
++ fourier_apply_box                    : 22831      604.17s  12.293%  3.319k ++
++ sparse_product                       :  1403      803.77s  16.354%  ------ ++
================================================================================
(!) WARNING: You're wasting precious cycles calling timer. 
             Each pair of timer_clock calls itself cost   1.25 microseconds!
Overhead of generating timer report: 
- 10 ms averaging over threads,
- 31 ms ensuring consistency across MPI ranks,
- 30 ms printing in order.

Job completed: 12-01-2023 21:10 (-0000)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
