
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cut-off Coulomb &#8212; ONETEP Documentation 6.2.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '6.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Species Dependent Scissor Shifts" href="scissor_operator.html" />
    <link rel="prev" title="Spherical wave resolution of identity (SWRI), Hartree-Fock exchange (HFx), hybrid functionals and distributed multipole analysis (DMA)" href="hfx.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cut-off-coulomb">
<h1>Cut-off Coulomb<a class="headerlink" href="#cut-off-coulomb" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Nick Hine, University of Warwick (implementation)</td>
</tr>
<tr class="field-even field"><th class="field-name">Author:</th><td class="field-body">Gabriel Bramley, University of Southampton (documentation)</td>
</tr>
<tr class="field-odd field"><th class="field-name">Date:</th><td class="field-body">July 2019</td>
</tr>
</tbody>
</table>
<div class="section" id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h2>
<p>The plane wave approach inherently involves the use of periodic boundary
conditions (PBC). In order to model isolated molecules, the supercell
technique was developed, which involves adding large quantities of
vacuum to the simualtion cell in order to separate their periodic
images. Although this method is adequate for neutral molecules, charged
systems and systems with significant multipoles require additional
considerations. The potential of the monopole and multipole moments
decay in accordance to the power law, where point charges decay with
<span class="math">\(\frac{1}{r^{1}}\)</span>, dipoles with <span class="math">\(\frac{1}{r^{2}}\)</span> etc..
Using the supercell method for systems with a net charge or significant
dipoles require large volumes of vacuum to eliminate the electrostatic
interactions between the system of the unit cell and its periodic
images. However, as traditional plane wave codes extend across the
entire cell, adding large quantities of vacuum is computationally
costly. Various dipole corrections such as the cut-off Coulomb (CC)
[Jarvis1997], Continuum Screening Method
[Otani2006] and Gaussian
Counter Charge model
[Dabo2008] have been
developed in order to isolate the electrostatic interactions of the unit
cell from its periodic images.</p>
<p>The cut-off Coulomb (or Coulomb cut-off) approach, as implemented in
ONETEP by Nick Hine [Hine2011], achieves this by only
allowing Coulombic interactions within a specified region, thereby
emulating the electrostatics of an isolated system with a periodic
representation of the charge density [Jarvis1997]. By
selecting an appropriate region, one can eliminate spurious
electrostatic interactions between charges in the periodic replicas and
the home cell, while also retaining the correct description of the
potential between charges in the isolated system. One can choose to
maintain periodic Coulombic interactions along specified axes, thereby
representing electrostatics in systems with either 1D (wire), 2D (slab)
or 0D (sphere) periodicity.</p>
<div class="section" id="d-periodic-coulomb-interaction">
<h3>3D Periodic Coulomb Interaction<a class="headerlink" href="#d-periodic-coulomb-interaction" title="Permalink to this headline">¶</a></h3>
<p>In a standard periodic calculation, the electrostatic potential is
defined as through the Hartree potential:</p>
<div class="math" id="equation-hartree">
<span class="eqno">(1)<a class="headerlink" href="#equation-hartree" title="Permalink to this equation">¶</a></span>\[V_{H}(\mathbf{r}) = \int_{space} {\frac{n(\mathbf{r'})}{|\mathbf{r} -  \mathbf{r'}|}}  d\mathbf{r'}\]</div>
<p>Where <span class="math">\(n(\mathbf{r'})\)</span> describes the charge density of the system.
This can be equivalently represented as:</p>
<div class="math">
\[V_{H}(\mathbf{r}) = \int_{space} v(\mathbf{r},\mathbf{r'})n(\mathbf{r'}) d\mathbf{r'}\]</div>
<p>Where <span class="math">\(v(\mathbf{r})\)</span> represents the Coulomb interaction,
<span class="math">\(\frac{1}{|\mathbf{r} -  \mathbf{r'}|}\)</span>. This is more conveniently
calculated in reciprocal space, which is achieved through a Fourier
transformation of the <span class="math">\(V_{H}\)</span> in accordance with convolution
theory:</p>
<div class="math">
\[V_{H}(\mathbf{G}) = v(\mathbf{G})n(\mathbf{G})\]</div>
<p>In the fully periodic case, the above expressions are taken over all
reciprocal space (<span class="math">\(\infty\)</span> to <span class="math">\(-\infty\)</span>), which yields a
Coulomb interaction of:</p>
<div class="math">
\[v(\mathbf{G}) = \frac{4 \pi}{|\mathbf{G}|^2}\]</div>
</div>
<div class="section" id="coulomb-cut-off-in-3d">
<h3>Coulomb Cut-off in 3D<a class="headerlink" href="#coulomb-cut-off-in-3d" title="Permalink to this headline">¶</a></h3>
<p>The standard periodic approach takes the integration of the Coulomb
interaction over all space, which allows interaction between the
periodic images and the original unit cell. In contrast, Coulomb cut-off
sets the Coulomb interaction between charges to zero beyond a specified
radius. In the simplest case, one can define this cut-off as a sphere,
which assumes a system without periodicity. By selecting an appropriate
cut-off radius, <span class="math">\(R_C\)</span>, one can retain the correct electrostatic
interactions of between charges in the unit cell, while eliminating
spurious interactions the periodic images:</p>
<div class="math">
\[\begin{split}v^{3D}(\mathbf{r},\mathbf{r'}) =
     \begin{cases}
      \frac{1}{|\mathbf{r} -  \mathbf{r'}|} &amp; \text{for $R_C &lt; |\mathbf{r} -  \mathbf{r'}|$}\\
      0 &amp; \text{for $R_C &gt; |\mathbf{r} -  \mathbf{r'}|$}\\
     \end{cases}\end{split}\]</div>
<p>Performing an analytic Fourier Transformation of
<span class="math">\(v(\mathbf{r},\mathbf{r'})\)</span> with modified boundaries yields the
following reciprocal space representation of the Coulomb interaction:</p>
<div class="math">
\[v^{3D}(\mathbf{G}) =  \frac{4 \pi}{\mathbf{G}^2}(1 - \cos(\mathbf{G}R_C))\]</div>
</div>
<div class="section" id="coulomb-cut-off-in-1d">
<h3>Coulomb Cut-off in 1D<a class="headerlink" href="#coulomb-cut-off-in-1d" title="Permalink to this headline">¶</a></h3>
<p>Although this approach is satisfactory for systems with no periodicity,
additional considerations must be made if periodicity is required in
either 1D (ie. a wire) or in 2D (ie. an infinitely extended plane). In
the 1D case, the Coulomb cut-off is defined as a cylinder, where
periodicity is retained in the z-axis and the Coulomb interaction is
applied in the xy-direction. In theory, this redefines the Coulomb
interaction as:</p>
<div class="math" id="equation-1dcc">
<span class="eqno">(2)<a class="headerlink" href="#equation-1dcc" title="Permalink to this equation">¶</a></span>\[\begin{aligned}
    v^{1D}(\mathbf{G_{\bot}, G}_x) =  \frac{4 \pi}{\mathbf{G}^2}  [1 + \mathbf{G}_{\bot}R_C J_1 (\mathbf{G}_{\bot}R_C) K_{0}(\mathbf{G}_x R_C)
    - \mathbf{G}_x R_C J_{0}(\mathbf{G}_{\bot}R_C) K_{1}(\mathbf{G}_x R_C) ]
    \end{aligned}\]</div>
<p>Where <span class="math">\(J\)</span> and <span class="math">\(K\)</span> are modified Bessel functions,
<span class="math">\(\mathbf{G}_x\)</span>, <span class="math">\(\mathbf{G}_y\)</span> and <span class="math">\(\mathbf{G}_z\)</span> the
reciprocal lattice vectors in <span class="math">\(x\)</span>, <span class="math">\(y\)</span> and <span class="math">\(z\)</span> and
<span class="math">\(\mathbf{G}_{\bot} = \sqrt{\mathbf{G}_x^2 + \mathbf{G}_z^2}\)</span>.</p>
<p>However, a divergence occurs at <span class="math">\(G_x = 0\)</span>, which is handled by
re-casting Equation <a class="reference internal" href="#equation-1dcc">(2)</a> into an analytical expression solved through
:</p>
<div class="math">
\[v^{1D}(\mathbf{G_{\bot}, G}_x = 0) =  - 4 \pi  \int_{0}^{R} r J_{0}(\mathbf{G}_{\bot})\ln{(\mathbf{r})} d \mathbf{r}\]</div>
</div>
<div class="section" id="coulomb-cut-off-in-2d">
<h3>Coulomb Cut-off in 2D<a class="headerlink" href="#coulomb-cut-off-in-2d" title="Permalink to this headline">¶</a></h3>
<p>For systems where periodicity is maintained in 2D, the Coulomb cut-off
must only be applied in the out-of-plane direction, while retaining PBC
in the xy-plane. Originally, this was implemented in ONETEP from the
formulation of <em>Rozzi et al.</em>
[Rozzi2006], where the Coulomb
interaction <span class="math">\(v^{3D}(\mathbf{G})\)</span> is re-cast to the following
expression:</p>
<div class="math">
\[v^{2D}(\mathbf{G_{\|}},\mathbf{G}_{z}) = \frac{4 \pi}{\mathbf{G}^2} \bigg \lbrack 1 + e^{-\mathbf{G}_{\|}R_C}\frac{\mathbf{G}_z}{\mathbf{G}_{\|}}\sin(\mathbf{G}_z R_C) - e^{-\mathbf{G}_{\|}R_C}\cos{|\mathbf{G}_z|R_C}) \bigg \rbrack\]</div>
<p>Where <span class="math">\(\mathbf{G}_{\|} = \sqrt{\mathbf{G}_{x}^2+\mathbf{G}_{y}^2}\)</span>
and <span class="math">\(\mathbf{G}_{z}\)</span> represent the in-plane and out-of-plane
reciprocal space vectors respectively. However, as described by <em>Sohier
et al.</em> [Sohier2017], if
<span class="math">\(R_C = \frac{L}{2}\)</span>, where L represents the length of the
simulation cell, this expression simplifies to:</p>
<div class="math">
\[v^{2D}(\mathbf{\mathbf{G}_{\|}},\mathbf{G}_{z}) = \frac{4 \pi}{\mathbf{G}^2} \bigg \lbrack 1 - e^{-\mathbf{G}_{\|}R_C}\cos({|\mathbf{G}_z|R_C}) \bigg \rbrack\]</div>
<p>Where <span class="math">\(G_z\)</span> is a multiple of <span class="math">\(\frac{2 \pi}{L}\)</span>. As with the
Coulomb interaction under periodic boundary conditions, this term
diverges at <span class="math">\(\mathbf{G} = 0\)</span>, and is therefore treated separately
and <span class="math">\(v^{2D}(\mathbf{\mathbf{G}}=0) = 0\)</span> as argued by <em>Sohier et
al.</em> [Sohier2017].</p>
</div>
</div>
<div class="section" id="performing-a-calculation-with-coulomb-cut-off">
<h2>Performing a Calculation with Coulomb Cut-off<a class="headerlink" href="#performing-a-calculation-with-coulomb-cut-off" title="Permalink to this headline">¶</a></h2>
<p>To use Coulomb cut-off, the keyword <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_TYPE</span></code> must be
inserted, with the input specifying the periodicity of the system:</p>
<ul class="simple">
<li>1D - <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_TYPE:</span> <span class="pre">WIRE</span></code></li>
<li>2D - <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_TYPE:</span> <span class="pre">SLAB</span></code></li>
<li>3D - <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_TYPE:</span> <span class="pre">SPHERE</span></code></li>
</ul>
<p>In addition, the length/radius of the cut-off must be specified with
either <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_RADIUS</span></code> or <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_LENGTH</span></code>:</p>
<ul class="simple">
<li>1D &amp; 2D - <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_LENGTH</span></code></li>
<li>3D - <code class="docutils literal"><span class="pre">COULOMB_CUTOFF_RADIUS</span></code></li>
</ul>
<p>As part of the Coulomb cut-off in ONETEP, the electron density
<span class="math">\(n(\mathbf{r})\)</span> in the original cell is placed into a larger,
padded cell in which <span class="math">\(n(\mathbf{r}) = 0\)</span>. This is determined in a
similar way as the original lattice block through a new block
<code class="docutils literal"><span class="pre">%BLOCK</span> <span class="pre">PADDED_LATTICE_CART</span></code>, which determines the size and dimensions
of the larger cell: <code class="docutils literal"><span class="pre">%BLOCK</span> <span class="pre">PADDED_LATTICE_CART</span></code> <code class="docutils literal"><span class="pre">a11</span> <span class="pre">a21</span> <span class="pre">a31</span></code>
<code class="docutils literal"><span class="pre">a21</span> <span class="pre">a22</span> <span class="pre">a23</span></code> <code class="docutils literal"><span class="pre">a31</span> <span class="pre">a32</span> <span class="pre">a33</span></code> <code class="docutils literal"><span class="pre">%ENDBLOCK</span> <span class="pre">PADDED_LATTICE_CART</span></code></p>
<p>This is automatically specified, so adjusting this block is not
recommended. The recommended set-ups for calculations of each
dimensionality are summarized in the table below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="37%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Coulomb Cut-off Type</th>
<th class="head">Cut-off Length/Radius</th>
<th class="head">Cell Dimensions</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><span class="math">\(a_{11}^{pad} = 2a_{11}^{cell}\)</span></td>
</tr>
<tr class="row-odd"><td>Sphere*</td>
<td><span class="math">\(R_C = \sqrt{3}a_{33}^{cell}\)</span></td>
<td><span class="math">\(a_{22}^{pad} = 2a_{22}^{cell}\)</span></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><span class="math">\(a_{33}^{pad} = 2a_{33}^{cell}\)</span></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><span class="math">\(a_{11}^{pad} = 2a_{11}^{cell}\)</span></td>
</tr>
<tr class="row-even"><td>Wire**</td>
<td><span class="math">\(R_C = \sqrt{2}a_{33}^{cell}\)</span></td>
<td><span class="math">\(a_{22}^{pad} = 2a_{22}^{cell}\)</span></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>&#160;</td>
<td><span class="math">\(a_{33}^{pad} = a_{33}^{cell}\)</span></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><span class="math">\(a_{11}^{pad} = a_{11}^{cell}\)</span></td>
</tr>
<tr class="row-odd"><td>Slab***</td>
<td><span class="math">\(R_C = a_{33}\)</span></td>
<td><span class="math">\(a_{22}^{pad} = a_{22}^{cell}\)</span></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>&#160;</td>
<td><span class="math">\(a_{33}^{pad} = 2 a_{33}^{cell}\)</span></td>
</tr>
</tbody>
</table>
<p>Table: The recommended calculation parameters for each periodicity of
the Coulomb cut-off, where <span class="math">\(a_{ii}^{cell}\)</span> and
<span class="math">\(a_{ii}^{pad}\)</span> represent the diagonal components of the original
simulation cell specified in <code class="docutils literal"><span class="pre">%</span> <span class="pre">BLOCK_LATTICE_CART</span></code> and the padded
cell respectively. Assumed orthogonal cell in all cases.</p>
<div class="line-block">
<div class="line">* Assuming <span class="math">\(a_{11}^{cell} = a_{22}^{cell} = a_{33}^{cell}\)</span>.</div>
<div class="line">** Assuming <span class="math">\(a_{11}^{cell} = a_{22}^{cell}\)</span>. <span class="math">\(a_{33}\)</span> being the periodic direction.</div>
<div class="line">*** <span class="math">\(a_{33}\)</span> defined as the non-periodic direction.</div>
</div>
<p>These choices of both the padded cell dimension and the cut-off
length/radius ensure two conditions are satisfied:</p>
<ol class="arabic simple">
<li>Charges within the original unit cell correctly interact with one
another.</li>
<li>The interaction between charges of the periodic image and the
original simulation cell are set to zero.</li>
</ol>
<p>The first condition is satisfied by setting the cut-off distance equal
to or greater than the distance between any two non-zero charges within
the original unit cell. For the 3D case, this is typically satisfied by
<span class="math">\(R_C &gt; \sqrt{3}L_{cell}\)</span>, while in 2D and 1D, this is satisfied by
<span class="math">\(R_C = \frac{L_{cell}}{2}\)</span>, where <span class="math">\(L_{cell}\)</span> is the cell
dimension in the non-periodic axis. The second condition requires that
the distance between non-zero charges of the simulation cell and the
periodic image must be greater than or equal to the cut-off length. In
ONETEP, this is achieved by placing the unit cell inside a larger padded
cell, in which the charge density <span class="math">\(\rho(\mathbf{r})=0\)</span>. The second
condition is satisfied when the total cell length,
<span class="math">\(L_{total} = L_{cell} + L_{pad} \geq R_C + L_{cell}\)</span>.</p>
<p>[Jarvis1997] M. R. Jarvis, I. D. White, R. W. Godby, and M. C. Payne, <em>Supercell technique for total-energy calculations of finite charged and polar systems</em>, Phys. Rev. B, <strong>56</strong>, (1997).</p>
<p>[Otani2006] M. Otani, and O. Sugino, <em>First-principles calculations of charged surfaces and interfaces: A plane-wave nonrepeated slab approach</em>, Phys. Rev. B, <strong>73</strong>, (2006).</p>
<p>[Dabo2008] I. Dabo, B. Kozinsky, N. E. Singh-Miller, N. Marzari, <em>Electrostatics in periodic boundary conditions and real-space corrections</em>, Phys. Rev. B, <strong>77</strong>, (2008).</p>
<p>[Hine2011] N. D. M. Hine, J. Dziedzic, P. D. Haynes, and C.-K. Skylaris, <em>Electrostatic interactions in finite systems treated with periodic boundary conditions: Application to linear-scaling density functional theory</em>, J. Chem. Phys. <strong>135</strong> (2011).</p>
<p>[Rozzi2006] C. A. Rozzi, D. Varsano, A. Marini, E. K. U. Gross, and A. Rubio, <em>Exact Coulomb cutoff technique for supercell calculations</em>, Phys. Rev. B <strong>73</strong> (2006).</p>
<p>[Sohier2017] T. Sohier, M. Calandra, and F. Mauri, <em>Density functional perturbation theory for gated two-dimensional heterostructures: Theoretical developments and application to flexural phonons in graphene</em>, Phys. Rev. B <strong>96</strong> (2017).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="index_ground_state.html">Ground State Calculation Setup</a><ul>
      <li>Previous: <a href="hfx.html" title="previous chapter">Spherical wave resolution of identity (SWRI), Hartree-Fock exchange (HFx), hybrid functionals and distributed multipole analysis (DMA)</a></li>
      <li>Next: <a href="scissor_operator.html" title="next chapter">Species Dependent Scissor Shifts</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Joseph Prentice.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/cutoff_coulomb.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>