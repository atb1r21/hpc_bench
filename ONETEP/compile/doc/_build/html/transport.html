
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Electronic transport calculations &#8212; ONETEP Documentation 6.2.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '6.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Bandstructure (spectral-function) unfolding" href="spectral_function_unfolding.html" />
    <link rel="prev" title="Electron Energy Loss Calculations" href="eels_in_onetep.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="electronic-transport-calculations">
<h1>Electronic transport calculations<a class="headerlink" href="#electronic-transport-calculations" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Robert A. Bell, University of Cambridge (<code class="docutils literal"><span class="pre">rab207&#64;cam.ac.uk</span></code>)</td>
</tr>
</tbody>
</table>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This document describes the use of the electronic transport
functionality that is implemented in the ONETEP
code [Bell2014]. The implementation computes the
ballistic Landauer-Büttiker conductance at zero bias through a device
and associated properties using electronic structure derived from
density functional theory (DFT). The calculation proceeds as a
post-processing step after a ground-state single-point calculation.</p>
<p>This document focuses on the practical aspects of setting up
calculations; a detailed technical explanation of the method can be
found in [Bell2014]. For a detailed discussion
of the Landauer-Büttiker formalism and conductance derived from DFT see
[DiVentra2008], [Datta1995].</p>
<p>I first briefly outline what is being calculated, I then give an example
calculation and suitable input parameters, and then finally a full input
parameter listing is given.</p>
</div>
<div class="section" id="what-is-being-calculated">
<h2>What is being calculated?<a class="headerlink" href="#what-is-being-calculated" title="Permalink to this headline">¶</a></h2>
<p>The transport calculation determines the ballistic conductance through a
device. Current can flow between two leads via the connection made by
the central scattering region. We will refer to this geometry as the
<em>device</em> geometry.</p>
<p>Under the Landauer formalism, the contribution to the conductance
between two leads (indexed <span class="math">\(i\)</span> and <span class="math">\(j\)</span>) from electrons with
energy <span class="math">\(E\)</span> is given by</p>
<div class="math">
\[G_{ij}(E) = \frac{2e^2}{h} T_{ij}(E)\]</div>
<p>where <span class="math">\(T_{ij}(E)\)</span> is the transmission function. The transmission
function is the central quantity to the Landauer-Büttiker conductance
and is calculated using a Green’s function technique:</p>
<div class="math" id="equation-caroli">
<span class="eqno">(1)<a class="headerlink" href="#equation-caroli" title="Permalink to this equation">¶</a></span>\[   T_{ij}(E) = \mathrm{tr}\Big[\Gamma_i(E)\;G_{\rm d}(E)\;\Gamma_j(E)\;G_{\rm d}^{\dagger}(E)\Big],\]</div>
<div class="math" id="equation-greenf">
<span class="eqno">(2)<a class="headerlink" href="#equation-greenf" title="Permalink to this equation">¶</a></span>\[   G_{\rm d}(E) = \big[ (E+i\eta)S_{\rm d} - H_{\rm d} - \Sigma(E)\big]^{-1},\]</div>
<p>where <span class="math">\(H_{\rm d}\)</span>, <span class="math">\(S_{\rm d}\)</span> the
Hamiltonian and overlap matrices for the device, and <span class="math">\(\eta\)</span> is an
infinitessimal positive energy that selects the retarded response of the
Green’s function <span class="math">\(G_{\rm d}\)</span>. The interaction with the
semi-infinite leads accounted for through the lead self-energies
<span class="math">\(\Sigma_j\)</span>, with
<span class="math">\(\Sigma = \sum_j \Sigma_j\)</span>. The coupling
matrices are defined as
<span class="math">\(\Gamma_j = i(\Sigma_j - \Sigma_j^{\dagger})\)</span>.</p>
<p>From the Green’s function, one may also calculate the density of states
within the device region as</p>
<div class="math">
\[\mathcal{N}(E) = -\frac{1}{\pi}{\mathrm{Im}}\mathrm{tr}\big[G_{\rm d}(E) S_{\rm d}\big].\]</div>
<p>Further post processing steps may be performed to determine the
eigenchannels. [Bell2014], [Paulsson2007]</p>
</div>
<div class="section" id="building-the-device">
<h2>Building the device<a class="headerlink" href="#building-the-device" title="Permalink to this headline">¶</a></h2>
<p>The principal quantities required in Eqns. <a class="reference internal" href="#equation-caroli">(1)</a> and <a class="reference internal" href="#equation-greenf">(2)</a>
are the device Hamiltonian and overlap matrices, and the lead self
energies. The approach adopted in this implementation is to extract
these matrix elements from the ground-state electronic structure
obtained after a standard single-point calculation. This approach
corresponds to a non-self consistent calculation of the transmission
spectrum and device electronic structure. Note that this procedure
differs from self consistent approaches, such as e.g.
[Brandbyge2002], where the open boundary conditions of
the leads are treated explicitly. At zero bias, however, both methods
produce equivalent results yet the non-self consistent approach is often
far less computationally expensive.</p>
<p>A detailed description of the matrix element extraction procedure, as
implemented in the ONETEP code, is given in [Bell2014]
which should be referred to in the first instance. Summarising briefly,
to calculate the transmission through any device geometry the user must
construct another <em>auxilliary simulation</em> structure that contains this
device. The <em>only</em> electronic structure that is calculated is that of
the auxilliary simulation geometry.</p>
<p>The structure of the auxilliary simulation geometry must take a specific
form, consisting of the central region that connects the leads and a
bulk-like region for each lead. Each lead region must have a local
electronic structure that is bulk-like, and be large enough that it
contains at least two principal layers of the bulk lead structure. <a class="footnote-reference" href="#id14" id="id9">[1]</a>
The device geometry is then defined as all the atoms contained within
the central region and the two lead principal layers for each lead.</p>
<p>For a device connecting two leads, the device Hamiltonian then looks
like</p>
<div class="math">
\[\begin{split}H_{\rm d} =
   \begin{pmatrix}
      \mathbf{h}_{00,L}    &amp; \mathbf{h}_{0,L}  &amp; \cdot                &amp; \cdot                  &amp; \cdot              \\
      \mathbf{h}^\dagger_{01,L} &amp; \mathbf{h}_{00,L}  &amp; \mathbf{h}_{LC}    &amp; \cdot                  &amp; \cdot              \\
      \cdot                  &amp; \mathbf{h}^\dagger_{LC} &amp; \mathbf{h}_{C}     &amp; \mathbf{h}_{CR}      &amp; \cdot              \\
      \cdot                  &amp; \cdot                &amp; \mathbf{h}^\dagger_{CR} &amp; \mathbf{h}_{00,R}    &amp; \mathbf{h}_{01,R}\\
      \cdot                  &amp; \cdot                &amp; \cdot                &amp; \mathbf{h}^\dagger_{01,R} &amp; \mathbf{h}_{00,R}
   \end{pmatrix}\end{split}\]</div>
<p>where <span class="math">\(\mathbf{h}_{00,L}\)</span> is the on-site Hamiltonian block for
the left lead principal layer, <span class="math">\(\mathbf{h}_{01,L}\)</span> is the
coupling Hamiltonian between principal layers, <span class="math">\(\mathbf{h}_{LC}\)</span>
is the coupling block between the left lead principal layer and the
central region, and <span class="math">\(\mathbf{h}_{C}\)</span> is the on-site block for
the central region. As a result of the localisation of the NGWFs the
device Hamiltonian takes the block tri-diagonal form, with zero matrix
blocks denoted by a dot. An equivalent form is found for the device
overlap matrix.</p>
<p>The lead self energies are computed using the
<span class="math">\(\mathbf{h}_{00,L}, \mathbf{h}_{01,L}\)</span> blocks via the method
of Ref. [Lopez-Sancho1985]. Note that these blocks are
contained within the device Hamiltonian <span class="math">\(H_{\rm d}\)</span>.</p>
<p>The device matrix elements are extracted from the electronic structure
of the auxilliary simulation geometry. This procedure is entirely
automated, however, and the user need only supply a list of atoms that
define the device, and the subsets of these atoms that form the two
principal layers for each lead. <em>i.e.</em> for an <span class="math">\(n\)</span>-lead device, the
user must define <span class="math">\(2n+1\)</span> sets of atoms.</p>
<p>A single limitation of the implementation is that the two principal
layers of any lead must be the exact same structure <em>with atoms in the
same relative ordering</em>. This ensures that the lead self energies are
computed correctly. The implementation will not do this automatically,
however a check is performed to ensure that it is true before the
calculation is started.</p>
<p>For a more detailed discussion of the procedure for extracting matrix
elements see [Bell2014].</p>
</div>
<div class="section" id="setting-up-a-calculation">
<h2>Setting up a calculation<a class="headerlink" href="#setting-up-a-calculation" title="Permalink to this headline">¶</a></h2>
<p>The best way to explain how to set up an input is through an example,
and here I give an explanation of the parameters required to calculation
the transmission between two semi-infinite organic wires. Specifically,
I will explain the setup for calculating the tunnelling current between
a polyacetylene wire and polyyne wire where each wire is semi-infinite
and terminated with a hydrogen atom. I will, however, assume that the
user knows how to successfully converge the standard ONETEP single-point
calculation.</p>
<p>A suitable auxiliary simulation geometry is shown in schematic form in Fig. <a class="reference internal" href="#fig1"><span class="std std-numref">Fig. 5</span></a>,
consisting of molecular fragments of the polyacetylene and polyyne wires
located in vacuum. This entire geometry contains 52 atoms. I will assume
that these atoms are ordered in the input file by their position from
left to right.</p>
<p>Suppose that I wish to calculate the transmission spectrum in a
<span class="math">\(\pm 2eV\)</span> window about the Fermi energy with a resolution
of <span class="math">\(0.01eV\)</span>. The transport specific input parameters are as
follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>etrans_lcr               : T
etrans_bulk              : T
etrans_emin              : -2.0 eV
etrans_emax              :  2.0 eV
etrans_enum              :  401
etrans_calculate_lead_mu : T

%block etrans_setup
  10  47
%endblock etrans_setup

%block etrans_leads
  10  17  18  25  unit_cells=2
  44  47  40  43  unit_cells=2
%endblock etrans_leads

! rest of input file...
</pre></div>
</div>
<p>The first six lines indicate that we wish to calculate the transmission
between the two leads (the LCR transmision, see
[Bell2014]), and the maximum transmission that
could be injected by each lead (the bulk transmission), and the energy
range the calculation will be performed over. I am also indicating that
I want to calculate the lead band structures.</p>
<p>The first block after these six lines is the <code class="docutils literal"><span class="pre">etrans_setup</span></code> block which
states that all atoms between atom <span class="math">\(10\)</span> and <span class="math">\(47\)</span> (inclusive,
and in the order found in the input file) are defined as the device
geometry. This region is given by the long-dashed box in . Atoms outside
this set will not be included in the transmission calculation, but will
be used when calculating the ground-state electronic structure.</p>
<p>The final block is the <code class="docutils literal"><span class="pre">etrans_leads</span></code> block which gives the subset of
these device atoms that define the two principal layers for each lead.
Each lead is given on a separate line, with the first pair of indices
defining the principal layer furthest from the central region, and the
second pair the principal layer closest to the central region. Note that
this ordering of the two principal layers is important. Finally, I have
indicated that each principal layer is in fact two primitive unit cells
of the lead structure by using <code class="docutils literal"><span class="pre">unit_cells=2</span></code>. This tells ONETEP to symmetrise
the lead matrix elements to reflect this periodicity. The atoms
contained within each principal layer are indicated in by dotted boxes.</p>
<p>This choice of auxilliary simulation geometry tries to ensure that the
lead principal layers are sufficiently far from the ends of the
molecular fragments that the local electronic structure within the lead
is bulk-like. This has required the use of buffer atoms (atoms 1–9 and
48–52) that are not included in the transport calculation. Some buffer
has also been used between the principal layers and the central
tunnelling gap (atoms 26–34 and 35–39) for the same reason. In practice,
the size of this buffer is probably too small and the lead principal
layers will not be well converged to the bulk. This can be tested by
comparing the band structures of each lead to the corresponding bulk
band structure for that lead, which can be calculated separately. If the
lead band structure is not converged, the size of the buffer region
should be increased.</p>
<div class="figure" id="id15">
<span id="fig1"></span><img alt="A possible auxilliary simulation geometry for calculating the tunnelling transmission between a polyacetylene wire and a polyyne wire. The atoms appear ordered in the input file by their position from left to right." src="_images/transport_fig1.png" />
<p class="caption"><span class="caption-number">Fig. 5 </span><span class="caption-text">A possible auxilliary simulation geometry for calculating the tunnelling transmission between a polyacetylene wire and a polyyne wire. The atoms appear ordered in the input file by their position from left to right.</span></p>
</div>
</div>
<div class="section" id="computational-scaling">
<h2>Computational scaling<a class="headerlink" href="#computational-scaling" title="Permalink to this headline">¶</a></h2>
<p>The dominant computationally-intensive task in the transport routines is
the computing of the device Green’s function. This calculation is
performed using an efficient block tri-diagonal Gaussian-elimination
algorithm [Petersen2008]. This algorithm results in memory
usage and operation counts that scale linearly in the number of atoms.
The pre-factor to this scaling depends on the precise geometry of the
device: the more one-dimensional a device (i.e. the fewer NGWFs that
overlap), the lower this pre-factor.</p>
</div>
<div class="section" id="information-on-parallelisation">
<h2>Information on parallelisation<a class="headerlink" href="#information-on-parallelisation" title="Permalink to this headline">¶</a></h2>
<p>The calculation of transmission coefficients is parallelised over the
energy points, with each MPI process performing the calculation in
serial. No internal communications are necessary making the routines
scale perfectly with the number of MPI processes. However, as all
matrices must be replicated on each MPI process, the memory requirements
can be large. On entering the transport routines but prior to starting
the calculation, an estimate of the additional memory required by the
transport routines is printed. Note that this estimate does not include
the memory required by the rest of the ONETEP routines.</p>
<p>Parallelisation using OpenMP threading is not currently available.
However, if the code is linked against Intel’s Math Kernel Library
(MKL), the linear algebra routines can make use of multi-threading
within this library. To do this, the flag <code class="docutils literal"><span class="pre">-DMKLOMP</span></code> must be included
during compilation, and the number of threads can be set from the input
file using <code class="docutils literal"><span class="pre">threads_num_mkl</span></code>.</p>
<p>The calculation of the eigenchannels can only be parallelised if linking
against the ScaLAPACK library to make use of parallel dense algebra. To
enable this, the flag <code class="docutils literal"><span class="pre">-DSCALAPACK</span></code> must be included at compilation.</p>
</div>
<div class="section" id="calculations-using-the-joint-ngwf-basis">
<h2>Calculations using the joint NGWF basis<a class="headerlink" href="#calculations-using-the-joint-ngwf-basis" title="Permalink to this headline">¶</a></h2>
<p>Transmission calculations using the joint (valence + conduction) NGWF
basis set have often been found to be numerically unstable and produce
qualitively incorrect results when compared to calculations using the
valence NGWF basis alone. This is a result of ill-conditioning of the
joint basis when the valence and conduction NGWFs are very similar in
character. This is a known issue, however there is currently no fix.</p>
<p>For some systems it has been found that the valence NGWFs alone are
capable of describing low-energy conduction states with good accuracy,
and therefore the joint basis is not needed. It is advised that the
valence basis is used in the first instance.</p>
<p>If you are certain that the joint basis is required, then proceed with
caution and always compare the results generated with the joint basis to
those generated using the valence basis. For energies below the Fermi
energy, the two calculations should coincide. If they do not, or if
errors (e.g. complaining about computing the transfer matrix/self
energy, or lead band structures) are found then it may not be possible
to use the joint basis.</p>
<p>If using the joint NGWF basis, all output files have <code class="docutils literal"><span class="pre">.joint</span></code> prepended
to the extension.</p>
</div>
<div class="section" id="warnings-and-fixing-errors">
<h2>Warnings and fixing errors<a class="headerlink" href="#warnings-and-fixing-errors" title="Permalink to this headline">¶</a></h2>
<p>A useful check is to ensure that the lead band structure is as expected,
and that the lead occupancy is correct. It is also useful to check the
lead/device <code class="docutils literal"><span class="pre">.xyz</span></code> files to ensure that the leads have the expected
geometry.</p>
<p>The following are the main warning messages that may be encountered, and
how they may be tackled.</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">Inversion</span> <span class="pre">of</span> <span class="pre">(eS-H)_lcr</span> <span class="pre">failed</span></code></dt>
<dd><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><strong>Cause</strong>: Failed to calculate the Green’s function as it is
singular at this energy. This can happen if etrans_ecmplx is too
small, or if localised states are present near this energy.</div>
<div class="line"><strong>Severity</strong>: Low</div>
<div class="line"><strong>Fix</strong>: It is safe to ignore this warning; the transmission
coefficients and associated values are not written to file. If it
occurs over a wide energy range, or in an energy range of
interest, try increasing <code class="docutils literal"><span class="pre">etrans_ecmplx</span></code>.</div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">Warning</span> <span class="pre">in</span> <span class="pre">compute_transfer:</span> <span class="pre">Failed</span> <span class="pre">to</span> <span class="pre">compute</span> <span class="pre">transfer</span> <span class="pre">matrix.</span></code></dt>
<dd><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><strong>Cause</strong>: Failed to compute the lead self energy. This can happen
if <code class="docutils literal"><span class="pre">etrans_ecmplx</span></code> is too small, or if localised states are present
near this energy.</div>
<div class="line"><strong>Severity</strong>: Low</div>
<div class="line"><strong>Fix</strong>: It is safe to ignore this warning; the transmission
coefficients and associated values are not written to file. If it
occurs over a wide energy range, or in an energy range of
interest, try increasing <code class="docutils literal"><span class="pre">etrans_ecmplx</span></code>. If using the joint NGWF
basis, this may indicate that the basis is ill-conditioned and
that the calculation is numerically unstable.</div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">Lead</span> <span class="pre">electronic</span> <span class="pre">occupancy</span> <span class="pre">is</span> <span class="pre">significantly</span> <span class="pre">different</span> <span class="pre">...</span></code></dt>
<dd><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><strong>Cause</strong>: Large discrepancy between the ionic and electronic
charge in the lead. Likely due to under-converged buffer region
between this lead and the scattering region.</div>
<div class="line"><strong>Severity</strong>: high</div>
<div class="line"><strong>Fix</strong>: Check that the lead band structure is what is expected.
Increase buffer region between the lead and the scattering region.
Check the ground state DFT calculation is converged and that the
density kernel occupancies are <span class="math">\(0\)</span> or <span class="math">\(1\)</span> (if using
the default LNV algorithm).</div>
</div>
</dd>
<dt><code class="docutils literal"><span class="pre">Unable</span> <span class="pre">to</span> <span class="pre">determine</span> <span class="pre">lead</span> <span class="pre">potential</span> <span class="pre">for</span> <span class="pre">lead</span> <span class="pre">...</span></code></dt>
<dd><div class="first last line-block">
<div class="line"><br /></div>
<div class="line"><strong>Cause</strong>: lead potential calculation for this lead failed: could
not determine the lead band structure. This may indicate that the
leads have been defined incorrectly. Check the lead structure.</div>
<div class="line"><strong>Severity</strong>: possibly high</div>
<div class="line"><strong>Fix</strong>: Check the lead structure. Check the matrix elements
contained in the lead .hsm output file are resonable, that the
main weight is along the matrix diagonal and that the values are
sensible. If using joint NGWF basis, try using the valence basis
only (<code class="docutils literal"><span class="pre">task</span> <span class="pre">=</span> <span class="pre">properties</span></code> not <code class="docutils literal"><span class="pre">properties_cond</span></code>). The calculation
will attempt to continue, but check carefully the results are as
expected.</div>
</div>
</dd>
</dl>
</div>
<div class="section" id="full-input-parameter-description">
<h2>Full input parameter description<a class="headerlink" href="#full-input-parameter-description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="main-parameters">
<h3>Main parameters<a class="headerlink" href="#main-parameters" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">etrans_lcr:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_lcr:</span> <span class="pre">F</span></code> ]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Calculate the transmission spectrum between all pairs of leads in the
system.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_bulk:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_bulk:</span> <span class="pre">F</span></code> ]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Calculate the bulk transmission spectrum for the leads.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_setup:</span> <span class="pre">[block]</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">%block</span> <span class="pre">etrans_setup</span></code></div>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">start</span> <span class="pre">end</span></code></div>
</div>
<div class="line"><code class="docutils literal"><span class="pre">%endblock</span> <span class="pre">etrans_setup</span></code></div>
<div class="line">The block defining the atoms to be used in the transport calculation. <code class="docutils literal"><span class="pre">start/end</span></code> are integers giving the indices (from the input file) of the first/last atoms to be included as part of the system. All atoms between <code class="docutils literal"><span class="pre">start</span></code> and <code class="docutils literal"><span class="pre">end</span></code> are used in the calculation; atoms outside this range are buffer regions and ignored. The atoms consituting the leads must be contained within this region.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_leads:</span> <span class="pre">[block]</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">%block</span> <span class="pre">etrans_leads</span></code></div>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">start0</span> <span class="pre">end0</span> <span class="pre">start1</span> <span class="pre">end1</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">start0</span> <span class="pre">end0</span> <span class="pre">start1</span> <span class="pre">end1</span> <span class="pre">unit_cells=&lt;n&gt;</span> <span class="pre">file=&lt;lead2.hsm&gt;</span></code></div>
<div class="line"><code class="docutils literal"><span class="pre">...</span></code></div>
</div>
<div class="line"><code class="docutils literal"><span class="pre">%endblock</span> <span class="pre">etrans_leads</span></code></div>
<div class="line">The block defining the atoms to be used as the leads. Each line defines a new lead. <code class="docutils literal"><span class="pre">start0/end0</span></code> are integers giving the indices (from the input file) of the first/last atoms of the lead principal layer farthest from the central region; <code class="docutils literal"><span class="pre">start1/end1</span></code> are integers giving the indices of the first/last atom of the principal later closest to the central region.</div>
<div class="line">The first principal layer geometry must be a periodic repeat of the lead geometry (i.e. same number of atoms, in the same relative ordering in the input file).</div>
<div class="line">For each lead, two optional tags can be defined. The option <code class="docutils literal"><span class="pre">unit_cells=&lt;n&gt;</span></code> forces the translational symmetry of the principal layer matrix elements, where <code class="docutils literal"><span class="pre">n</span></code> is the number of primitive unit cells in the principal layer. The option <code class="docutils literal"><span class="pre">file=&lt;lead1.hsm&gt;</span></code> allows for the lead matrix elements to be read in from a <code class="docutils literal"><span class="pre">.hsm</span></code> file. Reading in matrix elements is generally unnecessary, however it may be used effectively by taking the <code class="docutils literal"><span class="pre">.hsm</span></code> of a separate pristine/bulk transport calculation to ensure that the matrix elements are exactly at their bulk values. The positions and ordering of atoms in the lead principal layers in both calculations must be identical: this is not checked in the calculation.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_enum:</span> <span class="pre">n</span></code> [Integer, default <code class="docutils literal"><span class="pre">etrans_enum:</span> <span class="pre">50</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Number of transmission energy points calculated for. Energies are
distributed uniformly.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_emax</span> <span class="pre">:</span></code> <span class="math">\(E_{\mathrm{max}}\)</span> [Physical, default <code class="docutils literal"><span class="pre">etrans_emax:</span> <span class="pre">-0.2</span> <span class="pre">Hartree</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The maximum energy above the reference energy transmission is
calculated for.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_emin</span> <span class="pre">:</span></code> <span class="math">\(E_{\mathrm{min}}\)</span> [Physical, default <code class="docutils literal"><span class="pre">etrans_emin:</span> <span class="pre">0.2</span> <span class="pre">Hartree</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The minimum energy below the reference energy transmission is
calculated for.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_eref_method:</span> <span class="pre">LEADS|REFERENCE|DIAG</span></code> [String, default <code class="docutils literal"><span class="pre">etrans_eref_method:</span> <span class="pre">LEADS</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The method used to determine the reference energy
<span class="math">\(E_{\mathrm{ref}}\)</span> for the transmission calculation.</div>
<div class="line">If <code class="docutils literal"><span class="pre">etrans_eref_method:</span> <span class="pre">LEADS</span></code>, the reference energy is set as the average lead chemical potential.</div>
<div class="line">If <code class="docutils literal"><span class="pre">etrans_eref_method:</span> <span class="pre">DIAG</span></code>, the reference energy is set as the Fermi energy of the original DFT system.</div>
<div class="line">If <code class="docutils literal"><span class="pre">etrans_eref_method:</span> <span class="pre">REFERENCE</span></code>, the reference energy is set with <code class="docutils literal"><span class="pre">etrans_eref</span></code>.</div>
<div class="line">If unset, this will be determined by calculating the average chemical
potential of the leads, or if that calculation fails, the Fermi energy
of the original DFT system will be used.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_eref</span> <span class="pre">:</span></code> <span class="math">\(E_{\mathrm{ref}}\)</span> [Physical, default <code class="docutils literal"><span class="pre">etrans_eref:</span> <span class="pre">Determined</span> <span class="pre">automatically</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Reference energy around which the transmission will be calculated. Energies are distributed uniformly in range <span class="math">\(E_{\mathrm{ref}}+E_{\mathrm{min}} \leq E \leq E_{\mathrm{ref}}+E_{\mathrm{max}}\)</span>.</div>
<div class="line">This value is only used if <code class="docutils literal"><span class="pre">etrans_eref_method</span> <span class="pre">:</span> <span class="pre">REFERENCE</span></code>, otherwise it is determined automatically by the method given by <code class="docutils literal"><span class="pre">etrans_eref_method</span></code>.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_num_eigchan</span> <span class="pre">:</span></code> <span class="math">\(n_{\mathrm{chan}}\)</span> [Integer, default <code class="docutils literal"><span class="pre">etrans_num_eigchan:</span> <span class="pre">0</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The number of eigenchannel transmissions calculated. The default does
not decompose into eigenchannel transmissions.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_plot_eigchan</span> <span class="pre">:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_plot_eigchan:</span> <span class="pre">F</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Whether to plot the transmission eigenchannels of the LCR system.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_plot_eigchan_energies</span> <span class="pre">:</span> <span class="pre">[block]</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">%block</span> <span class="pre">etrans_plot_eigchan_energies</span></code></div>
<div class="line-block">
<div class="line"><code class="docutils literal"><span class="pre">{Ha|eV}</span> <span class="pre">!</span> <span class="pre">optional</span> <span class="pre">energy</span> <span class="pre">unit</span></code></div>
<div class="line"><span class="math">\(E_1\)</span></div>
<div class="line"><span class="math">\(E_2\)</span></div>
<div class="line"><code class="docutils literal"><span class="pre">...</span></code></div>
</div>
<div class="line"><code class="docutils literal"><span class="pre">%endblock</span> <span class="pre">etrans_plot_eigchan_energies</span></code></div>
<div class="line">The energies at which the eigenchannels are calculated and plotted. The first line may, optionally, define the energy unit; if undefined, the energy unit is Hartree.</div>
<div class="line">Plotting the eigenchannels uses an algorithm that scales with the cube of the number of atoms in the LCR system. Compiling with the ScaLAPACK library is strongly recommended to reduce memory requirements.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_write_xyz</span> <span class="pre">:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_write_xyz</span> <span class="pre">:</span> <span class="pre">T</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Whether to write, separately, the lead and LCR geometries to file in
the .xyz file format. This is useful for ensuring that the correct
atoms have been chosen for the leads/LCR region.</div>
</div>
</div></blockquote>
</div>
<div class="section" id="tweaking-optional-parameters">
<h3>Tweaking/optional parameters<a class="headerlink" href="#tweaking-optional-parameters" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal"><span class="pre">etrans_ecmplx</span> <span class="pre">:</span></code> <span class="math">\(\eta\)</span> [Physical, default <code class="docutils literal"><span class="pre">etrans_ecmplx:</span> <span class="pre">1e-6</span> <span class="pre">Hartree</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The small complex energy added to calculate the retarded Green’s
function.</div>
<div class="line">Ideally this should be infinitesimally small, however too small values
create numerical instabilities. Large values improve numerical
stability, but creates artificial scattering, reducing transmission.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_calculate_lead_mu</span> <span class="pre">:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_calculate_lead_mu:</span> <span class="pre">T</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Determine the chemical potential of the leads using a tight-binding
approach. If <code class="docutils literal"><span class="pre">etrans_eref</span></code> is unset, the average lead chemical
potential will be used as the reference energy. The band structure for
each lead is saved to file <code class="docutils literal"><span class="pre">basename_lead&lt;nn&gt;.bands</span></code>.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_num_lead_kpoints</span> <span class="pre">:</span></code> <span class="math">\(n_k\)</span> [Integer, default <code class="docutils literal"><span class="pre">etrans_num_lead_kpoints:</span> <span class="pre">32</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The number of lead band structure <span class="math">\(k\)</span>-points sampled to
determine the lead chemical potential. The <span class="math">\(k\)</span>-points are
distributed uniformly between <span class="math">\(\Gamma\)</span> and <span class="math">\(X\)</span>.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_same_leads</span> <span class="pre">:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_same_leads:</span> <span class="pre">F</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Reuse the self energy from one lead for all leads. If all leads are
identical, this may lead to a small computational saving. The saving
is typically negligible however.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_write_hs</span> <span class="pre">:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_write_hs:</span> <span class="pre">F</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">Write the lead Hamiltonian and overlap matrices to disk.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_lead_disp_tol</span> <span class="pre">:</span></code> <span class="math">\(\Delta r\)</span> [Physical, default <code class="docutils literal"><span class="pre">etrans_lead_disp_tol</span> <span class="pre">:</span> <span class="pre">1.0</span> <span class="pre">bohr</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The geometries of each lead and corresponding first principal layer
should be identical; this parameter determines how strictly this is
enforced. This should only be done if you are clear of the consequences.</div>
<div class="line">This may be useful in the case that the lead unit cell is much larger
than the NGWF radius. If the distance between the lead and the first
principal layer furthest from the lead is much larger than 2 NGWF radii,
these atoms do not directly influence the non-zero matrix elements
between the principal layer and the lead, and the coupling matrix
<span class="math">\(h_L\)</span> is (approximately) independent of the structure of these
atoms. Therefore, it may be possible to use a much smaller buffer region
between the lead and the first principal layer by including part of the
first principal layer in that buffer. The first principal layer and lead
geometry need not be identical, however both regions must contain the
same number of atoms and orbitals.</div>
</div>
<div class="line-block">
<div class="line">For each lead, the translation vector between the <span class="math">\(i^{th}\)</span> atoms
of the lead and first principal layer is calculated:
<span class="math">\(\mathbf{R}_{i} = \mathbf{r}_{i\mathrm{,lead}} - \mathbf{r}_{i\mathrm{,PL}}\)</span>.
If the geometries of the lead and first principal layer are identical,
all of these translation vectors are identical. The maximum allowed
difference between these displacement vectors is
<span class="math">\(\Delta r &gt; |\mathbf{R}_{i} - \mathbf{R}_{j}|\)</span>.</div>
<div class="line">If the lead crosses the supercell boundary, this check will fail. This
can be overridden by increasing <span class="math">\(\Delta r\)</span> to some very large
value.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_lead_size_check</span> <span class="pre">:</span> <span class="pre">T/F</span></code> [Logical, default <code class="docutils literal"><span class="pre">etrans_lead_size_check:</span> <span class="pre">T</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">If true, a check is performed to ensure that each lead forms complete
principal layer. The run will abort if the periodic length of the lead
unit cells, as defined in the input file, are smaller than twice the
maximum NGWF radius of the species in that lead.</div>
<div class="line">Turning off this check is not advised as the lead band structure and
self energies can be inaccurate. This can also be a problem in
situations where the left
lead can interact with the principal layer of the right lead, allowing
current to flow between the leads in the wrong direction, bypassing
the central scattering region.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">etrans_seed_lead</span></code> [Integer, default <code class="docutils literal"><span class="pre">etrans_seed_lead:</span> <span class="pre">1</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">The lead used to seed the block tri-diagonal partitioning. This should
only be relevant for devices with more than two leads where one lead
is much larger than the other leads.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">threads_num_mkl</span></code> [Integer, default <code class="docutils literal"><span class="pre">threads_num_mkl:</span> <span class="pre">1</span></code>]</p>
<blockquote>
<div><div class="line-block">
<div class="line">If the code is linked against Intel’s Math Kernel Library (MKL), this
defines the number of threads used in the linear algebra routines. The
flag <code class="docutils literal"><span class="pre">-DMKLOMP</span></code> must be set during compilation to enable this parameter,
otherwise it is ignored.</div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="output-file-description">
<h2>Output file description<a class="headerlink" href="#output-file-description" title="Permalink to this headline">¶</a></h2>
<p>Output files contain self-explanatory headers for each column. For spin
polarised calculations, a separate file is outputted for each spin
channel.</p>
<p><code class="docutils literal"><span class="pre">basename_LCR.TRC</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The LCR transmission coefficients between different pairs of leads
of the system.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_LCR_channels_lead&lt;nn&gt;.TRC</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The LCR transmission coefficients decomposed into eigenchannels.
The lead number defines which lead acts as the source.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_LCR_E&lt;nn&gt;_lead&lt;mm&gt;_chan&lt;ll&gt;_{real\|imag}.cube</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The plotted LCR eigenchannel. <span class="math">\(nn\)</span> is the the energy index
from <code class="docutils literal"><span class="pre">%block</span> <span class="pre">etrans_plot_eigchan_energies</span></code>; <span class="math">\(mm\)</span> is the lead
that acts as the source; <span class="math">\(ll\)</span> is the eigenchannel number.
The real and imaginary part are printed separately.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_BULK.TRC</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The bulk transmission coefficients for each lead of the system.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_LCR.DOS</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The density of states for the LCR system.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_BULK.DOS</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The density of states for each lead of the system.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_lead&lt;nn&gt;.bands</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">Bandstructure of the lead in the &nbsp;.bands format. The number of
<span class="math">\(k\)</span>-points is set with etrans_num_lead_kpoints.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_device.xyz</span></code>   <code class="docutils literal"><span class="pre">basename_lead&lt;nn&gt;.xyz</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The geometries of the device and leads in .xyz file format.</div>
</div>
</div></blockquote>
<p><code class="docutils literal"><span class="pre">basename_lead&lt;nn&gt;.hsm</span></code></p>
<blockquote>
<div><div class="line-block">
<div class="line">The lead matrix elements in Fortran (unformatted) binary format.
Note that all energies are in Hartree. It is planned, but
currently not possible, to be able to access the device matrix
elements. Please contact the developers if you are interested in
using this functionality. The format of this file is</div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>character(len=*) :: block_type  ! always lead
character(len=*) :: ham_type    ! valence or joint
integer          :: nspin       ! number of spin channels
integer          :: orbs(4)     ! NGWF indices corresponding
                                ! to the atoms defined
                                ! in block_etrans_leads
integer          :: norb        ! matrix sizes
real(kind=8)     :: eref        ! the lead chemical potential

real(kind=8)   :: h00(norb,norb,nspin)
real(kind=8)   :: h01(norb,norb,nspin)
real(kind=8)   :: s00(norb,norb)
real(kind=8)   :: s01(norb,norb)
</pre></div>
</div>
</div></blockquote>
<p>[Bell2014] R.A. Bell, S.M.-M. Dubois, M.C. Payne, A. A. Mostofi, <em>in preparation</em> (2014)</p>
<p>[DiVentra2008] M. Di Ventra, <em>Electrical Transport in Nanoscale Systems</em>, (Cambridge University Press, Cambridge 2008)</p>
<p>[Datta1995] S. Datta, <em>Electronic Transport in Mesoscopic System</em>, 2nd ed. (Cambridge University Press, Cambridge 1995)</p>
<p>[Paulsson2007] M. Paulsson, M. Brandbyge, Phys. Rev. B. <strong>76</strong> 115117 (2007)</p>
<p>[Lopez-Sancho1985] M.P. Lopez-Sancho, J.M. Lopez-Sancho, J. Rubio, <em>J. Phys. F: Met. Phys.</em> <strong>15</strong>, 851 (1985)</p>
<p>[Petersen2008] D.E. Petersen <em>et al.</em>, <em>J. Comp. Phys</em> <strong>227</strong>, 3174 (2008)</p>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[1]</a></td><td>A lead principal layer is defined as the minimum number of primitive
unit cells for that lead such that Hamiltonian and overlap matrix
elements between atoms in non-adjacent principal layers are exactly
zero. This is guaranteed to be true if the periodic length of the
principal layer is larger than twice the maximum NGWF radius.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="index_spectroscopy.html">Spectroscopy and Transport</a><ul>
      <li>Previous: <a href="eels_in_onetep.html" title="previous chapter">Electron Energy Loss Calculations</a></li>
      <li>Next: <a href="spectral_function_unfolding.html" title="next chapter">Bandstructure (spectral-function) unfolding</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Joseph Prentice.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
      |
      <a href="_sources/transport.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>