==================================================================================
It's Wed Sep 21 10:52:11 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 11645 11646 11647 11648)...
    - ONETEP arguments: acetonitrile_anion_dma_and_hfx.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test50
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test50/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test50/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack acetonitrile_anion_dma_and_hfx.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 10:52 (+0100)
 
Reading parameters from file "acetonitrile_anion_dma_and_hfx.dat" ...

WARNING: "cutoff_energy" not specified, but "psinc_spacing" specified.
         Using the latter to set the KE cutoff energy to  826.82697eV,
         thus *overriding* the default.

... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 10 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 10
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Hartree-Fock exchange | hfx_bc          |     P  P  P     |
BC: | DMA                   | hfx_bc          |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "acetonitrile_anion_dma_and_hfx.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
    
  PSINC grid spacing along a1 set to   0.500000000000a0 from input file.
  PSINC grid spacing along a2 set to   0.500000000000a0 from input file.
  PSINC grid spacing along a3 set to   0.500000000000a0 from input file.
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

print_qc T                                                                      
%block swri                                                                     
for_hfx_and_dma 2 9 V 12 12 WE                                                  
%endblock swri                                                                  
%block species_swri-for_hfx_and_dma                                             
H                                                                               
C                                                                               
N                                                                               
%endblock species_swri-for_hfx_and_dma                                          
do_properties T                                                                 
dma_calculate T                                                                 
dma_use_ri for_hfx_and_dma                                                      
dma_max_l 2                                                                     
dma_max_q 9                                                                     
dma_metric ELECTROSTATIC                                                        
dma_bessel_averaging T                                                          
dma_scale_charge T                                                              
hfx_use_ri for_hfx_and_dma                                                      
hfx_max_l 2                                                                     
hfx_max_q 9                                                                     
hfx_metric ELECTROSTATIC                                                        
hfx_bessel_rad_nptsx 300000                                                     
hfx_memory_limit 2000                                                           
hfx_memory_weights 0 5 1                                                        
charge -1                                                                       
maxit_pen 0                                                                     
maxit_ngwf_cg 8                                                                 
minit_lnv 5                                                                     
maxit_lnv 5                                                                     
write_denskern F                                                                
write_tightbox_ngwfs F                                                          
output_detail VERBOSE                                                           
write_density_plot F                                                            
dx_format F                                                                     
cube_format F                                                                   
xc_functional B3LYP                                                             
%block species                                                                  
H   H   1 1 7.0                                                                 
C   C   6 4 7.0                                                                 
N   N   7 4 7.0                                                                 
%endblock species                                                               
%block species_pot                                                              
H   "../../pseudo/hydrogen.recpot"                                              
C   "../../pseudo/carbon.recpot"                                                
N   "../../pseudo/nitrogen.recpot"                                              
%endblock species_pot                                                           
psinc_spacing 0.5 0.5 0.5                                                       
%block lattice_cart                                                             
31.50000000000000      0.000000000000000       0.000000000000000                
0.000000000000000      31.50000000000000       0.000000000000000                
0.000000000000000      0.000000000000000       31.50000000000000                
%endblock lattice_cart                                                          
%block positions_abs                                                            
     Hash =  -000002845094739623709189
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
File: ../../pseudo/nitrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  7;  ionic charge:  5.000000
    Shell 1: l = 0; rc = 1.48 bohr
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          2         8         2
  H          3         3         0
  N          1         4         1
.......   ......    ......    ......
Totals:      6        15         3
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   63 x  63 x  63
                              FFT-box:   63 x  63 x  63
                                  PPD:    7 x   7 x   1
Grid space d1=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.82697eV)
Grid space d2=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.82697eV)
Grid space d3=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.82697eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     63    63    63
          Real-space ('12') slabs/proc (min max mean):     15    16    15
         Recip-space ('23') slabs/proc (min max mean):      8     8     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    126   126   126
          Real-space ('12') slabs/proc (min max mean):     31    32    31
         Recip-space ('23') slabs/proc (min max mean):     16    16    16
********************************************************************************

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1069    0.0065543071    7.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   42    0  182.3119948938
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1          0.4796060027   -0.1805348342    0.2820952968   -0.1977712839
  2         -0.0527728702   -0.1785089250    0.2862344485   -0.2023942408
  3         -0.2257472403   -0.1772765416    0.2878095669   -0.2044694622
  4         -0.3149902420   -0.1768216683    0.2884132549   -0.2054661840
  5         -0.3609619928   -0.1767015305    0.2885908414   -0.2059107881
  6         -0.3846611672   -0.1766954479    0.2886158182   -0.2061025836
  7         -0.3968951162   -0.1767175443    0.2885982698   -0.2061839371
  8         -0.4032194986   -0.1767399782    0.2885758287   -0.2062181518
  9         -0.4064931398   -0.1767563114    0.2885584608   -0.2062324886
 10         -0.4081895265   -0.1767667817    0.2885470124   -0.2062384934
 11         -0.4090693954   -0.1767730619    0.2885400371   -0.2062410136
 12         -0.4095261021   -0.1767766815    0.2885359774   -0.2062420756
 13         -0.4097633053   -0.1767787140    0.2885336828   -0.2062425260
 14         -0.4098865635   -0.1767798353    0.2885324112   -0.2062427186
 15         -0.4099506375   -0.1767804461    0.2885317162   -0.2062428018
 16         -0.4099839559   -0.1767807758    0.2885313402   -0.2062428382
 17         -0.4100012858   -0.1767809526    0.2885311382   -0.2062428543
 18         -0.4100103014   -0.1767810469    0.2885310303   -0.2062428616
 19         -0.4100149924   -0.1767810970    0.2885309729   -0.2062428650
 20         -0.4100174336   -0.1767811236    0.2885309424   -0.2062428666
 21         -0.4100187041   -0.1767811376    0.2885309263   -0.2062428673
 22         -0.4100193654   -0.1767811450    0.2885309178   -0.2062428677
 23         -0.4100197096   -0.1767811489    0.2885309133   -0.2062428679
 24         -0.4100198888   -0.1767811510    0.2885309110   -0.2062428680
 25         -0.4100199821   -0.1767811521    0.2885309097   -0.2062428680
Atom SCF converged after  25 iterations to a total energy of     -0.41001998

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1069    0.0065543071    7.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   42    1  182.3119948938
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -2.1790559063   -0.9479710876    4.5135247483   -1.1733979230
  2         -3.8504941929   -1.0483149626    4.4041899651   -1.1483504236
  3         -4.6242442783   -1.0571940191    4.3945395705   -1.1477730072
  4         -4.9237510427   -1.0627260371    4.3885236015   -1.1472511589
  5         -5.0427810701   -1.0648161551    4.3862469406   -1.1471319029
  6         -5.0899999489   -1.0656259140    4.3853647255   -1.1471079725
  7         -5.1087462123   -1.0659345025    4.3850286295   -1.1471083966
  8         -5.1161880924   -1.0660516357    4.3849011479   -1.1471125758
  9         -5.1191418326   -1.0660959491    4.3848529696   -1.1471158950
 10         -5.1203138563   -1.0661126703    4.3848348139   -1.1471179048
 11         -5.1207787398   -1.0661189638    4.3848279911   -1.1471189928
 12         -5.1209630581   -1.0661213261    4.3848254349   -1.1471195469
 13         -5.1210361017   -1.0661222100    4.3848244805   -1.1471198184
 14         -5.1210650323   -1.0661225395    4.3848241255   -1.1471199480
 15         -5.1210764838   -1.0661226618    4.3848239942   -1.1471200087
 16         -5.1210810134   -1.0661227070    4.3848239459   -1.1471200367
 17         -5.1210828037   -1.0661227235    4.3848239282   -1.1471200496
 18         -5.1210835107   -1.0661227296    4.3848239218   -1.1471200554
 19         -5.1210837896   -1.0661227317    4.3848239196   -1.1471200580
 20         -5.1210838995   -1.0661227325    4.3848239187   -1.1471200591
 21         -5.1210839427   -1.0661227328    4.3848239185   -1.1471200597
Atom SCF converged after  21 iterations to a total energy of     -5.12108394

Atom SCF Calculation for N  : Z (AE atom) =   7 : Z (PS atom) =   5
Config String:
Orbitals (num,occ):  2     2.00 3.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1069    0.0065543071    7.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   42    1  182.3119948938
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -0.7820240124   -2.8715477391    7.0523824192   -1.5654639874
  2         -8.0849932631   -1.5789548020    8.2180050181   -1.8122049954
  3         -8.5561827946   -1.7494353851    8.0343860877   -1.7782110736
  4         -9.0376650353   -1.7317437923    8.0532694955   -1.7840786759
  5         -9.1669390992   -1.7420381326    8.0423419573   -1.7826171610
  6         -9.2304663997   -1.7424992158    8.0418745391   -1.7828644491
  7         -9.2532010836   -1.7433482180    8.0409794594   -1.7828201705
  8         -9.2627198522   -1.7435280752    8.0407920421   -1.7828401784
  9         -9.2664003355   -1.7436221451    8.0406935673   -1.7828440992
 10         -9.2678821130   -1.7436516739    8.0406628531   -1.7828478499
 11         -9.2684668480   -1.7436637529    8.0406502971   -1.7828494536
 12         -9.2687000161   -1.7436680299    8.0406458724   -1.7828502903
 13         -9.2687925321   -1.7436696664    8.0406441840   -1.7828506727
 14         -9.2688293413   -1.7436702672    8.0406435671   -1.7828508513
 15         -9.2688439689   -1.7436704928    8.0406433364   -1.7828509318
 16         -9.2688497860   -1.7436705766    8.0406432512   -1.7828509681
 17         -9.2688520987   -1.7436706078    8.0406432196   -1.7828509842
 18         -9.2688530183   -1.7436706194    8.0406432080   -1.7828509913
 19         -9.2688533839   -1.7436706237    8.0406432036   -1.7828509944
 20         -9.2688535293   -1.7436706253    8.0406432020   -1.7828509958
 21         -9.2688535870   -1.7436706259    8.0406432015   -1.7828509964
Atom SCF converged after  21 iterations to a total energy of     -9.26885359

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Hartree-Fock exchange | hfx_bc          |     P  P  P     |
BC: | DMA                   | hfx_bc          |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      5;  min      1;  average      4
... Projector load balancing: max      1;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =           23.070226
        Ewald: reciprocal-space energy =            1.502512
         Ewald: (sum_charge)**2 energy =            2.236226
         Ewald: (sum_charge**2) energy =            2.567631
                          Ewald energy =           19.768881
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):         17791        54261
... Nonlocal pseudopotential projector initialisation
... done

Initialising remote NGWF capability... done. 

SWRI: Initialising module (stage 1)... 
SWRI: [for_hfx_and_dma] Initialising (stage 1)...
SWRI: [for_hfx_and_dma] - Using default V metric matrix evaluation scheme (2D numerical-1D analytic).
SWRI: [for_hfx_and_dma] - Initialising Bessels (l_max=2)... done.
SWRI: [for_hfx_and_dma] - Initialising radial lookup... done.
SWRI: [for_hfx_and_dma] - SW batch size (tile width) set to 81.
SWRI: [for_hfx_and_dma] - Initialising persistent cache structures... done.
SWRI: [for_hfx_and_dma] - Initialising metric matrix... done.
SWRI: [for_hfx_and_dma] Done.
SWRI: Stage 1 completed.

========================== Sparse matrix information ===========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  22.67%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
HFx: Creating X matrix structure for val rep (spin 1).
HFx: Creating X matrix structure for val rep (spin 2).
Initializing spherical harmonic rotation module.

SWRI: Initializing module (stage 2)... 
SWRI: [for_hfx_and_dma] Initialising (stage 2)... 
SWRI: [for_hfx_and_dma] - NL: Populating neighbour list: SWRI_S_ATOMS... done.
SWRI: [for_hfx_and_dma] - Generating and communicating atomblock list.
SWRI: [for_hfx_and_dma]   0 atomblocks read from disk.
SWRI: [for_hfx_and_dma]   15 atomblocks to process.
SWRI: [for_hfx_and_dma]   Sorting atomblocks according to proximitiy to (0.000000,    0.000000,    0.000000).
SWRI: [for_hfx_and_dma] - Calculating on-site elements of the metric matrix V... done.
SWRI: [for_hfx_and_dma] - Calculating off-site elements of the metric matrix V.
 +----------------------------------------------------+
 |  Spherical wave res. of identity Chebyshev engine  |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  workspace atomblock                 :   51.26 kB  |
 |  vtile                               :   51.26 kB  |
 |  recvtile                            :   51.26 kB  |
 |  workers_done                        :   16.00  B  |
 |  atomblocklist                       :  300.00  B  |
 |  tilelist (root only)                :  180.00  B  |
 |  tile hash table (upper bound)       :  205.03 kB  |
 |  nodes_template                      :  162.00 kB  |
 |  swop_values                         :    1.58 MB  |
 |  swy_values                          :    1.58 MB  |
 |  swhome_all_coeffs                   :   12.81 MB  |
 |  swpot_batch_coeffs                  :   12.81 MB  |
 |  all_atomblocks (indices)            :  180.00  B  |
 |  my_atomblocks (indices)             :  180.00  B  |
 |  num_q_per_l                         :   36.00  B  |
 |  atomblock rotation matrix           :   51.26 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :   29.35 MB  |
 +----------------------------------------------------+
SWRI: [for_hfx_and_dma]   15 tiles to process (15 atomblocks x 1 batches)
SWRI: [for_hfx_and_dma]   Tiles completed:        0, left:       14, in progress:     1.
SWRI: [for_hfx_and_dma]   Tiles completed:        1, left:       10, in progress:     4.
SWRI: [for_hfx_and_dma]   Tiles completed:        5, left:        6, in progress:     4.
SWRI: [for_hfx_and_dma]   Tiles completed:        9, left:        2, in progress:     4.
SWRI: [for_hfx_and_dma]   Tiles completed:       13, left:        0, in progress:     2.
SWRI: [for_hfx_and_dma] - Filling the remainder by symmetry.
SWRI: [for_hfx_and_dma] - Writing for_hfx_and_dma.vmatrix to file "acetonitrile_anion_dma_and_hfx.for_hfx_and_dma.vmatrix"...done
SWRI: Done.
SWX: Initialising module... 
SWX: Initialising val%[properties_dma_swex-1]->full-RI->[for_hfx_and_dma].
SWX: - min_l: 0, max_l: 2, max_q: 9, num_sws: 81, max_sws: 81.
SWX: Done.
SWX: Initialising val%[properties_dma_swex-2]->part-RI->[for_hfx_and_dma].
SWX: - min_l: 0, max_l: 2, max_q: 8, num_sws: 72, max_sws: 72.
SWX: Done.
done.
NL: Populating neighbour list: HFx_S_ATOMS... done.
NL: Populating neighbour list: HFx_X_ATOMS... done.
NL: Populating neighbour list: HFx_XS_ATOMS... done.
NL: Populating neighbour list: HFx_SXS_ATOMS... done.
SWX: Initialising val%[hfx_swex]->full-RI->[for_hfx_and_dma].
SWX: - min_l: 0, max_l: 2, max_q: 9, num_sws: 81, max_sws: 81.
SWX: Done.
NGWF initialisation ...... done
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Estimating memory use...
 +----------------------------------------------------+
 |  HFx TEFCI engine: minimum requirements            |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  Radial Bessel lookup                :   61.80 MB  |
 |  Dd NGWFs hash table                 :  150.00 kB  |
 |  All remote NGWFs hash table         :    4.88 MB  |
 |  dlists hash table                   :    2.50 MB  |
 |  coeffs hash table (estimate)        :  211.23 kB  |
 |  V metric matrix hash table          :    1.77 MB  |
 |  f auxiliary term                    :   17.69 MB  |
 |  P term in NGWF gradient             :   17.69 MB  |
 |  Q term in NGWF gradient             :    5.61 MB  |
 |  My kets in NGWF grad. (estimate)    :   12.60 MB  |
 |  Local kets in NGWF grad. (estim.)   :    5.34 MB  |
 |  K^{CD} hash table                   :  309.00 kB  |
 |  K^{AB} hash table                   :  304.50 kB  |
 |  tcK^A_B hash table                  :  304.50 kB  |
 |  tcK^B_A hash table                  :  304.50 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  131.44 MB  |
 +----------------------------------------------------+
HFx: - Adjusting cache sizes according to weights: 0.0000, 0.8333, 0.1667.
 +----------------------------------------------------+
 |  HFx TEFCI engine: user-adjustable requirements    |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  Expansions hash table               :    1.52 GB  |
 |  AD NGWF products hash table         :  311.00 MB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :    1.82 GB  |
 +----------------------------------------------------+
HFx: - Peak memory use capped at 1999.4 MB per MPI rank.
+------------------------------------------------------------------------------+
|    MPI |                           |              |           |              |
|   rank |       SWOP cache capacity | SWOPs needed | Cacheable |    Hit ratio |
+------------------------------------------------------------------------------+
|      0 |              0 MiB (0 el) |      4500 el |     0.00% |        0.00% |
|      1 |              0 MiB (0 el) |      4500 el |     0.00% |        0.00% |
|      2 |              0 MiB (0 el) |      4500 el |     0.00% |        0.00% |
|      3 |              0 MiB (0 el) |      4500 el |     0.00% |        0.00% |
+------------------------------------------------------------------------------+
HFx: - Populating SWOP cache...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.34895734E+01     0.92013382E+00
               2       0.32533252E+01     0.84997499E+00
               3       0.29614294E+01     0.73321431E+00
               4       0.26627872E+01     0.66876320E+00
               5       0.24016384E+01     0.65596224E+00
               6       0.21588637E+01     0.63408959E+00
               7       0.18900457E+01     0.59444194E+00
               8       0.15651974E+01     0.52397496E+00
               9       0.11565357E+01     0.40891875E+00
              10       0.73320403E+00     0.25304349E+00
              11       0.38959563E+00     0.12254797E+00
              12       0.13786859E+00     0.44304355E-01
              13       0.18818813E-01     0.60168966E-02
              14       0.35411176E-03     0.11309934E-03
              15       0.12539514E-06     0.40049353E-07
              16       0.15707695E-13     0.53290705E-14
================================================================================
Density renormalisation, spin  1 ...
Target Charge:     9.000000000000 ; Input Charge:     8.000064470982
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -0.66900270193229    0.5823181
               2          -0.88100184421745    0.5589970
               3          -1.12521153364785    0.5241404
               4          -1.37707357059865    0.4625872
               5          -1.54817559910348    0.3622520
               6          -1.60014643736828    0.3247889
               7          -1.61400235226306    0.3659584
               8          -1.62362780149424    0.4212385
               9          -1.63023547382752    0.4706825
              10          -1.63301353291895    0.4957453
              11          -1.63343584559759    0.4999082
              12          -1.63344482882414    0.5000000
              13          -1.63344483647700    0.5000000
              14          -1.63344484170017    0.5000000
              15          -1.63344484953491    0.5000000
              16          -1.63344486128697    0.5000000
              17          -1.63344487891492    0.5000000
              18          -1.63344490535637    0.5000000
              19          -1.63344494501695    0.5000000
              20          -1.63344500450240    0.5000000
              21          -1.63344509371231    0.5000000
              22          -1.63344522746556    0.5000000
              23          -1.63344542788761    0.5000000
              24          -1.63344572782058    0.5000000
              25          -1.63344617536685    0.5000000
              26          -1.63344683881680    0.5000000
              27          -1.63344780797473    0.5000000
              28          -1.63344917787061    0.5000000
              29          -1.63345097745190    0.5000000
              30          -1.63345299027691    0.5000000
              31          -1.63345458750293    0.5000000
              32          -1.63345522100596    0.5000000
              33          -1.63345528951948    0.5000000
              34          -1.63345529020430    0.5000000
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000005798:    0.99999999999247]
Closest occupancy to 0.5:     0.99999999999199
================================================================================
... done
Down spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -0.50538234893950    0.5490522
               2          -0.77714900021134    0.5341231
               3          -1.08285363871937    0.5219853
               4          -1.37985903372471    0.5250053
               5          -1.60478576113397    0.5368707
               6          -1.72635454894773    0.5264880
               7          -1.78106612821749    0.5062264
               8          -1.79726346118811    0.5002903
               9          -1.79855331080301    0.5000006
              10          -1.79856091066759    0.4999993
              11          -1.79856091093489    0.4999993
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       9.00000000
   Initial electron number for spin 2:       8.00000000
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       5 [3] (1)
  - B:       2 [1] (1)
  - B:       4 [2] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       6 [3] (2)
  - B:       4 [1] (2)
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: +-----------------------------------------------------------------------+
HFx: |    MPI |                          Expansion cache                     |
HFx: |   rank |           hits |         misses |          total | hit ratio |
HFx: +-----------------------------------------------------------------------+
HFx: |      0 |          53250 |              0 |          53250 |  100.00 % |
HFx: |      1 |          32250 |              0 |          32250 |  100.00 % |
HFx: |      2 |          45000 |              0 |          45000 |  100.00 % |
HFx: |      3 |          38250 |              0 |          38250 |  100.00 % |
HFx: +-----------------------------------------------------------------------+
HFx: +-----------------------------------------------------------------------+
HFx: |    MPI |                    AD NGWF product cache                     |
HFx: |   rank |           hits |         misses |          total | hit ratio |
HFx: +-----------------------------------------------------------------------+
HFx: |      0 |          21388 |              0 |          21388 |  100.00 % |
HFx: |      1 |          32082 |              0 |          32082 |  100.00 % |
HFx: |      2 |          21388 |              0 |          21388 |  100.00 % |
HFx: |      3 |          21388 |              0 |          21388 |  100.00 % |
HFx: +-----------------------------------------------------------------------+
HFx: Exchange matrix symmetric to  4.32 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.685014627186 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.585101794593 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.270116421778 Ha.
      ideal mu1:      -0.360228357010
      ideal mu2:      -0.399059708647
             Q0:         -22.604629133656
             G0:      -0.439083851486
   RMS gradient:       0.062473735031
    Initial Ne1:       9.00000000
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000393 (step -0.4991 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -2.260462913366E+01     6.2474E-02     3.9539E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       5 [2]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  4.32 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.684572948628 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.584316035678 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.268888984305 Ha.
      ideal mu1:      -0.356873920736
      ideal mu2:      -0.396289395308
             Q0:         -22.641798868132
             G0:      -0.365005781559
   RMS gradient:       0.043783764138
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
  + B:       5 [2]
HFx: Exchange matrix symmetric to  4.32 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.685507693742 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.585366231624 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.270873925366 Ha.
     Trial step:       0.500000000000
             Q1:         -22.593909417225
 Quadratic coef:       0.230392341686
 Linear coef   :      -0.182502890780
           Qmin:         -22.677940808549
Quadratic minimum step length (  0.198034892831) accepted
    Initial Ne1:       9.00000000
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002996 (step -0.4927 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000013 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -2.264179886813E+01     4.3784E-02     2.7754E-02    -3.7170E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
  + B:       5 [2]
HFx: Exchange matrix symmetric to  4.31 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.684333083906 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.583675975999 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.268009059905 Ha.
      ideal mu1:      -0.344011175978
      ideal mu2:      -0.382892896782
             Q0:         -22.678045755842
             G0:      -0.033732087583
   RMS gradient:       0.017260432779
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       3 [1]
  + B:       2 [0]
  + B:       4 [1]
  + B:       5 [2]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  4.31 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.684664541857 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.583778049371 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.268442591228 Ha.
     Trial step:       0.314670377404
             Q1:         -22.683589967474
 Quadratic coef:       0.005070277098
 Linear coef   :      -0.010614488730
           Qmin:         -22.683601042507
Quadratic minimum step length (  0.329376985740) accepted
    Initial Ne1:       8.99999999
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001806 (step -0.4955 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000005 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -2.267804575584E+01     1.7260E-02     1.0841E-02    -3.6247E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
  + B:       5 [2]
HFx: Exchange matrix symmetric to  4.31 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.684685984905 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.583793105544 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.268479090449 Ha.
      ideal mu1:      -0.339308507602
      ideal mu2:      -0.377613211892
             Q0:         -22.683694891072
             G0:      -0.009803486253
   RMS gradient:       0.009247204245
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
  + B:       2 [0]
  + B:       4 [1]
  + B:       6 [3]
  + B:       5 [2]
HFx: Exchange matrix symmetric to  4.31 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.684283340275 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.583081768969 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.267365109245 Ha.
     Trial step:       0.321939715492
             Q1:         -22.685123962002
 Quadratic coef:       0.001727060645
 Linear coef   :      -0.003156131575
           Qmin:         -22.685136815904
Quadratic minimum step length (  0.294165727259) accepted
    Initial Ne1:       9.00000000
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000682 (step -0.4984 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -2.268369489107E+01     9.2472E-03     5.7590E-03    -5.6491E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
  + B:       5 [2]
HFx: Exchange matrix symmetric to  4.31 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.684317524879 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.583143095588 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.267460620466 Ha.
      ideal mu1:      -0.342328580377
      ideal mu2:      -0.380820710647
    5        -2.268515525813E+01     5.2188E-03     3.2536E-03    -1.4604E-03
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.26851552581336E+01  Eh
     Estimated bandgap (UP spin) =   8.9977E-02  Eh
     Estimated bandgap (DN spin) =   3.5055E-01  Eh
     RMS occupancy error         =   9.2544E-13
     [H,K] commutator            =   3.2536E-03
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       5 [3]
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Communicating NGWF gradient kets.
  * C:       1 [0]
  * C:       1 [2]
  * C:       1 [3]
  * C:       1 [1]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [2]
  * C:       3 [0]
  * C:       4 [2]
  * C:       4 [0]
  * C:       3 [1]
  * C:       5 [3]
  * C:       5 [2]
  * C:       4 [1]
  * C:       5 [1]
  * C:       6 [1]
  * C:       6 [3]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  4.31 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.684317524879 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.583143095588 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.267460620466 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8903E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.45265600E-02     0.17823754E-02
               2       0.88809400E-05     0.34244221E-05
               3       0.55467494E-10     0.21692648E-10
               4       0.20104247E-14     0.88817842E-15
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       2 [1] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  4.29 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.687614379624 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.586462184920 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.274076564544 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46687432E-01     0.18634427E-01
               2       0.84962476E-03     0.33031693E-03
               3       0.36161341E-06     0.16792468E-06
               4       0.88206192E-13     0.42410520E-13
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00189025373971
Trial step length           =               0.122474
Gradient along search dir.  =         -0.61603470981
Functional at step 0        =     -22.68515525813359
Functional at step 1        =     -22.75622587836592
Functional predicted        =     -23.01022333104306
Selected quadratic step     =               1.055356
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       9.04646168
   Initial electron number for spin 2:       8.03652096
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.004378 (step -0.4904 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000035 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       4 [2] (1)
  - B:       5 [3] (1)
  - B:       2 [1] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  - B:       2 [1] (2)
  + B:       5 [3]
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.92 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.713444363197 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612838532617 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.326282895814 Ha.
      ideal mu1:      -0.271103802138
      ideal mu2:      -0.308865126605
             Q0:         -23.005543497542
             G0:      -0.024471781192
   RMS gradient:       0.014748794660
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.92 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712456874006 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612374172802 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.324831046809 Ha.
     Trial step:       0.307739549849
             Q1:         -23.010240569527
 Quadratic coef:       0.002833862943
 Linear coef   :      -0.007530934928
           Qmin:         -23.010546825334
Quadratic minimum step length (  0.408905894765) accepted
    Initial Ne1:       8.99999990
    Initial Ne2:       7.99999991
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000385 (step -0.4989 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -2.300554349754E+01     1.4749E-02     9.2397E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712141933787 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612233981967 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.324375915754 Ha.
      ideal mu1:      -0.281567637776
      ideal mu2:      -0.320029920762
             Q0:         -23.010561083347
             G0:      -0.001792959366
   RMS gradient:       0.003977653460
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.711896484102 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612374643231 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.324271127333 Ha.
     Trial step:       0.354734430223
             Q1:         -23.011011374825
 Quadratic coef:       0.000185732941
 Linear coef   :      -0.000636024419
           Qmin:         -23.011105584310
Quadratic minimum step length (  0.607376801852) accepted
    Initial Ne1:       8.99999999
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000143 (step -0.4996 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    2        -2.301056108335E+01     3.9777E-03     2.4545E-03    -5.0176E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.711719032558 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612471927562 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.324190960119 Ha.
      ideal mu1:      -0.282516676672
      ideal mu2:      -0.320800645130
             Q0:         -23.011105508174
             G0:      -0.000715064071
   RMS gradient:       0.002522852983
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.711519112805 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612671070800 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.324190183605 Ha.
     Trial step:       0.464173958485
             Q1:         -23.011287065866
 Quadratic coef:       0.000150356428
 Linear coef   :      -0.000331914121
           Qmin:         -23.011288684551
Quadratic minimum step length (  0.512335565631) accepted
    Initial Ne1:       9.00000016
    Initial Ne2:       8.00000097
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000110 (step -0.4996 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    3        -2.301110550817E+01     2.5229E-03     1.5586E-03    -5.4442E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.711498285790 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612691644045 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.324189929835 Ha.
      ideal mu1:      -0.282808727675
      ideal mu2:      -0.321133593213
             Q0:         -23.011289012101
             G0:      -0.000371747798
   RMS gradient:       0.001815568589
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.711033126230 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612605278188 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323638404418 Ha.
     Trial step:       0.487660565939
             Q1:         -23.011409771182
 Quadratic coef:       0.000060527660
 Linear coef   :      -0.000181286742
           Qmin:         -23.011424755339
Quadratic minimum step length (  0.730297472916) accepted
    Initial Ne1:       9.00000062
    Initial Ne2:       8.00000233
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000169 (step -0.4992 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    4        -2.301128901210E+01     1.8156E-03     1.1289E-03    -1.8350E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.710801214888 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612563049435 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323364264323 Ha.
      ideal mu1:      -0.283663417807
      ideal mu2:      -0.322019323046
    5        -2.301142520801E+01     9.4315E-04     5.8716E-04    -1.3620E-04
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30114252080089E+01  Eh
     Estimated bandgap (UP spin) =   9.3219E-02  Eh
     Estimated bandgap (DN spin) =   3.5072E-01  Eh
     RMS occupancy error         =   8.8794E-08
     [H,K] commutator            =   5.8716E-04
     UP spin occupancy bounds    = [ -0.000:  1.000]
     DN spin occupancy bounds    = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       5 [3]
  + B:       4 [2]
  + B:       2 [1]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       6 [3]
  + B:       4 [1]
HFx: Communicating NGWF gradient kets.
  * C:       1 [3]
  * C:       1 [1]
  * C:       1 [0]
  * C:       1 [2]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [0]
  * C:       3 [2]
  * C:       4 [2]
  * C:       4 [0]
  * C:       3 [1]
  * C:       5 [3]
  * C:       4 [1]
  * C:       5 [2]
  * C:       5 [1]
  * C:       6 [1]
  * C:       6 [3]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.93 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.710801214888 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.612563049435 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323364264323 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.7029E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15576228E-01     0.62433228E-02
               2       0.12589866E-03     0.53281635E-04
               3       0.10633363E-07     0.47742319E-08
               4       0.23558957E-14     0.88817842E-15
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       5 [3] (1)
  - B:       1 [0] (1)
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.89 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712478170595 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.614732784446 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327210955041 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.35691149E-01     0.14681104E-01
               2       0.63445190E-03     0.27543581E-03
               3       0.26527587E-06     0.12020357E-06
               4       0.49128638E-13     0.22204460E-13
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00077028728793
Trial step length           =               0.359519
Gradient along search dir.  =         -0.10212228521
Functional at step 0        =     -23.01142520800888
Functional at step 1        =     -23.04194027797199
Functional predicted        =     -23.06578061471967
Selected quadratic step     =               1.064516
Conjugate gradients coeff.  =               0.166060
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       9.04299682
   Initial electron number for spin 2:       8.03305164
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003179 (step -0.4929 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000017 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       4 [2] (1)
  - B:       1 [0] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  - B:       2 [1] (2)
  + B:       6 [3]
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.715238268418 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618549681358 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333787949776 Ha.
      ideal mu1:      -0.275144578883
      ideal mu2:      -0.312075026530
             Q0:         -23.065965993352
             G0:      -0.005841089871
   RMS gradient:       0.007205608847
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       5 [3]
  + B:       4 [2]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.715395065139 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618816166190 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.334211231328 Ha.
     Trial step:       0.596772384537
             Q1:         -23.066297504940
 Quadratic coef:       0.003154289542
 Linear coef   :      -0.003485801130
           Qmin:         -23.066929031887
Quadratic minimum step length (  0.329746179730) accepted
    Initial Ne1:       8.99999997
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000055 (step -0.4999 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    1        -2.306596599335E+01     7.2056E-03     4.5462E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       5 [2]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.715314302031 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618682696562 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333996998593 Ha.
      ideal mu1:      -0.277127515577
      ideal mu2:      -0.314592020999
             Q0:         -23.066928666205
             G0:      -0.000672736996
   RMS gradient:       0.002445417805
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.715121092874 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618756880888 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333877973762 Ha.
     Trial step:       0.443602765962
             Q1:         -23.067086084822
 Quadratic coef:       0.000141009375
 Linear coef   :      -0.000298427992
           Qmin:         -23.067086562207
Quadratic minimum step length (  0.469413762630) accepted
    Initial Ne1:       9.00000004
    Initial Ne2:       8.00000007
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000031 (step -0.4999 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    2        -2.306692866621E+01     2.4454E-03     1.5221E-03    -9.6267E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.715109820994 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618761178449 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333870999443 Ha.
      ideal mu1:      -0.277535994032
      ideal mu2:      -0.315126279564
             Q0:         -23.067086606385
             G0:      -0.000240808018
   RMS gradient:       0.001462651790
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.715026966156 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619010322201 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.334037288357 Ha.
     Trial step:       0.456325808478
             Q1:         -23.067161937089
 Quadratic coef:       0.000034556209
 Linear coef   :      -0.000109886913
           Qmin:         -23.067173965024
Quadratic minimum step length (  0.725545937583) accepted
    Initial Ne1:       9.00000005
    Initial Ne2:       8.00000007
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000044 (step -0.4999 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    3        -2.306708660638E+01     1.4627E-03     8.9891E-04    -1.5794E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.714977491233 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619157410307 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.334134901539 Ha.
      ideal mu1:      -0.276945596076
      ideal mu2:      -0.314528280772
             Q0:         -23.067173994538
             G0:      -0.000101728326
   RMS gradient:       0.000950818910
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.714666540544 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619131844787 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333798385331 Ha.
     Trial step:       0.575400153420
             Q1:         -23.067213445923
 Quadratic coef:       0.000019083109
 Linear coef   :      -0.000058534494
           Qmin:         -23.067218880922
Quadratic minimum step length (  0.882475611437) accepted
    Initial Ne1:       9.00000004
    Initial Ne2:       8.00000028
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000058 (step -0.4997 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    4        -2.306717399454E+01     9.5082E-04     5.8657E-04    -8.7388E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.714500151438 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619118132714 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333618284152 Ha.
      ideal mu1:      -0.277641617351
      ideal mu2:      -0.315283904946
    5        -2.306721890964E+01     5.6655E-04     3.5298E-04    -4.4915E-05
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30672189096394E+01  Eh
     Estimated bandgap (UP spin) =   9.2012E-02  Eh
     Estimated bandgap (DN spin) =   3.4659E-01  Eh
     RMS occupancy error         =   1.0414E-08
     [H,K] commutator            =   3.5298E-04
     UP spin occupancy bounds    = [ -0.000:  1.000]
     DN spin occupancy bounds    = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       5 [3]
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       6 [3]
  + B:       5 [2]
  + B:       4 [1]
HFx: Communicating NGWF gradient kets.
  * C:       1 [3]
  * C:       1 [1]
  * C:       1 [0]
  * C:       1 [2]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [0]
  * C:       3 [2]
  * C:       4 [2]
  * C:       4 [0]
  * C:       3 [1]
  * C:       5 [3]
  * C:       4 [1]
  * C:       5 [2]
  * C:       5 [1]
  * C:       6 [1]
  * C:       6 [3]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.83 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.714500151438 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619118132714 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333618284152 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8514E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.25472617E-01     0.86529040E-02
               2       0.34368281E-03     0.13207253E-03
               3       0.82711229E-07     0.33705253E-07
               4       0.56560354E-14     0.28865799E-14
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       6 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.82 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.713675966900 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619407174932 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.333083141832 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.29108522E-01     0.99736164E-02
               2       0.44543012E-03     0.17150356E-03
               3       0.13918109E-06     0.57035480E-07
               4       0.14900591E-13     0.59952043E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00038514484684
Trial step length           =               0.618639
Gradient along search dir.  =         -0.02628729457
Functional at step 0        =     -23.06721890963937
Functional at step 1        =     -23.07940111161094
Functional predicted        =     -23.08342323364944
Selected quadratic step     =               1.232864
Conjugate gradients coeff.  =               0.250002
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       9.02823899
   Initial electron number for spin 2:       8.01959224
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002132 (step -0.4934 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000015 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       6 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712659112834 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619533852089 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332192964924 Ha.
      ideal mu1:      -0.282832803207
      ideal mu2:      -0.319838714905
             Q0:         -23.083368043336
             G0:      -0.002325201466
   RMS gradient:       0.004546257524
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712812874049 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619722589675 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332535463724 Ha.
     Trial step:       0.712584452686
             Q1:         -23.083317303959
 Quadratic coef:       0.001707641791
 Linear coef   :      -0.001656902414
           Qmin:         -23.083769961001
Quadratic minimum step length (  0.345705670365) accepted
    Initial Ne1:       8.99999997
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000028 (step -0.4999 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    1        -2.308336804334E+01     4.5463E-03     2.8675E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712728879905 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619619190662 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332348070567 Ha.
      ideal mu1:      -0.283823132837
      ideal mu2:      -0.321144347478
             Q0:         -23.083770003895
             G0:      -0.000258290386
   RMS gradient:       0.001515133090
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712619639222 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619690514345 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332310153567 Ha.
     Trial step:       0.496331024527
             Q1:         -23.083831185179
 Quadratic coef:       0.000067016248
 Linear coef   :      -0.000128197532
           Qmin:         -23.083831312189
Quadratic minimum step length (  0.474723777869) accepted
    Initial Ne1:       9.00000002
    Initial Ne2:       8.00000003
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -2.308377000389E+01     1.5151E-03     9.4581E-04    -4.0196E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712624407279 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619687421825 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332311829105 Ha.
      ideal mu1:      -0.283741881464
      ideal mu2:      -0.321144770249
             Q0:         -23.083831320344
             G0:      -0.000089161135
   RMS gradient:       0.000890167868
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712580344132 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619870700205 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332451044337 Ha.
     Trial step:       0.485407188901
             Q1:         -23.083859994202
 Quadratic coef:       0.000014605597
 Linear coef   :      -0.000043279456
           Qmin:         -23.083863381875
Quadratic minimum step length (  0.719181772754) accepted
    Initial Ne1:       8.99999998
    Initial Ne2:       7.99999998
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -2.308383132034E+01     8.9017E-04     5.4951E-04    -6.1316E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712558976228 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619959032632 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332518008860 Ha.
      ideal mu1:      -0.283191353253
      ideal mu2:      -0.320601214318
             Q0:         -23.083863388341
             G0:      -0.000038939044
   RMS gradient:       0.000588260368
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712348148219 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619959010692 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332307158910 Ha.
     Trial step:       0.590843467106
             Q1:         -23.083879596121
 Quadratic coef:       0.000006799099
 Linear coef   :      -0.000023006880
           Qmin:         -23.083882851084
Quadratic minimum step length (  0.999651836754) accepted
    Initial Ne1:       8.99999990
    Initial Ne2:       7.99999994
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000026 (step -0.4999 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    4        -2.308386338834E+01     5.8826E-04     3.6054E-04    -3.2068E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712202130515 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619958933518 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332161064033 Ha.
      ideal mu1:      -0.283771401678
      ideal mu2:      -0.321239022768
    5        -2.308388285328E+01     3.6127E-04     2.2536E-04    -1.9465E-05
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30838828532801E+01  Eh
     Estimated bandgap (UP spin) =   8.8027E-02  Eh
     Estimated bandgap (DN spin) =   3.4144E-01  Eh
     RMS occupancy error         =   2.0907E-09
     [H,K] commutator            =   2.2536E-04
     UP spin occupancy bounds    = [ -0.000:  1.000]
     DN spin occupancy bounds    = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       5 [3]
  + B:       2 [1]
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [0]
  + B:       5 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       4 [1]
HFx: Communicating NGWF gradient kets.
  * C:       1 [3]
  * C:       1 [1]
  * C:       1 [2]
  * C:       1 [0]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [1]
  * C:       2 [0]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [0]
  * C:       3 [2]
  * C:       4 [2]
  * C:       4 [0]
  * C:       3 [1]
  * C:       5 [3]
  * C:       4 [1]
  * C:       5 [2]
  * C:       5 [1]
  * C:       6 [1]
  * C:       6 [3]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.80 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.712202130515 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619958933518 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.332161064033 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4660E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.38763743E-01     0.12433592E-01
               2       0.81508858E-03     0.31512526E-03
               3       0.48883931E-06     0.20149184E-06
               4       0.19271320E-12     0.79936058E-13
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.79 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.710312251938 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619661476640 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.329973728577 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.21189587E-01     0.66769394E-02
               2       0.24220539E-03     0.93495912E-04
               3       0.43286065E-07     0.17845412E-07
               4       0.30449109E-14     0.11102230E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00024660480069
Trial step length           =               0.873326
Gradient along search dir.  =         -0.01077219063
Functional at step 0        =     -23.08388285328014
Functional at step 1        =     -23.09009998667775
Functional predicted        =     -23.09081778538814
Selected quadratic step     =               1.287562
Conjugate gradients coeff.  =               0.409973
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       9.01738153
   Initial electron number for spin 2:       8.01053616
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001667 (step -0.4936 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000011 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       4 [2] (1)
  - B:       5 [3] (1)
  - B:       2 [1] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.709341703923 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619469749312 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328811453235 Ha.
      ideal mu1:      -0.289497788923
      ideal mu2:      -0.326816007135
             Q0:         -23.090765592047
             G0:      -0.000869591374
   RMS gradient:       0.002780234002
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.709345607334 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619629919383 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328975526717 Ha.
     Trial step:       0.768529607189
             Q1:         -23.090720782856
 Quadratic coef:       0.000713115909
 Linear coef   :      -0.000668306717
           Qmin:         -23.090922170333
Quadratic minimum step length (  0.360119226555) accepted
    Initial Ne1:       8.99999998
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000011 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -2.309076559205E+01     2.7802E-03     1.7576E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.709342158540 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619542669810 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328884828351 Ha.
      ideal mu1:      -0.290121793225
      ideal mu2:      -0.327589823690
             Q0:         -23.090922167048
             G0:      -0.000135589538
   RMS gradient:       0.001097827048
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.709204065994 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619581381787 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328785447781 Ha.
     Trial step:       0.526082016158
             Q1:         -23.090960793725
 Quadratic coef:       0.000032704540
 Linear coef   :      -0.000071331218
           Qmin:         -23.090961061821
Quadratic minimum step length (  0.573713479469) accepted
    Initial Ne1:       8.99999998
    Initial Ne2:       7.99999998
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -2.309092216705E+01     1.0978E-03     6.8335E-04    -1.5658E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.709191536017 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619584863683 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328776399700 Ha.
      ideal mu1:      -0.290159979305
      ideal mu2:      -0.327698464287
             Q0:         -23.090961065907
             G0:      -0.000059374486
   RMS gradient:       0.000726411590
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.709111563364 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619737029064 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328848592428 Ha.
     Trial step:       0.549381783440
             Q1:         -23.090983386447
 Quadratic coef:       0.000010298721
 Linear coef   :      -0.000032619261
           Qmin:         -23.090986894749
Quadratic minimum step length (  0.870031692577) accepted
    Initial Ne1:       8.99999997
    Initial Ne2:       7.99999996
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000018 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -2.309096106591E+01     7.2641E-04     4.4614E-04    -3.8899E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.709064706165 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619825862306 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328890568470 Ha.
      ideal mu1:      -0.289705284000
      ideal mu2:      -0.327254128085
             Q0:         -23.090986895585
             G0:      -0.000029703817
   RMS gradient:       0.000513883597
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       4 [2]
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.708832064691 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619806337044 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328638401736 Ha.
     Trial step:       0.691360660522
             Q1:         -23.090999355246
 Quadratic coef:       0.000008076389
 Linear coef   :      -0.000020536050
           Qmin:         -23.090999949976
Quadratic minimum step length (  0.878970594838) accepted
    Initial Ne1:       8.99999987
    Initial Ne2:       7.99999995
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000022 (step -0.4999 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    4        -2.309098689559E+01     5.1388E-04     3.1675E-04    -2.5830E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.708768908319 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619801017454 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328569925773 Ha.
      ideal mu1:      -0.290279184593
      ideal mu2:      -0.327884432412
    5        -2.309099995477E+01     2.3930E-04     1.4904E-04    -1.3059E-05
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30909999547734E+01  Eh
     Estimated bandgap (UP spin) =   8.3303E-02  Eh
     Estimated bandgap (DN spin) =   3.3629E-01  Eh
     RMS occupancy error         =   1.3908E-09
     [H,K] commutator            =   1.4904E-04
     UP spin occupancy bounds    = [ -0.000:  1.000]
     DN spin occupancy bounds    = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       4 [2]
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [0]
  + B:       5 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       4 [1]
HFx: Communicating NGWF gradient kets.
  * C:       1 [3]
  * C:       1 [1]
  * C:       1 [0]
  * C:       1 [2]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [0]
  * C:       3 [2]
  * C:       4 [2]
  * C:       4 [0]
  * C:       3 [1]
  * C:       5 [3]
  * C:       4 [1]
  * C:       5 [2]
  * C:       5 [1]
  * C:       6 [1]
  * C:       6 [3]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.708768908319 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619801017454 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.328569925773 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7321E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.20022938E-01     0.66667957E-02
               2       0.21949006E-03     0.76900048E-04
               3       0.35656033E-07     0.13399593E-07
               4       0.26624021E-14     0.88817842E-15
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       2 [1] (1)
  - B:       4 [2] (1)
  - B:       1 [0] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       6 [3] (1)
  - B:       5 [2] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707843193949 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619572392391 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327415586340 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.59267577E-03     0.19520435E-03
               2       0.19817468E-06     0.69954833E-07
               3       0.30037631E-13     0.11102230E-13
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00017321211920
Trial step length           =               1.060406
Gradient along search dir.  =         -0.00517275038
Functional at step 0        =     -23.09099995477340
Functional at step 1        =     -23.09366472992267
Functional predicted        =     -23.09366687778254
Selected quadratic step     =               1.031143
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       8.99827854
   Initial electron number for spin 2:       7.99881915
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000490 (step -0.5002 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       6 [3] (1)
  - B:       5 [2] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707870164318 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619579830038 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327449994357 Ha.
      ideal mu1:      -0.292003667521
      ideal mu2:      -0.329647081781
             Q0:         -23.093666954730
             G0:      -0.000040412516
   RMS gradient:       0.000599351622
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707691049723 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619538692984 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327229742707 Ha.
     Trial step:       0.779541975154
             Q1:         -23.093675867721
 Quadratic coef:       0.000022590262
 Linear coef   :      -0.000031503253
           Qmin:         -23.093677937946
Quadratic minimum step length (  0.543555170901) accepted
    Initial Ne1:       9.00000000
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -2.309366695473E+01     5.9935E-04     3.6723E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707745286023 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619551171732 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327296457755 Ha.
      ideal mu1:      -0.292200354117
      ideal mu2:      -0.329818142377
             Q0:         -23.093677939211
             G0:      -0.000015892478
   RMS gradient:       0.000375855160
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707624404452 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619537457194 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327161861647 Ha.
     Trial step:       0.650940912472
             Q1:         -23.093685293989
 Quadratic coef:       0.000002990286
 Linear coef   :      -0.000010345064
           Qmin:         -23.093686886546
Quadratic minimum step length (  1.125983689806) accepted
    Initial Ne1:       9.00000000
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000008 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -2.309367793921E+01     3.7586E-04     2.3074E-04    -1.0984E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707536152877 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619527434897 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327063587774 Ha.
      ideal mu1:      -0.292524898017
      ideal mu2:      -0.330179528900
             Q0:         -23.093686887135
             G0:      -0.000012207175
   RMS gradient:       0.000329388317
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       5 [2]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707426778639 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619589947207 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327016725846 Ha.
     Trial step:       0.856124319518
             Q1:         -23.093691094909
 Quadratic coef:       0.000006243085
 Linear coef   :      -0.000010450859
           Qmin:         -23.093691260792
Quadratic minimum step length (  0.716571612840) accepted
    Initial Ne1:       8.99999997
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -2.309368688713E+01     3.2939E-04     2.0660E-04    -8.9479E-06
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707444614337 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619579770087 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327024384423 Ha.
      ideal mu1:      -0.292573835501
      ideal mu2:      -0.330245918576
             Q0:         -23.093691261756
             G0:      -0.000001406062
   RMS gradient:       0.000111783833
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707436192248 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619605515189 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327041707437 Ha.
     Trial step:       0.783246056121
             Q1:         -23.093691665092
 Quadratic coef:       0.000000697957
 Linear coef   :      -0.000001101293
           Qmin:         -23.093691696183
Quadratic minimum step length (  0.617934502491) accepted
    Initial Ne1:       8.99999997
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -2.309369126176E+01     1.1178E-04     7.0581E-05    -4.3746E-06
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707437971563 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619600082477 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327038054041 Ha.
      ideal mu1:      -0.292582862831
      ideal mu2:      -0.330256678505
    5        -2.309369169620E+01     4.3618E-05     2.7057E-05    -4.3444E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30936916961996E+01  Eh
     Estimated bandgap (UP spin) =   8.1571E-02  Eh
     Estimated bandgap (DN spin) =   3.3441E-01  Eh
     RMS occupancy error         =   1.6047E-11
     [H,K] commutator            =   2.7057E-05
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       17.23312682407322 |
           | Pseudopotential (local)    :      -96.39515552249412 |
           | Pseudo (non-coul chg cor)  :       -0.00006982257377
           | Pseudopotential (non-local):        2.91064985876857 |
           | Hartree                    :       40.65358044438884 |
           | Exchange-correlation       :       -5.93773671307919 |
           | Hartree-Fock exchange      :       -1.32703805404056 |
           | Ewald                      :       19.76888146618368 |
           | Total                      :      -23.09369169619957 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -96.39515552249426 |
           | Hartree                    :       40.65358044438864 |
           --------------------------------------------------------
           Integrated density           :       17.00000000000002
           Integrated spin density      :        0.99999999999997
           Integrated |spin density|    :        1.03707001905196
           Local density approx. <S^2>  :        0.76853500952598
           Integrated density tr(KS)    :       17.00000000000000
           Integrated spin tr(KS)       :        1.00000000000000
================================================================================




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       6 [3]
  + B:       4 [1]
  + B:       5 [2]
HFx: Communicating NGWF gradient kets.
  * C:       1 [1]
  * C:       1 [0]
  * C:       1 [2]
  * C:       1 [3]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [0]
  * C:       3 [2]
  * C:       4 [0]
  * C:       4 [2]
  * C:       3 [1]
  * C:       5 [3]
  * C:       4 [1]
  * C:       5 [2]
  * C:       5 [1]
  * C:       6 [3]
  * C:       6 [1]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.78 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.707437971563 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619600082477 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.327038054041 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.3514E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.35316590E-01     0.11404195E-01
               2       0.71436811E-03     0.24110071E-03
               3       0.38681978E-06     0.13880820E-06
               4       0.12123379E-12     0.43520743E-13
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       4 [2] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       2 [1] (2)
  - B:       5 [3] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  - B:       6 [3] (2)
  + B:       2 [1]
  + B:       5 [3]
  + B:       3 [1]
  + B:       4 [1]
  + B:       6 [3]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.706118200506 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619399538036 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.325517738542 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.26923096E-01     0.84794345E-02
               2       0.43542606E-03     0.14948554E-03
               3       0.15035237E-06     0.54551538E-07
               4       0.19105523E-13     0.73274720E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00013513589295
Trial step length           =               1.045672
Gradient along search dir.  =         -0.00317153044
Functional at step 0        =     -23.09369169619956
Functional at step 1        =     -23.09599947169906
Functional predicted        =     -23.09641783194773
Selected quadratic step     =               1.719129
Conjugate gradients coeff.  =               0.608674
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       8.99879426
   Initial electron number for spin 2:       7.99859341
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001206 (step -0.4997 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000006 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       4 [2] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.705213048596 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619248727753 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.324461776349 Ha.
      ideal mu1:      -0.296077703625
      ideal mu2:      -0.333900202143
             Q0:         -23.096420332822
             G0:      -0.000201865366
   RMS gradient:       0.001339536788
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704829115098 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619090374682 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323919489780 Ha.
     Trial step:       0.695697320691
             Q1:         -23.096478778219
 Quadratic coef:       0.000081991797
 Linear coef   :      -0.000140437194
           Qmin:         -23.096480468733
Quadratic minimum step length (  0.595802162791) accepted
    Initial Ne1:       9.00000000
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -2.309642033282E+01     1.3395E-03     8.2570E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704884482202 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619113358258 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323997840460 Ha.
      ideal mu1:      -0.296890494383
      ideal mu2:      -0.334709090940
             Q0:         -23.096480477920
             G0:      -0.000069945266
   RMS gradient:       0.000788563273
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704638168464 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619085297174 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323723465638 Ha.
     Trial step:       0.643815166267
             Q1:         -23.096512055233
 Quadratic coef:       0.000013454510
 Linear coef   :      -0.000045031823
           Qmin:         -23.096518157945
Quadratic minimum step length (  1.077414592951) accepted
    Initial Ne1:       8.99999997
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000030 (step -0.4998 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    2        -2.309648047792E+01     7.8856E-04     4.8299E-04    -6.0145E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704471993020 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619066308475 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323538301495 Ha.
      ideal mu1:      -0.297368469602
      ideal mu2:      -0.335262216644
             Q0:         -23.096518157659
             G0:      -0.000081047099
   RMS gradient:       0.000848848944
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       5 [3]
  + B:       4 [2]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704196392855 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619278324900 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323474717754 Ha.
     Trial step:       0.832860045445
             Q1:         -23.096543883530
 Quadratic coef:       0.000041775019
 Linear coef   :      -0.000067500890
           Qmin:         -23.096545424973
Quadratic minimum step length (  0.672875742524) accepted
    Initial Ne1:       9.00000000
    Initial Ne2:       8.00000007
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000056 (step -0.4997 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    3        -2.309651815766E+01     8.4885E-04     5.3074E-04    -3.7680E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704249314807 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619237627030 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323486941837 Ha.
      ideal mu1:      -0.297500422864
      ideal mu2:      -0.335437302166
             Q0:         -23.096545457689
             G0:      -0.000012890103
   RMS gradient:       0.000338263930
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704150805051 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619254409832 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323405214883 Ha.
     Trial step:       0.748606252644
             Q1:         -23.096547211464
 Quadratic coef:       0.000007895837
 Linear coef   :      -0.000009649612
           Qmin:         -23.096548405921
Quadratic minimum step length (  0.457441041595) accepted
    Initial Ne1:       9.00000006
    Initial Ne2:       8.00000015
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -2.309654545769E+01     3.3826E-04     2.1184E-04    -2.7300E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704189151787 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619247924609 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323437076397 Ha.
      ideal mu1:      -0.297607815417
      ideal mu2:      -0.335549087884
    5        -2.309654840699E+01     1.4312E-04     8.9264E-05    -2.9493E-06
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30965484069890E+01  Eh
     Estimated bandgap (UP spin) =   7.7283E-02  Eh
     Estimated bandgap (DN spin) =   3.3000E-01  Eh
     RMS occupancy error         =   8.2078E-10
     [H,K] commutator            =   8.9264E-05
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       6 [3]
  + B:       4 [1]
  + B:       5 [2]
HFx: Communicating NGWF gradient kets.
  * C:       1 [3]
  * C:       1 [2]
  * C:       1 [1]
  * C:       1 [0]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [0]
  * C:       3 [2]
  * C:       4 [2]
  * C:       4 [0]
  * C:       3 [1]
  * C:       5 [3]
  * C:       4 [1]
  * C:       5 [2]
  * C:       5 [1]
  * C:       6 [1]
  * C:       6 [3]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.77 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.704189151787 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619247924609 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.323437076397 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.2554E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.85481762E-01     0.26822732E-01
               2       0.45261272E-02     0.15218698E-02
               3       0.16450807E-04     0.58168876E-05
               4       0.22680614E-09     0.80442764E-10
               5       0.24465000E-14     0.11102230E-14
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       4 [2] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  - B:       2 [1] (2)
  + B:       6 [3]
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.701802216961 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618954639089 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.320756856050 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.64987324E-02     0.19547061E-02
               2       0.26465652E-04     0.89220296E-05
               3       0.57772260E-09     0.20389068E-09
               4       0.22178941E-14     0.88817842E-15
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00012554375423
Trial step length           =               1.340763
Gradient along search dir.  =         -0.00283491069
Functional at step 0        =     -23.09654840698895
Functional at step 1        =     -23.09856722327262
Functional predicted        =     -23.09857508207273
Selected quadratic step     =               1.429798
Conjugate gradients coeff.  =               0.863076
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       9.00317080
   Initial electron number for spin 2:       8.00003295
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001535 (step -0.4983 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000011 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.701636421173 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618934212760 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.320570633933 Ha.
      ideal mu1:      -0.301763012674
      ideal mu2:      -0.339980950271
             Q0:         -23.098574293288
             G0:      -0.000264081546
   RMS gradient:       0.001532119943
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.701372167256 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618813387634 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.320185554890 Ha.
     Trial step:       0.585186486476
             Q1:         -23.098645445953
 Quadratic coef:       0.000083384287
 Linear coef   :      -0.000154536952
           Qmin:         -23.098645894517
Quadratic minimum step length (  0.542266051523) accepted
    Initial Ne1:       8.99999998
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -2.309857429329E+01     1.5321E-03     9.5258E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.701391735108 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618822434245 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.320214169353 Ha.
      ideal mu1:      -0.302474275945
      ideal mu2:      -0.340733753188
             Q0:         -23.098645899914
             G0:      -0.000069510353
   RMS gradient:       0.000786058349
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.701175657792 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618785624834 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.319961282627 Ha.
     Trial step:       0.563317641678
             Q1:         -23.098673583655
 Quadratic coef:       0.000011472667
 Linear coef   :      -0.000039156408
           Qmin:         -23.098679310287
Quadratic minimum step length (  0.961306371887) accepted
    Initial Ne1:       8.99999998
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000021 (step -0.4999 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    2        -2.309864589991E+01     7.8606E-04     4.7848E-04    -7.1607E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       5 [3]
  + B:       4 [2]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       5 [2]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.701022747495 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618759486578 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.319782234073 Ha.
      ideal mu1:      -0.302927735221
      ideal mu2:      -0.341240201480
             Q0:         -23.098679301320
             G0:      -0.000080699007
   RMS gradient:       0.000847258261
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.700757284372 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618918722172 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.319676006545 Ha.
     Trial step:       0.735880994687
             Q1:         -23.098713869536
 Quadratic coef:       0.000024816649
 Linear coef   :      -0.000059384865
           Qmin:         -23.098714827493
Quadratic minimum step length (  0.880461226698) accepted
    Initial Ne1:       8.99999998
    Initial Ne2:       8.00000002
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000071 (step -0.4996 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    3        -2.309867930132E+01     8.4726E-04     5.2736E-04    -3.3401E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.700705212478 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618949996511 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.319655208989 Ha.
      ideal mu1:      -0.303245152282
      ideal mu2:      -0.341622668641
             Q0:         -23.098714866257
             G0:      -0.000016421031
   RMS gradient:       0.000381857862
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.700566657853 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618957821313 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.319524479166 Ha.
     Trial step:       0.804931477385
             Q1:         -23.098719252200
 Quadratic coef:       0.000008831862
 Linear coef   :      -0.000013217804
           Qmin:         -23.098719811714
Quadratic minimum step length (  0.602332033944) accepted
    Initial Ne1:       9.00000009
    Initial Ne2:       8.00000025
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000016 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -2.309871486626E+01     3.8186E-04     2.3884E-04    -3.5565E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.700601589745 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618955924337 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.319557514082 Ha.
      ideal mu1:      -0.303450847966
      ideal mu2:      -0.341852282239
    5        -2.309871981422E+01     1.2461E-04     7.8094E-05    -4.9480E-06
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30987198142178E+01  Eh
     Estimated bandgap (UP spin) =   7.2925E-02  Eh
     Estimated bandgap (DN spin) =   3.2529E-01  Eh
     RMS occupancy error         =   2.7330E-09
     [H,K] commutator            =   7.8094E-05
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       2 [1]
  + B:       1 [0]
  + B:       5 [3]
  + B:       4 [2]
  + B:       2 [0]
  + B:       3 [1]
  + B:       6 [3]
  + B:       5 [2]
  + B:       4 [1]
HFx: Communicating NGWF gradient kets.
  * C:       1 [2]
  * C:       1 [0]
  * C:       1 [3]
  * C:       1 [1]
  * C:       2 [3]
  * C:       2 [2]
  * C:       2 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       4 [3]
  * C:       3 [0]
  * C:       3 [2]
  * C:       4 [2]
  * C:       4 [0]
  * C:       3 [1]
  * C:       5 [3]
  * C:       4 [1]
  * C:       5 [2]
  * C:       5 [1]
  * C:       6 [1]
  * C:       6 [3]
  * C:       5 [0]
  * C:       6 [2]
  * C:       6 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.76 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.700601589745 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618955924337 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.319557514082 Ha.
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.7043E-05 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.95041358E-01     0.29064366E-01
               2       0.57901187E-02     0.18963136E-02
               3       0.27550717E-04     0.94634488E-05
               4       0.64282562E-09     0.22144442E-09
               5       0.16007244E-14     0.44408921E-15
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       4 [2] (1)
  - B:       5 [3] (1)
  - B:       2 [1] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.74 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698791105743 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619001688870 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317792794613 Ha.
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-2].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        11 |       2 |       6 |       8 |        71 |        71 |
|       1 |        10 |       3 |       6 |       9 |        43 |        43 |
|       2 |         6 |       2 |       6 |       8 |        60 |        60 |
|       3 |         9 |       2 |       6 |       8 |        51 |        51 |
+---------------------------------------------------------------------------+
|     min |         6 |       2 |       6 |       8 |        43 |        43 |
|     max |        11 |       3 |       6 |       9 |        71 |        71 |
| average |       9.0 |     2.2 |     6.0 |     8.2 |      56.2 |      56.2 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16684716E-01     0.49539516E-02
               2       0.17959457E-03     0.58570245E-04
               3       0.27009209E-07     0.92080394E-08
               4       0.25153074E-14     0.11657342E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00009704296447
Trial step length           =               1.384565
Gradient along search dir.  =         -0.00172883726
Functional at step 0        =     -23.09871981421776
Functional at step 1        =     -23.09968373945665
Functional predicted        =     -23.09972168360271
Selected quadratic step     =               1.159009
Conjugate gradients coeff.  =               0.597500
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:       9.00384736
   Initial electron number for spin 2:       7.99976168
     Final electron number for spin 1:       9.00000000
     Final electron number for spin 2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001442 (step -0.4977 Ne1=      9.0000)
                                                               Ne2=      8.0000
 RMS occupancy error at iteration   2:  0.000010 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  - B:       1 [0] (1)
  - B:       4 [2] (1)
  - B:       5 [3] (1)
  - B:       2 [1] (1)
  - B:       3 [1] (1)
  - B:       2 [0] (1)
  - B:       4 [1] (1)
  - B:       5 [2] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  + B:       5 [3]
  + B:       6 [3]
  - B:       2 [1] (2)
  - B:       3 [1] (2)
  - B:       4 [1] (2)
  + B:       2 [1]
  + B:       3 [1]
  + B:       4 [1]
  - B:       4 [2] (2)
  - B:       5 [2] (2)
  + B:       4 [2]
  + B:       5 [2]
  - B:       1 [0] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       2 [0]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.699094743498 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618998423097 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.318093166595 Ha.
      ideal mu1:      -0.305830435464
      ideal mu2:      -0.344445723930
             Q0:         -23.099706033163
             G0:      -0.000159766147
   RMS gradient:       0.001191697752
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698895605331 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618907206891 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317802812221 Ha.
     Trial step:       0.696301668790
             Q1:         -23.099742926297
 Quadratic coef:       0.000074352301
 Linear coef   :      -0.000111245435
           Qmin:         -23.099747644339
Quadratic minimum step length (  0.520901038445) accepted
    Initial Ne1:       8.99999998
    Initial Ne2:       8.00000000
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -2.309970603316E+01     1.1917E-03     7.4243E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       6 [3]
  + B:       4 [1]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698946257739 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618930670415 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317876928154 Ha.
      ideal mu1:      -0.306268943622
      ideal mu2:      -0.344926410369
             Q0:         -23.099747645993
             G0:      -0.000036708758
   RMS gradient:       0.000571212070
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698774462075 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618895501039 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317669963114 Ha.
     Trial step:       0.602249335694
             Q1:         -23.099763499727
 Quadratic coef:       0.000006254091
 Linear coef   :      -0.000022107825
           Qmin:         -23.099767183443
Quadratic minimum step length (  1.064457142361) accepted
    Initial Ne1:       8.99999999
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000013 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -2.309974764599E+01     5.7121E-04     3.4657E-04    -4.1613E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698642445054 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618868379990 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317510825044 Ha.
      ideal mu1:      -0.306678567116
      ideal mu2:      -0.345381817940
             Q0:         -23.099767176203
             G0:      -0.000043854922
   RMS gradient:       0.000624626996
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698416932419 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618983412331 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317400344751 Ha.
     Trial step:       0.800667600732
             Q1:         -23.099786305918
 Quadratic coef:       0.000015983500
 Linear coef   :      -0.000035113215
           Qmin:         -23.099786460744
Quadratic minimum step length (  0.879469894432) accepted
    Initial Ne1:       8.99999993
    Initial Ne2:       7.99999999
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000040 (step -0.4998 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    3        -2.309976717620E+01     6.2463E-04     3.8879E-04    -1.9530E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698394767618 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.618994723081 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317389490698 Ha.
      ideal mu1:      -0.307006288549
      ideal mu2:      -0.345762076240
             Q0:         -23.099786472486
             G0:      -0.000009044069
   RMS gradient:       0.000283483871
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698302891753 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619018519126 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317321410879 Ha.
     Trial step:       0.839144236881
             Q1:         -23.099789496083
 Quadratic coef:       0.000004565681
 Linear coef   :      -0.000007589278
           Qmin:         -23.099789626295
Quadratic minimum step length (  0.697431409760) accepted
    Initial Ne1:       9.00000002
    Initial Ne2:       8.00000008
      Final Ne1:       9.00000000
      Final Ne2:       8.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=      9.0000)
                                                               Ne2=      8.0000
            Final RMS occupancy error   :  0.000000 (Ne1=      9.0000)
                                                     Ne2=      8.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -2.309978647249E+01     2.8348E-04     1.7728E-04    -1.9296E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       5 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       5 [2]
  + B:       4 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698318435038 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619014534090 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317332969128 Ha.
      ideal mu1:      -0.307136281706
      ideal mu2:      -0.345916844545
    5        -2.309978962723E+01     1.0720E-04     6.7551E-05    -3.1547E-06
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30997896272344E+01  Eh
     Estimated bandgap (UP spin) =   6.1695E-02  Eh
     Estimated bandgap (DN spin) =   3.1683E-01  Eh
     RMS occupancy error         =   1.1801E-09
     [H,K] commutator            =   6.7551E-05
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       17.07639047713655 |
           | Pseudopotential (local)    :      -96.04638599993439 |
           | Pseudo (non-coul chg cor)  :       -0.00006982257377
           | Pseudopotential (non-local):        2.93885113746486 |
           | Hartree                    :       40.38357549928374 |
           | Exchange-correlation       :       -5.90376923824120 |
           | Hartree-Fock exchange      :       -1.31733296912760 |
           | Ewald                      :       19.76888146618368 |
           | Total                      :      -23.09978962723435 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -96.04638599993373 |
           | Hartree                    :       40.38357549928348 |
           --------------------------------------------------------
           Integrated density           :       16.99999999999999
           Integrated spin density      :        0.99999999999996
           Integrated |spin density|    :        1.02959080467366
           Local density approx. <S^2>  :        0.76479540233683
           Integrated density tr(KS)    :       17.00000000000000
           Integrated spin tr(KS)       :        1.00000000000000
================================================================================

WARNING: maximum number of NGWF CG iterations (   8) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00189025373971    -22.68515525813359   1.055356    -23.01022333104306        
   1     0.00077028728793    -23.01142520800888   1.064516    -23.06578061471967        
   2     0.00038514484684    -23.06721890963937   1.232864    -23.08342323364944        
   3     0.00024660480069    -23.08388285328014   1.287562    -23.09081778538814        
   4     0.00017321211920    -23.09099995477340   1.031143    -23.09366687778254        
   5     0.00013513589295    -23.09369169619956   1.719129    -23.09641783194773        
   6     0.00012554375423    -23.09654840698895   1.429798    -23.09857508207273        
   7     0.00009704296447    -23.09978962723436  <-- CG                                 
 
<QC>        [NGWF iterations]:                      8
<QC>           [total_energy]:       -23.099789627234
<QC>           [rms_gradient]:         0.000097042964
DMA: Performing SW expansion of NGWF pairs (multipole orders 0-2, 9 Bessels) for 6 atoms... 
SWX: val%[properties_dma_swex-1]: Fitting local NGWF pairs (V).
  - B:            1
  - B:            5
  - B:            3
  - B:            6
  - B:            4
  - B:            2
  / A:            1
  / A:            5
  / A:            6
  / A:            3
  / A:            2
  / A:            4
... done.
DMA: Performing SW expansion of NGWF pairs (multipole orders 0-2, 8 Bessels) for 6 atoms... 
SWX: val%[properties_dma_swex-2]: Fitting local NGWF pairs (V).
  - B:            1
  - B:            3
  - B:            5
  - B:            6
  - B:            4
  - B:            2
  / A:            1
  / A:            3
  / A:            5
  / A:            6
  / A:            2
  / A:            4
... done.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel AB normalised to        8.000 electrons (spin 2).
HFx: Density kernel CD normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 2).
  + B:       4 [2]
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       2 [0]
  + B:       3 [1]
  + B:       4 [1]
  + B:       5 [2]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.75 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.698318434733 Ha.
HFx: Hartree-Fock exchange energy (spin 2):     -0.619014534078 Ha.
HFx: Hartree-Fock exchange energy (total):      -1.317332968811 Ha.
<QC>      [atom_1_population]:         3.936729606006
<QC>          [atom_1_charge]:         0.063270393994
<QC>            [atom_1_spin]:         0.178158567649
<QC>      [atom_2_population]:         4.785072986025
<QC>          [atom_2_charge]:        -0.785072986025
<QC>            [atom_2_spin]:         0.006723098007
<QC>      [atom_3_population]:         0.879664675023
<QC>          [atom_3_charge]:         0.120335324977
<QC>            [atom_3_spin]:         0.092902695894

    Mulliken Atomic Populations
    ---------------------------
Species  Ion    Total   Charge (e)    Spin (hbar)
=================================================
  C      1       3.937      0.063      0.18
  C      2       4.785     -0.785      0.01
  H      3       0.880      0.120      0.09
  H      4       0.801      0.199      0.02
  H      5       0.800      0.200      0.02
  N      6       5.798     -0.798      0.17
=================================================

        Bond         Population      Spin       Length (bohr)
=============================================================
 C     2 -- H     3        0.48     -0.15      2.07477
 C     2 -- H     4        0.70     -0.04      2.07478
 C     2 -- H     5        0.71     -0.04      2.07478
 C     1 -- N     6        1.24     -0.21      2.18275
 C     1 -- C     2        0.99      0.11      2.75852
 H     3 -- H     4       -0.27     -0.09      3.36381
 H     3 -- H     5       -0.27     -0.09      3.36381
 H     4 -- H     5        0.00      0.05      3.36387
 C     1 -- H     3       -0.26     -0.08      3.99263
 C     1 -- H     4       -0.15     -0.02      3.99271
 C     1 -- H     5       -0.15     -0.02      3.99271
 C     2 -- N     6       -0.09     -0.01      4.94126
=============================================================


============== Orbital energy and occupancy information for spin 1 =============

      Total number of orbitals:      15
   Number of occupied orbitals:       9.000000000
   Occupancy sum (eigenvalues):       9.000000000
                 HOMO-LUMO gap:       0.061695331 Eh
                 Mid-gap level:       0.142890516 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.726979836   1.0000000
                            2    -0.618856123   1.0000000
                            3    -0.360793686   0.9999999
                            4    -0.318765329   1.0000000
                            5    -0.317291194   1.0000000
                            6    -0.197962972   0.9999997
                            7    -0.174313017   1.0000000
                            8    -0.161307525   1.0000000
                            9     0.112042851   0.9999996
                        .......   --- gap ---   .........
                           10     0.173738182   0.0000006
                           11     0.182260976   0.0000000
                           12     0.262553892   0.0000002
                           13     0.279194788   0.0000000
                           14     0.349631369   0.0000000
                           15     0.703264775   0.0000000
 
<QC>    [energy_eigenvalue_1]:        -0.726979836226
<QC>    [energy_eigenvalue_n]:         0.703264774721
<QC>            [occupancy_1]:         0.999999970893
<QC>            [occupancy_n]:         0.000000025890

================================================================================

============== Orbital energy and occupancy information for spin 2 =============

      Total number of orbitals:      15
   Number of occupied orbitals:       8.000000000
   Occupancy sum (eigenvalues):       8.000000000
                 HOMO-LUMO gap:       0.316831078 Eh
                 Mid-gap level:       0.022600513 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.713901824   1.0000000
                            2    -0.611828226   1.0000000
                            3    -0.347472758   0.9999999
                            4    -0.315239205   1.0000000
                            5    -0.302384599   1.0000000
                            6    -0.185273839   0.9999996
                            7    -0.155419609   1.0000000
                            8    -0.135815026   0.9999998
                        .......   --- gap ---   .........
                            9     0.181016052   0.0000004
                           10     0.190213963   0.0000000
                           11     0.201524177   0.0000002
                           12     0.284133042   0.0000000
                           13     0.294321585   0.0000001
                           14     0.361521180   0.0000000
                           15     0.712293306   0.0000000
 
<QC>    [energy_eigenvalue_1]:        -0.713901824094
<QC>    [energy_eigenvalue_n]:         0.712293306128
<QC>            [occupancy_1]:         0.999999974430
<QC>            [occupancy_n]:         0.000000032746

================================================================================

===================== Writing canonical molecular orbitals =====================
    Spin 1
| Orbital  Energy (eV)  Norm     |
| HOMO-5   -8.67404597  1.000000 | 
| HOMO-4   -8.63393271  1.000000 | 
| HOMO-3   -5.38684657  1.000000 | 
| HOMO-2   -4.74329856  1.000000 | 
| HOMO-1   -4.38940110  1.000000 | 
| HOMO      3.04884110  1.000000 | 
| LUMO      4.72765649  1.000000 | 
| LUMO+1    4.95957353  1.000000 | 
| LUMO+2    7.14445493  1.000000 | 
| LUMO+3    7.59727676  1.000000 | 
| LUMO+4    9.51395365  1.000000 | 
| LUMO+5   19.13680827  1.000000 | 
================================================================================

===================== Writing canonical molecular orbitals =====================
    Spin 2
| Orbital  Energy (eV)  Norm     |
| HOMO-5   -9.45521486  1.000000 | 
| HOMO-4   -8.57809526  1.000000 | 
| HOMO-3   -8.22830363  1.000000 | 
| HOMO-2   -5.04155769  1.000000 | 
| HOMO-1   -4.22918277  1.000000 | 
| HOMO     -3.69571491  1.000000 | 
| LUMO      4.92569741  1.000000 | 
| LUMO+1    5.17598531  1.000000 | 
| LUMO+2    5.48375188  1.000000 | 
| LUMO+3    7.73165348  1.000000 | 
| LUMO+4    8.00889785  1.000000 | 
| LUMO+5    9.83749186  1.000000 | 
================================================================================
 
=============== Density of States (DOS) calculation for UP spin ================
Writing "acetonitrile_anion_dma_and_hfx_UP_DOS.txt" ...  done
================================================================================
 
============== Density of States (DOS) calculation for DOWN spin ===============
Writing "acetonitrile_anion_dma_and_hfx_DN_DOS.txt" ...  done
================================================================================
 
Writing bands to file "acetonitrile_anion_dma_and_hfx.val_bands" ... done

DMA: Using SWRI [for_hfx_and_dma] and SWEX [properties_dma_swex-1] to generate multipoles
DMA: (mode P, multipole orders 0-2, 9 Bessels) for 6 atoms: properties_dma
DMA: total charge contribution from the monopoles:    16.995352
DMA: expected charge:                                 17.000000
DMA: charge scaling factor:                            1.000273
<QC>           [DMA_mp_1_0_0]:         3.379208021277
<QC>          [DMA_mp_1_1_m1]:         1.323465529805
<QC>           [DMA_mp_1_1_1]:        -0.002403274661
<QC>          [DMA_mp_1_2_m2]:        -0.018088340904
<QC>           [DMA_mp_1_2_0]:        -0.902866378596
<QC>           [DMA_mp_1_2_1]:        -0.007795199330
<QC>           [DMA_mp_1_2_2]:        -0.277597519184
<QC>             [DMA_mp_1_0]:        -3.379208021277
<QC>           [DMA_mp_1_1_x]:       -47.311315572541
<QC>           [DMA_mp_1_1_y]:       -47.788318553755
<QC>           [DMA_mp_1_1_z]:       -47.308897032836
<QC>          [DMA_mp_1_2_xx]:         6.207994652920
<QC>          [DMA_mp_1_2_xy]:     -1003.591416723153
<QC>          [DMA_mp_1_2_xz]:      -993.530555616785
<QC>          [DMA_mp_1_2_yy]:       -13.631461037716
<QC>          [DMA_mp_1_2_yz]:     -1003.554065982227
<QC>          [DMA_mp_1_2_zz]:         7.423466384796
<QC>           [DMA_mp_2_0_0]:         0.843625357321
<QC>          [DMA_mp_2_1_m1]:        -1.021495392230
<QC>           [DMA_mp_2_1_0]:        -0.006895924610
<QC>           [DMA_mp_2_1_1]:        -0.562913394789
<QC>          [DMA_mp_2_2_m2]:        -0.277363230899
<QC>          [DMA_mp_2_2_m1]:        -0.003321014603
<QC>           [DMA_mp_2_2_0]:        -0.487533446824
<QC>           [DMA_mp_2_2_1]:        -0.005007416378
<QC>           [DMA_mp_2_2_2]:        -0.001848119721
<QC>             [DMA_mp_2_0]:        -0.843625357321
<QC>           [DMA_mp_2_1_x]:       -12.373516949657
<QC>           [DMA_mp_2_1_y]:       -10.955186885191
<QC>           [DMA_mp_2_1_z]:       -11.817650927103
<QC>          [DMA_mp_2_2_xx]:       -28.065303148958
<QC>          [DMA_mp_2_2_xy]:      -239.758231720792
<QC>          [DMA_mp_2_2_xz]:      -259.984331952897
<QC>          [DMA_mp_2_2_yy]:        32.054836820896
<QC>          [DMA_mp_2_2_yz]:      -230.177847810127
<QC>          [DMA_mp_2_2_zz]:        -3.989533671938
<QC>           [DMA_mp_3_0_0]:         1.630560724082
<QC>          [DMA_mp_3_1_m1]:         0.022159164986
<QC>           [DMA_mp_3_1_1]:         0.660475833618
<QC>          [DMA_mp_3_2_m2]:        -0.677813880875
<QC>          [DMA_mp_3_2_m1]:         0.001937132547
<QC>           [DMA_mp_3_2_0]:        -0.487480274207
<QC>           [DMA_mp_3_2_1]:         0.001424885700
<QC>           [DMA_mp_3_2_2]:         0.692620301070
<QC>             [DMA_mp_3_0]:        -1.630560724082
<QC>           [DMA_mp_3_1_x]:       -25.333766907840
<QC>           [DMA_mp_3_1_y]:       -17.987304020885
<QC>           [DMA_mp_3_1_z]:       -22.828064233904
<QC>          [DMA_mp_3_2_xx]:      -135.172787783356
<QC>          [DMA_mp_3_2_xy]:      -418.598425588143
<QC>          [DMA_mp_3_2_xz]:      -532.015458716799
<QC>          [DMA_mp_3_2_yy]:       158.399512008095
<QC>          [DMA_mp_3_2_yz]:      -377.738609076820
<QC>          [DMA_mp_3_2_zz]:       -23.226724224739
<QC>           [DMA_mp_4_0_0]:         2.259722474339
<QC>          [DMA_mp_4_1_m1]:        -0.460651676111
<QC>           [DMA_mp_4_1_0]:         1.285915320884
<QC>           [DMA_mp_4_1_1]:        -0.765170648192
<QC>          [DMA_mp_4_2_m2]:         0.550714596530
<QC>          [DMA_mp_4_2_m1]:        -0.657791704898
<QC>           [DMA_mp_4_2_0]:         0.767433156782
<QC>           [DMA_mp_4_2_1]:        -0.866156237346
<QC>           [DMA_mp_4_2_2]:         0.092348929916
<QC>             [DMA_mp_4_0]:        -2.259722474339
<QC>           [DMA_mp_4_1_x]:       -30.206594576790
<QC>           [DMA_mp_4_1_y]:       -25.419342062154
<QC>           [DMA_mp_4_1_z]:       -34.150904283911
<QC>          [DMA_mp_4_2_xx]:        -2.604648837837
<QC>          [DMA_mp_4_2_xy]:      -509.928397548634
<QC>          [DMA_mp_4_2_xz]:      -684.665779478069
<QC>          [DMA_mp_4_2_yy]:       174.073962079818
<QC>          [DMA_mp_4_2_yz]:      -576.062568151053
<QC>          [DMA_mp_4_2_zz]:      -171.469313241981
<QC>           [DMA_mp_5_0_0]:         2.268648587577
<QC>          [DMA_mp_5_1_m1]:        -0.467714866820
<QC>           [DMA_mp_5_1_0]:        -1.296513805864
<QC>           [DMA_mp_5_1_1]:        -0.771048774468
<QC>          [DMA_mp_5_2_m2]:         0.550292430984
<QC>          [DMA_mp_5_2_m1]:         0.660985900835
<QC>           [DMA_mp_5_2_0]:         0.769032507208
<QC>           [DMA_mp_5_2_1]:         0.870766573465
<QC>           [DMA_mp_5_2_2]:         0.093104406157
<QC>             [DMA_mp_5_0]:        -2.268648587577
<QC>           [DMA_mp_5_1_x]:       -30.328769056648
<QC>           [DMA_mp_5_1_y]:       -25.524994393427
<QC>           [DMA_mp_5_1_z]:       -29.241875930989
<QC>          [DMA_mp_5_2_xx]:       -73.256756065876
<QC>          [DMA_mp_5_2_xy]:      -512.090199273813
<QC>          [DMA_mp_5_2_xz]:      -586.479743273859
<QC>          [DMA_mp_5_2_yy]:       104.058298391607
<QC>          [DMA_mp_5_2_yz]:      -493.680304026819
<QC>          [DMA_mp_5_2_zz]:       -30.801542325731
<QC>           [DMA_mp_6_0_0]:         6.618234835403
<QC>          [DMA_mp_6_1_m1]:         0.907534790488
<QC>           [DMA_mp_6_1_1]:        -0.001260951840
<QC>          [DMA_mp_6_2_m2]:         0.003112835456
<QC>           [DMA_mp_6_2_0]:        -1.060815596377
<QC>           [DMA_mp_6_2_1]:        -0.005691642213
<QC>           [DMA_mp_6_2_2]:        -0.889400248897
<QC>             [DMA_mp_6_0]:        -6.618234835403
<QC>           [DMA_mp_6_1_x]:       -92.658074481526
<QC>           [DMA_mp_6_1_y]:      -109.724645522084
<QC>           [DMA_mp_6_1_z]:       -92.655343157976
<QC>          [DMA_mp_6_2_xx]:       261.083503479346
<QC>          [DMA_mp_6_2_xy]:     -2304.289814895257
<QC>          [DMA_mp_6_2_xz]:     -1945.815799733453
<QC>          [DMA_mp_6_2_yy]:      -523.102704132486
<QC>          [DMA_mp_6_2_yz]:     -2304.218976223895
<QC>          [DMA_mp_6_2_zz]:       262.019200653141

DMA: Using SWRI [for_hfx_and_dma] and SWEX [properties_dma_swex-2] to generate multipoles
DMA: (mode P, multipole orders 0-2, 8 Bessels) for 6 atoms: properties_dma
DMA: total charge contribution from the monopoles:    17.000519
DMA: expected charge:                                 17.000000
DMA: charge scaling factor:                            0.999969
<QC>           [DMA_mp_1_0_0]:         3.989569521806
<QC>          [DMA_mp_1_1_m1]:         1.328232506609
<QC>           [DMA_mp_1_1_1]:         0.002156895881
<QC>          [DMA_mp_1_2_m2]:        -0.005037760925
<QC>           [DMA_mp_1_2_0]:        -0.858384113268
<QC>           [DMA_mp_1_2_1]:        -0.005817053384
<QC>           [DMA_mp_1_2_2]:        -0.544594733190
<QC>             [DMA_mp_1_0]:        -3.989569521806
<QC>           [DMA_mp_1_1_x]:       -55.851816409404
<QC>           [DMA_mp_1_1_y]:       -56.654252060067
<QC>           [DMA_mp_1_1_z]:       -55.853862365092
<QC>          [DMA_mp_1_2_xx]:        11.164346619221
<QC>          [DMA_mp_1_2_xy]:     -1189.687909501467
<QC>          [DMA_mp_1_2_xz]:     -1172.880777137417
<QC>          [DMA_mp_1_2_yy]:       -23.058706395728
<QC>          [DMA_mp_1_2_yz]:     -1189.736820043150
<QC>          [DMA_mp_1_2_zz]:        11.894359776507
<QC>           [DMA_mp_2_0_0]:         3.234831946310
<QC>          [DMA_mp_2_1_m1]:        -0.032372511431
<QC>           [DMA_mp_2_1_0]:        -0.002216082853
<QC>           [DMA_mp_2_1_1]:        -0.079066654762
<QC>          [DMA_mp_2_2_m2]:        -0.148760396837
<QC>          [DMA_mp_2_2_m1]:        -0.002562990268
<QC>           [DMA_mp_2_2_0]:        -0.670403290746
<QC>           [DMA_mp_2_2_1]:        -0.010880963764
<QC>           [DMA_mp_2_2_2]:         0.508110826416
<QC>             [DMA_mp_2_0]:        -3.234831946310
<QC>           [DMA_mp_2_1_x]:       -45.366133186071
<QC>           [DMA_mp_2_1_y]:       -38.122529839402
<QC>           [DMA_mp_2_1_z]:       -45.289863331193
<QC>          [DMA_mp_2_2_xx]:       -95.318268672321
<QC>          [DMA_mp_2_2_xy]:      -801.830545908779
<QC>          [DMA_mp_2_2_xz]:      -952.725910859624
<QC>          [DMA_mp_2_2_yy]:       185.987604045780
<QC>          [DMA_mp_2_2_yz]:      -800.610048587620
<QC>          [DMA_mp_2_2_zz]:       -90.669335373459
<QC>           [DMA_mp_3_0_0]:         1.137988474898
<QC>          [DMA_mp_3_1_m1]:         0.339554196142
<QC>           [DMA_mp_3_1_0]:        -0.001603513192
<QC>           [DMA_mp_3_1_1]:        -0.034891807316
<QC>          [DMA_mp_3_2_m2]:        -0.164951433647
<QC>          [DMA_mp_3_2_m1]:         0.002755571809
<QC>           [DMA_mp_3_2_0]:        -0.067923911032
<QC>           [DMA_mp_3_2_2]:         0.218688117225
<QC>             [DMA_mp_3_0]:        -1.137988474898
<QC>           [DMA_mp_3_1_x]:       -18.176594975186
<QC>           [DMA_mp_3_1_y]:       -12.229472668013
<QC>           [DMA_mp_3_1_z]:       -15.933442161765
<QC>          [DMA_mp_3_2_xx]:      -113.342025005497
<QC>          [DMA_mp_3_2_xy]:      -292.876836568451
<QC>          [DMA_mp_3_2_xz]:      -381.746222974301
<QC>          [DMA_mp_3_2_yy]:       125.540069326394
<QC>          [DMA_mp_3_2_yz]:      -256.847878510245
<QC>          [DMA_mp_3_2_zz]:       -12.198044320897
<QC>           [DMA_mp_4_0_0]:         1.170462770016
<QC>          [DMA_mp_4_1_m1]:         0.110437187042
<QC>           [DMA_mp_4_1_0]:        -0.098798425548
<QC>           [DMA_mp_4_1_1]:        -0.083242758824
<QC>          [DMA_mp_4_2_m2]:         0.117703118370
<QC>          [DMA_mp_4_2_m1]:         0.209590026399
<QC>           [DMA_mp_4_2_0]:        -0.189164150778
<QC>           [DMA_mp_4_2_1]:         0.186584570917
<QC>           [DMA_mp_4_2_2]:         0.016181366774
<QC>             [DMA_mp_4_0]:        -1.170462770016
<QC>           [DMA_mp_4_1_x]:       -15.332943107427
<QC>           [DMA_mp_4_1_y]:       -12.817352936281
<QC>           [DMA_mp_4_1_z]:       -18.453918802579
<QC>          [DMA_mp_4_2_xx]:        14.682677138728
<QC>          [DMA_mp_4_2_xy]:      -251.972742801439
<QC>          [DMA_mp_4_2_xz]:      -362.767733158913
<QC>          [DMA_mp_4_2_yy]:       105.469517873563
<QC>          [DMA_mp_4_2_yz]:      -303.319688745224
<QC>          [DMA_mp_4_2_zz]:      -120.152195012291
<QC>           [DMA_mp_5_0_0]:         1.171941103640
<QC>          [DMA_mp_5_1_m1]:         0.106810161074
<QC>           [DMA_mp_5_1_0]:         0.097277333690
<QC>           [DMA_mp_5_1_1]:        -0.082299874056
<QC>          [DMA_mp_5_2_m2]:         0.113365702514
<QC>          [DMA_mp_5_2_m1]:        -0.211558613928
<QC>           [DMA_mp_5_2_0]:        -0.192619683038
<QC>           [DMA_mp_5_2_1]:        -0.191613563095
<QC>           [DMA_mp_5_2_2]:         0.014475309425
<QC>             [DMA_mp_5_0]:        -1.171941103640
<QC>           [DMA_mp_5_1_x]:       -15.351261104216
<QC>           [DMA_mp_5_1_y]:       -12.837308193538
<QC>           [DMA_mp_5_1_z]:       -14.338770060282
<QC>          [DMA_mp_5_2_xx]:       -43.171142609975
<QC>          [DMA_mp_5_2_xy]:      -252.343354155434
<QC>          [DMA_mp_5_2_xz]:      -281.579712500883
<QC>          [DMA_mp_5_2_yy]:        47.561607531073
<QC>          [DMA_mp_5_2_yz]:      -235.401345729258
<QC>          [DMA_mp_5_2_zz]:        -4.390464921097
<QC>           [DMA_mp_6_0_0]:         6.295206183330
<QC>          [DMA_mp_6_1_m1]:         0.504563193070
<QC>          [DMA_mp_6_2_m2]:         0.002171193993
<QC>           [DMA_mp_6_2_0]:        -0.606614390453
<QC>           [DMA_mp_6_2_1]:        -0.003234230260
<QC>           [DMA_mp_6_2_2]:        -0.532038086691
<QC>             [DMA_mp_6_0]:        -6.295206183330
<QC>           [DMA_mp_6_1_x]:       -88.135208006426
<QC>           [DMA_mp_6_1_y]:      -104.727783935720
<QC>           [DMA_mp_6_1_z]:       -88.132918574908
<QC>          [DMA_mp_6_2_xx]:       254.274283085531
<QC>          [DMA_mp_6_2_xy]:     -2199.343377179929
<QC>          [DMA_mp_6_2_xz]:     -1850.837239394437
<QC>          [DMA_mp_6_2_yy]:      -509.093886485358
<QC>          [DMA_mp_6_2_yz]:     -2199.284327952370
<QC>          [DMA_mp_6_2_zz]:       254.819603399827
<QC>           [DMA_mp_1_0_0]:         3.684388771542
<QC>          [DMA_mp_1_1_m1]:         1.325849018207
<QC>          [DMA_mp_1_2_m2]:        -0.011563050915
<QC>           [DMA_mp_1_2_0]:        -0.880625245932
<QC>           [DMA_mp_1_2_1]:        -0.006806126357
<QC>           [DMA_mp_1_2_2]:        -0.411096126187
<QC>             [DMA_mp_1_0]:        -3.684388771542
<QC>           [DMA_mp_1_1_x]:       -51.581565990972
<QC>           [DMA_mp_1_1_y]:       -52.221285306911
<QC>           [DMA_mp_1_1_z]:       -51.581379698964
<QC>          [DMA_mp_1_2_xx]:         8.686170636070
<QC>          [DMA_mp_1_2_xy]:     -1096.639663112310
<QC>          [DMA_mp_1_2_xz]:     -1083.205666377101
<QC>          [DMA_mp_1_2_yy]:       -18.345083716722
<QC>          [DMA_mp_1_2_yz]:     -1096.645443012688
<QC>          [DMA_mp_1_2_zz]:         9.658913080651
<QC>           [DMA_mp_2_0_0]:         2.039228651815
<QC>          [DMA_mp_2_1_m1]:        -0.526933951831
<QC>           [DMA_mp_2_1_0]:        -0.004556003732
<QC>           [DMA_mp_2_1_1]:        -0.320990024775
<QC>          [DMA_mp_2_2_m2]:        -0.213061813868
<QC>          [DMA_mp_2_2_m1]:        -0.002942002436
<QC>           [DMA_mp_2_2_0]:        -0.578968368785
<QC>           [DMA_mp_2_2_1]:        -0.007944190071
<QC>           [DMA_mp_2_2_2]:         0.253131353348
<QC>             [DMA_mp_2_0]:        -2.039228651815
<QC>           [DMA_mp_2_1_x]:       -28.869825067864
<QC>           [DMA_mp_2_1_y]:       -24.538858362297
<QC>           [DMA_mp_2_1_z]:       -28.553757129148
<QC>          [DMA_mp_2_2_xx]:       -61.691785910640
<QC>          [DMA_mp_2_2_xy]:      -520.794388814786
<QC>          [DMA_mp_2_2_xz]:      -606.355121406261
<QC>          [DMA_mp_2_2_yy]:       109.021220433338
<QC>          [DMA_mp_2_2_yz]:      -515.393948198873
<QC>          [DMA_mp_2_2_zz]:       -47.329434522699
<QC>           [DMA_mp_3_0_0]:         1.384274599490
<QC>          [DMA_mp_3_1_m1]:         0.180856680564
<QC>           [DMA_mp_3_1_1]:         0.312792013151
<QC>          [DMA_mp_3_2_m2]:        -0.421382657261
<QC>          [DMA_mp_3_2_m1]:         0.002346352178
<QC>           [DMA_mp_3_2_0]:        -0.277702092619
<QC>           [DMA_mp_3_2_2]:         0.455654209147
<QC>             [DMA_mp_3_0]:        -1.384274599490
<QC>           [DMA_mp_3_1_x]:       -21.755180941513
<QC>           [DMA_mp_3_1_y]:       -15.108388344449
<QC>           [DMA_mp_3_1_z]:       -19.380753197834
<QC>          [DMA_mp_3_2_xx]:      -124.257406394426
<QC>          [DMA_mp_3_2_xy]:      -355.737631078297
<QC>          [DMA_mp_3_2_xz]:      -456.880840845550
<QC>          [DMA_mp_3_2_yy]:       141.969790667244
<QC>          [DMA_mp_3_2_yz]:      -317.293243793533
<QC>          [DMA_mp_3_2_zz]:       -17.712384272818
<QC>           [DMA_mp_4_0_0]:         1.715092622178
<QC>          [DMA_mp_4_1_m1]:        -0.175107244534
<QC>           [DMA_mp_4_1_0]:         0.593558447668
<QC>           [DMA_mp_4_1_1]:        -0.424206703508
<QC>          [DMA_mp_4_2_m2]:         0.334208857450
<QC>          [DMA_mp_4_2_m1]:        -0.224100839249
<QC>           [DMA_mp_4_2_0]:         0.289134503002
<QC>           [DMA_mp_4_2_1]:        -0.339785833214
<QC>           [DMA_mp_4_2_2]:         0.054265148345
<QC>             [DMA_mp_4_0]:        -1.715092622178
<QC>           [DMA_mp_4_1_x]:       -22.769768842108
<QC>           [DMA_mp_4_1_y]:       -19.118347499217
<QC>           [DMA_mp_4_1_z]:       -26.302411543245
<QC>          [DMA_mp_4_2_xx]:         6.039014150446
<QC>          [DMA_mp_4_2_xy]:      -380.950570175036
<QC>          [DMA_mp_4_2_xz]:      -523.716756318491
<QC>          [DMA_mp_4_2_yy]:       139.771739976690
<QC>          [DMA_mp_4_2_yz]:      -439.691128448138
<QC>          [DMA_mp_4_2_zz]:      -145.810754127136
<QC>           [DMA_mp_5_0_0]:         1.720294845609
<QC>          [DMA_mp_5_1_m1]:        -0.180452352873
<QC>           [DMA_mp_5_1_0]:        -0.599618236087
<QC>           [DMA_mp_5_1_1]:        -0.426674324262
<QC>          [DMA_mp_5_2_m2]:         0.331829066749
<QC>          [DMA_mp_5_2_m1]:         0.224713643454
<QC>           [DMA_mp_5_2_0]:         0.288206412085
<QC>           [DMA_mp_5_2_1]:         0.339576505185
<QC>           [DMA_mp_5_2_2]:         0.053789857791
<QC>             [DMA_mp_5_0]:        -1.720294845609
<QC>           [DMA_mp_5_1_x]:       -22.840015080432
<QC>           [DMA_mp_5_1_y]:       -19.181151293482
<QC>           [DMA_mp_5_1_z]:       -21.790322995636
<QC>          [DMA_mp_5_2_xx]:       -58.213949337925
<QC>          [DMA_mp_5_2_xy]:      -382.216776714624
<QC>          [DMA_mp_5_2_xz]:      -434.029727887371
<QC>          [DMA_mp_5_2_yy]:        75.809952961340
<QC>          [DMA_mp_5_2_yz]:      -364.540824878039
<QC>          [DMA_mp_5_2_zz]:       -17.596003623415
<QC>           [DMA_mp_6_0_0]:         6.456720509367
<QC>          [DMA_mp_6_1_m1]:         0.706048991779
<QC>           [DMA_mp_6_1_1]:        -0.001065515929
<QC>          [DMA_mp_6_2_m2]:         0.002642014725
<QC>           [DMA_mp_6_2_0]:        -0.833714993415
<QC>           [DMA_mp_6_2_1]:        -0.004462936237
<QC>           [DMA_mp_6_2_2]:        -0.710719167794
<QC>             [DMA_mp_6_0]:        -6.456720509367
<QC>           [DMA_mp_6_1_x]:       -90.396641243976
<QC>           [DMA_mp_6_1_y]:      -107.226214728902
<QC>           [DMA_mp_6_1_z]:       -90.394130866442
<QC>          [DMA_mp_6_2_xx]:       257.678893282439
<QC>          [DMA_mp_6_2_xy]:     -2251.816596037593
<QC>          [DMA_mp_6_2_xz]:     -1898.326519563945
<QC>          [DMA_mp_6_2_yy]:      -516.098295308922
<QC>          [DMA_mp_6_2_yz]:     -2251.751652088133
<QC>          [DMA_mp_6_2_zz]:       258.419402026484
SWX: Destroying [properties_dma_swex-1]... done
SWX: Destroying [properties_dma_swex-2]... done
SWX: Destroying [val%hfx_swex]... done

Cleaning up after remote NGWF capability... done. 
SWX: Clean-up... done.
SWRI: Clean-up... done.

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     121.292s on      4 proc(s)                                    
TOTAL TIME:       121.292s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| compute_multipole_elms               :     3        0.00s   0.000%  ------ ||
|| hfx_determine_my_d_atoms             :    17        0.00s   0.000%  ------ ||
|| swri_metric_mat_consistency          :     5        0.00s   0.000%  ------ || (3 procs only)
|| hfx_split_pair_list                  :    17        0.00s   0.000%  ------ ||
|| hfx_determine_my_a_atoms             :    17        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ||
|| hash_table_cleanup_[SWOPS_IN_PPDS]   :    99        0.00s   0.000%  ------ ||
|| swri_metric_mat_wait_send            :     3        0.00s   0.000%  ------ ||
|| swri_metric_mat_cheb_gen_nodes       :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[SWOPS_IN_PPDS]     :     2        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| hfx_main_comms_imbalance             :    97        0.00s   0.000%  ------ ||
|| hash_table_purge_[DKNBLKS_AB]        :     8        0.00s   0.000%  ------ ||
|| swri_metric_mat_oc_work_imbalance    :     2        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_AB]      :     8        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_BA]      :     8        0.00s   0.000%  ------ ||
|| neighbour_list_populate              :     5        0.00s   0.000%  ------ ||
|| hash_table_purge_[VMETRIC]           :     1        0.00s   0.001%  ------ ||
|| hfx_determine_ppd_list               :    17        0.00s   0.001%  ------ ||
|| swri_metric_mat_wait_req_master      :     5        0.00s   0.003%  ------ || (1 procs only)
|| hash_table_purge_[TILES]             :     1        0.00s   0.001%  ------ ||
|| swri_metric_mat_RSH_rotation         :     5        0.00s   0.001%  ------ || (3 procs only)
|| remote_obtain_matrix_block           :   153        0.00s   0.001%  ------ ||
|| remote_obtain_coeffs                 :   108        0.00s   0.001%  ------ ||
|| hash_table_purge_[ALISTS]            :    18        0.00s   0.001%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.002%  ------ ||
|| sparse_set_to_garbage                :   164        0.00s   0.002%  ------ ||
|| swx_communicate_coeffs               :     2        0.00s   0.002%  ------ ||
|| hash_table_purge_[COEFFS]            :    54        0.00s   0.002%  ------ ||
|| swri_metric_mat_dispatch             :  4362        0.00s   0.002%  ------ ||
|| swri_extract_matrix_2                :    18        0.00s   0.002%  ------ ||
|| hfx_all_ad_for_this_b_store          :   218        0.00s   0.003%  ------ ||
|| hash_table_purge_[DKNBLKS_CD]        :    97        0.00s   0.003%  ------ ||
|| swri_metric_mat_allocs               :     1        0.00s   0.003%  ------ ||
|| remote_pack_ngwf                     :   354        0.00s   0.004%  ------ ||
|| hfx_contract_over_dkn_cc_dkn_get     :   873        0.00s   0.004%  ------ ||
|| swri_metric_mat_symmetry             :     1        0.01s   0.004%  ------ ||
|| sparse_init                          :     1        0.01s   0.005%  ------ ||
|| swri_vmatrixblock_sc                 :   304        0.01s   0.005%  ------ ||
|| hfx_determine_bc_pairs               :    17        0.01s   0.005%  ------ ||
|| basis_extract_function_from_box      :   180        0.01s   0.005%  ------ ||
|| hf_exchange_calculate_imbalance      :    97        0.01s   0.006%  ------ ||
|| dense_eigensolve                     :     2        0.01s   0.006%  ------ ||
|| pseudo_make_structure_factor         :     1        0.01s   0.006%  ------ ||
|| pseudopotentials_nonlocal_mat        :    17        0.01s   0.007%  ------ ||
|| hash_table_purge_[XAB]               :    97        0.01s   0.007%  ------ ||
|| hash_table_purge_[SWOP_HITS]         :     1        0.01s   0.007%  ------ ||
|| hash_table_purge_[DLISTS]            :    18        0.01s   0.007%  ------ ||
|| swri_metric_mat_wait_req_worker      :     4        0.01s   0.011%  ------ || (3 procs only)
|| hfx_comms_gradient_imbalance         :    16        0.01s   0.010%  ------ ||
|| hfx_comms_xmatrix_imbalance          :    97        0.01s   0.012%  ------ ||
|| hash_table_purge_[PPD_NGWFS_DD]      :    18        0.02s   0.013%  ------ ||
|| ngwf_gradient_coeffs                 :     8        0.02s   0.013%  ------ ||
|| hfx_determine_alists                 :    17        0.02s   0.013%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.02s   0.015%  ------ ||
|| hfx_comms_metric                     :    17        0.02s   0.017%  ------ ||
|| hash_table_purge_[AKETS_DKN_LOC]     :    16        0.02s   0.018%  ------ ||
|| hash_table_purge_[NGWFS]             :    24        0.02s   0.019%  ------ ||
|| hfx_determine_a_ppd_list_for_b       :   337        0.02s   0.019%  ------ ||
|| sparse_embed_hotelling_invert_embed  :    17        0.02s   0.020%  ------ ||
|| palser_mano_kernel_optimise          :     2        0.03s   0.021%  ------ ||
|| hfx_populate_swop_cache_imbalance    :     2        0.03s   0.021%  ------ ||
|| remote_obtain_dkn_block              :  3816        0.03s   0.022%  ------ ||
|| hfx_comms_dkn                        :   121        0.03s   0.025%  ------ ||
|| basis_dot_function_with_box          :  6326        0.03s   0.026%  ------ ||
|| dma_calculate                        :     1        0.03s   0.028%  ------ ||
|| swri_metric_mat_home_sws             :     1        0.03s   0.028%  ------ ||
|| swri_build_matrix_2                  :   333        0.04s   0.029%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.04s   0.030%  ------ ||
|| swri_metric_mat_eval_swpot           :   303        0.04s   0.032%  ------ ||
|| remote_obtain_ngwf                   :   924        0.05s   0.037%  ------ ||
|| hfx_determine_dlists                 :    17        0.05s   0.039%  ------ ||
|| swri_metric_mat_cheb_expand          :   303        0.05s   0.041%  ------ ||
|| function_ops_brappd_ketppd           :    17        0.05s   0.042%  ------ ||
|| hfx_comms_ngwfs                      :    68        0.05s   0.043%  ------ ||
|| hfx_populate_swop_cache_bookkeeping  :     1        0.05s   0.044%  ------ ||
|| hfx_accum_q_beta                     :  1080        0.05s   0.044%  ------ ||
|| swri_metric_mat_cheb_int_product     : 12453        0.06s   0.048%  ------ ||
|| hash_table_purge_[AKETS_DKN_MY]      :    16        0.06s   0.048%  ------ ||
|| remote_unpack_ngwf_no_sphere         :  7126        0.06s   0.049%  ------ ||
|| remote_unpack_ngwf                   : 10016        0.06s   0.051%  ------ ||
|| hfx_populate_swop_cache_calc         :     1        0.07s   0.056%  ------ ||
|| hfx_gradient_term2_qexpand3          :  1800        0.07s   0.058%  ------ ||
|| basis_add_function_to_box            : 13837        0.07s   0.060%  ------ ||
|| hash_table_purge_[PPD_PRODUCTS]      :    18        0.08s   0.065%  ------ ||
|| hfx_calc_p_ac                        :   288        0.08s   0.069%  ------ ||
|| lnv_gradient_norm                    :    45        0.09s   0.077%  ------ ||
|| hash_table_list                      :   540        0.11s   0.090%  ------ ||
|| basis_copy_function_to_box           :  1331        0.12s   0.095%  ------ ||
|| hash_table_free                      :   254        0.13s   0.108%  ------ ||
|| hfx_populate_swop_cache_sort         :     1        0.14s   0.113%  ------ ||
|| hfx_gradient_term2_part0             :    48        0.15s   0.120%  ------ ||
|| internal_tile_by_chebs               :     3        0.15s   0.127%  ------ ||
|| kernel_purify                        :   142        0.15s   0.127%  ------ ||
|| eigenstates_calculate                :     1        0.16s   0.128%  ------ ||
|| swri_metric_mat_main_loop            :     1        0.17s   0.140%  ------ ||
|| density_init_guess_real              :     1        0.17s   0.143%  ------ ||
|| hfx_comms_xmatrix                    :    97        0.18s   0.150%  ------ ||
|| kernel_fix                           :    45        0.19s   0.154%  ------ ||
|| cell_grid_extract_box_real           :   680        0.19s   0.158%  ------ ||
|| sparse_trace                         :  4230        0.21s   0.174%  ------ ||
|| energy_and_force_init_cell           :     1        0.22s   0.180%  ------ ||
|| hash_table_purge_[EXPANSIONS]        :    19        0.23s   0.187%  ------ ||
|| swri_metric_mat_oc                   :     1        0.23s   0.190%  ------ ||
|| swri_init_container_stage_2          :     1        0.24s   0.198%  ------ ||
|| hfx_populate_swop_cache              :     1        0.26s   0.214%  ------ ||
|| projectors_init_fftbox_recip         :    25        0.27s   0.225%  ------ ||
|| integrals_kinetic                    :    17        0.28s   0.228%  ------ ||
|| hfx_contract_over_dkn_cc_main        :   873        0.29s   0.238%  ------ ||
|| fourier_apply_box_pair               :   278        0.31s   0.258%  79.760 ||
|| projectors_func_ovlp_box             :    17        0.31s   0.258%  ------ ||
|| sparse_product                       :  4267        0.31s   0.259%  ------ ||
|| hfx_calc_aa_dd_ngwf_prods_in_ppds    :    17        0.37s   0.307%  ------ ||
|| projectors_gradient_batch            :     8        0.38s   0.314%  ------ ||
|| hfx_gradient_term2_part1             :    48        0.39s   0.318%  ------ ||
|| density_batch_row_sums               :    91        0.50s   0.410%  ------ ||
|| cell_grid_deposit_box_real           :  1034        0.52s   0.426%  ------ ||
|| hfx_gradient_term2_part2             :   120        0.56s   0.462%  ------ ||
|| swri_swop_calc_all_in_ppd            : 52968        0.56s   0.462%  ------ ||
|| hfx_all_ad_for_this_b_main           :   218        0.56s   0.463%  ------ ||
|| hfx_all_ad_for_this_b                :   218        0.57s   0.467%  ------ ||
|| hfx_grad_ket_dkn_baccum              :    18        0.63s   0.520%  ------ ||
|| swx_swop_quantity_overlap_ppd        :    99        0.65s   0.534%  ------ ||
|| linalg_dgesv                         :  2728        0.77s   0.635%  ------ ||
|| integrals_locpot_mat_els_batch       :   100        0.87s   0.715%  ------ ||
|| hfx_dkn_indep_preparation            :    17        0.88s   0.729%  ------ ||
|| swx_local_ngwf_pair_fitting          :     2        0.91s   0.747%  ------ ||
|| swx_expand_local_ngwf_pairs          :     2        0.91s   0.749%  ------ ||
|| dma_expand_ngwf_pairs                :     1        0.91s   0.749%  ------ ||
|| properties_calculate                 :     1        0.91s   0.753%  ------ ||
|| density_fftbox_deposit_to_cell       :   910        1.04s   0.858%  ------ ||
|| hfx_contract_over_dkn_cc_expa_get    :   873        1.07s   0.881%  ------ ||
|| hfx_comms_gradient                   :    16        1.17s   0.968%  ------ ||
|| sw_init                              :     1        1.59s   1.311%  ------ ||
|| hamiltonian_energy_components        :     2        1.64s   1.352%  ------ ||
|| hartree_on_grid                      :    92        2.17s   1.788%  ------ ||
|| hfx_contract_over_dkn_cc             :   218        2.44s   2.014%  ------ ||
|| ngwf_gradient_build_batch            :     8        2.48s   2.041%  ------ ||
|| hfx_main_work_imbalance              :    97        2.49s   2.049%  ------ ||
|| density_fftbox_interpolate_multiply  :   910        3.04s   2.503%  ------ ||
|| fourier_apply_box                    :  2748        3.35s   2.760% 353.435 ||
|| swx_my_ngwf_pair_fitting             :    17        3.36s   2.768%  ------ ||
|| swx_expand_my_ngwf_pairs             :    17        3.36s   2.769%  ------ ||
|| hfx_expand_ngwf_pairs                :    17        4.29s   3.538%  ------ ||
|| ngwf_gradient_batch                  :     8        4.48s   3.691%  ------ ||
|| hfx_gradient_term2_imbal             :     8        4.99s   4.116%  ------ ||
|| hfx_main_ngwf_grad1                  :     8        5.20s   4.291%  ------ ||
|| hfx_calc_expansion_for_q             :  1800        5.97s   4.923%  ------ ||
|| hfx_gradient_term2_qexpand2          :  1800        5.98s   4.929%  ------ ||
|| hfx_calc_expansions_bb_cc            :  1912        7.46s   6.154%  ------ ||
|| fourier_apply_cell_forward           :   828        7.73s   6.375%  11.327 ||
|| fourier_apply_cell_backward          :   829        7.79s   6.423%  11.257 ||
|| hfx_gradient                         :    16        8.57s   7.067%  ------ ||
|| potential_apply_to_ngwf_batch        :   100       11.96s   9.861%  ------ ||
|| integrals_locpot_dbl_grid            :   100       12.91s  10.646%  ------ ||
|| density_batch_interp_deposit         :    91       13.68s  11.275%  ------ ||
|| hfx_gradient_term2_qexpand           :  1800       15.47s  12.757%  ------ ||
|| density_on_dbl_grid                  :    91       15.93s  13.132%  ------ ||
|| xc_energy_potential                  :    92       17.34s  14.298%  ------ ||
|| swx_swop_quantity_overlap_ppd_fast   :  2628       17.89s  14.752%  ------ ||
|| swx_expansion_2_fast                 :  2628       18.72s  15.435%  ------ ||
|| hfx_gradient_term2_part3             :   120       21.60s  17.809%  ------ ||
|| hfx_gradient_term2                   :     8       27.86s  22.968%  ------ ||
|| swri_swop_calc_all_in_ppd_fast       : 4.917M      29.02s  23.926%  ------ ||
|| hfx_main_ngwf_grad2                  :     8       32.50s  26.797%  ------ ||
|| hamiltonian_lhxc_calculate           :    89       38.38s  31.647%  ------ ||
|| ngwf_gradient_lnv                    :     8       44.22s  36.455%  ------ ||
|| hfx_main                             :    97       51.64s  42.576%  ------ ||
|| hf_exchange_calculate                :    97       51.92s  42.803%  ------ ||
|| lnv_denskernel_optimise_cg           :     9       55.38s  45.655%  ------ ||
|| ngwf_cg_optimise                     :     1      115.31s  95.065%  ------ ||
|| energy_and_force_calculate           :     1      120.69s  99.503%  ------ ||
|| total_time                           :     1      121.29s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 1 ms ensuring consistency across MPI ranks,
- 1 ms printing in order.

Job completed: 21-09-2022 10:54 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
