==================================================================================
It's Tue Sep 27 10:04:50 BST 2022.
*** Starting onetep_launcher (node uos-219041, PIDs 12799 12800 12801 12802)...
    - ONETEP arguments: ethanol_hybrid_conduction_1.dat
    - Current directory: /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/tests/test69
    - Launcher executable directory: /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/onetep.* -> no matches
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79 -> /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/tests/test69/onetep.* -> no matches
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/tests/test69/../bin/onetep.* -> no matches
      ... trying /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 2
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79 ethanol_hybrid_conduction_1.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE environment variable is not supported.
[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE environment variable is not supported.
[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE environment variable is not supported.
[0] MPI startup(): To check the list of supported variables, use the impi_info utility or refer to https://software.intel.com/en-us/mpi-library/documentation/get-started.
 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12.0  |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 27-09-2022 10:04 (+0100)
 
Reading parameters from file "ethanol_hybrid_conduction_1.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 2 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 2
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
               2 threads for loops over batched FFT box operations.
               2 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     O  O  O     |
BC: | Local pseudopotential | pspot_bc [3]    |     O  O  O     |
BC: | Hartree-Fock exchange | hfx_bc          |     O  O  O     |
BC: | Van der Waals         | vdw_bc          |     O  O  O     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.
... done

Reading geometry and species blocks from file "ethanol_hybrid_conduction_1.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
    
  Number of PPD points along a1 set to 7 from input file.
  Number of PPD points along a2 set to 7 from input file.
  Number of PPD points along a3 set to 7 from input file.
    
  PSINC grid spacing along a1 set to   0.476190476190a0 from input file.
  PSINC grid spacing along a2 set to   0.476190476190a0 from input file.
  PSINC grid spacing along a3 set to   0.476190476190a0 from input file.
  Number of PPD points along a1 set to 7 from input file.
  Number of PPD points along a2 set to 7 from input file.
  Number of PPD points along a3 set to 7 from input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

coulomb_cutoff_type SPHERE                                                      
coulomb_cutoff_radius 40.0                                                      
hfx_bc O O O                                                                    
print_qc T                                                                      
output_detail VERBOSE                                                           
timings_level 3                                                                 
%block swri                                                                     
for_hfx 2 10 V 10 10 X                                                          
%endblock swri                                                                  
%block species_swri-for_hfx                                                     
C                                                                               
H                                                                               
O                                                                               
%endblock species_swri-for_hfx                                                  
hfx_use_ri for_hfx                                                              
hfx_max_l 2                                                                     
hfx_max_q 10                                                                    
hfx_metric ELECTROSTATIC                                                        
hfx_memory_limit 1000                                                           
task                : SINGLEPOINT                                               
cutoff_energy       : 900.0 eV                                                  
do_properties       : T                                                         
xc_functional       : B3LYP                                                     
maxit_pen           : 0                                                         
write_density_plot  : F                                                         
maxit_palser_mano   : -1                                                        
ppd_npoints 7 7 7                                                               
write_denskern            : T                                                   
write_tightbox_ngwfs      : T                                                   
read_denskern             : F                                                   
read_tightbox_ngwfs       : F                                                   
maxit_ngwf_cg             : 1                                                   
cube_format F                                                                   
%BLOCK SPECIES                                                                  
C   C   6   4  8.0                                                              
H   H   1   1  8.0                                                              
O   O   8   4  8.0                                                              
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_POT                                                              
C "../../pseudo/carbon.recpot"                                                  
H "../../pseudo/hydrogen.recpot"                                                
O "../../pseudo/oxygen.recpot"                                                  
%ENDBLOCK SPECIES_POT                                                           
%block lattice_cart                                                             
30.00000000   0.00000000   0.00000000                                           
0.00000000  30.00000000   0.00000000                                            
0.00000000   0.00000000  30.00000000                                            
%endblock lattice_cart                                                          
%block positions_abs                                                            
     Hash =   000001727411528844452111
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
 ESDF WARNING(1
 ): "coulombcutoffradius" (esdf_physical) has no units. Assume "bohr".
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
File: ../../pseudo/oxygen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 0; rc = 1.31 bohr
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          2         8         2
  H          6         6         0
  O          1         4         1
.......   ......    ......    ......
Totals:      9        18         3
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   63 x  63 x  63
                              FFT-box:   63 x  63 x  63
                                  PPD:    7 x   7 x   7
Grid space d1=  0.476190476190a0 (KE cutoff=  33.49983Eh = 911.57673eV)
Grid space d2=  0.476190476190a0 (KE cutoff=  33.49983Eh = 911.57673eV)
Grid space d3=  0.476190476190a0 (KE cutoff=  33.49983Eh = 911.57673eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     63    63    63
          Real-space ('12') slabs/proc (min max mean):     15    16    15
         Recip-space ('23') slabs/proc (min max mean):      8     8     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    126   126   126
          Real-space ('12') slabs/proc (min max mean):     31    32    31
         Recip-space ('23') slabs/proc (min max mean):     16    16    16
********************************************************************************

********************* Fourier parallelisation information **********************
       Padded Grid (whole simulation cell) dimensions:    350   350   350
          Real-space ('12') slabs/proc (min max mean):     87    88    87
         Recip-space ('23') slabs/proc (min max mean):     44    44    44
********************************************************************************

Calculating transform of cutoff Coulomb interaction ... done

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.4069558845   -0.9644877669    4.5135240840   -1.1733979231
  2         -5.0359126314   -1.1382843369    4.3226714159   -1.1289948168
  3         -5.1282594161   -1.1377240508    4.3231865855   -1.1311772726
  4         -5.1305117567   -1.1442897097    4.3160899506   -1.1302832928
  5         -5.1333700816   -1.1469491295    4.3132129356   -1.1300634585
  6         -5.1347019316   -1.1482287186    4.3118281691   -1.1299931466
  7         -5.1352247630   -1.1488659381    4.3111385742   -1.1299709481
  8         -5.1354026025   -1.1491845154    4.3107938893   -1.1299659671
  9         -5.1354462804   -1.1493436051    4.3106218308   -1.1299666955
 10         -5.1354437091   -1.1494229242    4.3105360929   -1.1299687992
 11         -5.1354291929   -1.1494624155    4.3104934349   -1.1299707981
 12         -5.1354176285   -1.1494781256    4.3104764789   -1.1299720111
 13         -5.1354081812   -1.1494875095    4.3104663570   -1.1299729201
 14         -5.1354009151   -1.1494931118    4.3104603180   -1.1299735809
 15         -5.1353955381   -1.1494964547    4.3104567171   -1.1299740509
 16         -5.1353916641   -1.1494984483    4.3104545714   -1.1299743798
 17         -5.1353889271   -1.1494996364    4.3104532937   -1.1299746071
 18         -5.1353870222   -1.1495003441    4.3104525334   -1.1299747625
 19         -5.1353857119   -1.1495007653    4.3104520813   -1.1299748679
 20         -5.1353848191   -1.1495010158    4.3104518127   -1.1299749389
 21         -5.1353842155   -1.1495011646    4.3104516533   -1.1299749864
 22         -5.1353838101   -1.1495012530    4.3104515588   -1.1299750181
 23         -5.1353835393   -1.1495013054    4.3104515028   -1.1299750391
 24         -5.1353833593   -1.1495013365    4.3104514696   -1.1299750530
 25         -5.1353832401   -1.1495013548    4.3104514501   -1.1299750622
 26         -5.1353831615   -1.1495013657    4.3104514385   -1.1299750682
Atom SCF converged after  26 iterations to a total energy of     -5.13538316

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    0  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3079404309   -0.1847796142    0.2820952552   -0.1977712840
  2         -0.3685975256   -0.1881372461    0.2800584768   -0.1985632226
  3         -0.3972336746   -0.1884802615    0.2798203631   -0.1998878628
  4         -0.4080711007   -0.1888189230    0.2794872379   -0.2003449133
  5         -0.4121182830   -0.1890445832    0.2792475199   -0.2004732256
  6         -0.4136581625   -0.1891622406    0.2791188792   -0.2005066556
  7         -0.4142566052   -0.1892169058    0.2790582819   -0.2005150829
  8         -0.4144930958   -0.1892408430    0.2790315521   -0.2005171835
  9         -0.4145876365   -0.1892509919    0.2790201727   -0.2005177108
 10         -0.4146257137   -0.1892552173    0.2790154237   -0.2005178471
 11         -0.4146411214   -0.1892569584    0.2790134641   -0.2005178845
 12         -0.4146473737   -0.1892576715    0.2790126609   -0.2005178957
 13         -0.4146499153   -0.1892579626    0.2790123328   -0.2005178994
 14         -0.4146509496   -0.1892580812    0.2790121992   -0.2005179008
 15         -0.4146513708   -0.1892581294    0.2790121448   -0.2005179014
 16         -0.4146515424   -0.1892581490    0.2790121227   -0.2005179016
 17         -0.4146516123   -0.1892581570    0.2790121137   -0.2005179017
Atom SCF converged after  17 iterations to a total energy of     -0.41465161

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -1.5661537791   -6.8154847894   10.1554291890   -1.9817841195
  2        -16.4386271763   -2.3896369642   13.5944551264   -2.6260758875
  3        -14.9493899685   -2.7563303680   13.2023047998   -2.5596129673
  4        -15.3921207107   -2.6131563355   13.3532703810   -2.5891321659
  5        -15.2222594960   -2.6552654914   13.3087860131   -2.5818429119
  6        -15.2271175148   -2.6512425439   13.3131300524   -2.5830481331
  7        -15.2216500549   -2.6517501961   13.3126321642   -2.5831383761
  8        -15.2189346714   -2.6519101535   13.3124872443   -2.5832257372
  9        -15.2176764698   -2.6519806177   13.3124247517   -2.5832714783
 10        -15.2168206977   -2.6520315048   13.3123793018   -2.5833032826
 11        -15.2162363429   -2.6520687088   13.3123457720   -2.5833252807
 12        -15.2158365778   -2.6520959446   13.3123210089   -2.5833404663
 13        -15.2155628281   -2.6521158316   13.3123027835   -2.5833509437
 14        -15.2153752610   -2.6521302990   13.3122894320   -2.5833581733
 15        -15.2152466902   -2.6521407840   13.3122796964   -2.5833631637
 16        -15.2151585280   -2.6521483559   13.3122726278   -2.5833666101
 17        -15.2150980548   -2.6521538066   13.3122675152   -2.5833689914
 18        -15.2150565616   -2.6521577191   13.3122638299   -2.5833706378
 19        -15.2150280827   -2.6521605203   13.3122611815   -2.5833717766
 20        -15.2150085303   -2.6521625211   13.3122592834   -2.5833725649
 21        -15.2149951026   -2.6521639474   13.3122579264   -2.5833731107
 22        -15.2149858783   -2.6521649621   13.3122569582   -2.5833734889
 23        -15.2149795399   -2.6521656828   13.3122562689   -2.5833737512
 24        -15.2149751832   -2.6521661938   13.3122557790   -2.5833739330
 25        -15.2149721879   -2.6521665557   13.3122554314   -2.5833740592
 26        -15.2149701280   -2.6521668116   13.3122551851   -2.5833741469
 27        -15.2149687110   -2.6521669923   13.3122550109   -2.5833742077
 28        -15.2149677359   -2.6521671198   13.3122548877   -2.5833742500
 29        -15.2149670649   -2.6521672097   13.3122548009   -2.5833742795
 30        -15.2149666029   -2.6521672730   13.3122547396   -2.5833742999
 31        -15.2149662848   -2.6521673175   13.3122546964   -2.5833743142
 32        -15.2149660657   -2.6521673487   13.3122546661   -2.5833743241
 33        -15.2149659148   -2.6521673707   13.3122546447   -2.5833743310
 34        -15.2149658108   -2.6521673861   13.3122546297   -2.5833743358
 35        -15.2149657391   -2.6521673969   13.3122546192   -2.5833743391
Atom SCF converged after  35 iterations to a total energy of    -15.21496574

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     O  O  O     |
BC: | Local pseudopotential | pspot_bc [3]    |     O  O  O     |
BC: | Hartree-Fock exchange | hfx_bc          |     O  O  O     |
BC: | Van der Waals         | vdw_bc          |     O  O  O     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      5;  min      4;  average      5
... Projector load balancing: max      1;  min      0;  average      1
... done
Checking all ngwfs are fully within unit cell ... done
Calculating direct Ion-Ion energy ...
Ion-Ion Energy        :        48.82851249350384
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):          5648        24830
... Nonlocal pseudopotential projector initialisation
... done

Initialising remote NGWF capability... done. 

SWRI: Initialising module (stage 1)... 
SWRI: [for_hfx] Initialising (stage 1)...
SWRI: [for_hfx] - Using default V metric matrix evaluation scheme (2D numerical-1D analytic).
SWRI: [for_hfx] - Initialising Bessels (l_max=2)... done.
SWRI: [for_hfx] - Initialising radial lookup... done.
SWRI: [for_hfx] - SW batch size (tile width) set to 90.
SWRI: [for_hfx] - Initialising persistent cache structures... done.
SWRI: [for_hfx] - Initialising metric matrix... done.
SWRI: [for_hfx] Done.
SWRI: Stage 1 completed.

========================== Sparse matrix information ===========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  16.67%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
HFx: Creating X matrix structure for val rep (spin 1).
Initializing spherical harmonic rotation module.

SWRI: Initializing module (stage 2)... 
SWRI: [for_hfx] Initialising (stage 2)... 
SWRI: [for_hfx] - NL: Populating neighbour list: SWRI_S_ATOMS... done.
SWRI: [for_hfx] - Generating and communicating atomblock list.
SWRI: [for_hfx]   0 atomblocks read from disk.
SWRI: [for_hfx]   36 atomblocks to process.
SWRI: [for_hfx]   Sorting atomblocks according to proximitiy to (    0.000000,    0.000000,    0.000000).
SWRI: [for_hfx] - Calculating on-site elements of the metric matrix V... done.
SWRI: [for_hfx] - Calculating off-site elements of the metric matrix V.
 +----------------------------------------------------+
 |  Spherical wave res. of identity Chebyshev engine  |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  workspace atomblock                 :   63.28 kB  |
 |  vtile                               :   63.28 kB  |
 |  recvtile                            :   63.28 kB  |
 |  workers_done                        :   16.00  B  |
 |  atomblocklist                       :  720.00  B  |
 |  tilelist (root only)                :  432.00  B  |
 |  tile hash table (upper bound)       :  253.12 kB  |
 |  nodes_template                      :   78.12 kB  |
 |  swop_values                         :  156.25 kB  |
 |  swy_values                          :  156.25 kB  |
 |  swhome_all_coeffs                   :    6.87 MB  |
 |  swpot_batch_coeffs                  :    6.87 MB  |
 |  all_atomblocks (indices)            :  432.00  B  |
 |  my_atomblocks (indices)             :  432.00  B  |
 |  num_q_per_l                         :   36.00  B  |
 |  atomblock rotation matrix           :   63.28 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :   14.61 MB  |
 +----------------------------------------------------+
SWRI: [for_hfx]   36 tiles to process (36 atomblocks x 1 batches)
SWRI: [for_hfx]   Tiles completed:        0, left:       32, in progress:     4.
SWRI: [for_hfx]   Tiles completed:        4, left:       28, in progress:     4.
SWRI: [for_hfx]   Tiles completed:        8, left:       24, in progress:     4.
SWRI: [for_hfx]   Tiles completed:       12, left:       20, in progress:     4.
SWRI: [for_hfx]   Tiles completed:       16, left:       16, in progress:     4.
SWRI: [for_hfx]   Tiles completed:       20, left:       12, in progress:     4.
SWRI: [for_hfx]   Tiles completed:       24, left:        8, in progress:     4.
SWRI: [for_hfx]   Tiles completed:       28, left:        4, in progress:     4.
SWRI: [for_hfx]   Tiles completed:       33, left:        0, in progress:     3.
SWRI: [for_hfx] - Filling the remainder by symmetry.
SWRI: Done.
SWX: Initialising module... 
done.
NL: Populating neighbour list: HFx_S_ATOMS... done.
NL: Populating neighbour list: HFx_X_ATOMS... done.
NL: Populating neighbour list: HFx_XS_ATOMS... done.
NL: Populating neighbour list: HFx_SXS_ATOMS... done.
SWX: Initialising val%[hfx_swex]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 2, max_q: 10, num_sws: 90, max_sws: 90.
SWX: Done.
NGWF initialisation ...... done
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        12 |       2 |       9 |      11 |        81 |        81 |
|       1 |        15 |       2 |       9 |      11 |        81 |        81 |
|       2 |        12 |       2 |       9 |      11 |        81 |        81 |
|       3 |        42 |       5 |       9 |      14 |        81 |        81 |
+---------------------------------------------------------------------------+
|     min |        12 |       2 |       9 |      11 |        81 |        81 |
|     max |        42 |       5 |       9 |      14 |        81 |        81 |
| average |      20.2 |     2.8 |     9.0 |    11.8 |      81.0 |      81.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Estimating memory use...
 +----------------------------------------------------+
 |  HFx TEFCI engine: minimum requirements            |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  Radial Bessel lookup                :   22.89 MB  |
 |  Dd NGWFs hash table                 :  225.00 kB  |
 |  All remote NGWFs hash table         :    8.23 MB  |
 |  dlists hash table                   :    2.48 MB  |
 |  coeffs hash table (estimate)        :  292.78 kB  |
 |  V metric matrix hash table          :    3.82 MB  |
 |  f auxiliary term                    :   21.62 MB  |
 |  P term in NGWF gradient             :   21.62 MB  |
 |  Q term in NGWF gradient             :    6.07 MB  |
 |  My kets in NGWF grad. (estimate)    :   11.66 MB  |
 |  Local kets in NGWF grad. (estim.)   :    3.85 MB  |
 |  K^{CD} hash table                   :  460.12 kB  |
 |  K^{AB} hash table                   :  455.62 kB  |
 |  tcK^A_B hash table                  :  455.62 kB  |
 |  tcK^B_A hash table                  :  455.62 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  104.51 MB  |
 +----------------------------------------------------+
HFx: - Adjusting cache sizes according to weights: 0.6250, 0.3125, 0.0625.
 +----------------------------------------------------+
 |  HFx TEFCI engine: user-adjustable requirements    |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  SWOP hash table                     :  491.83 MB  |
 |  Expansions hash table               :  336.00 MB  |
 |  AD NGWF products hash table         :   67.00 MB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  894.83 MB  |
 +----------------------------------------------------+
HFx: - Peak memory use capped at 999.3 MB per MPI rank.
+------------------------------------------------------------------------------+
|    MPI |                           |              |           |              |
|   rank |       SWOP cache capacity | SWOPs needed | Cacheable |    Hit ratio |
+------------------------------------------------------------------------------+
|      0 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      1 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      2 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      3 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
+------------------------------------------------------------------------------+
HFx: - Populating SWOP cache...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              62 |                19 |              81 |      76.54% |
|      1 |              61 |                20 |              81 |      75.31% |
|      2 |              62 |                19 |              81 |      76.54% |
|      3 |              62 |                19 |              81 |      76.54% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.39409475E+01     0.94808086E+00
               2       0.37450077E+01     0.90202497E+00
               3       0.34902674E+01     0.82185649E+00
               4       0.31982308E+01     0.70514931E+00
               5       0.29021446E+01     0.68104884E+00
               6       0.26324964E+01     0.65689058E+00
               7       0.23629264E+01     0.61793247E+00
               8       0.19889911E+01     0.55208053E+00
               9       0.14549556E+01     0.44370785E+00
              10       0.83375398E+00     0.28869259E+00
              11       0.31187558E+00     0.12453177E+00
              12       0.55319012E-01     0.24313161E-01
              13       0.24458868E-02     0.10391180E-02
              14       0.58152246E-05     0.23114556E-05
              15       0.33799599E-10     0.13249180E-10
              16       0.29030206E-14     0.11102230E-14
================================================================================
Up spin density kernel initialisation ...... done

Writing density kernel to file "ethanol_hybrid_conduction_1.dkn" ... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      20.00000000
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       6 [3] (1)
  - B:       1 [0] (1)
  - B:       4 [2] (1)
  - B:       7 [3] (1)
  - B:       8 [3] (1)
  - B:       9 [3] (1)
  - B:       2 [1] (2)
  - B:       2 [0] (1)
  - B:       5 [2] (1)
  - B:       5 [3] (2)
  - B:       1 [0] (2)
  - B:       4 [2] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  - B:       7 [3] (2)
  - B:       8 [3] (2)
  - B:       9 [3] (2)
  - B:       5 [2] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       5 [3]
  + B:       4 [2]
  + B:       2 [1]
  + B:       6 [3]
  + B:       2 [0]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
HFx: +-----------------------------------------------------------------------+
HFx: |    MPI |                          Expansion cache                     |
HFx: |   rank |           hits |         misses |          total | hit ratio |
HFx: +-----------------------------------------------------------------------+
HFx: |      0 |          18792 |              0 |          18792 |  100.00 % |
HFx: |      1 |          18792 |              0 |          18792 |  100.00 % |
HFx: |      2 |          18792 |              0 |          18792 |  100.00 % |
HFx: |      3 |          18792 |              0 |          18792 |  100.00 % |
HFx: +-----------------------------------------------------------------------+
HFx: +-----------------------------------------------------------------------+
HFx: |    MPI |                    AD NGWF product cache                     |
HFx: |   rank |           hits |         misses |          total | hit ratio |
HFx: +-----------------------------------------------------------------------+
HFx: |      0 |          10276 |           3454 |          13730 |   74.84 % |
HFx: |      1 |          10276 |           3454 |          13730 |   74.84 % |
HFx: |      2 |          10276 |           3454 |          13730 |   74.84 % |
HFx: |      3 |          25690 |           8635 |          34325 |   74.84 % |
HFx: +-----------------------------------------------------------------------+
HFx: Exchange matrix symmetric to  4.59 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.589152623196 Ha.
      ideal mu1:      -0.564080242817
             Q0:         -30.453164619550
             G0:      -0.143119362792
   RMS gradient:       0.021017288797
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       2 [1]
  + B:       5 [3]
  + B:       4 [2]
  + B:       1 [0]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.559957384873 Ha.
     Trial step:       0.500000000000
             Q1:         -30.474912073784
 Quadratic coef:       0.049812227163
 Linear coef   :      -0.071559681396
           Qmin:         -30.478865076512
Quadratic minimum step length (  0.359147168636) accepted
    Initial Ne1:      20.00000000
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001764 (step -0.4937 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000007 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -3.045316461955E+01     2.1017E-02     1.8916E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       2 [1]
  + B:       1 [0]
  + B:       5 [3]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.567815269972 Ha.
      ideal mu1:      -0.599052156208
             Q0:         -30.479113814360
             G0:      -0.008042416035
   RMS gradient:       0.004961939406
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       2 [1]
  + B:       1 [0]
  + B:       5 [3]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.566725110010 Ha.
     Trial step:       0.423761235035
             Q1:         -30.481054410851
 Quadratic coef:       0.001467467660
 Linear coef   :      -0.003408064152
           Qmin:         -30.481092546426
Quadratic minimum step length (  0.492074037790) accepted
    Initial Ne1:      19.99999999
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000417 (step -0.4987 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -3.047911381436E+01     4.9619E-03     4.4657E-03    -2.5949E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.566539245316 Ha.
      ideal mu1:      -0.603467748794
             Q0:         -30.481099434924
             G0:      -0.000577505552
   RMS gradient:       0.001333155393
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       2 [1]
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.566964536290 Ha.
     Trial step:       0.456641984472
             Q1:         -30.481258971436
 Quadratic coef:       0.000104176770
 Linear coef   :      -0.000263713281
           Qmin:         -30.481266326005
Quadratic minimum step length (  0.577972211659) accepted
    Initial Ne1:      20.00000000
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000066 (step -0.4998 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -3.048109943492E+01     1.3332E-03     1.1998E-03    -1.9856E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       2 [1]
  + B:       5 [3]
  + B:       1 [0]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.567076120576 Ha.
      ideal mu1:      -0.601915975165
             Q0:         -30.481266503175
             G0:      -0.000125733326
   RMS gradient:       0.000622694039
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       2 [1]
  + B:       1 [0]
  + B:       5 [3]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.566862586558 Ha.
     Trial step:       0.513737654549
             Q1:         -30.481303370004
 Quadratic coef:       0.000027727115
 Linear coef   :      -0.000064593944
           Qmin:         -30.481304123187
Quadratic minimum step length (  0.598409568909) accepted
    Initial Ne1:      20.00000048
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000024 (step -0.4999 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -3.048126650317E+01     6.2269E-04     5.6042E-04    -1.6707E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       2 [1]
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.566827311512 Ha.
      ideal mu1:      -0.602534979785
    5        -3.048130414865E+01     1.8918E-04     1.7026E-04    -3.7645E-05
Finished density kernel iterations (   5)

Writing density kernel to file "ethanol_hybrid_conduction_1.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.04813041486536E+01  Eh
     Estimated bandgap           =   4.0295E-01  Eh
     RMS occupancy error         =   1.3079E-09
     [H,K] commutator            =   1.7026E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       10.000 electrons (spin 1).
HFx: Density kernel CD normalised to       10.000 electrons (spin 1).
  + B:       2 [1]
  + B:       1 [0]
  + B:       5 [3]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       8 [3]
  + B:       9 [3]
HFx: Communicating NGWF gradient kets.
  * C:       1 [1]
  * C:       1 [0]
  * C:       1 [2]
  * C:       1 [3]
  * C:       2 [0]
  * C:       2 [3]
  * C:       2 [1]
  * C:       3 [0]
  * C:       2 [2]
  * C:       3 [3]
  * C:       3 [1]
  * C:       3 [2]
  * C:       4 [1]
  * C:       4 [3]
  * C:       4 [0]
  * C:       4 [2]
  * C:       5 [1]
  * C:       5 [2]
  * C:       5 [0]
  * C:       6 [1]
  * C:       5 [3]
  * C:       6 [2]
  * C:       6 [0]
  * C:       6 [3]
  * C:       7 [1]
  * C:       7 [2]
  * C:       7 [0]
  * C:       7 [3]
  * C:       8 [1]
  * C:       8 [2]
  * C:       8 [0]
  * C:       8 [3]
  * C:       9 [1]
  * C:       9 [2]
  * C:       9 [0]
  * C:       9 [3]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  4.58 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.566827311512 Ha.
HFx: ^ (accounting for spin degeneracy in density kernel in val gradient calc)
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4160E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        12 |       2 |       9 |      11 |        81 |        81 |
|       1 |        15 |       2 |       9 |      11 |        81 |        81 |
|       2 |        12 |       2 |       9 |      11 |        81 |        81 |
|       3 |        42 |       5 |       9 |      14 |        81 |        81 |
+---------------------------------------------------------------------------+
|     min |        12 |       2 |       9 |      11 |        81 |        81 |
|     max |        42 |       5 |       9 |      14 |        81 |        81 |
| average |      20.2 |     2.8 |     9.0 |    11.8 |      81.0 |      81.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              62 |                19 |              81 |      76.54% |
|      1 |              62 |                19 |              81 |      76.54% |
|      2 |              62 |                19 |              81 |      76.54% |
|      3 |              62 |                19 |              81 |      76.54% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.44795696E-02     0.13481718E-02
               2       0.54343426E-05     0.21748323E-05
               3       0.14406013E-10     0.57609473E-11
               4       0.29077964E-14     0.88817842E-15
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       4 [2] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       6 [3] (1)
  - B:       7 [3] (1)
  - B:       8 [3] (1)
  - B:       5 [2] (1)
  - B:       9 [3] (1)
  - B:       2 [1] (2)
  - B:       2 [0] (1)
  - B:       4 [2] (2)
  - B:       1 [0] (2)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  - B:       7 [3] (2)
  - B:       8 [3] (2)
  - B:       9 [3] (2)
  - B:       5 [2] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       6 [3]
  + B:       3 [1]
  + B:       2 [0]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  4.55 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.573991688626 Ha.
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        12 |       2 |       9 |      11 |        81 |        81 |
|       1 |        15 |       2 |       9 |      11 |        81 |        81 |
|       2 |        12 |       2 |       9 |      11 |        81 |        81 |
|       3 |        42 |       5 |       9 |      14 |        81 |        81 |
+---------------------------------------------------------------------------+
|     min |        12 |       2 |       9 |      11 |        81 |        81 |
|     max |        42 |       5 |       9 |      14 |        81 |        81 |
| average |      20.2 |     2.8 |     9.0 |    11.8 |      81.0 |      81.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              62 |                19 |              81 |      76.54% |
|      1 |              62 |                19 |              81 |      76.54% |
|      2 |              62 |                19 |              81 |      76.54% |
|      3 |              62 |                19 |              81 |      76.54% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.71689177E-01     0.23807080E-01
               2       0.14975083E-02     0.46089307E-03
               3       0.81034749E-06     0.26199724E-06
               4       0.38823680E-12     0.13056223E-12
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  - B:       1 [0] (1)
  - B:       5 [3] (1)
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       3 [1] (1)
  - B:       6 [3] (1)
  - B:       7 [3] (1)
  - B:       8 [3] (1)
  - B:       5 [2] (1)
  - B:       2 [0] (1)
  - B:       9 [3] (1)
  - B:       2 [1] (2)
  - B:       4 [2] (2)
  - B:       1 [0] (2)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  - B:       7 [3] (2)
  - B:       8 [3] (2)
  - B:       9 [3] (2)
  - B:       5 [2] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       6 [3]
  + B:       3 [1]
  + B:       2 [0]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.84 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.643079703273 Ha.
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        12 |       2 |       9 |      11 |        81 |        81 |
|       1 |        15 |       2 |       9 |      11 |        81 |        81 |
|       2 |        12 |       2 |       9 |      11 |        81 |        81 |
|       3 |        42 |       5 |       9 |      14 |        81 |        81 |
+---------------------------------------------------------------------------+
|     min |        12 |       2 |       9 |      11 |        81 |        81 |
|     max |        42 |       5 |       9 |      14 |        81 |        81 |
| average |      20.2 |     2.8 |     9.0 |    11.8 |      81.0 |      81.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              62 |                19 |              81 |      76.54% |
|      1 |              62 |                19 |              81 |      76.54% |
|      2 |              62 |                19 |              81 |      76.54% |
|      3 |              62 |                19 |              81 |      76.54% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15699801E-02     0.54255867E-03
               2       0.74818452E-06     0.25578129E-06
               3       0.18860264E-12     0.55955240E-13
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00141599833022
Trial step length           =               0.122474
Gradient along search dir.  =         -0.71682788501
Functional at step 0        =     -30.48130414865359
Functional at step 1        =     -30.56484480680404
Rejected quadratic step     =               1.264256
Functional at new step 1    =     -30.92819746271605
Functional predicted        =     -30.92828205348103
Selected quadratic step     =               1.247100
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "ethanol_hybrid_conduction_1.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      20.18740583
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.006611 (step -0.4855 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000084 (step -0.5001 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  - B:       4 [2] (1)
  - B:       2 [1] (1)
  - B:       5 [3] (1)
  - B:       1 [0] (1)
  - B:       3 [1] (1)
  - B:       6 [3] (1)
  - B:       7 [3] (1)
  - B:       8 [3] (1)
  - B:       5 [2] (1)
  - B:       2 [0] (1)
  - B:       9 [3] (1)
  - B:       2 [1] (2)
  - B:       4 [2] (2)
  - B:       1 [0] (2)
  - B:       5 [3] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  - B:       7 [3] (2)
  - B:       8 [3] (2)
  - B:       9 [3] (2)
  - B:       5 [2] (2)
  - B:       2 [0] (2)
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       6 [3]
  + B:       3 [1]
  + B:       2 [0]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.85 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.642090766910 Ha.
      ideal mu1:      -0.535352391266
             Q0:         -30.928410674777
             G0:      -0.031737795327
   RMS gradient:       0.009897280354
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.643792817145 Ha.
     Trial step:       0.554459672466
             Q1:         -30.932930903012
 Quadratic coef:       0.013077099366
 Linear coef   :      -0.017597327602
           Qmin:         -30.934330679092
Quadratic minimum step length (  0.373057060473) accepted
    Initial Ne1:      19.99999862
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000434 (step -0.4984 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -3.092841067478E+01     9.8973E-03     8.9076E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       2 [0]
  + B:       5 [2]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.643178009522 Ha.
      ideal mu1:      -0.541343055935
             Q0:         -30.934323192245
             G0:      -0.001880335394
   RMS gradient:       0.002406105981
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       2 [0]
  + B:       5 [2]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.642725220259 Ha.
     Trial step:       0.454802259846
             Q1:         -30.934753144500
 Quadratic coef:       0.000425228531
 Linear coef   :      -0.000855180786
           Qmin:         -30.934753157619
Quadratic minimum step length (  0.457328384700) accepted
    Initial Ne1:      19.99999990
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000092 (step -0.4997 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -3.093432319224E+01     2.4061E-03     2.1655E-03    -5.9125E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       2 [0]
  + B:       5 [2]
  + B:       8 [3]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.642722641334 Ha.
      ideal mu1:      -0.541502956358
             Q0:         -30.934753579726
             G0:      -0.000141736905
   RMS gradient:       0.000661105535
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       2 [0]
  + B:       5 [2]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.643110105267 Ha.
     Trial step:       0.456063573258
             Q1:         -30.934792309476
 Quadratic coef:       0.000025911290
 Linear coef   :      -0.000064641039
           Qmin:         -30.934793894817
Quadratic minimum step length (  0.568872172317) accepted
    Initial Ne1:      20.00000079
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000015 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -3.093475357973E+01     6.6111E-04     5.9499E-04    -4.3039E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.643205646647 Ha.
      ideal mu1:      -0.540476184214
             Q0:         -30.934793911714
             G0:      -0.000020638955
   RMS gradient:       0.000252294470
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.642976084417 Ha.
     Trial step:       0.509354371370
             Q1:         -30.934799726271
 Quadratic coef:       0.000004697985
 Linear coef   :      -0.000010512542
           Qmin:         -30.934799792615
Quadratic minimum step length (  0.569883606591) accepted
    Initial Ne1:      20.00000006
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -3.093479391171E+01     2.5229E-04     2.2707E-04    -4.0332E-05
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.642948774036 Ha.
      ideal mu1:      -0.540972916949
    5        -3.093479979289E+01     6.9602E-05     6.2642E-05    -5.8812E-06
Finished density kernel iterations (   5)

Writing density kernel to file "ethanol_hybrid_conduction_1.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.09347997928898E+01  Eh
     Estimated bandgap           =   4.2142E-01  Eh
     RMS occupancy error         =   5.3699E-11
     [H,K] commutator            =   6.2642E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       22.66881728147548 |
           | Pseudopot. (local, OBC):         -169.72222573682245 |
           | Pseudopotential (non-local):        3.53521723776360 |
           | Hartree                    :       72.73142424455595 |
           | Exchange-correlation       :       -7.33359653932970 |
           | Hartree-Fock exchange      :       -1.64294877403647 |
           | Ion-ion (open BC)          :       48.82851249350384 |
           | Total                      :      -30.93479979288979 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -169.72222573682510 |
           | Hartree                    :       72.73142424455725 |
           --------------------------------------------------------
           Integrated density           :       19.99999999999924
           Integrated density tr(KS)    :       20.00000000000000
================================================================================

WARNING: maximum number of NGWF CG iterations (   1) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00141599833022    -30.93479979288975  <-- CG                                 
 
<QC>        [NGWF iterations]:                      1
<QC>           [total_energy]:       -30.934799792890
<QC>           [rms_gradient]:         0.001415998330
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       1 [0]
  + B:       3 [1]
  + B:       6 [3]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       2 [0]
  + B:       9 [3]
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.642948773966 Ha.
<QC>      [atom_1_population]:         4.962652781125
<QC>          [atom_1_charge]:        -0.962652781125
<QC>      [atom_2_population]:         4.389332282156
<QC>          [atom_2_charge]:        -0.389332282156
<QC>      [atom_3_population]:         0.682335924491
<QC>          [atom_3_charge]:         0.317664075509

    Mulliken Atomic Populations
    ---------------------------
Species  Ion    Total   Charge (e)
==================================
  C      1       4.963     -0.963
  C      2       4.389     -0.389
  H      3       0.682      0.318
  H      4       0.700      0.300
  H      5       0.673      0.327
  H      6       0.705      0.295
  H      7       0.663      0.337
  O      8       6.750     -0.750
  H      9       0.475      0.525
==================================

        Bond         Population      Length (bohr)
==================================================
 O     8 -- H     9        0.52      1.84493
 C     1 -- H     5        0.79      2.08042
 C     1 -- H     3        0.78      2.08234
 C     2 -- H     7        0.80      2.08290
 C     1 -- H     4        0.80      2.08602
 C     2 -- H     6        0.81      2.09602
 C     2 -- O     8        0.47      2.71065
 C     1 -- C     2        0.61      2.87759
 H     3 -- H     4       -0.10      3.35871
 H     6 -- H     7       -0.14      3.36066
 H     4 -- H     5       -0.11      3.37395
 H     3 -- H     5       -0.09      3.37899
 C     2 -- H     9       -0.19      3.70086
 H     7 -- O     8       -0.13      3.82342
 H     6 -- O     8       -0.12      3.96725
 C     2 -- H     5       -0.13      4.09761
 C     2 -- H     4       -0.13      4.10675
 C     1 -- H     7       -0.14      4.11071
 C     1 -- H     6       -0.17      4.11094
 C     2 -- H     3       -0.11      4.12605
 H     6 -- H     9       -0.03      4.47518
 C     1 -- O     8       -0.16      4.64596
 H     4 -- H     9       -0.00      4.69560
 H     5 -- H     7       -0.04      4.75889
 H     3 -- H     6       -0.01      4.76093
 H     4 -- H     6       -0.03      4.79394
 H     3 -- H     7       -0.02      4.81180
 C     1 -- H     9       -0.04      4.92219
 H     5 -- O     8       -0.01      5.13642
 H     4 -- O     8       -0.02      5.20578
 H     7 -- H     9        0.04      5.35231
 H     5 -- H     9       -0.00      5.59181
==================================================


=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      18
   Number of occupied orbitals:      10.000000000
   Occupancy sum (eigenvalues):      10.000000000
                 HOMO-LUMO gap:       0.421423290 Eh
                 Mid-gap level:      -0.082650762 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.023715913   1.0000000
                            2    -0.790537714   1.0000000
                            3    -0.656461772   1.0000000
                            4    -0.522400653   1.0000000
                            5    -0.481628833   1.0000000
                            6    -0.466187958   1.0000000
                            7    -0.418885220   1.0000000
                            8    -0.404430269   1.0000000
                            9    -0.352118726   0.9999999
                           10    -0.293362407   0.9999998
                        .......   --- gap ---   .........
                           11     0.128060883   0.0000002
                           12     0.181714376   0.0000001
                           13     0.188698464   0.0000000
                           14     0.214509172   0.0000000
                           15     0.238061927   0.0000000
                           16     0.289867471   0.0000000
                           17     0.301221185   0.0000000
                           18     0.313127899   0.0000000
 
<QC>    [energy_eigenvalue_1]:        -1.023715912968
<QC>    [energy_eigenvalue_n]:         0.313127899065
<QC>            [occupancy_1]:         0.999999995552
<QC>            [occupancy_n]:         0.000000032561

================================================================================

===================== Writing canonical molecular orbitals =====================
| Orbital  Energy (eV)  Norm     |
| HOMO-5  -13.10578741  1.000000 | 
| HOMO-4  -12.68561983  1.000000 | 
| HOMO-3  -11.39844682  1.000000 | 
| HOMO-2  -11.00510761  1.000000 | 
| HOMO-1   -9.58163807  1.000000 | 
| HOMO     -7.98279729  1.000000 | 
| LUMO      3.48471393  1.000000 | 
| LUMO+1    4.94469978  1.000000 | 
| LUMO+2    5.13474647  1.000000 | 
| LUMO+3    5.83709157  1.000000 | 
| LUMO+4    6.47799465  1.000000 | 
| LUMO+5    7.88769523  1.000000 | 
================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "ethanol_hybrid_conduction_1_DOS.txt" ...  done
================================================================================
 
Writing bands to file "ethanol_hybrid_conduction_1.val_bands" ... done
SWX: Destroying [val%hfx_swex]... done

Cleaning up after remote NGWF capability... done. 
SWX: Clean-up... done.
SWRI: Clean-up... done.

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:      54.728s on      4 proc(s)                                    
TOTAL TIME:        54.729s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| hfx_determine_my_d_atoms             :     4        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| hfx_split_pair_list                  :     4        0.00s   0.000%  ------ ||
|| hfx_determine_my_a_atoms             :     4        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_BA]      :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_AB]      :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[DKNBLKS_AB]        :     1        0.00s   0.000%  ------ ||
|| hfx_main_comms_imbalance             :    22        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                :    25        0.00s   0.000%  ------ ||
|| swri_metric_mat_cheb_gen_nodes       :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[COEFFS]            :     5        0.00s   0.000%  ------ ||
|| hfx_determine_ppd_list               :     4        0.00s   0.000%  ------ ||
|| hash_table_purge_[VMETRIC]           :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[ALISTS]            :     5        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_consistency          :     9        0.00s   0.000%  ------ ||
|| swri_metric_mat_oc_work_imbalance    :     2        0.00s   0.000%  ------ ||
|| hf_exchange_calculate_imbalance      :    22        0.00s   0.001%  ------ ||
|| neighbour_list_populate              :     5        0.00s   0.001%  ------ ||
|| hfx_all_ad_for_this_b_store          :    60        0.00s   0.001%  ------ ||
|| hfx_determine_alists                 :     4        0.00s   0.001%  ------ ||
|| hash_table_purge_[AKETS_DKN_LOC]     :     2        0.00s   0.001%  ------ ||
|| swri_metric_mat_wait_req_master      :     9        0.00s   0.006%  ------ || (1 procs only)
|| swri_metric_mat_wait_send            :     9        0.00s   0.001%  ------ ||
|| hash_table_purge_[TILES]             :     1        0.00s   0.001%  ------ ||
|| hash_table_purge_[AKETS_DKN_MY]      :     2        0.00s   0.002%  ------ ||
|| hash_table_purge_[DKNBLKS_CD]        :    22        0.00s   0.002%  ------ ||
|| basis_extract_function_from_box      :    18        0.00s   0.002%  ------ ||
|| swri_metric_mat_allocs               :     1        0.00s   0.002%  ------ ||
|| hfx_determine_bc_pairs               :     4        0.00s   0.002%  ------ ||
|| hash_table_purge_[DLISTS]            :     5        0.00s   0.002%  ------ ||
|| restart_kernel_write                 :     3        0.00s   0.002%  ------ ||
|| remote_pack_ngwf                     :    72        0.00s   0.003%  ------ ||
|| swri_metric_mat_RSH_rotation         :     9        0.00s   0.003%  ------ ||
|| hfx_comms_xmatrix_imbalance          :    22        0.00s   0.003%  ------ ||
|| swri_vmatrixblock_sc                 :    95        0.00s   0.003%  ------ ||
|| hash_table_purge_[SWOPS_IN_PPDS]     :     3        0.00s   0.003%  ------ ||
|| hash_table_purge_[NGWFS]             :    11        0.00s   0.004%  ------ ||
|| hash_table_purge_[XAB]               :    22        0.00s   0.004%  ------ ||
|| pseudopotentials_nonlocal_mat        :     4        0.00s   0.005%  ------ ||
|| remote_obtain_matrix_block           :    81        0.00s   0.005%  ------ ||
|| hash_table_purge_[PPD_NGWFS_DD]      :     5        0.00s   0.007%  ------ ||
|| hfx_determine_dlists                 :     4        0.00s   0.007%  ------ ||
|| hfx_comms_gradient_imbalance         :     2        0.00s   0.007%  ------ ||
|| hfx_contract_over_dkn_cc_dkn_get     :   445        0.00s   0.007%  ------ ||
|| ngwf_gradient_coeffs                 :     1        0.00s   0.007%  ------ ||
|| hfx_comms_metric                     :     4        0.00s   0.009%  ------ ||
|| swri_metric_mat_wait_req_worker      :    10        0.01s   0.012%  ------ || (3 procs only)
|| hfx_determine_a_ppd_list_for_b       :    99        0.01s   0.011%  ------ ||
|| hash_table_purge_[SWOP_HITS]         :     1        0.01s   0.013%  ------ ||
|| sparse_init                          :     1        0.01s   0.018%  ------ ||
|| restart_ngwfs_tightbox_output        :     1        0.01s   0.019%  ------ ||
|| function_ops_brappd_ketppd           :     4        0.01s   0.025%  ------ ||
|| hfx_populate_swop_cache_imbalance    :     2        0.01s   0.026%  ------ ||
|| swri_metric_mat_symmetry             :     1        0.01s   0.026%  ------ ||
|| hash_table_list                      :   240        0.01s   0.026%  ------ ||
|| hash_table_purge_[EXPANSIONS]        :     6        0.02s   0.028%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     4        0.02s   0.028%  ------ ||
|| dense_eigensolve                     :     2        0.02s   0.029%  ------ ||
|| hash_table_purge_[PPD_PRODUCTS]      :     5        0.02s   0.032%  ------ ||
|| swri_build_matrix_2                  :   121        0.02s   0.036%  ------ ||
|| hfx_grad_ket_dkn_baccum              :     2        0.02s   0.036%  ------ ||
|| swri_metric_mat_dispatch             :  7142        0.02s   0.040%  ------ ||
|| hfx_gradient_term2_qexpand3          :   162        0.03s   0.049%  ------ ||
|| kernel_purify                        :    32        0.03s   0.053%  ------ ||
|| hfx_gradient_term2_imbal             :     1        0.03s   0.054%  ------ ||
|| projectors_init_fftbox_recip         :     5        0.03s   0.057%  ------ ||
|| remote_obtain_ngwf                   :   236        0.03s   0.062%  ------ ||
|| remote_unpack_ngwf_no_sphere         :  2856        0.03s   0.063%  ------ ||
|| swri_metric_mat_home_sws             :     1        0.04s   0.065%  ------ ||
|| lnv_gradient_norm                    :    10        0.04s   0.066%  ------ ||
|| hfx_comms_ngwfs                      :    16        0.04s   0.071%  ------ ||
|| hash_table_free                      :    67        0.05s   0.091%  ------ ||
|| projectors_func_ovlp_box             :     4        0.06s   0.103%  ------ ||
|| hfx_populate_swop_cache_bookkeeping  :     1        0.06s   0.105%  ------ ||
|| sparse_trace                         :   464        0.06s   0.107%  ------ ||
|| hfx_gradient_term2_part0             :     9        0.06s   0.108%  ------ ||
|| kernel_fix                           :    10        0.06s   0.111%  ------ ||
|| basis_dot_function_with_box          :  1359        0.07s   0.119%  ------ ||
|| hfx_comms_gradient                   :     2        0.07s   0.120%  ------ ||
|| linalg_dgesv                         :   454        0.09s   0.160%  ------ ||
|| fourier_apply_box_pair               :    37        0.09s   0.171%  35.550 ||
|| projectors_gradient_batch            :     1        0.09s   0.173%  ------ ||
|| eigenstates_calculate                :     1        0.10s   0.174%  ------ ||
|| remote_obtain_dkn_block              :  1856        0.10s   0.189%  ------ ||
|| hfx_accum_q_beta                     :   364        0.11s   0.192%  ------ ||
|| hfx_comms_xmatrix                    :    22        0.11s   0.201%  ------ ||
|| hfx_populate_swop_cache_sort         :     1        0.12s   0.211%  ------ ||
|| basis_copy_function_to_box           :   247        0.12s   0.216%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.12s   0.221%  ------ ||
|| basis_add_function_to_box            :  2106        0.13s   0.235%  ------ ||
|| hfx_comms_dkn                        :    25        0.13s   0.239%  ------ ||
|| sparse_product                       :   489        0.14s   0.250%  ------ ||
|| integrals_kinetic                    :     4        0.14s   0.258%  ------ ||
|| remote_unpack_ngwf                   :  3023        0.16s   0.290%  ------ ||
|| cc_interaction_on_recip              :     1        0.16s   0.295%  ------ ||
|| swri_metric_mat_cheb_expand          :   810        0.16s   0.296%  ------ ||
|| hfx_gradient_term2_part2             :    18        0.18s   0.323%  ------ ||
|| swri_metric_mat_eval_swpot           :   810        0.18s   0.324%  ------ ||
|| density_init_guess_real              :     1        0.18s   0.325%  ------ ||
|| swri_metric_mat_cheb_int_product     : 36855        0.18s   0.338%  ------ ||
|| hfx_main_work_imbalance              :    22        0.19s   0.342%  ------ ||
|| density_batch_row_sums               :    22        0.19s   0.355%  ------ ||
|| integrals_locpot_mat_els_batch       :    14        0.20s   0.373%  ------ ||
|| hfx_calc_aa_dd_ngwf_prod_in_ppd      : 109.0k       0.22s   0.408%  ------ ||
|| pseudo_make_structure_factor         :     1        0.25s   0.448%  ------ ||
|| hfx_calc_p_ac                        :    81        0.27s   0.498%  ------ ||
|| cell_grid_extract_box_real           :   113        0.28s   0.516%  ------ ||
|| hfx_gradient_term2_part1             :     9        0.30s   0.544%  ------ ||
|| energy_and_force_init_cell           :     1        0.31s   0.570%  ------ ||
|| hfx_calc_aa_dd_ngwf_prods_in_ppds    :     4        0.35s   0.640%  ------ ||
|| swri_swop_calc_all_in_ppd_fast       :  2200        0.37s   0.675%  ------ ||
|| hfx_main_ngwf_grad1                  :     1        0.41s   0.757%  ------ ||
|| hfx_populate_swop_cache_calc         :     1        0.45s   0.831%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.51s   0.935%  ------ ||
|| hfx_contract_over_dkn_cc_expa_get    :   445        0.55s   1.010%  ------ ||
|| density_fftbox_deposit_to_cell       :   110        0.59s   1.087%  ------ ||
|| internal_tile_by_chebs               :     9        0.60s   1.103%  ------ ||
|| hfx_populate_swop_cache              :     1        0.63s   1.159%  ------ ||
|| swri_metric_mat_main_loop            :     1        0.64s   1.167%  ------ ||
|| cell_grid_deposit_box_real           :   198        0.66s   1.211%  ------ ||
|| ngwf_gradient_build_batch            :     1        0.70s   1.288%  ------ ||
|| swri_metric_mat_oc                   :     1        0.71s   1.299%  ------ ||
|| swri_init_container_stage_2          :     1        0.71s   1.301%  ------ ||
|| hfx_gradient                         :     2        0.73s   1.332%  ------ ||
|| hfx_calc_expansion_for_q             :   162        0.73s   1.335%  ------ ||
|| hfx_gradient_term2_qexpand2          :   162        0.73s   1.337%  ------ ||
|| hfx_all_ad_for_this_b_main           :    60        0.79s   1.443%  ------ ||
|| hfx_all_ad_for_this_b                :    60        0.79s   1.445%  ------ ||
|| ngwf_gradient_batch                  :     1        0.93s   1.692%  ------ ||
|| hfx_contract_over_dkn_cc_main        :   445        0.97s   1.775%  ------ ||
|| hfx_dkn_indep_preparation            :     4        1.04s   1.894%  ------ ||
|| swx_my_ngwf_pair_fitting             :     4        1.40s   2.561%  ------ ||
|| swx_expand_my_ngwf_pairs             :     4        1.40s   2.561%  ------ ||
|| hfx_expand_ngwf_pairs                :     4        1.43s   2.609%  ------ ||
|| hfx_contract_over_dkn_cc             :    60        1.66s   3.038%  ------ ||
|| properties_calculate                 :     1        1.71s   3.119%  ------ ||
|| hamiltonian_energy_components        :     1        1.84s   3.354%  ------ ||
|| hfx_gradient_term2_qexpand           :   162        1.94s   3.543%  ------ ||
|| xc_energy_potential                  :    23        2.22s   4.048%  ------ ||
|| hfx_gradient_term2_part3             :    18        2.73s   4.982%  ------ ||
|| swx_swop_quantity_overlap_ppd_fast   :   454        3.13s   5.726%  ------ ||
|| swx_expansion_2_fast                 :   454        3.26s   5.955%  ------ ||
|| hfx_gradient_term2                   :     1        3.29s   6.017%  ------ ||
|| hfx_calc_expansions_bb_cc            :   648        3.64s   6.657%  ------ ||
|| hfx_main_ngwf_grad2                  :     1        3.68s   6.718%  ------ ||
|| potential_apply_to_ngwf_batch        :    14        4.48s   8.186%  ------ ||
|| integrals_locpot_dbl_grid            :    14        4.70s   8.586%  ------ ||
|| fourier_apply_box                    :   383        5.19s   9.482%  32.267 ||
|| ngwf_gradient_lnv                    :     1        5.26s   9.608%  ------ ||
|| density_fftbox_interpolate_multiply  :   110        5.43s   9.918%  ------ ||
|| density_batch_interp_deposit         :    22        6.68s  12.205%  ------ ||
|| sw_init                              :     1        6.99s  12.776%  ------ ||
|| density_on_dbl_grid                  :    22        7.10s  12.974%  ------ ||
|| fourier_apply_cell_backward          :   116        7.54s  13.780%   9.972 ||
|| fourier_apply_cell_forward           :   115        7.84s  14.317%   9.250 ||
|| hfx_main                             :    22       10.54s  19.262%  ------ ||
|| hf_exchange_calculate                :    22       10.70s  19.549%  ------ ||
|| hartree_on_grid                      :    23       14.07s  25.712%  ------ ||
|| hamiltonian_lhxc_calculate           :    21       23.80s  43.483%  ------ ||
|| lnv_denskernel_optimise_cg           :     2       28.31s  51.733%  ------ ||
|| ngwf_cg_optimise                     :     1       41.31s  75.483%  ------ ||
|| energy_and_forces                    :     1       54.17s  98.988%  ------ ||
|| total_time                           :     1       54.73s 100.000%  ------ ||
================================================================================
==================== AVERAGE TIMINGS FROM ALL PROCS (SELF) =====================
++ TAG                                    #calls    cpu time   %total  Gflops ++
++ hfx_populate_swop_cache              :     1        0.00s   0.000%  ------ ++
++ hfx_determine_my_d_atoms             :     4        0.00s   0.000%  ------ ++
++ onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ++
++ hfx_split_pair_list                  :     4        0.00s   0.000%  ------ ++
++ hfx_determine_my_a_atoms             :     4        0.00s   0.000%  ------ ++
++ hfx_main_ngwf_grad1                  :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[TCDKNBLKS_BA]      :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[TCDKNBLKS_AB]      :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[DKNBLKS_AB]        :     1        0.00s   0.000%  ------ ++
++ hfx_main_comms_imbalance             :    22        0.00s   0.000%  ------ ++
++ sparse_set_to_garbage                :    25        0.00s   0.000%  ------ ++
++ swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ++
++ swri_metric_mat_cheb_gen_nodes       :     1        0.00s   0.000%  ------ ++
++ hfx_determine_ppd_list               :     4        0.00s   0.000%  ------ ++
++ swx_expand_my_ngwf_pairs             :     4        0.00s   0.000%  ------ ++
++ hash_table_purge_[COEFFS]            :     5        0.00s   0.000%  ------ ++
++ hash_table_purge_[VMETRIC]           :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[ALISTS]            :     5        0.00s   0.000%  ------ ++
++ onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ++
++ hfx_main_ngwf_grad2                  :     1        0.00s   0.000%  ------ ++
++ swri_metric_mat_consistency          :     9        0.00s   0.000%  ------ ++
++ swri_metric_mat_oc_work_imbalance    :     2        0.00s   0.000%  ------ ++
++ hfx_all_ad_for_this_b                :    60        0.00s   0.000%  ------ ++
++ ngwf_gradient_coeffs                 :     1        0.00s   0.001%  ------ ++
++ hfx_determine_alists                 :     4        0.00s   0.001%  ------ ++
++ hf_exchange_calculate_imbalance      :    22        0.00s   0.001%  ------ ++
++ swri_metric_mat_wait_req_master      :     9        0.00s   0.003%  ------ ++ (1 procs only)
++ hfx_gradient_term2_qexpand2          :   162        0.00s   0.001%  ------ ++
++ neighbour_list_populate              :     5        0.00s   0.001%  ------ ++
++ sparse_embed_hotelling_invert_embed  :     4        0.00s   0.001%  ------ ++
++ hfx_all_ad_for_this_b_store          :    60        0.00s   0.001%  ------ ++
++ pseudopotentials_nonlocal_mat        :     4        0.00s   0.001%  ------ ++
++ hash_table_purge_[AKETS_DKN_LOC]     :     2        0.00s   0.001%  ------ ++
++ swri_metric_mat_wait_send            :     9        0.00s   0.001%  ------ ++
++ hash_table_purge_[TILES]             :     1        0.00s   0.001%  ------ ++
++ hash_table_purge_[AKETS_DKN_MY]      :     2        0.00s   0.002%  ------ ++
++ hash_table_purge_[DKNBLKS_CD]        :    22        0.00s   0.002%  ------ ++
++ swri_init_container_stage_2          :     1        0.00s   0.002%  ------ ++
++ basis_extract_function_from_box      :    18        0.00s   0.002%  ------ ++
++ hfx_gradient_term2_qexpand           :   162        0.00s   0.002%  ------ ++
++ swri_metric_mat_allocs               :     1        0.00s   0.002%  ------ ++
++ hfx_determine_bc_pairs               :     4        0.00s   0.002%  ------ ++
++ hash_table_purge_[DLISTS]            :     5        0.00s   0.002%  ------ ++
++ restart_kernel_write                 :     3        0.00s   0.002%  ------ ++
++ hfx_comms_metric                     :     4        0.00s   0.003%  ------ ++
++ remote_pack_ngwf                     :    72        0.00s   0.003%  ------ ++
++ swri_metric_mat_RSH_rotation         :     9        0.00s   0.003%  ------ ++
++ hfx_comms_xmatrix_imbalance          :    22        0.00s   0.003%  ------ ++
++ swri_vmatrixblock_sc                 :    95        0.00s   0.003%  ------ ++
++ hash_table_purge_[SWOPS_IN_PPDS]     :     3        0.00s   0.003%  ------ ++
++ hfx_determine_dlists                 :     4        0.00s   0.004%  ------ ++
++ hash_table_purge_[NGWFS]             :    11        0.00s   0.004%  ------ ++
++ hash_table_purge_[XAB]               :    22        0.00s   0.004%  ------ ++
++ hfx_dkn_indep_preparation            :     4        0.00s   0.005%  ------ ++
++ remote_obtain_matrix_block           :    81        0.00s   0.005%  ------ ++
++ hash_table_purge_[PPD_NGWFS_DD]      :     5        0.00s   0.007%  ------ ++
++ hfx_comms_gradient_imbalance         :     2        0.00s   0.007%  ------ ++
++ hfx_gradient_term2                   :     1        0.00s   0.007%  ------ ++
++ hfx_contract_over_dkn_cc_dkn_get     :   445        0.00s   0.007%  ------ ++
++ swri_metric_mat_wait_req_worker      :    10        0.01s   0.010%  ------ ++ (3 procs only)
++ kernel_fix                           :    10        0.00s   0.008%  ------ ++
++ hfx_comms_ngwfs                      :    16        0.01s   0.009%  ------ ++
++ hfx_determine_a_ppd_list_for_b       :    99        0.01s   0.010%  ------ ++
++ hash_table_purge_[SWOP_HITS]         :     1        0.01s   0.013%  ------ ++
++ properties_calculate                 :     1        0.01s   0.015%  ------ ++
++ sparse_init                          :     1        0.01s   0.018%  ------ ++
++ kernel_purify                        :    32        0.01s   0.018%  ------ ++
++ hf_exchange_calculate                :    22        0.01s   0.019%  ------ ++
++ restart_ngwfs_tightbox_output        :     1        0.01s   0.019%  ------ ++
++ lnv_gradient_norm                    :    10        0.01s   0.019%  ------ ++
++ function_ops_brappd_ketppd           :     4        0.01s   0.025%  ------ ++
++ hfx_populate_swop_cache_imbalance    :     2        0.01s   0.026%  ------ ++
++ swri_metric_mat_symmetry             :     1        0.01s   0.026%  ------ ++
++ hash_table_list                      :   240        0.01s   0.026%  ------ ++
++ integrals_locpot_dbl_grid            :    14        0.01s   0.027%  ------ ++
++ hash_table_purge_[EXPANSIONS]        :     6        0.02s   0.028%  ------ ++
++ dense_eigensolve                     :     2        0.02s   0.029%  ------ ++
++ swx_my_ngwf_pair_fitting             :     4        0.02s   0.032%  ------ ++
++ hash_table_purge_[PPD_PRODUCTS]      :     5        0.02s   0.032%  ------ ++
++ swri_build_matrix_2                  :   121        0.02s   0.032%  ------ ++
++ swri_metric_mat_oc                   :     1        0.02s   0.032%  ------ ++
++ hfx_grad_ket_dkn_baccum              :     2        0.02s   0.036%  ------ ++
++ ngwf_cg_optimise                     :     1        0.02s   0.036%  ------ ++
++ swri_metric_mat_main_loop            :     1        0.02s   0.038%  ------ ++
++ eigenstates_calculate                :     1        0.02s   0.038%  ------ ++
++ swri_metric_mat_dispatch             :  7142        0.02s   0.040%  ------ ++
++ hfx_gradient_term2_part3             :    18        0.02s   0.040%  ------ ++
++ hfx_main                             :    22        0.02s   0.044%  ------ ++
++ hfx_gradient_term2_part0             :     9        0.03s   0.046%  ------ ++
++ hash_table_free                      :    67        0.03s   0.047%  ------ ++
++ projectors_func_ovlp_box             :     4        0.03s   0.047%  ------ ++
++ hfx_expand_ngwf_pairs                :     4        0.03s   0.048%  ------ ++
++ hfx_gradient_term2_qexpand3          :   162        0.03s   0.049%  ------ ++
++ hfx_comms_dkn                        :    25        0.03s   0.050%  ------ ++
++ hfx_gradient_term2_part1             :     9        0.03s   0.052%  ------ ++
++ hfx_gradient_term2_imbal             :     1        0.03s   0.054%  ------ ++
++ projectors_init_fftbox_recip         :     5        0.03s   0.057%  ------ ++
++ remote_obtain_ngwf                   :   236        0.03s   0.059%  ------ ++
++ remote_unpack_ngwf_no_sphere         :  2856        0.03s   0.063%  ------ ++
++ swri_metric_mat_home_sws             :     1        0.04s   0.065%  ------ ++
++ swx_expansion_2_fast                 :   454        0.04s   0.069%  ------ ++
++ hfx_gradient_term2_part2             :    18        0.05s   0.100%  ------ ++
++ hfx_populate_swop_cache_bookkeeping  :     1        0.06s   0.104%  ------ ++
++ sparse_trace                         :   464        0.06s   0.107%  ------ ++
++ hfx_comms_gradient                   :     2        0.06s   0.113%  ------ ++
++ projectors_gradient_batch            :     1        0.06s   0.117%  ------ ++
++ basis_dot_function_with_box          :  1359        0.07s   0.119%  ------ ++
++ hfx_populate_swop_cache_calc         :     1        0.07s   0.119%  ------ ++
++ integrals_kinetic                    :     4        0.07s   0.119%  ------ ++
++ ngwf_gradient_lnv                    :     1        0.08s   0.149%  ------ ++
++ linalg_dgesv                         :   454        0.09s   0.160%  ------ ++
++ hfx_populate_swop_cache_sort         :     1        0.09s   0.170%  ------ ++
++ fourier_apply_box_pair               :    37        0.09s   0.171%  35.550 ++
++ density_batch_row_sums               :    22        0.10s   0.183%  ------ ++
++ lnv_denskernel_optimise_cg           :     2        0.10s   0.186%  ------ ++
++ remote_obtain_dkn_block              :  1856        0.10s   0.189%  ------ ++
++ hfx_accum_q_beta                     :   364        0.11s   0.192%  ------ ++
++ hfx_comms_xmatrix                    :    22        0.11s   0.198%  ------ ++
++ density_init_guess_real              :     1        0.11s   0.203%  ------ ++
++ basis_copy_function_to_box           :   247        0.12s   0.216%  ------ ++
++ ngwfs_initialise_from_radial         :     1        0.12s   0.221%  ------ ++
++ internal_tile_by_chebs               :     9        0.12s   0.225%  ------ ++
++ basis_add_function_to_box            :  2106        0.13s   0.235%  ------ ++
++ hamiltonian_energy_components        :     1        0.13s   0.236%  ------ ++
++ energy_and_forces                    :     1        0.13s   0.243%  ------ ++
++ hfx_contract_over_dkn_cc             :    60        0.13s   0.246%  ------ ++
++ sparse_product                       :   489        0.14s   0.250%  ------ ++
++ energy_and_force_init_cell           :     1        0.15s   0.275%  ------ ++
++ density_fftbox_deposit_to_cell       :   110        0.15s   0.279%  ------ ++
++ integrals_locpot_mat_els_batch       :    14        0.15s   0.281%  ------ ++
++ remote_unpack_ngwf                   :  3023        0.16s   0.290%  ------ ++
++ cc_interaction_on_recip              :     1        0.16s   0.295%  ------ ++
++ swri_metric_mat_cheb_expand          :   810        0.16s   0.296%  ------ ++
++ swri_metric_mat_eval_swpot           :   810        0.18s   0.324%  ------ ++
++ swri_metric_mat_cheb_int_product     : 36855        0.18s   0.338%  ------ ++
++ ngwf_gradient_batch                  :     1        0.19s   0.341%  ------ ++
++ hfx_main_work_imbalance              :    22        0.19s   0.342%  ------ ++
++ pseudopotentials_local_on_grid       :     1        0.22s   0.407%  ------ ++
++ hfx_calc_aa_dd_ngwf_prod_in_ppd      : 109.0k       0.22s   0.408%  ------ ++
++ density_on_dbl_grid                  :    22        0.23s   0.414%  ------ ++
++ hfx_calc_aa_dd_ngwf_prods_in_ppds    :     4        0.24s   0.434%  ------ ++
++ main_program_(onetep.F90)            :     1        0.24s   0.438%  ------ ++
++ ngwf_gradient_build_batch            :     1        0.24s   0.446%  ------ ++
++ pseudo_make_structure_factor         :     1        0.25s   0.448%  ------ ++
++ hfx_calc_p_ac                        :    81        0.27s   0.498%  ------ ++
++ cell_grid_extract_box_real           :   113        0.28s   0.516%  ------ ++
++ swri_swop_calc_all_in_ppd_fast       :  2200        0.37s   0.675%  ------ ++
++ hfx_all_ad_for_this_b_main           :    60        0.54s   0.992%  ------ ++
++ hfx_contract_over_dkn_cc_expa_get    :   445        0.55s   1.010%  ------ ++
++ xc_energy_potential                  :    23        0.57s   1.048%  ------ ++
++ hartree_on_grid                      :    23        0.63s   1.144%  ------ ++
++ cell_grid_deposit_box_real           :   198        0.66s   1.211%  ------ ++
++ hfx_gradient                         :     2        0.69s   1.262%  ------ ++
++ hfx_calc_expansion_for_q             :   162        0.73s   1.335%  ------ ++
++ density_batch_interp_deposit         :    22        0.86s   1.574%  ------ ++
++ hfx_contract_over_dkn_cc_main        :   445        0.97s   1.775%  ------ ++
++ potential_apply_to_ngwf_batch        :    14        1.94s   3.541%  ------ ++
++ hamiltonian_lhxc_calculate           :    21        1.96s   3.587%  ------ ++
++ density_fftbox_interpolate_multiply  :   110        1.98s   3.611%  ------ ++
++ swx_swop_quantity_overlap_ppd_fast   :   454        3.13s   5.726%  ------ ++
++ hfx_calc_expansions_bb_cc            :   648        3.64s   6.657%  ------ ++
++ fourier_apply_box                    :   383        5.19s   9.482%  32.267 ++
++ sw_init                              :     1        6.99s  12.776%  ------ ++
++ fourier_apply_cell_backward          :   116        7.54s  13.780%   9.972 ++
++ fourier_apply_cell_forward           :   115        7.84s  14.317%   9.250 ++
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 1 ms ensuring consistency across MPI ranks,
- 5 ms printing in order.

Job completed: 27-09-2022 10:05 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
