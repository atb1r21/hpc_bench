==================================================================================
It's Tue Sep 27 10:05:46 BST 2022.
*** Starting onetep_launcher (node uos-219041, PIDs 13136 13137 13138 13139)...
    - ONETEP arguments: ethanol_hybrid_conduction_2.dat
    - Current directory: /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/tests/test69
    - Launcher executable directory: /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/onetep.* -> no matches
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79 -> /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/tests/test69/onetep.* -> no matches
      ... resolving /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/tests/test69/../bin/onetep.* -> no matches
      ... trying /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 2
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /local/scratch/jd12g09/comp/QC/QC_6_1____retreat_F2008/utils/../bin/onetep.RH79 ethanol_hybrid_conduction_2.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE environment variable is not supported.
[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE environment variable is not supported.
[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE environment variable is not supported.
[0] MPI startup(): To check the list of supported variables, use the impi_info utility or refer to https://software.intel.com/en-us/mpi-library/documentation/get-started.
 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12.0  |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 27-09-2022 10:05 (+0100)
 
Reading parameters from file "ethanol_hybrid_conduction_2.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 2 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 2
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
               2 threads for loops over batched FFT box operations.
               2 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     O  O  O     |
BC: | Local pseudopotential | pspot_bc [3]    |     O  O  O     |
BC: | Hartree-Fock exchange | hfx_bc          |     O  O  O     |
BC: | Van der Waals         | vdw_bc          |     O  O  O     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.
... done

Reading geometry and species blocks from file "ethanol_hybrid_conduction_2.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
    
  Number of PPD points along a1 set to 7 from input file.
  Number of PPD points along a2 set to 7 from input file.
  Number of PPD points along a3 set to 7 from input file.
    
  PSINC grid spacing along a1 set to   0.476190476190a0 from input file.
  PSINC grid spacing along a2 set to   0.476190476190a0 from input file.
  PSINC grid spacing along a3 set to   0.476190476190a0 from input file.
  Number of PPD points along a1 set to 7 from input file.
  Number of PPD points along a2 set to 7 from input file.
  Number of PPD points along a3 set to 7 from input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

coulomb_cutoff_type SPHERE                                                      
coulomb_cutoff_radius 40.0                                                      
hfx_bc O O O                                                                    
print_qc T                                                                      
output_detail VERBOSE                                                           
timings_level 3                                                                 
%block swri                                                                     
for_hfx 2 10 V 10 10 E                                                          
%endblock swri                                                                  
swri_assembly_prefix ethanol_hybrid_conduction_1                                
%block species_swri-for_hfx                                                     
C                                                                               
H                                                                               
O                                                                               
%endblock species_swri-for_hfx                                                  
hfx_use_ri for_hfx                                                              
hfx_max_l 2                                                                     
hfx_max_q 10                                                                    
hfx_metric ELECTROSTATIC                                                        
hfx_memory_limit 1500                                                           
task                : COND                                                      
cutoff_energy       : 900.0 eV                                                  
do_properties       : T                                                         
xc_functional       : B3LYP                                                     
maxit_pen           : 0                                                         
write_density_plot  : F                                                         
maxit_palser_mano   : -1                                                        
ppd_npoints 7 7 7                                                               
write_denskern            : F                                                   
write_tightbox_ngwfs      : F                                                   
read_denskern             : T                                                   
read_tightbox_ngwfs       : T                                                   
maxit_ngwf_cg             : 1                                                   
cond_num_states           : 18                                                  
cond_calc_max_eigen       : T                                                   
cond_plot_joint_orbitals  : F                                                   
cond_plot_vc_orbitals     : F                                                   
cond_minit_lnv            : 15                                                  
cond_maxit_lnv            : 15                                                  
cond_calc_optical_spectra : F                                                   
cond_spec_print_mat_els   : F                                                   
%BLOCK SPECIES                                                                  
C   C   6   4  8.0                                                              
H   H   1   1  8.0                                                              
O   O   8   4  8.0                                                              
%ENDBLOCK SPECIES                                                               
%BLOCK SPECIES_COND                                                             
C   C   6   13  8.0                                                             
H   H   1    5  8.0                                                             
O   O   8   13  8.0                                                             
%ENDBLOCK SPECIES_COND                                                          
%BLOCK SPECIES_POT                                                              
C "../../pseudo/carbon.recpot"                                                  
H "../../pseudo/hydrogen.recpot"                                                
O "../../pseudo/oxygen.recpot"                                                  
%ENDBLOCK SPECIES_POT                                                           
%block lattice_cart                                                             
30.00000000   0.00000000   0.00000000                                           
0.00000000  30.00000000   0.00000000                                            
0.00000000   0.00000000  30.00000000                                            
%endblock lattice_cart                                                          
%block positions_abs                                                            
     Hash =   000001727411528844452111
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
 ESDF WARNING(1
 ): "coulombcutoffradius" (esdf_physical) has no units. Assume "bohr".
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
File: ../../pseudo/oxygen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 0; rc = 1.31 bohr
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms  Nvalngwfs Ncondngwfs  Nprojs
  C          2         8        26         2
  H          6         6        30         0
  O          1         4        13         1
.......   ......    ......    ......    ......
Totals:      9        18        69         3
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   63 x  63 x  63
                              FFT-box:   63 x  63 x  63
                                  PPD:    7 x   7 x   7
Grid space d1=  0.476190476190a0 (KE cutoff=  33.49983Eh = 911.57673eV)
Grid space d2=  0.476190476190a0 (KE cutoff=  33.49983Eh = 911.57673eV)
Grid space d3=  0.476190476190a0 (KE cutoff=  33.49983Eh = 911.57673eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     63    63    63
          Real-space ('12') slabs/proc (min max mean):     15    16    15
         Recip-space ('23') slabs/proc (min max mean):      8     8     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    126   126   126
          Real-space ('12') slabs/proc (min max mean):     31    32    31
         Recip-space ('23') slabs/proc (min max mean):     16    16    16
********************************************************************************

********************* Fourier parallelisation information **********************
       Padded Grid (whole simulation cell) dimensions:    350   350   350
          Real-space ('12') slabs/proc (min max mean):     87    88    87
         Recip-space ('23') slabs/proc (min max mean):     44    44    44
********************************************************************************

Calculating transform of cutoff Coulomb interaction ... done

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.4069558845   -0.9644877669    4.5135240840   -1.1733979231
  2         -5.0359126314   -1.1382843369    4.3226714159   -1.1289948168
  3         -5.1282594161   -1.1377240508    4.3231865855   -1.1311772726
  4         -5.1305117567   -1.1442897097    4.3160899506   -1.1302832928
  5         -5.1333700816   -1.1469491295    4.3132129356   -1.1300634585
  6         -5.1347019316   -1.1482287186    4.3118281691   -1.1299931466
  7         -5.1352247630   -1.1488659381    4.3111385742   -1.1299709481
  8         -5.1354026025   -1.1491845154    4.3107938893   -1.1299659671
  9         -5.1354462804   -1.1493436051    4.3106218308   -1.1299666955
 10         -5.1354437091   -1.1494229242    4.3105360929   -1.1299687992
 11         -5.1354291929   -1.1494624155    4.3104934349   -1.1299707981
 12         -5.1354176285   -1.1494781256    4.3104764789   -1.1299720111
 13         -5.1354081812   -1.1494875095    4.3104663570   -1.1299729201
 14         -5.1354009151   -1.1494931118    4.3104603180   -1.1299735809
 15         -5.1353955381   -1.1494964547    4.3104567171   -1.1299740509
 16         -5.1353916641   -1.1494984483    4.3104545714   -1.1299743798
 17         -5.1353889271   -1.1494996364    4.3104532937   -1.1299746071
 18         -5.1353870222   -1.1495003441    4.3104525334   -1.1299747625
 19         -5.1353857119   -1.1495007653    4.3104520813   -1.1299748679
 20         -5.1353848191   -1.1495010158    4.3104518127   -1.1299749389
 21         -5.1353842155   -1.1495011646    4.3104516533   -1.1299749864
 22         -5.1353838101   -1.1495012530    4.3104515588   -1.1299750181
 23         -5.1353835393   -1.1495013054    4.3104515028   -1.1299750391
 24         -5.1353833593   -1.1495013365    4.3104514696   -1.1299750530
 25         -5.1353832401   -1.1495013548    4.3104514501   -1.1299750622
 26         -5.1353831615   -1.1495013657    4.3104514385   -1.1299750682
Atom SCF converged after  26 iterations to a total energy of     -5.13538316

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    0  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3079404309   -0.1847796142    0.2820952552   -0.1977712840
  2         -0.3685975256   -0.1881372461    0.2800584768   -0.1985632226
  3         -0.3972336746   -0.1884802615    0.2798203631   -0.1998878628
  4         -0.4080711007   -0.1888189230    0.2794872379   -0.2003449133
  5         -0.4121182830   -0.1890445832    0.2792475199   -0.2004732256
  6         -0.4136581625   -0.1891622406    0.2791188792   -0.2005066556
  7         -0.4142566052   -0.1892169058    0.2790582819   -0.2005150829
  8         -0.4144930958   -0.1892408430    0.2790315521   -0.2005171835
  9         -0.4145876365   -0.1892509919    0.2790201727   -0.2005177108
 10         -0.4146257137   -0.1892552173    0.2790154237   -0.2005178471
 11         -0.4146411214   -0.1892569584    0.2790134641   -0.2005178845
 12         -0.4146473737   -0.1892576715    0.2790126609   -0.2005178957
 13         -0.4146499153   -0.1892579626    0.2790123328   -0.2005178994
 14         -0.4146509496   -0.1892580812    0.2790121992   -0.2005179008
 15         -0.4146513708   -0.1892581294    0.2790121448   -0.2005179014
 16         -0.4146515424   -0.1892581490    0.2790121227   -0.2005179016
 17         -0.4146516123   -0.1892581570    0.2790121137   -0.2005179017
Atom SCF converged after  17 iterations to a total energy of     -0.41465161

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -1.5661537791   -6.8154847894   10.1554291890   -1.9817841195
  2        -16.4386271763   -2.3896369642   13.5944551264   -2.6260758875
  3        -14.9493899685   -2.7563303680   13.2023047998   -2.5596129673
  4        -15.3921207107   -2.6131563355   13.3532703810   -2.5891321659
  5        -15.2222594960   -2.6552654914   13.3087860131   -2.5818429119
  6        -15.2271175148   -2.6512425439   13.3131300524   -2.5830481331
  7        -15.2216500549   -2.6517501961   13.3126321642   -2.5831383761
  8        -15.2189346714   -2.6519101535   13.3124872443   -2.5832257372
  9        -15.2176764698   -2.6519806177   13.3124247517   -2.5832714783
 10        -15.2168206977   -2.6520315048   13.3123793018   -2.5833032826
 11        -15.2162363429   -2.6520687088   13.3123457720   -2.5833252807
 12        -15.2158365778   -2.6520959446   13.3123210089   -2.5833404663
 13        -15.2155628281   -2.6521158316   13.3123027835   -2.5833509437
 14        -15.2153752610   -2.6521302990   13.3122894320   -2.5833581733
 15        -15.2152466902   -2.6521407840   13.3122796964   -2.5833631637
 16        -15.2151585280   -2.6521483559   13.3122726278   -2.5833666101
 17        -15.2150980548   -2.6521538066   13.3122675152   -2.5833689914
 18        -15.2150565616   -2.6521577191   13.3122638299   -2.5833706378
 19        -15.2150280827   -2.6521605203   13.3122611815   -2.5833717766
 20        -15.2150085303   -2.6521625211   13.3122592834   -2.5833725649
 21        -15.2149951026   -2.6521639474   13.3122579264   -2.5833731107
 22        -15.2149858783   -2.6521649621   13.3122569582   -2.5833734889
 23        -15.2149795399   -2.6521656828   13.3122562689   -2.5833737512
 24        -15.2149751832   -2.6521661938   13.3122557790   -2.5833739330
 25        -15.2149721879   -2.6521665557   13.3122554314   -2.5833740592
 26        -15.2149701280   -2.6521668116   13.3122551851   -2.5833741469
 27        -15.2149687110   -2.6521669923   13.3122550109   -2.5833742077
 28        -15.2149677359   -2.6521671198   13.3122548877   -2.5833742500
 29        -15.2149670649   -2.6521672097   13.3122548009   -2.5833742795
 30        -15.2149666029   -2.6521672730   13.3122547396   -2.5833742999
 31        -15.2149662848   -2.6521673175   13.3122546964   -2.5833743142
 32        -15.2149660657   -2.6521673487   13.3122546661   -2.5833743241
 33        -15.2149659148   -2.6521673707   13.3122546447   -2.5833743310
 34        -15.2149658108   -2.6521673861   13.3122546297   -2.5833743358
 35        -15.2149657391   -2.6521673969   13.3122546192   -2.5833743391
Atom SCF converged after  35 iterations to a total energy of    -15.21496574

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  5     2.00 2.00 0.00 0.00 0.00
Orbitals   (num,l):  5        0    1    0    1    2
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   49    2  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
Confining potential (l,width,scale):  2    3.0000000000  100.0000000000
  1         -5.4069558845   -0.9644877669    4.5135240840   -1.1733979231
  2         -5.0359126314   -1.1382843369    4.3226714159   -1.1289948168
  3         -5.1282594161   -1.1377240508    4.3231865855   -1.1311772726
  4         -5.1305117567   -1.1442897097    4.3160899506   -1.1302832928
  5         -5.1333700816   -1.1469491295    4.3132129356   -1.1300634585
  6         -5.1347019316   -1.1482287186    4.3118281691   -1.1299931466
  7         -5.1352247630   -1.1488659381    4.3111385742   -1.1299709481
  8         -5.1354026025   -1.1491845154    4.3107938893   -1.1299659671
  9         -5.1354462804   -1.1493436051    4.3106218308   -1.1299666955
 10         -5.1354437091   -1.1494229242    4.3105360929   -1.1299687992
 11         -5.1354291929   -1.1494624155    4.3104934349   -1.1299707981
 12         -5.1354176285   -1.1494781256    4.3104764789   -1.1299720111
 13         -5.1354081812   -1.1494875095    4.3104663570   -1.1299729201
 14         -5.1354009151   -1.1494931118    4.3104603180   -1.1299735809
 15         -5.1353955381   -1.1494964547    4.3104567171   -1.1299740509
 16         -5.1353916641   -1.1494984483    4.3104545714   -1.1299743798
 17         -5.1353889271   -1.1494996364    4.3104532937   -1.1299746071
 18         -5.1353870222   -1.1495003441    4.3104525334   -1.1299747625
 19         -5.1353857119   -1.1495007653    4.3104520813   -1.1299748679
 20         -5.1353848191   -1.1495010158    4.3104518127   -1.1299749389
 21         -5.1353842155   -1.1495011646    4.3104516533   -1.1299749864
 22         -5.1353838101   -1.1495012530    4.3104515588   -1.1299750181
 23         -5.1353835393   -1.1495013054    4.3104515028   -1.1299750391
 24         -5.1353833593   -1.1495013365    4.3104514696   -1.1299750530
 25         -5.1353832401   -1.1495013548    4.3104514501   -1.1299750622
 26         -5.1353831615   -1.1495013657    4.3104514385   -1.1299750682
Atom SCF converged after  26 iterations to a total energy of     -5.13538316

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  3     1.00 0.00 0.00
Orbitals   (num,l):  3        0    0    1
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -0.3079404309   -0.1847796142    0.2820952552   -0.1977712840
  2         -0.3685975256   -0.1881372461    0.2800584768   -0.1985632226
  3         -0.3972336746   -0.1884802615    0.2798203631   -0.1998878628
  4         -0.4080711007   -0.1888189230    0.2794872379   -0.2003449133
  5         -0.4121182830   -0.1890445832    0.2792475199   -0.2004732256
  6         -0.4136581625   -0.1891622406    0.2791188792   -0.2005066556
  7         -0.4142566052   -0.1892169058    0.2790582819   -0.2005150829
  8         -0.4144930958   -0.1892408430    0.2790315521   -0.2005171835
  9         -0.4145876365   -0.1892509919    0.2790201727   -0.2005177108
 10         -0.4146257137   -0.1892552173    0.2790154237   -0.2005178471
 11         -0.4146411214   -0.1892569584    0.2790134641   -0.2005178845
 12         -0.4146473737   -0.1892576715    0.2790126609   -0.2005178957
 13         -0.4146499153   -0.1892579626    0.2790123328   -0.2005178994
 14         -0.4146509496   -0.1892580812    0.2790121992   -0.2005179008
 15         -0.4146513708   -0.1892581294    0.2790121448   -0.2005179014
 16         -0.4146515424   -0.1892581490    0.2790121227   -0.2005179016
 17         -0.4146516123   -0.1892581570    0.2790121137   -0.2005179017
Atom SCF converged after  17 iterations to a total energy of     -0.41465161

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  5     2.00 4.00 0.00 0.00 0.00
Orbitals   (num,l):  5        0    1    0    1    2
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   49    2  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
Confining potential (l,width,scale):  2    3.0000000000  100.0000000000
  1         -1.5661537791   -6.8154847894   10.1554291890   -1.9817841195
  2        -16.4386271763   -2.3896369642   13.5944551264   -2.6260758875
  3        -14.9493899685   -2.7563303680   13.2023047998   -2.5596129673
  4        -15.3921207107   -2.6131563355   13.3532703810   -2.5891321659
  5        -15.2222594960   -2.6552654914   13.3087860131   -2.5818429119
  6        -15.2271175148   -2.6512425439   13.3131300524   -2.5830481331
  7        -15.2216500549   -2.6517501961   13.3126321642   -2.5831383761
  8        -15.2189346714   -2.6519101535   13.3124872443   -2.5832257372
  9        -15.2176764698   -2.6519806177   13.3124247517   -2.5832714783
 10        -15.2168206977   -2.6520315048   13.3123793018   -2.5833032826
 11        -15.2162363429   -2.6520687088   13.3123457720   -2.5833252807
 12        -15.2158365778   -2.6520959446   13.3123210089   -2.5833404663
 13        -15.2155628281   -2.6521158316   13.3123027835   -2.5833509437
 14        -15.2153752610   -2.6521302990   13.3122894320   -2.5833581733
 15        -15.2152466902   -2.6521407840   13.3122796964   -2.5833631637
 16        -15.2151585280   -2.6521483559   13.3122726278   -2.5833666101
 17        -15.2150980548   -2.6521538066   13.3122675152   -2.5833689914
 18        -15.2150565616   -2.6521577191   13.3122638299   -2.5833706378
 19        -15.2150280827   -2.6521605203   13.3122611815   -2.5833717766
 20        -15.2150085303   -2.6521625211   13.3122592834   -2.5833725649
 21        -15.2149951026   -2.6521639474   13.3122579264   -2.5833731107
 22        -15.2149858783   -2.6521649621   13.3122569582   -2.5833734889
 23        -15.2149795399   -2.6521656828   13.3122562689   -2.5833737512
 24        -15.2149751832   -2.6521661938   13.3122557790   -2.5833739330
 25        -15.2149721879   -2.6521665557   13.3122554314   -2.5833740592
 26        -15.2149701280   -2.6521668116   13.3122551851   -2.5833741469
 27        -15.2149687110   -2.6521669923   13.3122550109   -2.5833742077
 28        -15.2149677359   -2.6521671198   13.3122548877   -2.5833742500
 29        -15.2149670649   -2.6521672097   13.3122548009   -2.5833742795
 30        -15.2149666029   -2.6521672730   13.3122547396   -2.5833742999
 31        -15.2149662848   -2.6521673175   13.3122546964   -2.5833743142
 32        -15.2149660657   -2.6521673487   13.3122546661   -2.5833743241
 33        -15.2149659148   -2.6521673707   13.3122546447   -2.5833743310
 34        -15.2149658108   -2.6521673861   13.3122546297   -2.5833743358
 35        -15.2149657391   -2.6521673969   13.3122546192   -2.5833743391
Atom SCF converged after  35 iterations to a total energy of    -15.21496574

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     O  O  O     |
BC: | Local pseudopotential | pspot_bc [3]    |     O  O  O     |
BC: | Hartree-Fock exchange | hfx_bc          |     O  O  O     |
BC: | Van der Waals         | vdw_bc          |     O  O  O     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      5;  min      4;  average      5
... Projector load balancing: max      1;  min      0;  average      1
... Conduction NGWF load balancing: max     25;  min     13;  average     17
... Joint NGWF load balancing: max     30;  min     17;  average     22
... done
Checking all ngwfs are fully within unit cell ... done
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... Conduction NGWF spheres initialised
... NGWF tight boxes initialised
... Conduction NGWF tight boxes initialised
... Joint NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):          5648        24830
... Conduction NGWF basis size (local,global):         18887        93759
... Joint NGWF basis size (local,global):         24379       117965
... Nonlocal pseudopotential projector initialisation
... done

Initialising remote NGWF capability... done. 

SWRI: Initialising module (stage 1)... 
SWRI: [for_hfx] Initialising (stage 1)...
SWRI: [for_hfx] - Using default V metric matrix evaluation scheme (2D numerical-1D analytic).
SWRI: [for_hfx] - Initialising Bessels (l_max=2)... done.
SWRI: [for_hfx] - Initialising radial lookup... done.
SWRI: [for_hfx] - SW batch size (tile width) set to 90.
SWRI: [for_hfx] - Initialising persistent cache structures... done.
SWRI: [for_hfx] - Initialising metric matrix... done.
SWRI: [for_hfx] Done.
SWRI: Stage 1 completed.

========================== Sparse matrix information ===========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  16.67%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
HFx: Creating X matrix structure for val rep (spin 1).
Initializing spherical harmonic rotation module.

SWRI: Initializing module (stage 2)... 
SWRI: [for_hfx] Initialising (stage 2)... 
SWRI: [for_hfx] - NL: Populating neighbour list: SWRI_S_ATOMS... done.
SWRI: [for_hfx] - Generating and communicating atomblock list.
SWRI: [for_hfx]   36 atomblocks read from disk.
SWRI: [for_hfx]   0 atomblocks to process.
SWRI: [for_hfx]   Sorting atomblocks according to proximitiy to (    0.000000,    0.000000,    0.000000).
SWRI: [for_hfx] - Calculating on-site elements of the metric matrix V... done.
SWRI: [for_hfx] - Not calculating off-site elements, all have been read from disk.
SWRI: [for_hfx] - Filling the remainder by symmetry (path 2).
SWRI: Done.
SWX: Initialising module... 
done.
NL: Populating neighbour list: HFx_S_ATOMS... done.
NL: Populating neighbour list: HFx_X_ATOMS... done.
NL: Populating neighbour list: HFx_XS_ATOMS... done.
NL: Populating neighbour list: HFx_SXS_ATOMS... done.
SWX: Initialising val%[hfx_swex]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 2, max_q: 10, num_sws: 90, max_sws: 90.
SWX: Done.
SWX: Initialising val%[hfx_swex_other]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 2, max_q: 10, num_sws: 90, max_sws: 90.
SWX: Done.

Reading NGWFs from file "ethanol_hybrid_conduction_2.tightbox_ngwfs" ...  done
SWX: Invalidating val%[hfx_swex].
SWX: Invalidating val%[hfx_swex_other].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        12 |       2 |       9 |      11 |        81 |        81 |
|       1 |        15 |       2 |       9 |      11 |        81 |        81 |
|       2 |        12 |       2 |       9 |      11 |        81 |        81 |
|       3 |        42 |       5 |       9 |      14 |        81 |        81 |
+---------------------------------------------------------------------------+
|     min |        12 |       2 |       9 |      11 |        81 |        81 |
|     max |        42 |       5 |       9 |      14 |        81 |        81 |
| average |      20.2 |     2.8 |     9.0 |    11.8 |      81.0 |      81.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Estimating memory use...
 +----------------------------------------------------+
 |  HFx TEFCI engine: minimum requirements            |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  Radial Bessel lookup                :   22.89 MB  |
 |  Dd NGWFs hash table                 :  225.00 kB  |
 |  All remote NGWFs hash table         :    8.23 MB  |
 |  dlists hash table                   :    2.48 MB  |
 |  coeffs hash table (estimate)        :  292.78 kB  |
 |  V metric matrix hash table          :    3.82 MB  |
 |  f auxiliary term                    :   21.62 MB  |
 |  P term in NGWF gradient             :   21.62 MB  |
 |  Q term in NGWF gradient             :    6.07 MB  |
 |  My kets in NGWF grad. (estimate)    :   11.66 MB  |
 |  Local kets in NGWF grad. (estim.)   :    3.85 MB  |
 |  K^{CD} hash table                   :  460.12 kB  |
 |  K^{AB} hash table                   :  455.62 kB  |
 |  tcK^A_B hash table                  :  455.62 kB  |
 |  tcK^B_A hash table                  :  455.62 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  104.51 MB  |
 +----------------------------------------------------+
HFx: - Adjusting cache sizes according to weights: 1.0000, 0.0000, 0.0000.
 +----------------------------------------------------+
 |  HFx TEFCI engine: user-adjustable requirements    |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  SWOP hash table                     :  491.83 MB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  491.83 MB  |
 +----------------------------------------------------+
HFx: - Peak memory use capped at 596.3 MB per MPI rank.
+------------------------------------------------------------------------------+
|    MPI |                           |              |           |              |
|   rank |       SWOP cache capacity | SWOPs needed | Cacheable |    Hit ratio |
+------------------------------------------------------------------------------+
|      0 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      1 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      2 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      3 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
+------------------------------------------------------------------------------+
HFx: - Populating SWOP cache...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
| AD NGWF products are not cached (cache_limit_for_prods == 0).                |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.39424673E+01     0.94762150E+00
               2       0.37471942E+01     0.90114061E+00
               3       0.34928787E+01     0.82022207E+00
               4       0.32004633E+01     0.70342899E+00
               5       0.29030098E+01     0.67914014E+00
               6       0.26321860E+01     0.65501280E+00
               7       0.23626065E+01     0.61622879E+00
               8       0.19887322E+01     0.55067378E+00
               9       0.14547611E+01     0.44273284E+00
              10       0.83382958E+00     0.28828341E+00
              11       0.31220553E+00     0.12458438E+00
              12       0.55636114E-01     0.24430266E-01
              13       0.24885363E-02     0.10548576E-02
              14       0.60302950E-05     0.23948101E-05
              15       0.36347519E-10     0.14247270E-10
              16       0.28606712E-14     0.11102230E-14
================================================================================

Reading density kernel from file "ethanol_hybrid_conduction_2.dkn" ... done

===================== Conduction Sparse matrix information =====================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
              NGWF-COND overlap matrix filling: 100.00%
        Proj. Cond. Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  13.80%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Conduction NGWF sparse matrix initialisation ... done
Conduction NGWF initialisation ...... done
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       20.000 electrons (spin 1).
HFx: Density kernel CD normalised to       20.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       9 [3]
  + B:       5 [2]
  + B:       2 [0]
HFx: +-----------------------------------------------------------------------+
HFx: | Expansion cache is not used (cache_limit_for_expansions == 0).        |
HFx: +-----------------------------------------------------------------------+
HFx: Exchange matrix symmetric to  3.86 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -1.642948773966 Ha.
HFx: Creating X matrix structure for cond rep (spin 1).
SWX: Initialising cond%[hfx_swex]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 2, max_q: 10, num_sws: 90, max_sws: 90.
SWX: Done.
SWX: Initialising cond%[hfx_swex_other]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 2, max_q: 10, num_sws: 90, max_sws: 90.
SWX: Done.
HFx: Stage-1 for cond+val, selector: 11222 (mixed NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        16 |       2 |       9 |      11 |       314 |       314 |
|       1 |        13 |       3 |       9 |      12 |       309 |       309 |
|       2 |        20 |       3 |       9 |      12 |       324 |       324 |
|       3 |        32 |       4 |       9 |      13 |       295 |       295 |
+---------------------------------------------------------------------------+
|     min |        13 |       2 |       9 |      11 |       295 |       295 |
|     max |        32 |       4 |       9 |      13 |       324 |       324 |
| average |      20.2 |     3.0 |     9.0 |    12.0 |     310.5 |     310.5 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Estimating memory use...
 +----------------------------------------------------+
 |  HFx TEFCI engine: minimum requirements            |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  Radial Bessel lookup                :   22.89 MB  |
 |  Dd NGWFs hash table                 :  225.00 kB  |
 |  All remote NGWFs hash table         :   32.84 MB  |
 |  dlists hash table                   :    2.47 MB  |
 |  coeffs hash table (estimate)        :  664.88 kB  |
 |  V metric matrix hash table          :    3.82 MB  |
 |  f auxiliary term                    :   70.25 MB  |
 |  P term in NGWF gradient             :   83.31 MB  |
 |  Q term in NGWF gradient             :   31.57 MB  |
 |  My kets in NGWF grad. (estimate)    :   44.30 MB  |
 |  Local kets in NGWF grad. (estim.)   :   17.13 MB  |
 |  K^{CD} hash table                   :  460.12 kB  |
 |  K^{AB} hash table                   :  497.53 kB  |
 |  tcK^A_B hash table                  :  497.53 kB  |
 |  tcK^B_A hash table                  :  497.53 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  311.36 MB  |
 +----------------------------------------------------+
HFx: - Adjusting cache sizes according to weights: 1.0000, 0.0000, 0.0000.
 +----------------------------------------------------+
 |  HFx TEFCI engine: user-adjustable requirements    |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  SWOP hash table                     :  491.83 MB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  491.83 MB  |
 +----------------------------------------------------+
HFx: - Peak memory use capped at 803.2 MB per MPI rank.
+------------------------------------------------------------------------------+
|    MPI |                           |              |           |              |
|   rank |       SWOP cache capacity | SWOPs needed | Cacheable |    Hit ratio |
+------------------------------------------------------------------------------+
|      0 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      1 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      2 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      3 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
+------------------------------------------------------------------------------+
HFx: - Populating SWOP cache...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
| AD NGWF products are not cached (cache_limit_for_prods == 0).                |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: cond%[hfx_swex_other]: Fitting my NGWF pairs (V).
+------------------------------------------------------------------------------+
|                   Starting conduction NGWF optimisation                      |
+------------------------------------------------------------------------------+
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.81828394E+01     0.99176289E+00
               2       0.80842730E+01     0.98385989E+00
               3       0.79328049E+01     0.96894901E+00
               4       0.77249053E+01     0.94297071E+00
               5       0.74714971E+01     0.90006850E+00
               6       0.71928781E+01     0.84336840E+00
               7       0.68997455E+01     0.82539304E+00
               8       0.66027636E+01     0.81182737E+00
               9       0.63243710E+01     0.79808255E+00
              10       0.60536116E+01     0.77710324E+00
              11       0.57835031E+01     0.74252636E+00
              12       0.55460359E+01     0.69052302E+00
              13       0.53381294E+01     0.63571005E+00
              14       0.50981356E+01     0.59079791E+00
              15       0.47852134E+01     0.54204856E+00
              16       0.44052986E+01     0.48982685E+00
              17       0.39899606E+01     0.46096156E+00
              18       0.35677797E+01     0.41652541E+00
              19       0.31168173E+01     0.37026418E+00
              20       0.25794023E+01     0.32063854E+00
              21       0.19588349E+01     0.26127036E+00
              22       0.13357050E+01     0.18984086E+00
              23       0.79269769E+00     0.11703828E+00
              24       0.35816248E+00     0.54276779E-01
              25       0.88783714E-01     0.13845563E-01
              26       0.63810418E-02     0.10458572E-02
              27       0.38039034E-04     0.64147736E-05
              28       0.14392820E-08     0.24334668E-09
              29       0.20976744E-12     0.28421709E-13
================================================================================

Conduction Hamiltonian max eigenvalue, shift:    1.39996294253326    0.00000000000000

Conduction shift updated:        1.49996294253326
Generating conduction density kernel for     9 'occupied' orbitals
Up spin density kernel initialisation ...... done
HFx: Calculation for cond+val, structure: HFxc, selector: 11222 (mixed NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to       10.000 electrons (spin 1).
HFx: Energy prefactor:   2.0000
  + B:       1 [0]
  + B:       4 [2]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
  + B:       2 [0]
  + B:       4 [1]
  + B:       6 [2]
HFx: Exchange matrix symmetric to  4.22 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.258027810472 Ha.

Conduction Hamiltonian max eigenvalue, shift:    1.38784536497873    1.49996294253326

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      18.00000000
     Final electron number for spin 1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:       0.083962919791
             Q0:           1.511332556231
             G0:      -0.057346244451
   RMS gradient:       0.003470590711
     Trial step:       0.500000000000
             Q1:           1.498400382806
 Quadratic coef:       0.015740948801
 Linear coef   :      -0.028673122226
           Qmin:           1.498275085100
Quadratic minimum step length (  0.455390627782) accepted
    Initial Ne1:      18.00000000
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000364 (step -0.4987 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1         1.511332556231E+00     3.4706E-03     1.3304E-02
      ideal mu1:       0.083235593733
             Q0:           1.498240687185
             G0:      -0.011979849426
   RMS gradient:       0.001583570138
     Trial step:       0.477174301373
             Q1:           1.493608114317
 Quadratic coef:       0.001083903412
 Linear coef   :      -0.005716476281
           Qmin:           1.490703553182
Quadratic minimum step length (  1.258301959437) accepted
    Initial Ne1:      18.00000000
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001060 (step -0.4958 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000004 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2         1.498240687185E+00     1.5836E-03     6.0704E-03    -1.3092E-02
      ideal mu1:       0.082813923470
             Q0:           1.490650622466
             G0:      -0.002951035407
   RMS gradient:       0.000783557747
     Trial step:       0.774873769340
             Q1:           1.489583146736
 Quadratic coef:       0.001219204200
 Linear coef   :      -0.002286679930
           Qmin:           1.489578426130
Quadratic minimum step length (  0.726657723413) accepted
    Initial Ne1:      17.99999998
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000316 (step -0.4985 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3         1.490650622466E+00     7.8356E-04     3.0036E-03    -7.5901E-03
      ideal mu1:       0.082754080414
             Q0:           1.489573447450
             G0:      -0.000968583127
   RMS gradient:       0.000449768401
     Trial step:       0.750378577227
             Q1:           1.489132937329
 Quadratic coef:       0.000286293909
 Linear coef   :      -0.000726804029
           Qmin:           1.489112169650
Quadratic minimum step length (  0.952479526230) accepted
    Initial Ne1:      17.99999999
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000219 (step -0.4987 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4         1.489573447450E+00     4.4977E-04     1.7241E-03    -1.0772E-03
      ideal mu1:       0.082728351362
             Q0:           1.489110324510
             G0:      -0.000673655508
   RMS gradient:       0.000375239586
     Trial step:       0.845411279633
             Q1:           1.488776941843
 Quadratic coef:       0.000236133297
 Linear coef   :      -0.000569515965
           Qmin:           1.488766929023
Quadratic minimum step length (  1.019498788678) accepted
    Initial Ne1:      17.99999999
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000276 (step -0.4981 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    5         1.489110324510E+00     3.7524E-04     1.4384E-03    -4.6312E-04
      ideal mu1:       0.082709150893
             Q0:           1.488764716073
             G0:      -0.000262699735
   RMS gradient:       0.000234007310
     Trial step:       0.928383420533
             Q1:           1.488617714243
 Quadratic coef:       0.000096884248
 Linear coef   :      -0.000243886078
           Qmin:           1.488611232870
Quadratic minimum step length (  1.168506726151) accepted
    Initial Ne1:      18.00000000
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000184 (step -0.4986 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    6         1.488764716073E+00     2.3401E-04     8.9703E-04    -3.4561E-04
      ideal mu1:       0.082700580149
             Q0:           1.488610442675
             G0:      -0.000175246088
   RMS gradient:       0.000191855863
     Trial step:       1.041548016819
             Q1:           1.488578937837
 Quadratic coef:       0.000151022378
 Linear coef   :      -0.000182527216
           Qmin:           1.488555291603
Quadratic minimum step length (  0.629412879249) accepted
    Initial Ne1:      18.00000000
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7         1.488610442675E+00     1.9186E-04     7.3545E-04    -1.5427E-04
      ideal mu1:       0.082697516113
             Q0:           1.488555290029
             G0:      -0.000076617638
   RMS gradient:       0.000126855132
     Trial step:       0.809668905258
             Q1:           1.488510674152
 Quadratic coef:       0.000017419042
 Linear coef   :      -0.000062034919
           Qmin:           1.488500058357
Quadratic minimum step length (  1.441748225134) accepted
    Initial Ne1:      17.99999999
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.4999 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    8         1.488555290029E+00     1.2686E-04     4.8628E-04    -5.5153E-05
      ideal mu1:       0.082694447469
             Q0:           1.488500054436
             G0:      -0.000083076412
   RMS gradient:       0.000132088923
     Trial step:       1.080434499219
             Q1:           1.488455360231
 Quadratic coef:       0.000045064417
 Linear coef   :      -0.000089758621
           Qmin:           1.488455359471
Quadratic minimum step length (  1.075996522081) accepted
    Initial Ne1:      18.00000022
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000034 (step -0.4998 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    9         1.488500054436E+00     1.3209E-04     5.0634E-04    -5.5236E-05
      ideal mu1:       0.082691963307
             Q0:           1.488455339524
             G0:      -0.000058895772
   RMS gradient:       0.000111190031
     Trial step:       1.078213227287
             Q1:           1.488418672316
 Quadratic coef:       0.000026834993
 Linear coef   :      -0.000063502201
           Qmin:           1.488417771696
Quadratic minimum step length (  1.275739364626) accepted
    Initial Ne1:      18.00000125
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000056 (step -0.4996 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

   10         1.488455339524E+00     1.1119E-04     4.2623E-04    -4.4715E-05
      ideal mu1:       0.082689874246
             Q0:           1.488417736420
             G0:      -0.000048736991
   RMS gradient:       0.000101116058
     Trial step:       1.172825245938
             Q1:           1.488387473225
 Quadratic coef:       0.000026896778
 Linear coef   :      -0.000057159973
           Qmin:           1.488387367890
Quadratic minimum step length (  1.246220987783) accepted
    Initial Ne1:      18.00000319
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000075 (step -0.4994 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

   11         1.488417736420E+00     1.0112E-04     3.8761E-04    -3.7603E-05
      ideal mu1:       0.082688184443
             Q0:           1.488387319976
             G0:      -0.000029852630
   RMS gradient:       0.000079108743
     Trial step:       1.208966267722
             Q1:           1.488375558604
 Quadratic coef:       0.000024329451
 Linear coef   :      -0.000036090823
           Qmin:           1.488373935503
Quadratic minimum step length (  0.896703093286) accepted
    Initial Ne1:      18.00000355
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000044 (step -0.4996 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

   12         1.488387319976E+00     7.9109E-05     3.0325E-04    -3.0416E-05
      ideal mu1:       0.082687440054
             Q0:           1.488373920965
             G0:      -0.000018835344
   RMS gradient:       0.000062898123
     Trial step:       1.041193445976
             Q1:           1.488370629365
 Quadratic coef:       0.000016319637
 Linear coef   :      -0.000019611236
           Qmin:           1.488368029280
Quadratic minimum step length (  0.625598824288) accepted
    Initial Ne1:      18.00000046
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

   13         1.488373920965E+00     6.2898E-05     2.4111E-04    -1.3399E-05
      ideal mu1:       0.082687112737
             Q0:           1.488368029264
             G0:      -0.000008477771
   RMS gradient:       0.000042197919
     Trial step:       0.807074591137
             Q1:           1.488363526897
 Quadratic coef:       0.000002339827
 Linear coef   :      -0.000006842194
           Qmin:           1.488363027226
Quadratic minimum step length (  1.180035911212) accepted
    Initial Ne1:      18.00000039
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

   14         1.488368029264E+00     4.2198E-05     1.6176E-04    -5.8917E-06
      ideal mu1:       0.082686834844
   15         1.488363027187E+00     3.4058E-05     1.3056E-04    -5.0021E-06
Finished density kernel iterations (  15)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   1.48836302718663E+00  Eh
     Estimated gap above Kc      =   1.8228E-02  Eh
     RMS occupancy error         =   1.1325E-11
     [H,K] commutator            =   1.3056E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
######################### COND NGWF CG iteration  001 ##########################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for cond rep.
HFx: Calculation for cond+val, structure: HFxc, selector: 11222 (mixed NGWF basis).
HFx: Density kernel AB normalised to        9.000 electrons (spin 1).
HFx: Density kernel CD normalised to       10.000 electrons (spin 1).
HFx: Energy prefactor:   2.0000
HFx: Grad prefactor:   1.0000
  + B:       2 [1]
  + B:       6 [3]
  + B:       4 [2]
  + B:       1 [0]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
  + B:       2 [0]
  + B:       4 [1]
  + B:       6 [2]
HFx: Communicating NGWF gradient kets.
  * C:       1 [0]
  * C:       1 [1]
  * C:       1 [3]
  * C:       1 [2]
  * C:       2 [2]
  * C:       3 [2]
  * C:       2 [0]
  * C:       2 [3]
  * C:       3 [0]
  * C:       3 [3]
  * C:       2 [1]
  * C:       3 [1]
  * C:       4 [3]
  * C:       4 [2]
  * C:       4 [0]
  * C:       4 [1]
  * C:       5 [3]
  * C:       5 [2]
  * C:       5 [1]
  * C:       5 [0]
  * C:       6 [3]
  * C:       6 [2]
  * C:       6 [1]
  * C:       6 [0]
  * C:       7 [3]
  * C:       7 [1]
  * C:       7 [2]
  * C:       8 [3]
  * C:       7 [0]
  * C:       8 [1]
  * C:       8 [2]
  * C:       9 [3]
  * C:       8 [0]
  * C:       9 [1]
  * C:       9 [2]
  * C:       9 [0]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.92 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.306387580844 Ha.
HFx: ^ (accounting for spin degeneracy in density kernel in non-val gradient calc)
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5715E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating cond%[hfx_swex].
SWX: Invalidating cond%[hfx_swex_other].
HFx: Stage-1 for cond+val, selector: 11222 (mixed NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        16 |       2 |       9 |      11 |       314 |       314 |
|       1 |        13 |       3 |       9 |      12 |       309 |       309 |
|       2 |        20 |       3 |       9 |      12 |       324 |       324 |
|       3 |        32 |       4 |       9 |      13 |       295 |       295 |
+---------------------------------------------------------------------------+
|     min |        13 |       2 |       9 |      11 |       295 |       295 |
|     max |        32 |       4 |       9 |      13 |       324 |       324 |
| average |      20.2 |     3.0 |     9.0 |    12.0 |     310.5 |     310.5 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
| AD NGWF products are not cached (cache_limit_for_prods == 0).                |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: cond%[hfx_swex_other]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.50814625E-01     0.45209512E-02
               2       0.13709112E-03     0.11954082E-04
               3       0.38731727E-08     0.38878678E-09
               4       0.20397293E-12     0.23092639E-13
================================================================================
HFx: Calculation for cond+val, structure: HFxc, selector: 11222 (mixed NGWF basis).
HFx: Density kernel AB normalised to        9.002 electrons (spin 1).
HFx: Density kernel CD normalised to       10.000 electrons (spin 1).
HFx: Energy prefactor:   2.0000
  + B:       1 [0]
  + B:       2 [1]
  + B:       6 [3]
  + B:       4 [2]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
  + B:       2 [0]
  + B:       4 [1]
  + B:       6 [2]
HFx: Exchange matrix symmetric to  4.22 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.307129637233 Ha.

Conduction Hamiltonian max eigenvalue, shift:    1.37186971157276    1.49996294253326
SWX: Invalidating cond%[hfx_swex].
SWX: Invalidating cond%[hfx_swex_other].
HFx: Stage-1 for cond+val, selector: 11222 (mixed NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        16 |       2 |       9 |      11 |       314 |       314 |
|       1 |        13 |       3 |       9 |      12 |       309 |       309 |
|       2 |        20 |       3 |       9 |      12 |       324 |       324 |
|       3 |        32 |       4 |       9 |      13 |       295 |       295 |
+---------------------------------------------------------------------------+
|     min |        13 |       2 |       9 |      11 |       295 |       295 |
|     max |        32 |       4 |       9 |      13 |       324 |       324 |
| average |      20.2 |     3.0 |     9.0 |    12.0 |     310.5 |     310.5 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
| AD NGWF products are not cached (cache_limit_for_prods == 0).                |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: cond%[hfx_swex_other]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.66417144E+00     0.60376853E-01
               2       0.36629073E-01     0.37775800E-02
               3       0.23116628E-03     0.26636805E-04
               4       0.14576521E-07     0.14315340E-08
               5       0.20150602E-12     0.35527137E-13
================================================================================
HFx: Calculation for cond+val, structure: HFxc, selector: 11222 (mixed NGWF basis).
HFx: Density kernel AB normalised to        9.083 electrons (spin 1).
HFx: Density kernel CD normalised to       10.000 electrons (spin 1).
HFx: Energy prefactor:   2.0000
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
  + B:       2 [0]
  + B:       4 [1]
  + B:       6 [2]
HFx: Exchange matrix symmetric to  4.22 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.316867119236 Ha.

Conduction Hamiltonian max eigenvalue, shift:    1.25113097899459    1.49996294253326
SWX: Invalidating cond%[hfx_swex].
SWX: Invalidating cond%[hfx_swex_other].
HFx: Stage-1 for cond+val, selector: 11222 (mixed NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        16 |       2 |       9 |      11 |       314 |       314 |
|       1 |        13 |       3 |       9 |      12 |       309 |       309 |
|       2 |        20 |       3 |       9 |      12 |       324 |       324 |
|       3 |        32 |       4 |       9 |      13 |       295 |       295 |
+---------------------------------------------------------------------------+
|     min |        13 |       2 |       9 |      11 |       295 |       295 |
|     max |        32 |       4 |       9 |      13 |       324 |       324 |
| average |      20.2 |     3.0 |     9.0 |    12.0 |     310.5 |     310.5 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
| AD NGWF products are not cached (cache_limit_for_prods == 0).                |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: cond%[hfx_swex_other]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30085133E-02     0.28045882E-03
               2       0.90845943E-06     0.10925375E-06
               3       0.24283324E-12     0.35527137E-13
================================================================================
HFx: Calculation for cond+val, structure: HFxc, selector: 11222 (mixed NGWF basis).
HFx: Density kernel AB normalised to        9.083 electrons (spin 1).
HFx: Density kernel CD normalised to       10.000 electrons (spin 1).
HFx: Energy prefactor:   2.0000
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
  + B:       2 [0]
  + B:       4 [1]
  + B:       6 [2]
HFx: Exchange matrix symmetric to  4.22 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -0.316823008937 Ha.

Conduction Hamiltonian max eigenvalue, shift:    1.25139118510472    1.49996294253326
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00045715332132
Trial step length           =               0.122474
Gradient along search dir.  =         -0.28641065614
Functional at step 0        =       1.48836302718663
Functional at step 1        =       1.45463108126669
Rejected quadratic step     =               1.595837
Functional at new step 1    =       1.26072198591639
Functional predicted        =       1.26071852322446
Selected quadratic step     =               1.589637
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      18.16525465
     Final electron number for spin 1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003292 (step -0.4869 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000027 (step -0.5001 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:       0.070039118894
             Q0:           1.260704140099
             G0:      -0.073681876781
   RMS gradient:       0.003933971859
     Trial step:       0.975898048245
             Q1:           1.238958824175
 Quadratic coef:       0.050160683818
 Linear coef   :      -0.071905999741
           Qmin:           1.234934591095
Quadratic minimum step length (  0.699481341395) accepted
    Initial Ne1:      17.99999825
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001070 (step -0.4965 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1         1.260704140099E+00     3.9340E-03     1.5080E-02
      ideal mu1:       0.068593209064
             Q0:           1.234677763152
             G0:      -0.009422798975
   RMS gradient:       0.001398378796
     Trial step:       0.826209704525
             Q1:           1.230749391660
 Quadratic coef:       0.003856836464
 Linear coef   :      -0.007785207957
           Qmin:           1.230749059959
Quadratic minimum step length (  0.833871804748) accepted
    Initial Ne1:      17.99999973
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000501 (step -0.4983 Ne1=     18.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2         1.234677763152E+00     1.3984E-03     5.3605E-03    -2.6026E-02
      ideal mu1:       0.068373634532
             Q0:           1.230725421575
             G0:      -0.002332825090
   RMS gradient:       0.000697412156
     Trial step:       0.830031913490
             Q1:           1.230047525778
 Quadratic coef:       0.001258423477
 Linear coef   :      -0.001936319273
           Qmin:           1.229980574471
Quadratic minimum step length (  0.638579469299) accepted
    Initial Ne1:      17.99999995
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000163 (step -0.4994 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3         1.230725421575E+00     6.9741E-04     2.6734E-03    -3.9523E-03
      ideal mu1:       0.068332145588
             Q0:           1.229978620593
             G0:      -0.000508301162
   RMS gradient:       0.000326253762
     Trial step:       0.728039379991
             Q1:           1.229782958598
 Quadratic coef:       0.000174401268
 Linear coef   :      -0.000370063263
           Qmin:           1.229782310640
Quadratic minimum step length (  0.772415910100) accepted
    Initial Ne1:      18.00000268
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000059 (step -0.4998 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4         1.229978620593E+00     3.2625E-04     1.2506E-03    -7.4680E-04
      ideal mu1:       0.068321227207
             Q0:           1.229782089720
             G0:      -0.000192355310
   RMS gradient:       0.000200874988
     Trial step:       0.749899460117
             Q1:           1.229690226855
 Quadratic coef:       0.000052384278
 Linear coef   :      -0.000144247143
           Qmin:           1.229682788752
Quadratic minimum step length (  1.032474420776) accepted
    Initial Ne1:      18.00000134
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000042 (step -0.4999 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    5         1.229782089720E+00     2.0087E-04     7.7002E-04    -1.9653E-04
      ideal mu1:       0.068315705605
             Q0:           1.229682700885
             G0:      -0.000086484221
   RMS gradient:       0.000134710523
     Trial step:       0.879915911167
             Q1:           1.229637972076
 Quadratic coef:       0.000031370033
 Linear coef   :      -0.000076098842
           Qmin:           1.229636549883
Quadratic minimum step length (  1.067269880430) accepted
    Initial Ne1:      18.00000048
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000029 (step -0.4999 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    6         1.229682700885E+00     1.3471E-04     5.1639E-04    -9.9389E-05
      ideal mu1:       0.068313140029
             Q0:           1.229636520513
             G0:      -0.000058176962
   RMS gradient:       0.000110541773
     Trial step:       0.969075719074
             Q1:           1.229628826262
 Quadratic coef:       0.000048683630
 Linear coef   :      -0.000056377881
           Qmin:           1.229620198469
Quadratic minimum step length (  0.561117108544) accepted
    Initial Ne1:      18.00000003
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    7         1.229636520513E+00     1.1054E-04     4.2374E-04    -4.6180E-05
      ideal mu1:       0.068312233239
             Q0:           1.229620198295
             G0:      -0.000022852305
   RMS gradient:       0.000069280847
     Trial step:       0.737404207641
             Q1:           1.229608106323
 Quadratic coef:       0.000004759414
 Linear coef   :      -0.000016851386
           Qmin:           1.229605282109
Quadratic minimum step length (  1.305442571084) accepted
    Initial Ne1:      18.00000003
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000003 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    8         1.229620198295E+00     6.9281E-05     2.6558E-04    -1.6322E-05
      ideal mu1:       0.068311404537
             Q0:           1.229605281661
             G0:      -0.000017008748
   RMS gradient:       0.000059769397
     Trial step:       0.981141602803
             Q1:           1.229595937007
 Quadratic coef:       0.000007343336
 Linear coef   :      -0.000016687990
           Qmin:           1.229595800649
Quadratic minimum step length (  1.114839514245) accepted
    Initial Ne1:      18.00000001
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    9         1.229605281661E+00     5.9769E-05     2.2912E-04    -1.4917E-05
      ideal mu1:       0.068310877776
             Q0:           1.229595799964
             G0:      -0.000010988108
   RMS gradient:       0.000048038890
     Trial step:       1.045856313207
             Q1:           1.229589811584
 Quadratic coef:       0.000005503602
 Linear coef   :      -0.000011491983
           Qmin:           1.229589800909
Quadratic minimum step length (  1.091917817186) accepted
    Initial Ne1:      17.99999998
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000006 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

   10         1.229595799964E+00     4.8039E-05     1.8415E-04    -9.4817E-06
      ideal mu1:       0.068310544460
             Q0:           1.229589800288
             G0:      -0.000007120488
   RMS gradient:       0.000038670363
     Trial step:       1.068638920594
             Q1:           1.229586939579
 Quadratic coef:       0.000004748522
 Linear coef   :      -0.000007609231
           Qmin:           1.229586751950
Quadratic minimum step length (  0.856215849462) accepted
    Initial Ne1:      17.99999997
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

   11         1.229589800288E+00     3.8670E-05     1.4824E-04    -5.9997E-06
      ideal mu1:       0.068310375092
             Q0:           1.229586751663
             G0:      -0.000002828717
   RMS gradient:       0.000024373737
     Trial step:       0.956548786609
             Q1:           1.229585494634
 Quadratic coef:       0.000001448777
 Linear coef   :      -0.000002705806
           Qmin:           1.229585488289
Quadratic minimum step length (  0.893248523958) accepted
    Initial Ne1:      17.99999998
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

   12         1.229586751663E+00     2.4374E-05     9.3433E-05    -3.0486E-06
      ideal mu1:       0.068310304901
             Q0:           1.229585488220
             G0:      -0.000000927211
   RMS gradient:       0.000013955335
     Trial step:       0.924356961207
             Q1:           1.229585183508
 Quadratic coef:       0.000000552362
 Linear coef   :      -0.000000857074
           Qmin:           1.229585155750
Quadratic minimum step length (  0.717140249778) accepted
    Initial Ne1:      18.00000000
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

   13         1.229585488220E+00     1.3955E-05     5.3495E-05    -1.2634E-06
      ideal mu1:       0.068310286431
             Q0:           1.229585155750
             G0:      -0.000000376982
   RMS gradient:       0.000008898379
     Trial step:       0.814182769435
             Q1:           1.229584956901
 Quadratic coef:       0.000000108083
 Linear coef   :      -0.000000306932
           Qmin:           1.229584937846
Quadratic minimum step length (  1.156046737947) accepted
    Initial Ne1:      18.00000000
      Final Ne1:      18.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     18.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     18.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

   14         1.229585155750E+00     8.8984E-06     3.4110E-05    -3.3247E-07
      ideal mu1:       0.068310274325
   15         1.229584937845E+00     8.3703E-06     3.2086E-05    -2.1790E-07
Finished density kernel iterations (  15)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =   1.22958493784544E+00  Eh
     Estimated gap above Kc      =   2.5604E-02  Eh
     RMS occupancy error         =   2.5937E-14
     [H,K] commutator            =   3.2086E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

WARNING: maximum number of NGWF CG iterations (   1) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00045715332132      1.22958493784544  <-- CG                                 
 
<QC>        [NGWF iterations]:                      1
<QC>           [total_energy]:         1.229584937845
<QC>           [rms_gradient]:         0.000457153321
+------------------------------------------------------------------------------+
|                    Conduction NGWF optimisation complete                     |
+------------------------------------------------------------------------------+

+------------------------------------------------------------------------------+
|                  Starting conduction properties calculation                  |
+------------------------------------------------------------------------------+
<QC>      [atom_1_population]:         4.962652781125
<QC>          [atom_1_charge]:        -0.962652781125
<QC>      [atom_2_population]:         4.389332282156
<QC>          [atom_2_charge]:        -0.389332282156
<QC>      [atom_3_population]:         0.682335924491
<QC>          [atom_3_charge]:         0.317664075509

    Mulliken Atomic Populations
    ---------------------------
Species  Ion    Total   Charge (e)
==================================
  C      1       4.963     -0.963
  C      2       4.389     -0.389
  H      3       0.682      0.318
  H      4       0.700      0.300
  H      5       0.673      0.327
  H      6       0.705      0.295
  H      7       0.663      0.337
  O      8       6.750     -0.750
  H      9       0.475      0.525
==================================

        Bond         Population      Length (bohr)
==================================================
 O     8 -- H     9        0.52      1.84493
 C     1 -- H     5        0.79      2.08042
 C     1 -- H     3        0.78      2.08234
 C     2 -- H     7        0.80      2.08290
 C     1 -- H     4        0.80      2.08602
 C     2 -- H     6        0.81      2.09602
 C     2 -- O     8        0.47      2.71065
 C     1 -- C     2        0.61      2.87759
 H     3 -- H     4       -0.10      3.35871
 H     6 -- H     7       -0.14      3.36066
 H     4 -- H     5       -0.11      3.37395
 H     3 -- H     5       -0.09      3.37899
 C     2 -- H     9       -0.19      3.70086
 H     7 -- O     8       -0.13      3.82342
 H     6 -- O     8       -0.12      3.96725
 C     2 -- H     5       -0.13      4.09761
 C     2 -- H     4       -0.13      4.10675
 C     1 -- H     7       -0.14      4.11071
 C     1 -- H     6       -0.17      4.11094
 C     2 -- H     3       -0.11      4.12605
 H     6 -- H     9       -0.03      4.47518
 C     1 -- O     8       -0.16      4.64596
 H     4 -- H     9       -0.00      4.69560
 H     5 -- H     7       -0.04      4.75889
 H     3 -- H     6       -0.01      4.76093
 H     4 -- H     6       -0.03      4.79394
 H     3 -- H     7       -0.02      4.81180
 C     1 -- H     9       -0.04      4.92219
 H     5 -- O     8       -0.01      5.13642
 H     4 -- O     8       -0.02      5.20578
 H     7 -- H     9        0.04      5.35231
 H     5 -- H     9       -0.00      5.59181
==================================================




=========================== Valence diagonalisation ============================

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      18
   Number of occupied orbitals:      10.000000000
   Occupancy sum (eigenvalues):      10.000000000
                 HOMO-LUMO gap:       0.421423290 Eh
                 Mid-gap level:      -0.082650762 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.023715913   1.0000000
                            2    -0.790537714   1.0000000
                            3    -0.656461772   1.0000000
                            4    -0.522400653   1.0000000
                            5    -0.481628833   1.0000000
                            6    -0.466187958   1.0000000
                            7    -0.418885220   1.0000000
                            8    -0.404430269   1.0000000
                            9    -0.352118726   0.9999999
                           10    -0.293362407   0.9999998
                        .......   --- gap ---   .........
                           11     0.128060883   0.0000002
                           12     0.181714376   0.0000001
                           13     0.188698464   0.0000000
                           14     0.214509172   0.0000000
                           15     0.238061927   0.0000000
                           16     0.289867471   0.0000000
                           17     0.301221185   0.0000000
                           18     0.313127899   0.0000000
 
<QC>    [energy_eigenvalue_1]:        -1.023715912968
<QC>    [energy_eigenvalue_n]:         0.313127899065
<QC>            [occupancy_1]:         0.999999995552
<QC>            [occupancy_n]:         0.000000032561

================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "ethanol_hybrid_conduction_2_valence_DOS.txt" ...  done
================================================================================
 
Writing bands to file "ethanol_hybrid_conduction_2.val_bands" ... done
 

============= Joint Valence + Conduction Sparse matrix information =============
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
              NGWF-COND overlap matrix filling: 100.00%
              NGWF-COND overlap matrix filling: 100.00%
                  NGWF diagonal matrix filling:  14.31%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Joint Valence + Conduction NGWF sparse matrix initialisation ... done
Joint Valence + Conduction NGWF initialisation ...... done

HFx: Creating X matrix structure for joint rep (spin 1).
SWX: Initialising joint%[hfx_swex]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 2, max_q: 10, num_sws: 90, max_sws: 90.
SWX: Done.
SWX: Initialising joint%[hfx_swex_other]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 2, max_q: 10, num_sws: 90, max_sws: 90.
SWX: Done.
HFx: Stage-1 for joint+val, selector: 11222 (mixed NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |        15 |       2 |       9 |      11 |       396 |       396 |
|       1 |        13 |       3 |       9 |      12 |       392 |       392 |
|       2 |        20 |       3 |       9 |      12 |       400 |       400 |
|       3 |        33 |       4 |       9 |      13 |       378 |       378 |
+---------------------------------------------------------------------------+
|     min |        13 |       2 |       9 |      11 |       378 |       378 |
|     max |        33 |       4 |       9 |      13 |       400 |       400 |
| average |      20.2 |     3.0 |     9.0 |    12.0 |     391.5 |     391.5 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Estimating memory use...
 +----------------------------------------------------+
 |  HFx TEFCI engine: minimum requirements            |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  Radial Bessel lookup                :   22.89 MB  |
 |  Dd NGWFs hash table                 :  225.00 kB  |
 |  All remote NGWFs hash table         :   38.62 MB  |
 |  dlists hash table                   :    2.47 MB  |
 |  coeffs hash table (estimate)        :  781.25 kB  |
 |  V metric matrix hash table          :    3.82 MB  |
 |  f auxiliary term                    :   91.87 MB  |
 |  P term in NGWF gradient             :  104.93 MB  |
 |  Q term in NGWF gradient             :   41.28 MB  |
 |  My kets in NGWF grad. (estimate)    :   55.74 MB  |
 |  Local kets in NGWF grad. (estim.)   :   20.45 MB  |
 |  K^{CD} hash table                   :  460.12 kB  |
 |  K^{AB} hash table                   :  531.28 kB  |
 |  tcK^A_B hash table                  :  531.28 kB  |
 |  tcK^B_A hash table                  :  531.28 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  385.06 MB  |
 +----------------------------------------------------+
HFx: - Adjusting cache sizes according to weights: 1.0000, 0.0000, 0.0000.
 +----------------------------------------------------+
 |  HFx TEFCI engine: user-adjustable requirements    |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  SWOP hash table                     :  491.83 MB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  491.83 MB  |
 +----------------------------------------------------+
HFx: - Peak memory use capped at 876.9 MB per MPI rank.
+------------------------------------------------------------------------------+
|    MPI |                           |              |           |              |
|   rank |       SWOP cache capacity | SWOPs needed | Cacheable |    Hit ratio |
+------------------------------------------------------------------------------+
|      0 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      1 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      2 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
|      3 |         491 MiB (2088 el) |      2088 el |   100.00% |      100.00% |
+------------------------------------------------------------------------------+
HFx: - Populating SWOP cache...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
| AD NGWF products are not cached (cache_limit_for_prods == 0).                |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: joint%[hfx_swex_other]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.92227498E+01     0.99327537E+00
               2       0.91418453E+01     0.98700102E+00
               3       0.90197895E+01     0.97546586E+00
               4       0.88524432E+01     0.95514101E+00
               5       0.86427436E+01     0.92123895E+00
               6       0.84011710E+01     0.88898955E+00
               7       0.81456454E+01     0.87754148E+00
               8       0.78953191E+01     0.86676146E+00
               9       0.76614919E+01     0.85509942E+00
              10       0.74360545E+01     0.83773881E+00
              11       0.72151235E+01     0.81074506E+00
              12       0.70197664E+01     0.77441542E+00
              13       0.68569049E+01     0.75158648E+00
              14       0.66884778E+01     0.73370205E+00
              15       0.64712613E+01     0.71386501E+00
              16       0.61974993E+01     0.68923332E+00
              17       0.58945744E+01     0.66191465E+00
              18       0.55884784E+01     0.63939246E+00
              19       0.52724430E+01     0.62443172E+00
              20       0.49285937E+01     0.61066482E+00
              21       0.45919814E+01     0.59924394E+00
              22       0.43209672E+01     0.58408981E+00
              23       0.41155874E+01     0.56245792E+00
              24       0.39392758E+01     0.53279825E+00
              25       0.37588379E+01     0.49296377E+00
              26       0.35445358E+01     0.44698961E+00
              27       0.32935109E+01     0.41446115E+00
              28       0.30414603E+01     0.37516373E+00
              29       0.28287580E+01     0.36959047E+00
              30       0.26615806E+01     0.36156216E+00
              31       0.24857126E+01     0.34989796E+00
              32       0.22261157E+01     0.33071302E+00
              33       0.18686923E+01     0.29813012E+00
              34       0.14734829E+01     0.24829558E+00
              35       0.11296560E+01     0.18477834E+00
              36       0.86591220E+00     0.14947981E+00
              37       0.62747409E+00     0.11310102E+00
              38       0.37748162E+00     0.68402811E-01
              39       0.14221767E+00     0.25702439E-01
              40       0.20225789E-01     0.36547252E-02
              41       0.40908254E-03     0.73919675E-04
              42       0.16734879E-06     0.30238155E-07
              43       0.12219003E-10     0.25863756E-11
              44       0.10598216E-10     0.15205615E-11
              45       0.11736414E-10     0.18900437E-11
================================================================================
HFx: Calculation for joint+val, structure: HFxj, selector: 11222 (mixed NGWF basis).
HFx: Density kernel AB normalised to        0.000 electrons (spin 1).
HFx: Density kernel CD normalised to       10.000 electrons (spin 1).
HFx: Energy prefactor:   2.0000
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       6 [3]
  + B:       3 [1]
  + B:       7 [3]
  + B:       8 [3]
  + B:       5 [2]
  + B:       9 [3]
  + B:       2 [0]
  + B:       4 [1]
  + B:       6 [2]
HFx: Exchange matrix symmetric to  4.20 digits (rms).



================= Joint valence and conduction diagonalisation =================

=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      87
   Number of occupied orbitals:      10.000000000
   Occupancy sum (eigenvalues):      10.000000000
 Num of occupied cond orbitals:       9
            Cond Occupancy sum:       9.000000000
                 HOMO-LUMO gap:       0.295605056 Eh
                 Mid-gap level:      -0.148693433 Eh

                        Orbital | Energy (Eh) | Occupancy | Cond Occupancy
                            1    -1.025843316   0.9990643   0.0002625
                            2    -0.793561172   0.9977763   0.0016455
                            3    -0.661427516   0.9953015   0.0046452
                            4    -0.529306258   0.9917393   0.0063889
                            5    -0.487894364   0.9921446   0.0065605
                            6    -0.471950971   0.9923520   0.0074069
                            7    -0.424175807   0.9924931   0.0098884
                            8    -0.408433858   0.9947668   0.0062554
                            9    -0.356437548   0.9940668   0.0039493
                           10    -0.296495961   0.9955028   0.0033965
                        .......   --- gap ---   .........
                           11    -0.000890905   0.0015457   0.9970794
                           12     0.030550318   0.0021272   0.9954741
                           13     0.042941327   0.0026948   0.9941642
                           14     0.056469079   0.0046763   0.9901693
                           15     0.077575645   0.0015979   0.9966013
                           16     0.091513990   0.0019003   0.9960467
                           17     0.098943861   0.0017072   0.9963967
                           18     0.111191506   0.0052845   0.9886157
                           19     0.123773066   0.0038699   0.9914639
                           20     0.147429547   0.0021945   0.0008053
                        .......   ...........   .........
                           87     3.265658876   0.0001102   0.0000354
 
<QC>    [energy_eigenvalue_1]:        -1.025843315704
<QC>    [energy_eigenvalue_n]:         3.265658876256
<QC>            [occupancy_1]:         0.999064298959
<QC>            [occupancy_n]:         0.000110184166
<QC>       [cond_occupancy_1]:         0.000262524638
<QC>       [cond_occupancy_n]:         0.000035355939

================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "ethanol_hybrid_conduction_2_joint_DOS.txt" ...  done
================================================================================
 
Writing bands to file "ethanol_hybrid_conduction_2.joint_bands" ... done
SWX: Destroying [joint%hfx_swex]... done
SWX: Destroying [joint%hfx_swex_other]... done
+------------------------------------------------------------------------------+
|                  Conduction properties calculation complete                  |
+------------------------------------------------------------------------------+
SWX: Destroying [cond%hfx_swex]... done
SWX: Destroying [cond%hfx_swex_other]... done
SWX: Destroying [val%hfx_swex]... done
SWX: Destroying [val%hfx_swex_other]... done

Cleaning up after remote NGWF capability... done. 
SWX: Clean-up... done.
SWRI: Clean-up... done.

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:      80.612s on      4 proc(s)                                    
TOTAL TIME:        80.612s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| hfx_determine_my_d_atoms             :     6        0.00s   0.000%  ------ ||
|| hfx_main_comms_imbalance             :     7        0.00s   0.000%  ------ ||
|| hfx_determine_my_a_atoms             :     6        0.00s   0.000%  ------ ||
|| hfx_split_pair_list                  :     6        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_AB]      :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[DKNBLKS_AB]        :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[PPD_PRODUCTS]      :     2        0.00s   0.000%  ------ ||
|| hash_table_purge_[VMETRIC]           :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_BA]      :     1        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                :    40        0.00s   0.000%  ------ ||
|| hf_exchange_calculate_imbalance      :     7        0.00s   0.000%  ------ ||
|| hfx_determine_ppd_list               :     6        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| hash_table_purge_[ALISTS]            :     7        0.00s   0.000%  ------ ||
|| hash_table_purge_[DKNBLKS_CD]        :     7        0.00s   0.000%  ------ ||
|| restart_kernel_read                  :     1        0.00s   0.001%  ------ ||
|| hash_table_purge_[COEFFS]            :    14        0.00s   0.001%  ------ ||
|| hfx_all_ad_for_this_b_store          :    20        0.00s   0.001%  ------ ||
|| hash_table_purge_[XAB]               :     7        0.00s   0.001%  ------ ||
|| neighbour_list_populate              :     5        0.00s   0.001%  ------ ||
|| hfx_comms_xmatrix_imbalance          :     7        0.00s   0.001%  ------ ||
|| hfx_determine_alists                 :     6        0.00s   0.001%  ------ ||
|| hash_table_purge_[EXPANSIONS]        :     2        0.00s   0.002%  ------ ||
|| hfx_contract_over_dkn_cc_dkn_get     :   141        0.00s   0.002%  ------ ||
|| hash_table_purge_[DLISTS]            :     7        0.00s   0.002%  ------ ||
|| hfx_determine_bc_pairs               :     6        0.00s   0.002%  ------ ||
|| hash_table_purge_[AKETS_DKN_LOC]     :     2        0.00s   0.003%  ------ ||
|| swri_vmatrixblock_sc                 :   124        0.00s   0.003%  ------ ||
|| hfx_determine_a_ppd_list_for_b       :    56        0.00s   0.003%  ------ ||
|| hash_table_purge_[NGWFS]             :    14        0.00s   0.004%  ------ ||
|| remote_obtain_matrix_block           :   121        0.00s   0.004%  ------ ||
|| hash_table_purge_[PPD_NGWFS_DD]      :     7        0.00s   0.005%  ------ ||
|| basis_extract_function_from_box      :    73        0.00s   0.005%  ------ ||
|| hfx_determine_dlists                 :     6        0.01s   0.006%  ------ ||
|| pseudopotentials_nonlocal_mat        :     6        0.01s   0.006%  ------ ||
|| hash_table_purge_[AKETS_DKN_MY]      :     2        0.01s   0.007%  ------ ||
|| hfx_comms_metric                     :     6        0.01s   0.008%  ------ ||
|| remote_pack_ngwf                     :   381        0.01s   0.010%  ------ ||
|| ngwf_gradient_coeffs                 :     1        0.01s   0.010%  ------ ||
|| density_batch_row_sums               :     1        0.01s   0.011%  ------ ||
|| swri_metric_mat_symmetry             :     1        0.01s   0.016%  ------ ||
|| hash_table_purge_[SWOPS_IN_PPDS]     :     7        0.01s   0.016%  ------ ||
|| swri_init_container_stage_2          :     1        0.02s   0.019%  ------ ||
|| restart_ngwfs_tightbox_input         :     1        0.02s   0.022%  ------ ||
|| hash_table_list                      :   428        0.02s   0.025%  ------ ||
|| hash_table_purge_[SWOP_HITS]         :     3        0.02s   0.027%  ------ ||
|| cell_grid_deposit_box_real           :     6        0.02s   0.031%  ------ ||
|| density_fftbox_deposit_to_cell       :     5        0.03s   0.031%  ------ ||
|| dense_eigensolve                     :     3        0.03s   0.033%  ------ ||
|| hfx_comms_gradient_imbalance         :     2        0.03s   0.034%  ------ ||
|| swri_build_matrix_2                  :   162        0.03s   0.035%  ------ ||
|| hfx_populate_swop_cache_imbalance    :     6        0.04s   0.044%  ------ ||
|| eigenstates_calculate                :     2        0.04s   0.044%  ------ ||
|| hfx_comms_xmatrix                    :     7        0.04s   0.045%  ------ ||
|| remote_obtain_dkn_block              :   648        0.04s   0.046%  ------ ||
|| hfx_calc_aa_dd_ngwf_prods_in_ppds    :     6        0.04s   0.047%  ------ ||
|| properties_calculate                 :     2        0.04s   0.047%  ------ ||
|| sparse_init                          :     3        0.04s   0.052%  ------ ||
|| hfx_comms_dkn                        :    10        0.05s   0.059%  ------ ||
|| projectors_init_fftbox_recip         :     8        0.05s   0.061%  ------ ||
|| hash_table_free                      :    44        0.08s   0.101%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     6        0.08s   0.102%  ------ ||
|| remote_unpack_ngwf_no_sphere         :  3681        0.08s   0.103%  ------ ||
|| kernel_purify                        :    92        0.10s   0.119%  ------ ||
|| xc_energy_potential                  :     1        0.10s   0.119%  ------ ||
|| hfx_gradient_term2_qexpand3          :   621        0.10s   0.124%  ------ ||
|| basis_copy_function_to_box           :   246        0.12s   0.147%  ------ ||
|| hfx_gradient_term2_imbal             :     1        0.12s   0.155%  ------ ||
|| hfx_gradient_term2_part0             :     9        0.14s   0.170%  ------ ||
|| sparse_trace                         :   962        0.14s   0.174%  ------ ||
|| projectors_func_ovlp_box             :     6        0.14s   0.175%  ------ ||
|| lnv_gradient_norm                    :    30        0.14s   0.176%  ------ ||
|| cc_interaction_on_recip              :     1        0.16s   0.200%  ------ ||
|| cell_grid_extract_box_real           :   193        0.17s   0.207%  ------ ||
|| hfx_populate_swop_cache_bookkeeping  :     3        0.18s   0.218%  ------ ||
|| remote_obtain_ngwf                   :   723        0.18s   0.229%  ------ ||
|| kernel_fix                           :    30        0.20s   0.247%  ------ ||
|| hfx_comms_ngwfs                      :    24        0.20s   0.252%  ------ ||
|| hfx_grad_ket_dkn_baccum              :     3        0.21s   0.263%  ------ ||
|| hfx_comms_gradient                   :     2        0.23s   0.290%  ------ ||
|| hfx_main_work_imbalance              :     7        0.24s   0.294%  ------ ||
|| density_fftbox_interpolate_multiply  :     5        0.25s   0.304%  ------ ||
|| pseudo_make_structure_factor         :     1        0.25s   0.305%  ------ ||
|| function_ops_brappd_ketppd           :    12        0.28s   0.353%  ------ ||
|| remote_unpack_ngwf                   :  3629        0.29s   0.354%  ------ ||
|| density_batch_interp_deposit         :     1        0.31s   0.379%  ------ ||
|| projectors_gradient_batch            :     2        0.31s   0.391%  ------ ||
|| density_on_dbl_grid                  :     1        0.33s   0.404%  ------ ||
|| fourier_apply_cell_forward           :     5        0.34s   0.417%   9.371 ||
|| hfx_populate_swop_cache_sort         :     3        0.36s   0.444%  ------ ||
|| fourier_apply_box_pair               :   153        0.40s   0.491%  34.742 ||
|| linalg_dgesv                         :  2327        0.43s   0.532%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.44s   0.541%  ------ ||
|| energy_and_force_init_cell           :     1        0.44s   0.547%  ------ ||
|| hfx_calc_aa_dd_ngwf_prod_in_ppd      : 144.5k       0.48s   0.594%  ------ ||
|| basis_add_function_to_box            :  5463        0.51s   0.628%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.51s   0.635%  ------ ||
|| sparse_product                       :  1412        0.53s   0.654%  ------ ||
|| basis_dot_function_with_box          : 11625        0.57s   0.701%  ------ ||
|| fourier_apply_cell_backward          :     6        0.60s   0.738%   9.878 ||
|| hartree_on_grid                      :     1        0.60s   0.743%  ------ ||
|| lnv_denskernel_optimise_cg           :     2        0.65s   0.810%  ------ ||
|| hfx_all_ad_for_this_b_main           :    20        0.94s   1.162%  ------ ||
|| hfx_all_ad_for_this_b                :    20        0.94s   1.163%  ------ ||
|| swri_swop_calc_all_in_ppd_fast       :  6400        0.99s   1.226%  ------ ||
|| integrals_kinetic                    :     6        1.01s   1.250%  ------ ||
|| hfx_accum_q_beta                     :   364        1.05s   1.303%  ------ ||
|| hamiltonian_lhxc_calculate           :     1        1.12s   1.392%  ------ ||
|| hfx_contract_over_dkn_cc_main        :   141        1.12s   1.396%  ------ ||
|| hfx_populate_swop_cache_calc         :     3        1.29s   1.595%  ------ ||
|| hfx_calc_p_ac                        :    81        1.30s   1.618%  ------ ||
|| hfx_gradient_term2_part1             :     9        1.40s   1.742%  ------ ||
|| hfx_gradient_term2_part2             :    18        1.46s   1.815%  ------ ||
|| integrals_locpot_mat_els_batch       :    13        1.53s   1.893%  ------ ||
|| hfx_populate_swop_cache              :     3        1.84s   2.280%  ------ ||
|| hfx_main_ngwf_grad1                  :     1        1.91s   2.372%  ------ ||
|| hfx_dkn_indep_preparation            :     6        2.11s   2.616%  ------ ||
|| ngwf_gradient_build_batch            :     2        2.76s   3.420%  ------ ||
|| hfx_calc_expansion_for_q             :   621        2.79s   3.456%  ------ ||
|| hfx_gradient_term2_qexpand2          :   621        2.79s   3.458%  ------ ||
|| hfx_gradient                         :     2        3.46s   4.297%  ------ ||
|| ngwf_gradient_batch                  :     2        3.99s   4.946%  ------ ||
|| fourier_apply_box                    :   419        5.20s   6.454%  29.729 ||
|| sw_init                              :     1        7.02s   8.714%  ------ ||
|| potential_apply_to_ngwf_batch        :    13        7.04s   8.729%  ------ ||
|| hfx_gradient_term2_qexpand           :   621        7.43s   9.222%  ------ ||
|| swx_my_ngwf_pair_fitting             :     6        8.01s   9.940%  ------ ||
|| swx_expand_my_ngwf_pairs             :     6        8.01s   9.940%  ------ ||
|| hfx_expand_ngwf_pairs                :     6        8.13s  10.091%  ------ ||
|| integrals_locpot_dbl_grid            :     7        8.57s  10.628%  ------ ||
|| hfx_gradient_term2_part3             :    18       10.41s  12.908%  ------ ||
|| hfx_gradient_term2                   :     1       13.55s  16.809%  ------ ||
|| swx_swop_quantity_overlap_ppd_fast   :  2327       14.42s  17.894%  ------ ||
|| swx_expansion_2_fast                 :  2327       15.04s  18.661%  ------ ||
|| hfx_main_ngwf_grad2                  :     1       15.35s  19.038%  ------ ||
|| hfx_contract_over_dkn_cc_expa_get    :   141       24.67s  30.598%  ------ ||
|| ngwf_gradient_lnv                    :     1       25.83s  32.045%  ------ ||
|| hfx_contract_over_dkn_cc             :    20       25.95s  32.197%  ------ ||
|| hfx_main                             :     7       44.65s  55.389%  ------ ||
|| hf_exchange_calculate                :     7       44.71s  55.460%  ------ ||
|| ngwf_cg_optimise                     :     1       53.99s  66.973%  ------ ||
|| energy_and_forces                    :     1       79.92s  99.143%  ------ ||
|| total_time                           :     1       80.61s 100.000%  ------ ||
================================================================================
==================== AVERAGE TIMINGS FROM ALL PROCS (SELF) =====================
++ TAG                                    #calls    cpu time   %total  Gflops ++
++ onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ++
++ hfx_populate_swop_cache              :     3        0.00s   0.000%  ------ ++
++ hfx_determine_my_d_atoms             :     6        0.00s   0.000%  ------ ++
++ hfx_main_comms_imbalance             :     7        0.00s   0.000%  ------ ++
++ hfx_determine_my_a_atoms             :     6        0.00s   0.000%  ------ ++
++ hfx_split_pair_list                  :     6        0.00s   0.000%  ------ ++
++ hash_table_purge_[TCDKNBLKS_AB]      :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[DKNBLKS_AB]        :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[PPD_PRODUCTS]      :     2        0.00s   0.000%  ------ ++
++ hfx_main_ngwf_grad1                  :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[VMETRIC]           :     1        0.00s   0.000%  ------ ++
++ swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ++
++ hfx_all_ad_for_this_b                :    20        0.00s   0.000%  ------ ++
++ hash_table_purge_[TCDKNBLKS_BA]      :     1        0.00s   0.000%  ------ ++
++ sparse_set_to_garbage                :    40        0.00s   0.000%  ------ ++
++ hf_exchange_calculate_imbalance      :     7        0.00s   0.000%  ------ ++
++ hfx_determine_ppd_list               :     6        0.00s   0.000%  ------ ++
++ swx_expand_my_ngwf_pairs             :     6        0.00s   0.000%  ------ ++
++ onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ++
++ hash_table_purge_[ALISTS]            :     7        0.00s   0.000%  ------ ++
++ hash_table_purge_[DKNBLKS_CD]        :     7        0.00s   0.000%  ------ ++
++ restart_kernel_read                  :     1        0.00s   0.001%  ------ ++
++ ngwf_gradient_coeffs                 :     1        0.00s   0.001%  ------ ++
++ hfx_determine_alists                 :     6        0.00s   0.001%  ------ ++
++ hash_table_purge_[COEFFS]            :    14        0.00s   0.001%  ------ ++
++ hfx_all_ad_for_this_b_store          :    20        0.00s   0.001%  ------ ++
++ hash_table_purge_[XAB]               :     7        0.00s   0.001%  ------ ++
++ properties_calculate                 :     2        0.00s   0.001%  ------ ++
++ neighbour_list_populate              :     5        0.00s   0.001%  ------ ++
++ hfx_comms_xmatrix_imbalance          :     7        0.00s   0.001%  ------ ++
++ hfx_main_ngwf_grad2                  :     1        0.00s   0.001%  ------ ++
++ pseudopotentials_nonlocal_mat        :     6        0.00s   0.001%  ------ ++
++ hash_table_purge_[EXPANSIONS]        :     2        0.00s   0.002%  ------ ++
++ hfx_contract_over_dkn_cc_dkn_get     :   141        0.00s   0.002%  ------ ++
++ hash_table_purge_[DLISTS]            :     7        0.00s   0.002%  ------ ++
++ hfx_determine_bc_pairs               :     6        0.00s   0.002%  ------ ++
++ swri_init_container_stage_2          :     1        0.00s   0.002%  ------ ++
++ hash_table_purge_[AKETS_DKN_LOC]     :     2        0.00s   0.003%  ------ ++
++ hfx_gradient_term2_qexpand2          :   621        0.00s   0.003%  ------ ++
++ hfx_determine_dlists                 :     6        0.00s   0.003%  ------ ++
++ hfx_comms_metric                     :     6        0.00s   0.003%  ------ ++
++ hfx_determine_a_ppd_list_for_b       :    56        0.00s   0.003%  ------ ++
++ swri_vmatrixblock_sc                 :   124        0.00s   0.003%  ------ ++
++ sparse_embed_hotelling_invert_embed  :     6        0.00s   0.003%  ------ ++
++ hash_table_purge_[NGWFS]             :    14        0.00s   0.004%  ------ ++
++ remote_obtain_matrix_block           :   121        0.00s   0.004%  ------ ++
++ hash_table_purge_[PPD_NGWFS_DD]      :     7        0.00s   0.005%  ------ ++
++ basis_extract_function_from_box      :    73        0.00s   0.005%  ------ ++
++ hfx_gradient_term2_qexpand           :   621        0.00s   0.005%  ------ ++
++ hf_exchange_calculate                :     7        0.00s   0.005%  ------ ++
++ density_batch_row_sums               :     1        0.00s   0.006%  ------ ++
++ hfx_dkn_indep_preparation            :     6        0.00s   0.006%  ------ ++
++ density_fftbox_deposit_to_cell       :     5        0.01s   0.006%  ------ ++
++ integrals_locpot_dbl_grid            :     7        0.01s   0.006%  ------ ++
++ hash_table_purge_[AKETS_DKN_MY]      :     2        0.01s   0.007%  ------ ++
++ remote_pack_ngwf                     :   381        0.01s   0.010%  ------ ++
++ hfx_main                             :     7        0.01s   0.012%  ------ ++
++ hfx_comms_dkn                        :    10        0.01s   0.013%  ------ ++
++ density_on_dbl_grid                  :     1        0.01s   0.013%  ------ ++
++ swri_metric_mat_symmetry             :     1        0.01s   0.016%  ------ ++
++ hash_table_purge_[SWOPS_IN_PPDS]     :     7        0.01s   0.016%  ------ ++
++ kernel_fix                           :    30        0.01s   0.017%  ------ ++
++ hfx_gradient_term2                   :     1        0.02s   0.019%  ------ ++
++ eigenstates_calculate                :     2        0.02s   0.020%  ------ ++
++ restart_ngwfs_tightbox_input         :     1        0.02s   0.022%  ------ ++
++ hfx_comms_ngwfs                      :    24        0.02s   0.022%  ------ ++
++ hash_table_list                      :   428        0.02s   0.025%  ------ ++
++ hash_table_purge_[SWOP_HITS]         :     3        0.02s   0.027%  ------ ++
++ cell_grid_deposit_box_real           :     6        0.02s   0.031%  ------ ++
++ xc_energy_potential                  :     1        0.03s   0.031%  ------ ++
++ swri_build_matrix_2                  :   162        0.03s   0.031%  ------ ++
++ kernel_purify                        :    92        0.03s   0.032%  ------ ++
++ dense_eigensolve                     :     3        0.03s   0.033%  ------ ++
++ hartree_on_grid                      :     1        0.03s   0.033%  ------ ++
++ hfx_comms_gradient_imbalance         :     2        0.03s   0.034%  ------ ++
++ hfx_calc_aa_dd_ngwf_prods_in_ppds    :     6        0.03s   0.036%  ------ ++
++ hfx_populate_swop_cache_imbalance    :     6        0.04s   0.044%  ------ ++
++ hfx_comms_xmatrix                    :     7        0.04s   0.044%  ------ ++
++ remote_obtain_dkn_block              :   648        0.04s   0.046%  ------ ++
++ lnv_gradient_norm                    :    30        0.04s   0.049%  ------ ++
++ lnv_denskernel_optimise_cg           :     2        0.04s   0.050%  ------ ++
++ sparse_init                          :     3        0.04s   0.052%  ------ ++
++ projectors_init_fftbox_recip         :     8        0.05s   0.061%  ------ ++
++ density_batch_interp_deposit         :     1        0.05s   0.062%  ------ ++
++ hash_table_free                      :    44        0.05s   0.064%  ------ ++
++ hfx_gradient_term2_part0             :     9        0.06s   0.068%  ------ ++
++ hfx_gradient_term2_part3             :    18        0.08s   0.095%  ------ ++
++ remote_unpack_ngwf_no_sphere         :  3681        0.08s   0.103%  ------ ++
++ density_fftbox_interpolate_multiply  :     5        0.09s   0.112%  ------ ++
++ ngwf_cg_optimise                     :     1        0.09s   0.113%  ------ ++
++ hamiltonian_lhxc_calculate           :     1        0.09s   0.115%  ------ ++
++ projectors_func_ovlp_box             :     6        0.09s   0.117%  ------ ++
++ swx_my_ngwf_pair_fitting             :     6        0.10s   0.121%  ------ ++
++ hfx_gradient_term2_qexpand3          :   621        0.10s   0.124%  ------ ++
++ hfx_gradient_term2_part1             :     9        0.10s   0.125%  ------ ++
++ basis_copy_function_to_box           :   246        0.12s   0.147%  ------ ++
++ hfx_expand_ngwf_pairs                :     6        0.12s   0.150%  ------ ++
++ hfx_gradient_term2_imbal             :     1        0.12s   0.155%  ------ ++
++ sparse_trace                         :   962        0.14s   0.174%  ------ ++
++ cc_interaction_on_recip              :     1        0.16s   0.200%  ------ ++
++ hfx_contract_over_dkn_cc             :    20        0.16s   0.202%  ------ ++
++ cell_grid_extract_box_real           :   193        0.17s   0.207%  ------ ++
++ hfx_populate_swop_cache_bookkeeping  :     3        0.17s   0.217%  ------ ++
++ remote_obtain_ngwf                   :   723        0.18s   0.219%  ------ ++
++ swx_expansion_2_fast                 :  2327        0.19s   0.235%  ------ ++
++ hfx_comms_gradient                   :     2        0.21s   0.256%  ------ ++
++ hfx_grad_ket_dkn_baccum              :     3        0.21s   0.263%  ------ ++
++ projectors_gradient_batch            :     2        0.22s   0.272%  ------ ++
++ pseudopotentials_local_on_grid       :     1        0.22s   0.277%  ------ ++
++ hfx_main_work_imbalance              :     7        0.24s   0.294%  ------ ++
++ pseudo_make_structure_factor         :     1        0.25s   0.305%  ------ ++
++ main_program_(onetep.F90)            :     1        0.25s   0.308%  ------ ++
++ hfx_populate_swop_cache_calc         :     3        0.25s   0.310%  ------ ++
++ energy_and_force_init_cell           :     1        0.28s   0.347%  ------ ++
++ function_ops_brappd_ketppd           :    12        0.28s   0.353%  ------ ++
++ remote_unpack_ngwf                   :  3629        0.29s   0.354%  ------ ++
++ hfx_populate_swop_cache_sort         :     3        0.29s   0.358%  ------ ++
++ ngwf_gradient_lnv                    :     1        0.29s   0.363%  ------ ++
++ fourier_apply_cell_forward           :     5        0.34s   0.417%   9.371 ++
++ energy_and_forces                    :     1        0.34s   0.417%  ------ ++
++ hfx_gradient_term2_part2             :    18        0.38s   0.469%  ------ ++
++ fourier_apply_box_pair               :   153        0.40s   0.491%  34.742 ++
++ linalg_dgesv                         :  2327        0.43s   0.532%  ------ ++
++ ngwfs_initialise_from_radial         :     1        0.44s   0.541%  ------ ++
++ hfx_all_ad_for_this_b_main           :    20        0.44s   0.542%  ------ ++
++ hfx_calc_aa_dd_ngwf_prod_in_ppd      : 144.5k       0.48s   0.594%  ------ ++
++ basis_add_function_to_box            :  5463        0.51s   0.628%  ------ ++
++ integrals_kinetic                    :     6        0.53s   0.654%  ------ ++
++ sparse_product                       :  1412        0.53s   0.654%  ------ ++
++ basis_dot_function_with_box          : 11625        0.57s   0.701%  ------ ++
++ fourier_apply_cell_backward          :     6        0.60s   0.738%   9.878 ++
++ ngwf_gradient_batch                  :     2        0.76s   0.945%  ------ ++
++ swri_swop_calc_all_in_ppd_fast       :  6400        0.99s   1.226%  ------ ++
++ ngwf_gradient_build_batch            :     2        1.03s   1.277%  ------ ++
++ hfx_accum_q_beta                     :   364        1.05s   1.303%  ------ ++
++ hfx_contract_over_dkn_cc_main        :   141        1.12s   1.396%  ------ ++
++ integrals_locpot_mat_els_batch       :    13        1.13s   1.405%  ------ ++
++ hfx_calc_p_ac                        :    81        1.30s   1.617%  ------ ++
++ hfx_calc_expansion_for_q             :   621        2.79s   3.456%  ------ ++
++ potential_apply_to_ngwf_batch        :    13        2.81s   3.485%  ------ ++
++ hfx_gradient                         :     2        3.32s   4.116%  ------ ++
++ fourier_apply_box                    :   419        5.20s   6.454%  29.729 ++
++ sw_init                              :     1        7.02s   8.714%  ------ ++
++ swx_swop_quantity_overlap_ppd_fast   :  2327       14.42s  17.894%  ------ ++
++ hfx_contract_over_dkn_cc_expa_get    :   141       24.67s  30.598%  ------ ++
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 1 ms ensuring consistency across MPI ranks,
- 4 ms printing in order.

Job completed: 27-09-2022 10:07 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
