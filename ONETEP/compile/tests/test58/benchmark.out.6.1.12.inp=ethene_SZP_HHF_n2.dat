==================================================================================
It's Wed Sep 21 11:06:33 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 18037 18038 18039 18040)...
    - ONETEP arguments: ethene_SZP_HHF_n2.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test58
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test58/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test58/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack ethene_SZP_HHF_n2.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 11:06 (+0100)
 
Reading parameters from file "ethene_SZP_HHF_n2.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 10 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 10
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Hartree-Fock exchange | hfx_bc          |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "ethene_SZP_HHF_n2.dat" ...    
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

print_qc T                                                                      
hhf_nstates 2                                                                   
num_eigenvalues 100                                                             
output_detail VERBOSE                                                           
timings_level 3                                                                 
do_properties T                                                                 
xc_functional HF                                                                
maxit_ngwf_cg 2                                                                 
%block swri                                                                     
for_hfx 3 14 V 12 12 E                                                          
%endblock swri                                                                  
%block species_swri-for_hfx                                                     
C                                                                               
H                                                                               
%endblock species_swri-for_hfx                                                  
hfx_use_ri for_hfx                                                              
hfx_max_l 3                                                                     
hfx_max_q 14                                                                    
cutoff_energy 800.0 eV                                                          
%block lattice_cart                                                             
40.000    0.000    0.000                                                        
0.000   40.000    0.000                                                         
0.000    0.000   40.000                                                         
%endblock lattice_cart                                                          
%block positions_abs                                                            
     Hash =   000003804036565042708289
%endblock positions_abs                                                         
%block species                                                                  
C   C   6 9 6.0                                                                 
H   H   1 4 6.0                                                                 
%endblock species                                                               
%block species_atomic_set                                                       
C "SOLVE conf=2s2 2p2 3sX 3pX 3d0"                                              
H "SOLVE conf=1s1 2sX 2p0"                                                      
%endblock species_atomic_set                                                    
%block species_pot                                                              
C   "../../pseudo/carbon.recpot"                                                
H   "../../pseudo/hydrogen.recpot"                                              
%endblock species_pot                                                           

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          2        18         2
  H          4        16         0
.......   ......    ......    ......
Totals:      6        34         2
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   81 x  81 x  81
                              FFT-box:   81 x  81 x  81
                                  PPD:    9 x   9 x   1
Grid space d1=  0.493827160494a0 (KE cutoff=  31.14971Eh = 847.62683eV)
Grid space d2=  0.493827160494a0 (KE cutoff=  31.14971Eh = 847.62683eV)
Grid space d3=  0.493827160494a0 (KE cutoff=  31.14971Eh = 847.62683eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     81    81    81
          Real-space ('12') slabs/proc (min max mean):     20    21    20
         Recip-space ('23') slabs/proc (min max mean):     10    11    10
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    162   162   162
          Real-space ('12') slabs/proc (min max mean):     40    41    40
         Recip-space ('23') slabs/proc (min max mean):     20    21    20
********************************************************************************

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String: 2s2 2p2 3sX 3pX 3d0
Orbitals (num,occ):  3     2.00 2.00 0.00
Orbitals   (num,l):  3        0    1    2
Real-space Grid (nr,dr,rmax):  901    0.0066666667    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   35    2  176.3967570603
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
Confining potential (l,width,scale):  2    3.0000000000  100.0000000000
  1       1515.2178147317    0.5700789947    4.5135255103    0.0000000000
  2        604.1655129531    0.2805610610    4.2025687664    0.0000000000
  3        312.2387311263    0.2981655004    4.2196727647    0.0000000000
  4        160.4767102865    0.2968259127    4.2182786268    0.0000000000
  5         81.5648862448    0.2951146617    4.2165545031    0.0000000000
  6         40.5313018917    0.2941638643    4.2156004768    0.0000000000
  7         19.1939390509    0.2936860494    4.2151218476    0.0000000000
  8          8.0985393782    0.2934505941    4.2148861862    0.0000000000
  9          2.3289428055    0.2933349950    4.2147705348    0.0000000000
 10         -0.6712425669    0.2932782547    4.2147137812    0.0000000000
 11         -2.2313368276    0.2932503905    4.2146859137    0.0000000000
 12         -3.0425849057    0.2932366978    4.2146722201    0.0000000000
 13         -3.4644334982    0.2932299645    4.2146654866    0.0000000000
 14         -3.6837945913    0.2932266512    4.2146621733    0.0000000000
 15         -3.7978622860    0.2932250198    4.2146605418    0.0000000000
 16         -3.8571774571    0.2932242159    4.2146597380    0.0000000000
 17         -3.8880213342    0.2932238196    4.2146593417    0.0000000000
 18         -3.9040601459    0.2932236241    4.2146591462    0.0000000000
 19         -3.9124003265    0.2932235276    4.2146590497    0.0000000000
 20         -3.9167372201    0.2932234800    4.2146590020    0.0000000000
 21         -3.9189924047    0.2932234564    4.2146589785    0.0000000000
 22         -3.9201651008    0.2932234448    4.2146589668    0.0000000000
 23         -3.9207749028    0.2932234390    4.2146589611    0.0000000000
 24         -3.9210920000    0.2932234362    4.2146589582    0.0000000000
 25         -3.9212568905    0.2932234347    4.2146589568    0.0000000000
 26         -3.9213426336    0.2932234340    4.2146589561    0.0000000000
 27         -3.9213872200    0.2932234337    4.2146589557    0.0000000000
 28         -3.9214104050    0.2932234335    4.2146589556    0.0000000000
 29         -3.9214224612    0.2932234334    4.2146589555    0.0000000000
 30         -3.9214287304    0.2932234334    4.2146589554    0.0000000000
 31         -3.9214319904    0.2932234334    4.2146589554    0.0000000000
 32         -3.9214336856    0.2932234334    4.2146589554    0.0000000000
 33         -3.9214345671    0.2932234334    4.2146589554    0.0000000000
 34         -3.9214350255    0.2932234334    4.2146589554    0.0000000000
 35         -3.9214352638    0.2932234334    4.2146589554    0.0000000000
 36         -3.9214353878    0.2932234334    4.2146589554    0.0000000000
 37         -3.9214354522    0.2932234334    4.2146589554    0.0000000000
Atom SCF converged after  37 iterations to a total energy of     -3.92143545

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String: 1s1 2sX 2p0
Orbitals (num,occ):  2     1.00 0.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax):  901    0.0066666667    6.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   35    1  176.3967570603
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1        379.8618174641    0.0922494543    0.2820953444    0.0000000000
  2        151.8277803917    0.0885098813    0.2770700000    0.0000000000
  3         78.8593071394    0.0869259909    0.2753289952    0.0000000000
  4         40.9161382248    0.0860597497    0.2744230724    0.0000000000
  5         21.1858607877    0.0855992334    0.2739525060    0.0000000000
  6         10.9261860443    0.0853586554    0.2737093791    0.0000000000
  7          5.5911847012    0.0852343956    0.2735844723    0.0000000000
  8          2.8169969849    0.0851707024    0.2735206149    0.0000000000
  9          1.3744252536    0.0851382246    0.2734880954    0.0000000000
 10          0.6242906844    0.0851217239    0.2734715840    0.0000000000
 11          0.2342220023    0.0851133618    0.2734632192    0.0000000000
 12          0.0313869103    0.0851091317    0.2734589885    0.0000000000
 13         -0.0740870342    0.0851069946    0.2734568512    0.0000000000
 14         -0.1289333362    0.0851059159    0.2734557725    0.0000000000
 15         -0.1574533394    0.0851053718    0.2734552283    0.0000000000
 16         -0.1722837044    0.0851050974    0.2734549540    0.0000000000
 17         -0.1799954758    0.0851049592    0.2734548157    0.0000000000
 18         -0.1840055878    0.0851048895    0.2734547460    0.0000000000
 19         -0.1860908414    0.0851048544    0.2734547109    0.0000000000
 20         -0.1871751710    0.0851048367    0.2734546932    0.0000000000
 21         -0.1877390212    0.0851048278    0.2734546843    0.0000000000
 22         -0.1880322228    0.0851048233    0.2734546799    0.0000000000
 23         -0.1881846873    0.0851048211    0.2734546776    0.0000000000
 24         -0.1882639687    0.0851048199    0.2734546765    0.0000000000
 25         -0.1883051949    0.0851048194    0.2734546759    0.0000000000
 26         -0.1883266325    0.0851048191    0.2734546756    0.0000000000
 27         -0.1883377801    0.0851048189    0.2734546755    0.0000000000
 28         -0.1883435768    0.0851048189    0.2734546754    0.0000000000
 29         -0.1883465911    0.0851048188    0.2734546753    0.0000000000
 30         -0.1883481585    0.0851048188    0.2734546753    0.0000000000
 31         -0.1883489735    0.0851048188    0.2734546753    0.0000000000
 32         -0.1883493974    0.0851048188    0.2734546753    0.0000000000
 33         -0.1883496178    0.0851048188    0.2734546753    0.0000000000
 34         -0.1883497324    0.0851048188    0.2734546753    0.0000000000
 35         -0.1883497920    0.0851048188    0.2734546753    0.0000000000
Atom SCF converged after  35 iterations to a total energy of     -0.18834979

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Hartree-Fock exchange | hfx_bc          |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      9;  min      8;  average      9
... Projector load balancing: max      1;  min      0;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =           16.026401
        Ewald: reciprocal-space energy =            0.702002
         Ewald: (sum_charge)**2 energy =            0.990578
         Ewald: (sum_charge**2) energy =            1.213206
                          Ewald energy =           14.524619
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):         17631        70518
... Nonlocal pseudopotential projector initialisation
... done

Initialising remote NGWF capability... done. 

SWRI: Initialising module (stage 1)... 
SWRI: [for_hfx] Initialising (stage 1)...
SWRI: [for_hfx] - Using default V metric matrix evaluation scheme (2D numerical-1D analytic).
SWRI: [for_hfx] - Initialising Bessels (l_max=3)... WARNING: Spherical waves with l=2 and qi=14 will be ignored for species #1.
WARNING: Spherical waves with l=3 and qi=14 will be ignored for species #1.
WARNING: Spherical waves with l=2 and qi=14 will be ignored for species #2.
WARNING: Spherical waves with l=3 and qi=14 will be ignored for species #2.
done.
SWRI: [for_hfx] - Initialising radial lookup... done.
SWRI: [for_hfx] - SW batch size (tile width) set to 212.
SWRI: [for_hfx] - Initialising persistent cache structures... done.
SWRI: [for_hfx] - Initialising metric matrix... done.
SWRI: [for_hfx] Done.
SWRI: Stage 1 completed.

========================== Sparse matrix information ===========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  19.55%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
HFx: Creating X matrix structure for val rep (spin 1).
Initializing spherical harmonic rotation module.

SWRI: Initializing module (stage 2)... 
SWRI: [for_hfx] Initialising (stage 2)... 
SWRI: [for_hfx] - NL: Populating neighbour list: SWRI_S_ATOMS... done.
SWRI: [for_hfx] - Generating and communicating atomblock list.
SWRI: [for_hfx]   0 atomblocks read from disk.
SWRI: [for_hfx]   15 atomblocks to process.
SWRI: [for_hfx]   Sorting atomblocks according to proximitiy to (0.000000,    0.000000,    0.000000).
SWRI: [for_hfx] - Calculating on-site elements of the metric matrix V... done.
SWRI: [for_hfx] - Calculating off-site elements of the metric matrix V.
 +----------------------------------------------------+
 |  Spherical wave res. of identity Chebyshev engine  |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  workspace atomblock                 :  392.00 kB  |
 |  vtile                               :  371.00 kB  |
 |  recvtile                            :  371.00 kB  |
 |  workers_done                        :   16.00  B  |
 |  atomblocklist                       :  300.00  B  |
 |  tilelist (root only)                :  180.00  B  |
 |  tile hash table (upper bound)       :    1.53 MB  |
 |  nodes_template                      :  162.00 kB  |
 |  swop_values                         :    1.58 MB  |
 |  swy_values                          :    1.58 MB  |
 |  swhome_all_coeffs                   :   33.54 MB  |
 |  swpot_batch_coeffs                  :   33.54 MB  |
 |  all_atomblocks (indices)            :  180.00  B  |
 |  my_atomblocks (indices)             :  180.00  B  |
 |  num_q_per_l                         :   32.00  B  |
 |  atomblock rotation matrix           :  351.12 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :   73.38 MB  |
 +----------------------------------------------------+
SWRI: [for_hfx]   15 tiles to process (15 atomblocks x 1 batches)
SWRI: [for_hfx]   Tiles completed:        0, left:       14, in progress:     1.
SWRI: [for_hfx]   Tiles completed:        2, left:        9, in progress:     4.
SWRI: [for_hfx]   Tiles completed:        5, left:        6, in progress:     4.
SWRI: [for_hfx]   Tiles completed:        9, left:        2, in progress:     4.
SWRI: [for_hfx]   Tiles completed:       13, left:        0, in progress:     2.
SWRI: [for_hfx] - Filling the remainder by symmetry.
SWRI: Done.
SWX: Initialising module... 
done.
NL: Populating neighbour list: HFx_S_ATOMS... done.
NL: Populating neighbour list: HFx_X_ATOMS... done.
NL: Populating neighbour list: HFx_XS_ATOMS... done.
NL: Populating neighbour list: HFx_SXS_ATOMS... done.
SWX: Initialising val%[hfx_swex]->full-RI->[for_hfx].
SWX: - min_l: 0, max_l: 3, max_q: 14, num_sws: 212, max_sws: 224.
SWX: Done.
NGWF initialisation ...... done
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |         6 |       1 |       6 |       7 |       306 |       306 |
|       1 |        12 |       2 |       6 |       8 |       272 |       272 |
|       2 |         6 |       1 |       6 |       7 |       306 |       306 |
|       3 |        12 |       2 |       6 |       8 |       272 |       272 |
+---------------------------------------------------------------------------+
|     min |         6 |       1 |       6 |       7 |       272 |       272 |
|     max |        12 |       2 |       6 |       8 |       306 |       306 |
| average |       9.0 |     1.5 |     6.0 |     7.5 |     289.0 |     289.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Estimating memory use...
 +----------------------------------------------------+
 |  HFx TEFCI engine: minimum requirements            |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  Radial Bessel lookup                :   41.20 MB  |
 |  Dd NGWFs hash table                 :  150.00 kB  |
 |  All remote NGWFs hash table         :    7.10 MB  |
 |  dlists hash table                   :    2.46 MB  |
 |  coeffs hash table (estimate)        :    1.14 MB  |
 |  V metric matrix hash table          :    5.34 MB  |
 |  f auxiliary term                    :   38.57 MB  |
 |  P term in NGWF gradient             :   38.57 MB  |
 |  Q term in NGWF gradient             :    4.35 MB  |
 |  My kets in NGWF grad. (estimate)    :   10.83 MB  |
 |  Local kets in NGWF grad. (estim.)   :    3.11 MB  |
 |  K^{CD} hash table                   :  322.78 kB  |
 |  K^{AB} hash table                   :  307.59 kB  |
 |  tcK^A_B hash table                  :  307.59 kB  |
 |  tcK^B_A hash table                  :  307.59 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :  154.02 MB  |
 +----------------------------------------------------+
HFx: - Adjusting cache sizes according to weights: 0.6250, 0.3125, 0.0625.
 +----------------------------------------------------+
 |  HFx TEFCI engine: user-adjustable requirements    |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  SWOP hash table                     :  324.82 MB  |
 |  Expansions hash table               :    2.94 GB  |
 |  AD NGWF products hash table         :  602.00 MB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :    3.85 GB  |
 +----------------------------------------------------+
HFx: - Peak memory use capped at 4094.8 MB per MPI rank.
+------------------------------------------------------------------------------+
|    MPI |                           |              |           |              |
|   rank |       SWOP cache capacity | SWOPs needed | Cacheable |    Hit ratio |
+------------------------------------------------------------------------------+
|      0 |         324 MiB (2346 el) |      2346 el |   100.00% |      100.00% |
|      1 |         324 MiB (2346 el) |      2346 el |   100.00% |      100.00% |
|      2 |         324 MiB (2346 el) |      2346 el |   100.00% |      100.00% |
|      3 |         324 MiB (2346 el) |      2346 el |   100.00% |      100.00% |
+------------------------------------------------------------------------------+
HFx: - Populating SWOP cache...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.56155789E+01     0.97039275E+00
               2       0.54464962E+01     0.94293697E+00
               3       0.51983912E+01     0.89370171E+00
               4       0.48970783E+01     0.81356620E+00
               5       0.46023414E+01     0.72999884E+00
               6       0.43499756E+01     0.71867354E+00
               7       0.41215750E+01     0.71391649E+00
               8       0.38752983E+01     0.70948828E+00
               9       0.35777496E+01     0.70488675E+00
              10       0.32388663E+01     0.70003637E+00
              11       0.28826677E+01     0.69350027E+00
              12       0.25289694E+01     0.68277365E+00
              13       0.21901475E+01     0.66489831E+00
              14       0.18754230E+01     0.63576880E+00
              15       0.15976667E+01     0.58595675E+00
              16       0.13322060E+01     0.49938543E+00
              17       0.10182657E+01     0.36369712E+00
              18       0.63015886E+00     0.19455836E+00
              19       0.26963416E+00     0.57379603E-01
              20       0.59882362E-01     0.84684673E-02
              21       0.34402343E-02     0.47803309E-03
              22       0.11814339E-04     0.16326895E-05
              23       0.13957652E-09     0.19280577E-10
              24       0.32246567E-13     0.97699626E-14
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1           3.90161556752851    0.2558053
               2           3.65621486767347    0.2621933
               3           3.36055504437448    0.2712731
               4           3.00649386536200    0.2837706
               5           2.58721394285709    0.2999630
               6           2.10279993489340    0.3184677
               7           1.57309263086461    0.3344869
               8           1.05315252582265    0.3403816
               9           0.61884177360345    0.3277446
              10           0.31807644808775    0.2878005
              11           0.15507648743321    0.2393874
              12           0.08310350843619    0.2300359
              13           0.04020854336435    0.2526756
              14          -0.00022183967403    0.2725295
              15          -0.03655011288218    0.2674314
              16          -0.06174895208563    0.2411374
              17          -0.07489068786269    0.2449590
              18          -0.08346878828364    0.2738816
              19          -0.09089815154180    0.3071669
              20          -0.09720287289088    0.3428628
              21          -0.10235342193910    0.3813430
              22          -0.10647286235097    0.4227393
              23          -0.10961324960400    0.4629303
              24          -0.11155411435181    0.4906005
              25          -0.11222117289288    0.4993707
              26          -0.11228755990279    0.4999973
              27          -0.11228818481203    0.5000006
              28          -0.11228818487017    0.5000006
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

Writing density kernel to file "ethene_SZP_HHF_n2.dkn" ... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      16.00000000
     Final electron number for spin 1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  - B:       1 [0] (1)
  - B:       5 [3] (1)
  - B:       2 [1] (1)
  - B:       4 [2] (1)
  - B:       6 [3] (1)
  - B:       3 [1] (1)
  - B:       5 [3] (2)
  - B:       2 [1] (2)
  - B:       4 [2] (2)
  - B:       1 [0] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  + B:       5 [3]
  + B:       6 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       1 [0]
  + B:       3 [1]
HFx: +-----------------------------------------------------------------------+
HFx: |    MPI |                          Expansion cache                     |
HFx: |   rank |           hits |         misses |          total | hit ratio |
HFx: +-----------------------------------------------------------------------+
HFx: |      0 |         119646 |              0 |         119646 |  100.00 % |
HFx: |      1 |         106352 |              0 |         106352 |  100.00 % |
HFx: |      2 |         119646 |              0 |         119646 |  100.00 % |
HFx: |      3 |         106352 |              0 |         106352 |  100.00 % |
HFx: +-----------------------------------------------------------------------+
HFx: +-----------------------------------------------------------------------+
HFx: |    MPI |                    AD NGWF product cache                     |
HFx: |   rank |           hits |         misses |          total | hit ratio |
HFx: +-----------------------------------------------------------------------+
HFx: |      0 |           5534 |              0 |           5534 |  100.00 % |
HFx: |      1 |          11068 |              0 |          11068 |  100.00 % |
HFx: |      2 |           5534 |              0 |           5534 |  100.00 % |
HFx: |      3 |          11068 |              0 |          11068 |  100.00 % |
HFx: +-----------------------------------------------------------------------+
HFx: Exchange matrix symmetric to  3.79 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -3.910892143293 Ha.
      ideal mu1:      -0.707462081479
             Q0:         -19.367868925582
             G0:      -1.454411045430
   RMS gradient:       0.035470283940
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.55 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.269342166219 Ha.
     Trial step:       0.500000000000
             Q1:         -19.581874917396
 Quadratic coef:       0.513199530900
 Linear coef   :      -0.727205522715
           Qmin:         -19.625482115202
Quadratic minimum step length (  0.354250870728) accepted
    Initial Ne1:      16.00000000
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.008508 (step -0.4788 Ne1=     16.0000)
 RMS occupancy error at iteration   2:  0.000098 (step -0.5001 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -1.936786892558E+01     3.5470E-02     7.5374E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.61 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.174485330729 Ha.
      ideal mu1:      -0.598150558094
             Q0:         -19.633233728089
             G0:      -0.122117128115
   RMS gradient:       0.010018385353
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       1 [0]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.70 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.210570169397 Ha.
     Trial step:       0.420862727459
             Q1:         -19.657829047553
 Quadratic coef:       0.026799228144
 Linear coef   :      -0.051394547608
           Qmin:         -19.657874358685
Quadratic minimum step length (  0.403557321998) accepted
    Initial Ne1:      15.99999366
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002435 (step -0.4934 Ne1=     16.0000)
 RMS occupancy error at iteration   2:  0.000011 (step -0.5000 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -1.963323372809E+01     1.0018E-02     2.1289E-02    -2.6536E-01
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.70 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.209502842407 Ha.
      ideal mu1:      -0.584303739157
             Q0:         -19.658422855334
             G0:      -0.008789097272
   RMS gradient:       0.002713451024
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.70 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.216823019233 Ha.
     Trial step:       0.412119200259
             Q1:         -19.660664165734
 Quadratic coef:       0.001380845338
 Linear coef   :      -0.003622155739
           Qmin:         -19.660798214078
Quadratic minimum step length (  0.540523940240) accepted
    Initial Ne1:      15.99999927
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000492 (step -0.4984 Ne1=     16.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -1.965842285533E+01     2.7135E-03     5.7661E-03    -2.5189E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.70 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.218972363009 Ha.
      ideal mu1:      -0.582035775971
             Q0:         -19.660818293261
             G0:      -0.001680062382
   RMS gradient:       0.001199160713
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       1 [0]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.71 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.218620462029 Ha.
     Trial step:       0.471974887015
             Q1:         -19.661276835152
 Quadratic coef:       0.000334405362
 Linear coef   :      -0.000792947253
           Qmin:         -19.661288355510
Quadratic minimum step length (  0.559577136523) accepted
    Initial Ne1:      15.99999985
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000162 (step -0.4995 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    4        -1.966081829326E+01     1.1992E-03     2.5482E-03    -2.3954E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.71 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.218544117110 Ha.
      ideal mu1:      -0.582648640329
    5        -1.966129018984E+01     6.5085E-04     1.3830E-03    -4.7190E-04
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_SZP_HHF_n2.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.96612901898357E+01  Eh
     Estimated bandgap           =   1.5789E-01  Eh
     RMS occupancy error         =   5.7773E-08
     [H,K] commutator            =   1.3830E-03
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        8.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 1).
  + B:       5 [3]
  + B:       4 [2]
  + B:       1 [0]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
HFx: Communicating NGWF gradient kets.
  * C:       1 [2]
  * C:       1 [0]
  * C:       1 [1]
  * C:       1 [3]
  * C:       2 [0]
  * C:       2 [3]
  * C:       2 [2]
  * C:       3 [0]
  * C:       2 [1]
  * C:       3 [3]
  * C:       3 [1]
  * C:       3 [2]
  * C:       4 [3]
  * C:       4 [0]
  * C:       4 [1]
  * C:       4 [2]
  * C:       5 [3]
  * C:       5 [2]
  * C:       5 [0]
  * C:       6 [3]
  * C:       5 [1]
  * C:       6 [2]
  * C:       6 [0]
  * C:       6 [1]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.71 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.218544117110 Ha.
HFx: ^ (accounting for spin degeneracy in density kernel in val gradient calc)
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1436E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |         6 |       1 |       6 |       7 |       306 |       306 |
|       1 |        12 |       2 |       6 |       8 |       272 |       272 |
|       2 |         6 |       1 |       6 |       7 |       306 |       306 |
|       3 |        12 |       2 |       6 |       8 |       272 |       272 |
+---------------------------------------------------------------------------+
|     min |         6 |       1 |       6 |       7 |       272 |       272 |
|     max |        12 |       2 |       6 |       8 |       306 |       306 |
| average |       9.0 |     1.5 |     6.0 |     7.5 |     289.0 |     289.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.65872166E-01     0.12600124E-01
               2       0.58618328E-03     0.95037245E-04
               3       0.10793440E-06     0.18522964E-07
               4       0.30288847E-13     0.71054274E-14
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  - B:       2 [1] (1)
  - B:       4 [2] (1)
  - B:       1 [0] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       6 [3] (1)
  - B:       2 [1] (2)
  - B:       5 [3] (2)
  - B:       4 [2] (2)
  - B:       1 [0] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  + B:       5 [3]
  + B:       6 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       1 [0]
  + B:       4 [2]
HFx: Exchange matrix symmetric to  3.70 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.250669902319 Ha.
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |         6 |       1 |       6 |       7 |       306 |       306 |
|       1 |        12 |       2 |       6 |       8 |       272 |       272 |
|       2 |         6 |       1 |       6 |       7 |       306 |       306 |
|       3 |        12 |       2 |       6 |       8 |       272 |       272 |
+---------------------------------------------------------------------------+
|     min |         6 |       1 |       6 |       7 |       272 |       272 |
|     max |        12 |       2 |       6 |       8 |       306 |       306 |
| average |       9.0 |     1.5 |     6.0 |     7.5 |     289.0 |     289.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.46987028E+00     0.78798977E-01
               2       0.35265465E-01     0.59884070E-02
               3       0.41338438E-03     0.74329765E-04
               4       0.67122039E-07     0.12516873E-07
               5       0.28683150E-13     0.81046281E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00214356247526
Trial step length           =               0.122474
Gradient along search dir.  =         -1.17372943964
Functional at step 0        =     -19.66129018983574
Functional at step 1        =     -19.79621070275187
Functional predicted        =     -20.24626584689913
Selected quadratic step     =               0.996781
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "ethene_SZP_HHF_n2.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      16.24397902
     Final electron number for spin 1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.006871 (step -0.4821 Ne1=     16.0000)
 RMS occupancy error at iteration   2:  0.000085 (step -0.5001 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  - B:       1 [0] (1)
  - B:       2 [1] (1)
  - B:       4 [2] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       6 [3] (1)
  - B:       5 [3] (2)
  - B:       2 [1] (2)
  - B:       4 [2] (2)
  - B:       1 [0] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  + B:       5 [3]
  + B:       6 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.51 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.466077527535 Ha.
      ideal mu1:      -0.551448728646
             Q0:         -20.242753995498
             G0:      -0.083664559996
   RMS gradient:       0.008507301972
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.49 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.443807571022 Ha.
     Trial step:       0.513912790059
             Q1:         -20.254125572152
 Quadratic coef:       0.031624710802
 Linear coef   :      -0.042996287457
           Qmin:         -20.257368206096
Quadratic minimum step length (  0.349352476091) accepted
    Initial Ne1:      15.99999271
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000573 (step -0.4979 Ne1=     16.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -2.024275399550E+01     8.5073E-03     1.8078E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.51 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.452139246780 Ha.
      ideal mu1:      -0.561228910878
             Q0:         -20.257489765427
             G0:      -0.009997635982
   RMS gradient:       0.002929847490
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.48 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.438172318799 Ha.
     Trial step:       0.423717719363
             Q1:         -20.259403291355
 Quadratic coef:       0.002322649589
 Linear coef   :      -0.004236175517
           Qmin:         -20.259421307651
Quadratic minimum step length (  0.386399790493) accepted
    Initial Ne1:      15.99999904
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000218 (step -0.4993 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -2.025748976543E+01     2.9298E-03     6.2259E-03    -1.4736E-02
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.48 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.439433712185 Ha.
      ideal mu1:      -0.567672363348
             Q0:         -20.259428941025
             G0:      -0.002270221693
   RMS gradient:       0.001399135251
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.50 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.435180672916 Ha.
     Trial step:       0.404628765648
             Q1:         -20.259899143272
 Quadratic coef:       0.000448394754
 Linear coef   :      -0.000918597001
           Qmin:         -20.259899408422
Quadratic minimum step length (  0.414468242055) accepted
    Initial Ne1:      16.00000928
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000097 (step -0.4997 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    3        -2.025942894102E+01     1.3991E-03     2.9732E-03    -1.9392E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       1 [0]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.50 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.435075738235 Ha.
      ideal mu1:      -0.569004950349
             Q0:         -20.259900503195
             G0:      -0.000457896080
   RMS gradient:       0.000628617787
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.49 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.436002719122 Ha.
     Trial step:       0.409518953387
             Q1:         -20.259999745660
 Quadratic coef:       0.000088274659
 Linear coef   :      -0.000187517124
           Qmin:         -20.260000086337
Quadratic minimum step length (  0.434959573996) accepted
    Initial Ne1:      16.00000395
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000030 (step -0.4999 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    4        -2.025990050320E+01     6.2862E-04     1.3358E-03    -4.7156E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.49 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.436059767840 Ha.
      ideal mu1:      -0.568205714374
    5        -2.026000017271E+01     3.2391E-04     6.8831E-04    -9.9670E-05
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_SZP_HHF_n2.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.02600001727109E+01  Eh
     Estimated bandgap           =   1.7230E-01  Eh
     RMS occupancy error         =   1.8999E-09
     [H,K] commutator            =   6.8831E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs: 
HFx: NGWF gradient calculation for val rep.
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to        8.000 electrons (spin 1).
HFx: Density kernel CD normalised to        8.000 electrons (spin 1).
  + B:       2 [1]
  + B:       5 [3]
  + B:       4 [2]
  + B:       1 [0]
  + B:       6 [3]
  + B:       3 [1]
HFx: Communicating NGWF gradient kets.
  * C:       1 [0]
  * C:       1 [3]
  * C:       1 [2]
  * C:       1 [1]
  * C:       2 [0]
  * C:       2 [3]
  * C:       2 [1]
  * C:       3 [0]
  * C:       2 [2]
  * C:       3 [3]
  * C:       3 [1]
  * C:       4 [0]
  * C:       3 [2]
  * C:       4 [1]
  * C:       4 [3]
  * C:       4 [2]
  * C:       5 [1]
  * C:       5 [3]
  * C:       5 [0]
  * C:       5 [2]
  * C:       6 [3]
  * C:       6 [1]
  * C:       6 [0]
  * C:       6 [2]
HFx: Communicating NGWF gradient kets.
HFx: Exchange matrix symmetric to  3.49 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.436059767840 Ha.
HFx: ^ (accounting for spin degeneracy in density kernel in val gradient calc)
  NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.6233E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |         6 |       1 |       6 |       7 |       306 |       306 |
|       1 |        12 |       2 |       6 |       8 |       272 |       272 |
|       2 |         6 |       1 |       6 |       7 |       306 |       306 |
|       3 |        12 |       2 |       6 |       8 |       272 |       272 |
+---------------------------------------------------------------------------+
|     min |         6 |       1 |       6 |       7 |       272 |       272 |
|     max |        12 |       2 |       6 |       8 |       306 |       306 |
| average |       9.0 |     1.5 |     6.0 |     7.5 |     289.0 |     289.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11067958E+00     0.15625943E-01
               2       0.24528550E-02     0.38463027E-03
               3       0.19466724E-05     0.35807140E-06
               4       0.16164446E-11     0.32684966E-12
================================================================================
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  - B:       1 [0] (1)
  - B:       2 [1] (1)
  - B:       4 [2] (1)
  - B:       5 [3] (1)
  - B:       3 [1] (1)
  - B:       6 [3] (1)
  - B:       2 [1] (2)
  - B:       5 [3] (2)
  - B:       1 [0] (2)
  - B:       4 [2] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  + B:       5 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       6 [3]
  + B:       4 [2]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.47 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.455359596185 Ha.
SWX: Invalidating val%[hfx_swex].
HFx: Stage-1 for val (single NGWF basis).
HFx: - Parallel distribution... 
============================= Load distribution =============================   
|     MPI |      # BC |     # B |     # C |    #B+C |    # NGWF | estimated |
|    rank |     pairs |   atoms |   atoms |   atoms |  products |      load |
+---------------------------------------------------------------------------+
|       0 |         6 |       1 |       6 |       7 |       306 |       306 |
|       1 |        12 |       2 |       6 |       8 |       272 |       272 |
|       2 |         6 |       1 |       6 |       7 |       306 |       306 |
|       3 |        12 |       2 |       6 |       8 |       272 |       272 |
+---------------------------------------------------------------------------+
|     min |         6 |       1 |       6 |       7 |       272 |       272 |
|     max |        12 |       2 |       6 |       8 |       306 |       306 |
| average |       9.0 |     1.5 |     6.0 |     7.5 |     289.0 |     289.0 |
=============================================================================
HFx: - Communicating metric matrix (ket: BC)...
HFx: - Communicating NGWFs...
HFx: - Index book-keeping...
HFx: - Calculating NGWF products...
+------------------------------------------------------------------------------+
|    MPI |                          AD NGWF product cache                      |
|   rank | products stored | products left out |           total | store ratio |
+------------------------------------------------------------------------------+
|      0 |              36 |                 0 |              36 |     100.00% |
|      1 |              36 |                 0 |              36 |     100.00% |
|      2 |              36 |                 0 |              36 |     100.00% |
|      3 |              36 |                 0 |              36 |     100.00% |
+------------------------------------------------------------------------------+
HFx: ...done.
SWX: val%[hfx_swex]: Fitting my NGWF pairs (V).
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19442926E+00     0.26194688E-01
               2       0.87285210E-02     0.14502133E-02
               3       0.26826266E-04     0.51814800E-05
               4       0.34298649E-09     0.70798034E-10
               5       0.28122589E-13     0.68833828E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00076233389194
Trial step length           =               0.349400
Gradient along search dir.  =         -0.15180776159
Functional at step 0        =     -20.26000017271087
Functional at step 1        =     -20.30318705870152
Functional predicted        =     -20.33137235477538
Selected quadratic step     =               0.940297
Conjugate gradients coeff.  =               0.126479
--------------------------- NGWF line search finished --------------------------
                                               
Writing NGWFs to file "ethene_SZP_HHF_n2.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      16.08098365
     Final electron number for spin 1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002358 (step -0.4932 Ne1=     16.0000)
 RMS occupancy error at iteration   2:  0.000011 (step -0.5000 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  - B:       1 [0] (1)
  - B:       2 [1] (1)
  - B:       4 [2] (1)
  - B:       5 [3] (1)
  - B:       6 [3] (1)
  - B:       3 [1] (1)
  - B:       5 [3] (2)
  - B:       2 [1] (2)
  - B:       1 [0] (2)
  - B:       4 [2] (2)
  - B:       6 [3] (2)
  - B:       3 [1] (2)
  + B:       5 [3]
  + B:       6 [3]
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.42 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.483657393202 Ha.
      ideal mu1:      -0.561312135169
             Q0:         -20.331735841934
             G0:      -0.018377092550
   RMS gradient:       0.003987121629
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.47 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.460455755358 Ha.
     Trial step:       0.422047615215
             Q1:         -20.334802243937
 Quadratic coef:       0.004689606082
 Linear coef   :      -0.007756008085
           Qmin:         -20.334942703041
Quadratic minimum step length (  0.349006361988) accepted
    Initial Ne1:      15.99999991
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000151 (step -0.4994 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -2.033173584193E+01     3.9871E-03     8.4726E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.46 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.464555968505 Ha.
      ideal mu1:      -0.570099971428
             Q0:         -20.334948950262
             G0:      -0.003755257909
   RMS gradient:       0.001801354485
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.45 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.458669071010 Ha.
     Trial step:       0.383793307357
             Q1:         -20.335734233206
 Quadratic coef:       0.000655959908
 Linear coef   :      -0.001441242853
           Qmin:         -20.335740607242
Quadratic minimum step length (  0.421625890730) accepted
    Initial Ne1:      16.00000216
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000136 (step -0.4994 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -2.033494895026E+01     1.8014E-03     3.8279E-03    -3.2131E-03
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.45 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.458080391867 Ha.
      ideal mu1:      -0.573559340085
             Q0:         -20.335742604630
             G0:      -0.000690079509
   RMS gradient:       0.000771642731
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.45 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.459259855244 Ha.
     Trial step:       0.402265080601
             Q1:         -20.335930893833
 Quadratic coef:       0.000089305687
 Linear coef   :      -0.000277594889
           Qmin:         -20.335958321360
Quadratic minimum step length (  0.625193840785) accepted
    Initial Ne1:      16.00000585
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000076 (step -0.4996 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    3        -2.033574260463E+01     7.7164E-04     1.6397E-03    -7.9365E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       5 [3]
  + B:       2 [1]
  + B:       4 [2]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.45 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.459912606961 Ha.
      ideal mu1:      -0.572540402985
             Q0:         -20.335958702981
             G0:      -0.000296549190
   RMS gradient:       0.000505999353
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       1 [0]
  + B:       6 [3]
  + B:       3 [1]
HFx: Exchange matrix symmetric to  3.45 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.458334857725 Ha.
     Trial step:       0.501491426402
             Q1:         -20.336051761911
 Quadratic coef:       0.000055657946
 Linear coef   :      -0.000148716876
           Qmin:         -20.336058045083
Quadratic minimum step length (  0.669987344321) accepted
    Initial Ne1:      16.00000532
      Final Ne1:      16.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000063 (step -0.4997 Ne1=     16.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     16.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -2.033595870298E+01     5.0600E-04     1.0752E-03    -2.1610E-04
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       4 [2]
  + B:       5 [3]
  + B:       2 [1]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.45 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.457802304707 Ha.
      ideal mu1:      -0.573299169935
    5        -2.033605818881E+01     3.1781E-04     6.7534E-04    -9.9486E-05
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_SZP_HHF_n2.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.03360581888098E+01  Eh
     Estimated bandgap           =   1.7047E-01  Eh
     RMS occupancy error         =   1.1423E-08
     [H,K] commutator            =   6.7534E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       14.82104174044897 |
           | Pseudopotential (local)    :      -77.24072888721393 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.87112010390449 |
           | Hartree                    :       41.10776245453468 |
           | Exchange-correlation       :        0.00000000000000 |
           | Hartree-Fock exchange      :       -4.45780230470708 |
           | Ewald                      :       14.52461869209874 |
           | Total                      :       -9.37398820093413 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -77.24072888721416 |
           | Hartree                    :       30.14569246665900 |
           --------------------------------------------------------
           Integrated density           :       15.99999999999996
           Integrated density tr(KS)    :       16.00000000000000
================================================================================

WARNING: maximum number of NGWF CG iterations (   2) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00214356247526    -19.66129018983574   0.996781    -20.24626584689913        
   1     0.00076233389194    -20.33605818880981  <-- CG                                 
 
<QC>        [NGWF iterations]:                      2
<QC>           [total_energy]:       -20.336058188810
<QC>           [rms_gradient]:         0.000762333892
HFx: Calculation for val (single NGWF basis).
HFx: Density kernel AB normalised to       16.000 electrons (spin 1).
HFx: Density kernel CD normalised to       16.000 electrons (spin 1).
  + B:       1 [0]
  + B:       2 [1]
  + B:       4 [2]
  + B:       5 [3]
  + B:       3 [1]
  + B:       6 [3]
HFx: Exchange matrix symmetric to  3.45 digits (rms).
HFx: Hartree-Fock exchange energy (spin 1):     -4.457802394503 Ha.

======================== Writing density and potential =========================
Writing "ethene_SZP_HHF_n2_density.cube" ... done
Writing "ethene_SZP_HHF_n2_potential.cube" ... done
<QC>            [props_ES_n1]:         0.041534911831
<QC>            [props_ES_n2]:         0.017017139576
<QC>            [props_ES_n3]:        -0.015479919693
<QC>            [props_ES_n4]:        -0.011228195241
<QC>            [props_ES_n5]:        -0.007155001688
<QC>            [props_ES_n6]:         0.041503845460
<QC>            [props_ES_n7]:         0.010813087680
<QC>            [props_ES_n8]:         0.116232567423
<QC>            [props_ES_n9]:         0.031166340196
<QC>           [props_ES_n10]:        -0.018055258163
Writing "ethene_SZP_HHF_n2_electrostatic_potential.cube" ... done
================================================================================
<QC>      [atom_1_population]:         5.991709833689
<QC>          [atom_1_charge]:        -1.991709833689
<QC>      [atom_2_population]:         1.003691964182
<QC>          [atom_2_charge]:        -0.003691964182
<QC>      [atom_3_population]:         1.003809839192
<QC>          [atom_3_charge]:        -0.003809839192

    Mulliken Atomic Populations
    ---------------------------
Species  Ion    Total   Charge (e)
==================================
  C      1       5.992     -1.992
  H      2       1.004     -0.004
  H      3       1.004     -0.004
  C      4       5.992     -1.992
  H      5       1.004     -0.004
  H      6       1.005     -0.005
==================================

        Bond         Population      Length (bohr)
==================================================
 C     1 -- H     2        0.25      2.06618
 C     1 -- H     3        0.24      2.06667
 C     4 -- H     5        0.24      2.06684
 C     4 -- H     6        0.24      2.06690
 C     1 -- C     4       -0.56      2.46613
 H     2 -- H     3       -0.23      3.52211
 H     5 -- H     6       -0.23      3.52345
 H     3 -- C     4       -0.17      3.96030
 C     1 -- H     5       -0.17      3.96031
 H     2 -- C     4       -0.17      3.96036
 C     1 -- H     6       -0.17      3.96053
 H     3 -- H     6        0.16      4.62800
 H     2 -- H     5        0.16      4.62822
==================================================


=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      34
   Number of occupied orbitals:       8.000000000
   Occupancy sum (eigenvalues):       8.000000000
                 HOMO-LUMO gap:       0.170483057 Eh
                 Mid-gap level:       0.084343891 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -1.114577967   0.9999995
                            2    -0.834327314   0.9999990
                            3    -0.699589107   0.9999996
                            4    -0.659723174   0.9999992
                            5    -0.539204444   0.9999998
                            6    -0.512326074   1.0000000
                            7    -0.225767187   0.9999992
                            8    -0.000897638   0.9999627
                        .......   --- gap ---   .........
                            9     0.169585419   0.0000000
                           10     0.190056269   0.0000002
                           11     0.303249928   0.0000292
                           12     0.310074966   0.0000001
                           13     0.330957693   0.0000000
                           14     0.345062043   0.0000000
                           15     0.355658927   0.0000001
                           16     0.380748184   0.0000000
                           17     0.438247351   0.0000000
                           18     0.443168856   0.0000021
                           19     0.484823649   0.0000008
                           20     0.581293872   0.0000001
                           21     0.605246204   0.0000001
                           22     0.632790807   0.0000001
                           23     0.710309780   0.0000001
                           24     0.715405444   0.0000067
                           25     0.740207621   0.0000000
                           26     0.741679664   0.0000000
                           27     0.882956275   0.0000001
                           28     0.936738748   0.0000005
                           29     0.966806700   0.0000000
                           30     0.987214474   0.0000000
                           31     1.097653267   0.0000002
                           32     1.123123968   0.0000005
                           33     1.449442055   0.0000002
                           34     1.837553100  -0.0000000
 
<QC>    [energy_eigenvalue_1]:        -1.114577966964
<QC>    [energy_eigenvalue_n]:         1.837553100117
<QC>            [occupancy_1]:         0.999999518848
<QC>            [occupancy_n]:        -0.000000020574

================================================================================

===================== Writing canonical molecular orbitals =====================
| Orbital  Energy (eV)  Norm     |
| HOMO-5  -19.03678826  1.000000 | Writing "ethene_SZP_HHF_n2_HOMO-5.cube" ... done
| HOMO-4  -17.95198102  1.000000 | Writing "ethene_SZP_HHF_n2_HOMO-4.cube" ... done
| HOMO-3  -14.67249950  1.000000 | Writing "ethene_SZP_HHF_n2_HOMO-3.cube" ... done
| HOMO-2  -13.94110183  1.000000 | Writing "ethene_SZP_HHF_n2_HOMO-2.cube" ... done
| HOMO-1   -6.14343776  1.000000 | Writing "ethene_SZP_HHF_n2_HOMO-1.cube" ... done
| HOMO     -0.02442596  1.000000 | Writing "ethene_SZP_HHF_n2_HOMO.cube" ... done
| LUMO      4.61465407  1.000000 | Writing "ethene_SZP_HHF_n2_LUMO.cube" ... done
| LUMO+1    5.17169423  1.000000 | Writing "ethene_SZP_HHF_n2_LUMO+1.cube" ... done
| LUMO+2    8.25185043  1.000000 | Writing "ethene_SZP_HHF_n2_LUMO+2.cube" ... done
| LUMO+3    8.43756915  1.000000 | Writing "ethene_SZP_HHF_n2_LUMO+3.cube" ... done
| LUMO+4    9.00581707  1.000000 | Writing "ethene_SZP_HHF_n2_LUMO+4.cube" ... done
| LUMO+5    9.38961596  1.000000 | Writing "ethene_SZP_HHF_n2_LUMO+5.cube" ... done
================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "ethene_SZP_HHF_n2_DOS.txt" ...  done
================================================================================
 
Writing bands to file "ethene_SZP_HHF_n2.val_bands" ... done
SWX: Destroying [val%hfx_swex]... done

Cleaning up after remote NGWF capability... done. 
SWX: Clean-up... done.
SWRI: Clean-up... done.

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:      59.208s on      4 proc(s)                                    
TOTAL TIME:        59.209s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| hfx_determine_my_d_atoms             :     5        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| hfx_split_pair_list                  :     5        0.00s   0.000%  ------ ||
|| hfx_determine_my_a_atoms             :     5        0.00s   0.000%  ------ ||
|| hfx_main_comms_imbalance             :    32        0.00s   0.000%  ------ ||
|| hash_table_purge_[DKNBLKS_AB]        :     2        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_AB]      :     2        0.00s   0.000%  ------ ||
|| hash_table_purge_[TCDKNBLKS_BA]      :     2        0.00s   0.000%  ------ ||
|| hash_table_purge_[VMETRIC]           :     1        0.00s   0.000%  ------ ||
|| hfx_determine_ppd_list               :     5        0.00s   0.000%  ------ ||
|| swri_metric_mat_cheb_gen_nodes       :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_consistency          :     3        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                :    32        0.00s   0.001%  ------ ||
|| hash_table_purge_[ALISTS]            :     6        0.00s   0.001%  ------ ||
|| swri_metric_mat_oc_work_imbalance    :     2        0.00s   0.001%  ------ ||
|| neighbour_list_populate              :     5        0.00s   0.001%  ------ ||
|| hash_table_purge_[TILES]             :     1        0.00s   0.002%  ------ ||
|| hash_table_purge_[DKNBLKS_CD]        :    32        0.00s   0.002%  ------ ||
|| swri_metric_mat_wait_send            :     3        0.00s   0.002%  ------ ||
|| hfx_all_ad_for_this_b_store          :    48        0.00s   0.002%  ------ ||
|| hash_table_purge_[COEFFS]            :     6        0.00s   0.002%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.003%  ------ ||
|| remote_pack_ngwf                     :   170        0.00s   0.003%  ------ ||
|| hf_exchange_calculate_imbalance      :    32        0.00s   0.003%  ------ ||
|| basis_extract_function_from_box      :    68        0.00s   0.003%  ------ ||
|| swri_metric_mat_wait_req_master      :     5        0.01s   0.015%  ------ || (1 procs only)
|| hfx_determine_alists                 :     5        0.00s   0.004%  ------ ||
|| hfx_contract_over_dkn_cc_dkn_get     :   288        0.00s   0.004%  ------ ||
|| hfx_comms_xmatrix_imbalance          :    32        0.00s   0.004%  ------ ||
|| hash_table_purge_[DLISTS]            :     6        0.00s   0.005%  ------ ||
|| ngwf_gradient_coeffs                 :     2        0.00s   0.005%  ------ ||
|| hash_table_purge_[XAB]               :    32        0.00s   0.005%  ------ ||
|| hfx_determine_bc_pairs               :     5        0.00s   0.005%  ------ ||
|| hash_table_purge_[AKETS_DKN_LOC]     :     4        0.00s   0.005%  ------ ||
|| hash_table_purge_[PPD_NGWFS_DD]      :     6        0.00s   0.006%  ------ ||
|| pseudopotentials_nonlocal_mat        :     5        0.00s   0.007%  ------ ||
|| hfx_comms_gradient_imbalance         :     4        0.00s   0.007%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.008%  ------ ||
|| hfx_determine_a_ppd_list_for_b       :    73        0.01s   0.009%  ------ ||
|| remote_obtain_matrix_block           :    45        0.01s   0.011%  ------ ||
|| hash_table_purge_[AKETS_DKN_MY]      :     4        0.01s   0.012%  ------ ||
|| sparse_init                          :     1        0.01s   0.014%  ------ ||
|| remote_obtain_dkn_block              :  1206        0.01s   0.014%  ------ ||
|| swri_metric_mat_allocs               :     1        0.01s   0.014%  ------ ||
|| hash_table_purge_[SWOP_HITS]         :     1        0.01s   0.015%  ------ ||
|| swri_metric_mat_dispatch             : 14671        0.01s   0.016%  ------ ||
|| hfx_determine_dlists                 :     5        0.01s   0.016%  ------ ||
|| hfx_comms_dkn                        :    38        0.01s   0.017%  ------ ||
|| pseudo_make_structure_factor         :     1        0.01s   0.017%  ------ ||
|| hash_table_purge_[NGWFS]             :    12        0.01s   0.018%  ------ ||
|| hfx_comms_metric                     :     5        0.01s   0.019%  ------ ||
|| restart_kernel_write                 :     4        0.01s   0.019%  ------ ||
|| swri_vmatrixblock_sc                 :   111        0.01s   0.019%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     5        0.01s   0.019%  ------ ||
|| hfx_populate_swop_cache_imbalance    :     2        0.01s   0.022%  ------ ||
|| swri_metric_mat_RSH_rotation         :     3        0.01s   0.024%  ------ ||
|| lnv_gradient_norm                    :    15        0.02s   0.031%  ------ ||
|| hash_table_purge_[SWOPS_IN_PPDS]     :     3        0.02s   0.036%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.02s   0.036%  ------ ||
|| swri_metric_mat_wait_req_worker      :     4        0.03s   0.049%  ------ || (3 procs only)
|| swri_metric_mat_symmetry             :     1        0.02s   0.037%  ------ ||
|| basis_dot_function_with_box          :  6319        0.02s   0.038%  ------ ||
|| remote_obtain_ngwf                   :   552        0.03s   0.044%  ------ ||
|| remote_unpack_ngwf_no_sphere         :  2353        0.03s   0.045%  ------ ||
|| hfx_comms_ngwfs                      :    20        0.03s   0.049%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.03s   0.052%  ------ ||
|| kernel_purify                        :    47        0.03s   0.052%  ------ ||
|| function_ops_brappd_ketppd           :     5        0.03s   0.052%  ------ ||
|| hash_table_list                      :   168        0.03s   0.058%  ------ ||
|| basis_add_function_to_box            : 11849        0.03s   0.058%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.03s   0.059%  ------ ||
|| hfx_accum_q_beta                     :   612        0.05s   0.081%  ------ ||
|| hfx_populate_swop_cache_bookkeeping  :     1        0.05s   0.085%  ------ ||
|| hfx_gradient_term2_qexpand3          :  1156        0.05s   0.086%  ------ ||
|| hfx_gradient_term2_part0             :    12        0.05s   0.091%  ------ ||
|| hfx_comms_xmatrix                    :    32        0.06s   0.100%  ------ ||
|| hash_table_purge_[PPD_PRODUCTS]      :     6        0.06s   0.109%  ------ ||
|| swri_swop_calc_all_in_ppd_fast       :  3000        0.07s   0.114%  ------ ||
|| remote_unpack_ngwf                   : 14470        0.08s   0.131%  ------ ||
|| swri_metric_mat_home_sws             :     1        0.09s   0.147%  ------ ||
|| restart_ngwfs_tightbox_output        :     2        0.09s   0.148%  ------ ||
|| swri_metric_mat_eval_swpot           :   795        0.10s   0.175%  ------ ||
|| hfx_grad_ket_dkn_baccum              :     3        0.10s   0.176%  ------ ||
|| basis_copy_function_to_box           :   637        0.11s   0.183%  ------ ||
|| hfx_populate_swop_cache_sort         :     1        0.11s   0.184%  ------ ||
|| hash_table_free                      :    92        0.12s   0.209%  ------ ||
|| swri_build_matrix_2                  :   147        0.12s   0.210%  ------ ||
|| hfx_calc_p_ac                        :    72        0.12s   0.211%  ------ ||
|| swri_metric_mat_cheb_expand          :   795        0.13s   0.217%  ------ ||
|| hfx_comms_gradient                   :     4        0.13s   0.226%  ------ ||
|| projectors_gradient_batch            :     2        0.14s   0.233%  ------ ||
|| projectors_init_fftbox_recip         :     7        0.14s   0.240%  ------ ||
|| hash_table_purge_[EXPANSIONS]        :     7        0.15s   0.250%  ------ ||
|| sparse_trace                         :   800        0.16s   0.265%  ------ ||
|| projectors_func_ovlp_box             :     5        0.17s   0.285%  ------ ||
|| density_init_guess_real              :     1        0.17s   0.294%  ------ ||
|| xc_energy_potential                  :    32        0.18s   0.302%  ------ ||
|| density_batch_row_sums               :    33        0.19s   0.320%  ------ ||
|| cell_grid_extract_box_real           :   223        0.19s   0.322%  ------ ||
|| sparse_product                       :   864        0.19s   0.327%  ------ ||
|| integrals_kinetic                    :     5        0.20s   0.333%  ------ ||
|| kernel_fix                           :    15        0.22s   0.375%  ------ ||
|| hfx_populate_swop_cache_calc         :     1        0.24s   0.401%  ------ ||
|| integrals_locpot_mat_els_batch       :    19        0.24s   0.409%  ------ ||
|| energy_and_force_init_cell           :     1        0.26s   0.439%  ------ ||
|| swri_metric_mat_cheb_int_product     : 84667        0.27s   0.460%  ------ ||
|| hfx_all_ad_for_this_b_main           :    48        0.28s   0.467%  ------ ||
|| hfx_all_ad_for_this_b                :    48        0.28s   0.469%  ------ ||
|| hfx_contract_over_dkn_cc_main        :   288        0.31s   0.523%  ------ ||
|| hfx_gradient_term2_imbal             :     2        0.33s   0.557%  ------ ||
|| hfx_calc_aa_dd_ngwf_prods_in_ppds    :     5        0.35s   0.599%  ------ ||
|| fourier_apply_box_pair               :   124        0.37s   0.621%  68.467 ||
|| hfx_populate_swop_cache              :     1        0.40s   0.675%  ------ ||
|| hfx_gradient_term2_part2             :    68        0.42s   0.707%  ------ ||
|| hfx_gradient_term2_part1             :    12        0.42s   0.716%  ------ ||
|| hfx_main_work_imbalance              :    32        0.48s   0.815%  ------ ||
|| internal_tile_by_chebs               :     3        0.53s   0.888%  ------ ||
|| swri_metric_mat_main_loop            :     1        0.57s   0.958%  ------ ||
|| cell_grid_deposit_box_real           :   407        0.62s   1.041%  ------ ||
|| fourier_apply_cell_forward           :    33        0.68s   1.146%  11.477 ||
|| fourier_apply_cell_backward          :    34        0.69s   1.172%  11.559 ||
|| hfx_contract_over_dkn_cc_expa_get    :   288        0.73s   1.236%  ------ ||
|| swri_metric_mat_oc                   :     1        0.75s   1.259%  ------ ||
|| swri_init_container_stage_2          :     1        0.75s   1.265%  ------ ||
|| hfx_dkn_indep_preparation            :     5        0.85s   1.428%  ------ ||
|| hamiltonian_energy_components        :     1        1.16s   1.955%  ------ ||
|| ngwf_gradient_build_batch            :     2        1.16s   1.957%  ------ ||
|| hfx_main_ngwf_grad1                  :     2        1.34s   2.256%  ------ ||
|| hartree_on_grid                      :    33        1.38s   2.337%  ------ ||
|| sw_init                              :     1        1.41s   2.387%  ------ ||
|| hfx_contract_over_dkn_cc             :    48        1.44s   2.433%  ------ ||
|| ngwf_gradient_batch                  :     2        1.58s   2.676%  ------ ||
|| hfx_calc_expansion_for_q             :  1156        1.65s   2.787%  ------ ||
|| hfx_gradient_term2_qexpand2          :  1156        1.66s   2.797%  ------ ||
|| density_fftbox_deposit_to_cell       :   297        2.14s   3.609%  ------ ||
|| hfx_gradient                         :     4        2.16s   3.648%  ------ ||
|| linalg_dgesv                         :  2441        2.17s   3.671%  ------ ||
|| swx_my_ngwf_pair_fitting             :     5        2.59s   4.381%  ------ ||
|| swx_expand_my_ngwf_pairs             :     5        2.59s   4.382%  ------ ||
|| hfx_calc_expansions_bb_cc            :  2890        2.86s   4.833%  ------ ||
|| hfx_expand_ngwf_pairs                :     5        2.90s   4.891%  ------ ||
|| swx_swop_quantity_overlap_ppd_fast   :  2441        2.92s   4.934%  ------ ||
|| hfx_gradient_term2_qexpand           :  1156        3.24s   5.469%  ------ ||
|| fourier_apply_box                    :  1048        3.55s   5.999% 287.916 ||
|| eigenstates_calculate                :     1        4.37s   7.386%  ------ ||
|| density_fftbox_interpolate_multiply  :   297        4.51s   7.620%  ------ ||
|| hfx_gradient_term2_part3             :    68        5.07s   8.563%  ------ ||
|| swx_expansion_2_fast                 :  2441        5.67s   9.580%  ------ ||
|| potential_apply_to_ngwf_batch        :    19        6.22s  10.500%  ------ ||
|| hfx_gradient_term2                   :     2        6.31s  10.651%  ------ ||
|| integrals_locpot_dbl_grid            :    19        6.49s  10.959%  ------ ||
|| hfx_main_ngwf_grad2                  :     2        7.28s  12.291%  ------ ||
|| ngwf_gradient_lnv                    :     2       10.64s  17.976%  ------ ||
|| density_batch_interp_deposit         :    33       11.83s  19.978%  ------ ||
|| density_on_dbl_grid                  :    33       12.57s  21.238%  ------ ||
|| hfx_main                             :    32       13.89s  23.462%  ------ ||
|| hf_exchange_calculate                :    32       13.97s  23.593%  ------ ||
|| hamiltonian_lhxc_calculate           :    30       14.02s  23.675%  ------ ||
|| properties_calculate                 :     1       14.95s  25.244%  ------ ||
|| lnv_denskernel_optimise_cg           :     3       22.08s  37.284%  ------ ||
|| ngwf_cg_optimise                     :     1       39.20s  66.205%  ------ ||
|| energy_and_force_calculate           :     1       58.64s  99.040%  ------ ||
|| total_time                           :     1       59.21s 100.000%  ------ ||
================================================================================
==================== AVERAGE TIMINGS FROM ALL PROCS (SELF) =====================
++ TAG                                    #calls    cpu time   %total  Gflops ++
++ hfx_populate_swop_cache              :     1        0.00s   0.000%  ------ ++
++ hfx_determine_my_d_atoms             :     5        0.00s   0.000%  ------ ++
++ onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ++
++ hfx_split_pair_list                  :     5        0.00s   0.000%  ------ ++
++ hfx_determine_my_a_atoms             :     5        0.00s   0.000%  ------ ++
++ hfx_main_comms_imbalance             :    32        0.00s   0.000%  ------ ++
++ hash_table_purge_[DKNBLKS_AB]        :     2        0.00s   0.000%  ------ ++
++ hash_table_purge_[TCDKNBLKS_AB]      :     2        0.00s   0.000%  ------ ++
++ hash_table_purge_[TCDKNBLKS_BA]      :     2        0.00s   0.000%  ------ ++
++ hash_table_purge_[VMETRIC]           :     1        0.00s   0.000%  ------ ++
++ swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ++
++ hfx_determine_ppd_list               :     5        0.00s   0.000%  ------ ++
++ swri_metric_mat_cheb_gen_nodes       :     1        0.00s   0.000%  ------ ++
++ onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ++
++ hfx_all_ad_for_this_b                :    48        0.00s   0.000%  ------ ++
++ swri_metric_mat_consistency          :     3        0.00s   0.000%  ------ ++
++ swx_expand_my_ngwf_pairs             :     5        0.00s   0.000%  ------ ++
++ swri_metric_mat_wait_req_master      :     5        0.00s   0.002%  ------ ++ (1 procs only)
++ sparse_set_to_garbage                :    32        0.00s   0.001%  ------ ++
++ hash_table_purge_[ALISTS]            :     6        0.00s   0.001%  ------ ++
++ ngwf_gradient_coeffs                 :     2        0.00s   0.001%  ------ ++
++ hfx_main_ngwf_grad1                  :     2        0.00s   0.001%  ------ ++
++ swri_metric_mat_oc_work_imbalance    :     2        0.00s   0.001%  ------ ++
++ neighbour_list_populate              :     5        0.00s   0.001%  ------ ++
++ hfx_main_ngwf_grad2                  :     2        0.00s   0.001%  ------ ++
++ hash_table_purge_[TILES]             :     1        0.00s   0.002%  ------ ++
++ pseudopotentials_nonlocal_mat        :     5        0.00s   0.002%  ------ ++
++ hash_table_purge_[DKNBLKS_CD]        :    32        0.00s   0.002%  ------ ++
++ swri_metric_mat_wait_send            :     3        0.00s   0.002%  ------ ++
++ hfx_all_ad_for_this_b_store          :    48        0.00s   0.002%  ------ ++
++ hash_table_purge_[COEFFS]            :     6        0.00s   0.002%  ------ ++
++ hfx_determine_alists                 :     5        0.00s   0.002%  ------ ++
++ hfx_comms_dkn                        :    38        0.00s   0.003%  ------ ++
++ ewald_calculate_energy               :     1        0.00s   0.003%  ------ ++
++ remote_pack_ngwf                     :   170        0.00s   0.003%  ------ ++
++ hf_exchange_calculate_imbalance      :    32        0.00s   0.003%  ------ ++
++ basis_extract_function_from_box      :    68        0.00s   0.003%  ------ ++
++ sparse_embed_hotelling_invert_embed  :     5        0.00s   0.003%  ------ ++
++ hfx_contract_over_dkn_cc_dkn_get     :   288        0.00s   0.004%  ------ ++
++ hfx_comms_xmatrix_imbalance          :    32        0.00s   0.004%  ------ ++
++ hash_table_purge_[DLISTS]            :     6        0.00s   0.005%  ------ ++
++ hfx_comms_ngwfs                      :    20        0.00s   0.005%  ------ ++
++ hash_table_purge_[XAB]               :    32        0.00s   0.005%  ------ ++
++ swri_init_container_stage_2          :     1        0.00s   0.005%  ------ ++
++ hfx_determine_bc_pairs               :     5        0.00s   0.005%  ------ ++
++ hash_table_purge_[AKETS_DKN_LOC]     :     4        0.00s   0.005%  ------ ++
++ hash_table_purge_[PPD_NGWFS_DD]      :     6        0.00s   0.006%  ------ ++
++ hfx_comms_metric                     :     5        0.00s   0.006%  ------ ++
++ hfx_determine_dlists                 :     5        0.00s   0.007%  ------ ++
++ hfx_comms_gradient_imbalance         :     4        0.00s   0.007%  ------ ++
++ hfx_determine_a_ppd_list_for_b       :    73        0.00s   0.008%  ------ ++
++ dense_eigensolve                     :     1        0.00s   0.008%  ------ ++
++ palser_mano_kernel_optimise          :     1        0.01s   0.009%  ------ ++
++ hfx_gradient_term2_qexpand2          :  1156        0.01s   0.010%  ------ ++
++ remote_obtain_matrix_block           :    45        0.01s   0.011%  ------ ++
++ hash_table_purge_[AKETS_DKN_MY]      :     4        0.01s   0.012%  ------ ++
++ swri_metric_mat_main_loop            :     1        0.01s   0.013%  ------ ++
++ pseudopotentials_local_on_grid       :     1        0.01s   0.013%  ------ ++
++ lnv_gradient_norm                    :    15        0.01s   0.014%  ------ ++
++ sparse_init                          :     1        0.01s   0.014%  ------ ++
++ remote_obtain_dkn_block              :  1206        0.01s   0.014%  ------ ++
++ swri_metric_mat_allocs               :     1        0.01s   0.014%  ------ ++
++ swri_metric_mat_wait_req_worker      :     4        0.01s   0.020%  ------ ++ (3 procs only)
++ hfx_gradient_term2_qexpand           :  1156        0.01s   0.015%  ------ ++
++ hash_table_purge_[SWOP_HITS]         :     1        0.01s   0.015%  ------ ++
++ swri_metric_mat_dispatch             : 14671        0.01s   0.016%  ------ ++
++ hfx_gradient_term2                   :     2        0.01s   0.016%  ------ ++
++ pseudo_make_structure_factor         :     1        0.01s   0.017%  ------ ++
++ hash_table_purge_[NGWFS]             :    12        0.01s   0.018%  ------ ++
++ restart_kernel_write                 :     4        0.01s   0.019%  ------ ++
++ swri_vmatrixblock_sc                 :   111        0.01s   0.019%  ------ ++
++ hfx_populate_swop_cache_imbalance    :     2        0.01s   0.022%  ------ ++
++ swri_metric_mat_RSH_rotation         :     3        0.01s   0.024%  ------ ++
++ internal_tile_by_chebs               :     3        0.02s   0.028%  ------ ++
++ kernel_purify                        :    47        0.02s   0.035%  ------ ++
++ hash_table_purge_[SWOPS_IN_PPDS]     :     3        0.02s   0.036%  ------ ++
++ swri_metric_mat_symmetry             :     1        0.02s   0.037%  ------ ++
++ basis_dot_function_with_box          :  6319        0.02s   0.038%  ------ ++
++ remote_obtain_ngwf                   :   552        0.02s   0.041%  ------ ++
++ kernel_fix                           :    15        0.03s   0.043%  ------ ++
++ remote_unpack_ngwf_no_sphere         :  2353        0.03s   0.045%  ------ ++
++ hfx_gradient_term2_part0             :    12        0.03s   0.048%  ------ ++
++ integrals_locpot_dbl_grid            :    19        0.03s   0.050%  ------ ++
++ ngwfs_initialise_from_radial         :     1        0.03s   0.052%  ------ ++
++ hfx_main                             :    32        0.03s   0.052%  ------ ++
++ function_ops_brappd_ketppd           :     5        0.03s   0.052%  ------ ++
++ hash_table_list                      :   168        0.03s   0.058%  ------ ++
++ basis_add_function_to_box            : 11849        0.03s   0.058%  ------ ++
++ hfx_dkn_indep_preparation            :     5        0.04s   0.060%  ------ ++
++ hartree_on_grid                      :    33        0.04s   0.064%  ------ ++
++ hfx_gradient_term2_part3             :    68        0.04s   0.069%  ------ ++
++ hash_table_free                      :    92        0.04s   0.070%  ------ ++
++ swx_my_ngwf_pair_fitting             :     5        0.04s   0.070%  ------ ++
++ hf_exchange_calculate                :    32        0.04s   0.071%  ------ ++
++ hfx_accum_q_beta                     :   612        0.05s   0.081%  ------ ++
++ hfx_populate_swop_cache_bookkeeping  :     1        0.05s   0.084%  ------ ++
++ hfx_gradient_term2_qexpand3          :  1156        0.05s   0.086%  ------ ++
++ projectors_func_ovlp_box             :     5        0.05s   0.087%  ------ ++
++ hfx_comms_xmatrix                    :    32        0.06s   0.095%  ------ ++
++ swri_metric_mat_oc                   :     1        0.06s   0.097%  ------ ++
++ projectors_gradient_batch            :     2        0.06s   0.106%  ------ ++
++ hash_table_purge_[PPD_PRODUCTS]      :     6        0.06s   0.109%  ------ ++
++ ngwf_cg_optimise                     :     1        0.06s   0.109%  ------ ++
++ swri_swop_calc_all_in_ppd_fast       :  3000        0.07s   0.114%  ------ ++
++ hamiltonian_energy_components        :     1        0.07s   0.117%  ------ ++
++ remote_unpack_ngwf                   : 14470        0.08s   0.131%  ------ ++
++ hfx_populate_swop_cache_sort         :     1        0.08s   0.143%  ------ ++
++ restart_ngwfs_tightbox_output        :     2        0.09s   0.147%  ------ ++
++ swri_metric_mat_home_sws             :     1        0.09s   0.147%  ------ ++
++ integrals_kinetic                    :     5        0.10s   0.167%  ------ ++
++ swri_metric_mat_eval_swpot           :   795        0.10s   0.175%  ------ ++
++ hfx_grad_ket_dkn_baccum              :     3        0.10s   0.176%  ------ ++
++ basis_copy_function_to_box           :   637        0.11s   0.183%  ------ ++
++ swri_build_matrix_2                  :   147        0.11s   0.191%  ------ ++
++ hfx_calc_p_ac                        :    72        0.12s   0.211%  ------ ++
++ swri_metric_mat_cheb_expand          :   795        0.13s   0.217%  ------ ++
++ hfx_comms_gradient                   :     4        0.13s   0.218%  ------ ++
++ projectors_init_fftbox_recip         :     7        0.14s   0.240%  ------ ++
++ hfx_populate_swop_cache_calc         :     1        0.14s   0.243%  ------ ++
++ hash_table_purge_[EXPANSIONS]        :     7        0.15s   0.250%  ------ ++
++ energy_and_force_calculate           :     1        0.15s   0.258%  ------ ++
++ sparse_trace                         :   800        0.16s   0.265%  ------ ++
++ density_init_guess_real              :     1        0.16s   0.267%  ------ ++
++ ngwf_gradient_lnv                    :     2        0.17s   0.282%  ------ ++
++ xc_energy_potential                  :    32        0.18s   0.302%  ------ ++
++ density_batch_row_sums               :    33        0.19s   0.320%  ------ ++
++ cell_grid_extract_box_real           :   223        0.19s   0.322%  ------ ++
++ sparse_product                       :   864        0.19s   0.327%  ------ ++
++ hfx_gradient_term2_part2             :    68        0.19s   0.328%  ------ ++
++ lnv_denskernel_optimise_cg           :     3        0.23s   0.381%  ------ ++
++ integrals_locpot_mat_els_batch       :    19        0.24s   0.409%  ------ ++
++ hfx_gradient_term2_part1             :    12        0.26s   0.437%  ------ ++
++ energy_and_force_init_cell           :     1        0.26s   0.439%  ------ ++
++ swri_metric_mat_cheb_int_product     : 84667        0.27s   0.460%  ------ ++
++ hfx_all_ad_for_this_b_main           :    48        0.28s   0.467%  ------ ++
++ hfx_expand_ngwf_pairs                :     5        0.30s   0.509%  ------ ++
++ main_program_(onetep.F90)            :     1        0.31s   0.517%  ------ ++
++ hfx_contract_over_dkn_cc_main        :   288        0.31s   0.523%  ------ ++
++ hfx_gradient_term2_imbal             :     2        0.33s   0.557%  ------ ++
++ hfx_calc_aa_dd_ngwf_prods_in_ppds    :     5        0.34s   0.570%  ------ ++
++ fourier_apply_box_pair               :   124        0.37s   0.621%  68.467 ++
++ hfx_contract_over_dkn_cc             :    48        0.40s   0.670%  ------ ++
++ ngwf_gradient_batch                  :     2        0.40s   0.673%  ------ ++
++ hfx_main_work_imbalance              :    32        0.48s   0.815%  ------ ++
++ density_on_dbl_grid                  :    33        0.56s   0.941%  ------ ++
++ swx_expansion_2_fast                 :  2441        0.58s   0.975%  ------ ++
++ ngwf_gradient_build_batch            :     2        0.59s   1.005%  ------ ++
++ cell_grid_deposit_box_real           :   407        0.62s   1.041%  ------ ++
++ fourier_apply_cell_forward           :    33        0.68s   1.146%  11.477 ++
++ fourier_apply_cell_backward          :    34        0.69s   1.172%  11.559 ++
++ hfx_contract_over_dkn_cc_expa_get    :   288        0.73s   1.236%  ------ ++
++ hamiltonian_lhxc_calculate           :    30        1.14s   1.928%  ------ ++
++ sw_init                              :     1        1.41s   2.387%  ------ ++
++ hfx_calc_expansion_for_q             :  1156        1.65s   2.787%  ------ ++
++ density_fftbox_deposit_to_cell       :   297        1.68s   2.829%  ------ ++
++ hfx_gradient                         :     4        1.84s   3.106%  ------ ++
++ linalg_dgesv                         :  2441        2.17s   3.671%  ------ ++
++ density_fftbox_interpolate_multiply  :   297        2.30s   3.881%  ------ ++
++ hfx_calc_expansions_bb_cc            :  2890        2.86s   4.833%  ------ ++
++ swx_swop_quantity_overlap_ppd_fast   :  2441        2.92s   4.934%  ------ ++
++ potential_apply_to_ngwf_batch        :    19        3.43s   5.787%  ------ ++
++ fourier_apply_box                    :  1048        3.55s   5.999% 287.916 ++
++ eigenstates_calculate                :     1        4.20s   7.091%  ------ ++
++ properties_calculate                 :     1        8.92s  15.071%  ------ ++
++ density_batch_interp_deposit         :    33       11.83s  19.978%  ------ ++
================================================================================
Overhead of generating timer report: 
- 0 ms averaging over threads,
- 1 ms ensuring consistency across MPI ranks,
- 2 ms printing in order.

Job completed: 21-09-2022 11:07 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
