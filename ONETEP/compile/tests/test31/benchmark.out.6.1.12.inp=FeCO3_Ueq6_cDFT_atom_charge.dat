==================================================================================
It's Wed Sep 21 10:24:51 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 1100 1101 1102 1103)...
    - ONETEP arguments: FeCO3_Ueq6_cDFT_atom_charge.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test31
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test31/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test31/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack FeCO3_Ueq6_cDFT_atom_charge.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 10:24 (+0100)
 
Reading parameters from file "FeCO3_Ueq6_cDFT_atom_charge.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 10
   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "FeCO3_Ueq6_cDFT_atom_charge.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
WARNING in internal_cdft: turning spin-polarisation on for constrained-DFT run
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task                  : SINGLEPOINT                                             
cutoff_energy         : 400.000000  eV                                          
maxit_ngwf_cg         : 2                                                       
minit_lnv             : 5                                                       
maxit_lnv             : 5                                                       
xc_functional         : LDA                                                     
kerfix                : 2                                                       
pen_param             : 6.0                                                     
spin_polarized        : T                                                       
spin                  : 2                                                       
write_denskern        : FALSE                                                   
write_tightbox_ngwfs  : FALSE                                                   
write_forces          : TRUE                                                    
do_properties         : FALSE                                                   
output_detail         : NORMAL                                                  
timings_level         : 0                                                       
print_qc              : TRUE                                                    
%block constrained_dft                                                          
Fe1 2   -1.0   6.0   0.0     -0.15      0.10       0.0   3.00  2.10      0.     
%endblock constrained_dft                                                       
cdft_guru         : T                                                           
maxit_cdft_u_cg        : 0                                                      
cdft_hubbard           : T                                                      
cdft_atom_charge       : T                                                      
%block  lattice_cart                                                            
Ang                                                                             
21.167    0.000    0.000                                                        
0.000   21.167    0.000                                                         
0.000    0.000   21.167                                                         
%endblock  lattice_cart                                                         
%block  positions_abs                                                           
     Hash =  -000002453539554274207625
%endblock  positions_abs                                                        
%block  species                                                                 
ANG                                                                             
Fe1    Fe  26  9  5.0                                                           
C1      C   6  4  5.0                                                           
O1      O   8  4  5.0                                                           
%endblock  species                                                              
%block  species_pot                                                             
Fe1   "../../pseudo/iron.recpot"                                                
C1    "../../pseudo/carbon.recpot"                                              
O1    "../../pseudo/oxygen.recpot"                                              
%endblock  species_pot                                                          

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
WARNING in pseudopotentials_read_species: string "GGA" found in pseudopotential
file "../../pseudo/iron.recpot", yet xc_functional = "LDA".
 
WARNING in pseudopotentials_read_species: string "GGA" found in pseudopotential
file "../../pseudo/carbon.recpot", yet xc_functional = "LDA".
 
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/iron.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number: 26;  ionic charge:  8.000000
    Shell 1: l = 1; rc = 2.02 bohr
    Shell 2: l = 2; rc = 1.90 bohr
  Core charge supplied for Nonlinear Core Corrections
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/oxygen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 0; rc = 1.31 bohr
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  Fe         1         9         8
  C          1         4         1
  O          3        12         3
.......   ......    ......    ......
Totals:      5        25        12
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   63 x  63 x  63
                              FFT-box:   63 x  63 x  63
                                  PPD:    7 x   7 x   1
Grid space d1=  0.634917985567a0 (KE cutoff=  18.84381Eh = 512.76619eV)
Grid space d2=  0.634917985567a0 (KE cutoff=  18.84381Eh = 512.76619eV)
Grid space d3=  0.634917985567a0 (KE cutoff=  18.84381Eh = 512.76619eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     63    63    63
          Real-space ('12') slabs/proc (min max mean):     15    16    15
         Recip-space ('23') slabs/proc (min max mean):      8     8     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    126   126   126
          Real-space ('12') slabs/proc (min max mean):     31    32    31
         Recip-space ('23') slabs/proc (min max mean):     16    16    16
********************************************************************************

Atom SCF Calculation for Fe : Z (AE atom) =  26 : Z (PS atom) =   8
Config String:
Orbitals (num,occ):  3     6.00 2.00 0.00
Orbitals   (num,l):  3        2    0    1
Atom SCF converged after  25 iterations to a total energy of    -26.95591450

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  16 iterations to a total energy of     -5.36398228

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  23 iterations to a total energy of    -15.72501069

Atom SCF Calculation for Fe : Z (AE atom) =  26 : Z (PS atom) =   8
Config String:
Orbitals (num,occ):  3     6.00 2.00 0.00
Orbitals   (num,l):  3        2    0    1
Atom SCF converged after  25 iterations to a total energy of    -26.95591450

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  16 iterations to a total energy of     -5.36398228

Atom SCF Calculation for O  : Z (AE atom) =   8 : Z (PS atom) =   6
Config String:
Orbitals (num,occ):  2     2.00 4.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  23 iterations to a total energy of    -15.72501069

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

Determining parallel strategy ...... done
Calculating Ewald energy ...               64.762607 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done
NGWF initialisation ...... done
... done
Density renormalisation, spin  1 ...
Target Charge:    16.000000000000 ; Input Charge:    15.000279344834
Density renormalisation, spin  2 ...
Target Charge:    14.000000000000 ; Input Charge:    15.000279344834
Up spin density kernel initialisation ...... done
Down spin density kernel initialisation ...... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.826368716594E+01     4.0924E-02     2.4477E-02
    2        -7.836607966338E+01     1.8933E-02     1.1365E-02    -1.0239E-01
    3        -7.839038310717E+01     8.1614E-03     4.9069E-03    -2.4303E-02
    4        -7.839787179939E+01     6.7043E-03     4.0014E-03    -7.4887E-03
    5        -7.840249249974E+01     4.5913E-03     2.7147E-03    -4.6207E-03
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.84024924997388E+01  Eh
     Estimated bandgap (UP spin) =   4.3804E-02  Eh
     Estimated bandgap (DN spin) =   4.8797E-02  Eh
     RMS occupancy error         =   7.5392E-09
     [H,K] commutator            =   2.7147E-03
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.2614E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.89163095601872E+01 Eh
   Predicted gain in energy  =      -5.13817060448446E-01 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.891506265442E+01     1.0014E-02     5.9390E-03
    2        -7.892023025698E+01     4.0415E-03     2.3958E-03    -5.1676E-03
    3        -7.892194104153E+01     3.1281E-03     1.8472E-03    -1.7108E-03
    4        -7.892302638645E+01     2.5903E-03     1.5320E-03    -1.0853E-03
    5        -7.892373439320E+01     2.0531E-03     1.2057E-03    -7.0801E-04
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.89237343931970E+01  Eh
     Estimated bandgap (UP spin) =   3.1588E-02  Eh
     Estimated bandgap (DN spin) =   6.6137E-02  Eh
     RMS occupancy error         =   9.0111E-12
     [H,K] commutator            =   1.2057E-03
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4946E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -7.93673505599518E+01 Eh
   Predicted gain in energy  =      -4.43616166754722E-01 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -7.935868263431E+01     1.0894E-02     6.4722E-03
    2        -7.936504178108E+01     3.8900E-03     2.3058E-03    -6.3591E-03
    3        -7.936627185356E+01     3.1258E-03     1.8418E-03    -1.2301E-03
    4        -7.936816109162E+01     3.0349E-03     1.7943E-03    -1.8892E-03
    5        -7.936908882720E+01     2.5748E-03     1.5287E-03    -9.2774E-04
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -7.93690888272031E+01  Eh
     Estimated bandgap (UP spin) =   2.8578E-02  Eh
     Estimated bandgap (DN spin) =   7.1692E-02  Eh
     RMS occupancy error         =   1.9009E-10
     [H,K] commutator            =   1.5287E-03
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       59.29824794964781 |
           | Pseudopotential (local)    :     -284.05719013891803 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):      -20.99430546184720 |
           | Hartree                    :      126.30798592082343 |
           | Exchange-correlation       :      -24.75854995323838 |
           | cDFT [+(DFT+U)] correction :        0.07211598189768 |
           | Ewald                      :       64.76260687443161 |
           | Total                      :      -79.36908882720306 |
           --------------------------------------------------------
           Integrated density           :       30.00000000000004
           Integrated spin density      :        2.00000000000001
           Integrated |spin density|    :        2.06422643081278
================================================================================

WARNING: maximum number of NGWF CG iterations (   2) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00426143245580    -78.40249249973880   0.163963    -78.91630956018724        
   1     0.00549455419962    -79.36908882720306  <-- CG                                 
 
<QC>        [NGWF iterations]:                      2
<QC>           [total_energy]:       -79.369088827203
<QC>           [rms_gradient]:         0.005494554200

################################################################################
cDFT information on atom      1 of constrained species Fe1 
################################################################################
Occupancy matrix of cDFT site      1 and spin      1 is 
  0.93000561 -0.00662146  0.02934190 -0.01488794  0.19540602
 -0.00665070  0.99665458  0.01606780 -0.00250656  0.01866523
  0.02514327  0.01570255  0.24115780  0.03143659 -0.14885298
 -0.01478246 -0.00247800  0.03200234  0.99126278  0.04597191
  0.19494788  0.01823966 -0.14486919  0.04561899  0.37416627
################################################################################
Occupancy matrix of cDFT site      1 and spin      2 is 
  0.74380483 -0.07988401  0.00347462 -0.03526814 -0.14439929
 -0.08021565  0.96974222 -0.02113459 -0.01268822 -0.06619841
  0.00677404 -0.01971828  0.05176626 -0.00512412 -0.01287516
 -0.03501773 -0.01254595 -0.00485947  0.98818832  0.00865017
 -0.14463050 -0.06552385 -0.01205105  0.00883078  0.08458942
################################################################################
Total occupancy of cDFT site            1 is   6.37133808 e
UP occupancy of cDFT site               1 is   3.53324703 e
DOWN occupancy of cDFT site             1 is   2.83809105 e
Local magnetic moment of cDFT site      1 is   0.69515597 mu_B
cDFT energy of cDFT site                1 is   0.07211598 Ha
################################################################################


********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    Fe      1      0.01416879   0.01171976   0.00716699 *
*    C       2      0.08942523   0.01065429   0.01701727 *
*    O       3      0.02206052  -0.05087934   0.00778954 *
*    O       4      0.01220392   0.05826347  -0.01206165 *
*    O       5     -0.13785846  -0.02975818  -0.01991215 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:         0.014168787353
<QC>       [total_force(1,2)]:         0.089425228835
<QC>       [total_force(1,3)]:         0.022060520781
<QC>       [total_force(1,4)]:         0.012203921506
<QC>       [total_force(1,5)]:        -0.137858458474
<QC>       [total_force(2,1)]:         0.011719755089
<QC>       [total_force(2,2)]:         0.010654293355
<QC>       [total_force(2,3)]:        -0.050879338774
<QC>       [total_force(2,4)]:         0.058263470244
<QC>       [total_force(2,5)]:        -0.029758179915
<QC>       [total_force(3,1)]:         0.007166986381
<QC>       [total_force(3,2)]:         0.017017271484
<QC>       [total_force(3,3)]:         0.007789544428
<QC>       [total_force(3,4)]:        -0.012061650278
<QC>       [total_force(3,5)]:        -0.019912152015

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:      21.579s on      4 proc(s)                                    
TOTAL TIME:        21.579s on      4 proc(s)                                    

Job completed: 21-09-2022 10:25 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
