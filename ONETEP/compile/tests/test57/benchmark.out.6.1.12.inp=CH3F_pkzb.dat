==================================================================================
It's Wed Sep 21 11:04:36 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 17510 17511 17512 17513)...
    - ONETEP arguments: CH3F_pkzb.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test57
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test57/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test57/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack CH3F_pkzb.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 11:04 (+0100)
 
Reading parameters from file "CH3F_pkzb.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 10 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 10
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "CH3F_pkzb.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
    
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task: SINGLEPOINT                                                               
print_qc: TRUE                                                                  
output_detail: VERBOSE                                                          
maxit_lnv: 5                                                                    
maxit_ngwf_cg: 3                                                                
write_denskern       : FALSE                                                    
write_tightbox_ngwfs : FALSE                                                    
write_xyz            : FALSE                                                    
%block lattice_cart                                                             
ang                                                                             
20.255526 0.000000 0.000000                                                     
0.000000 20.299986 0.000000                                                     
0.000000 0.000000 24.181228                                                     
%endblock lattice_cart                                                          
xc_functional        : PKZB                                                     
xc_min_tau           : 1e-7                                                     
cutoff_energy: 900 eV                                                           
%block species_pot                                                              
C "../../pseudo/carbon.recpot"                                                  
H "../../pseudo/hydrogen.recpot"                                                
F "../../pseudo/fluorine.recpot"                                                
%endblock species_pot                                                           
%block species                                                                  
F      F    9    4   8.00                                                       
C      C    6    4   8.00                                                       
H      H    1    1   8.00                                                       
%endblock species                                                               
%block positions_abs                                                            
     Hash =   000000850609061806108529
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/fluorine.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  9;  ionic charge:  7.000000
    Shell 1: l = 0; rc = 1.60 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          2         8         2
  F          2         8         2
  H          6         6         0
.......   ......    ......    ......
Totals:     10        22         4
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   81 x  81 x  99
                              FFT-box:   81 x  81 x  99
                                  PPD:    9 x   9 x   1
Grid space d1=  0.472560454962a0 (KE cutoff=  34.01647Eh = 925.63526eV)
Grid space d2=  0.473597704640a0 (KE cutoff=  33.86763Eh = 921.58514eV)
Grid space d3=  0.461574732504a0 (KE cutoff=  35.65496Eh = 970.22082eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     81    81    99
          Real-space ('12') slabs/proc (min max mean):     24    25    24
         Recip-space ('23') slabs/proc (min max mean):     10    11    10
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    162   162   198
          Real-space ('12') slabs/proc (min max mean):     49    50    49
         Recip-space ('23') slabs/proc (min max mean):     20    21    20
********************************************************************************
 WARNING: meta-GGA functionality under development.
          Using this functional is experimental.
          Minimum tau threshold, xc_min_tau =   1.00000000E-07
 WARNING: Using alternative XC functional PBE for 
          radial densities (xc_radial).

Atom SCF Calculation for F  : Z (AE atom) =   9 : Z (PS atom) =   7
Config String:
Orbitals (num,occ):  2     2.00 5.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1          2.7611488743  -14.5814808926   13.8226675072   -2.9941905181
  2        -23.6468988571   -4.9262852107   20.5563391575   -4.3754291518
  3        -24.5333422388   -4.3845174060   21.1176360031   -4.4841774257
  4        -24.3589846110   -4.3106007262   21.1951185558   -4.4997226010
  5        -24.2648130915   -4.2782480462   21.2295405571   -4.5072746172
  6        -24.2273967317   -4.2662721993   21.2423931666   -4.5102591208
  7        -24.2051874669   -4.2594289004   21.2497709560   -4.5120304002
  8        -24.1920127016   -4.2555245615   21.2539946585   -4.5130749575
  9        -24.1842085413   -4.2532979384   21.2564101258   -4.5136893003
 10        -24.1795905881   -4.2520289885   21.2577900978   -4.5140501613
 11        -24.1768594791   -4.2513067407   21.2585773956   -4.5142619864
 12        -24.1752444737   -4.2508964304   21.2590257411   -4.5143862777
 13        -24.1742893079   -4.2506638992   21.2592804817   -4.5144591881
 14        -24.1737241935   -4.2505325104   21.2594248269   -4.5145019496
 15        -24.1733896886   -4.2504585326   21.2595063579   -4.5145270252
 16        -24.1731915743   -4.2504170521   21.2595522389   -4.5145417276
 17        -24.1730741643   -4.2503939062   21.2595779472   -4.5145503470
 18        -24.1730045349   -4.2503810647   21.2595922801   -4.5145553995
 19        -24.1729632114   -4.2503739886   21.2596002237   -4.5145583608
 20        -24.1729386678   -4.2503701212   21.2596045955   -4.5145600962
 21        -24.1729240786   -4.2503680287   21.2596069811   -4.5145611130
 22        -24.1729153991   -4.2503669105   21.2596082695   -4.5145617088
 23        -24.1729102310   -4.2503663225   21.2596089563   -4.5145620577
 24        -24.1729071508   -4.2503660198   21.2596093163   -4.5145622620
 25        -24.1729053133   -4.2503658685   21.2596095008   -4.5145623817
 26        -24.1729042160   -4.2503657960   21.2596095926   -4.5145624517
 27        -24.1729035601   -4.2503657636   21.2596096361   -4.5145624927
 28        -24.1729031676   -4.2503657509   21.2596096552   -4.5145625167
 29        -24.1729029325   -4.2503657473   21.2596096625   -4.5145625307
 30        -24.1729027915   -4.2503657477   21.2596096642   -4.5145625389
 31        -24.1729027068   -4.2503657494   21.2596096638   -4.5145625437
Atom SCF converged after  31 iterations to a total energy of    -24.17290271

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    1  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.2978537703   -1.3069556415    4.5135240840   -1.4493313819
  2         -5.3722101572   -1.3429720855    4.4750047034   -1.4361585075
  3         -5.3810024625   -1.3617318955    4.4541564016   -1.4305910646
  4         -5.3918891919   -1.3667874256    4.4484651894   -1.4294637301
  5         -5.3956001246   -1.3688483875    4.4461293995   -1.4290720368
  6         -5.3968156416   -1.3696797517    4.4451828381   -1.4289352254
  7         -5.3971904699   -1.3700123675    4.4448029332   -1.4288885408
  8         -5.3972940900   -1.3701446126    4.4446515101   -1.4288733837
  9         -5.3973158643   -1.3701970057    4.4445913856   -1.4288688700
 10         -5.3973161065   -1.3702177186    4.4445675639   -1.4288677470
 11         -5.3973125304   -1.3702258950    4.4445581388   -1.4288675988
 12         -5.3973094987   -1.3702291184    4.4445544138   -1.4288676724
 13         -5.3973079681   -1.3702301335    4.4445532373   -1.4288677429
 14         -5.3973069755   -1.3702306558    4.4445526310   -1.4288677962
 15         -5.3973063507   -1.3702309242    4.4445523187   -1.4288678332
 16         -5.3973059658   -1.3702310621    4.4445521579   -1.4288678576
 17         -5.3973057325   -1.3702311328    4.4445520752   -1.4288678731
 18         -5.3973055929   -1.3702311691    4.4445520327   -1.4288678828
 19         -5.3973055101   -1.3702311876    4.4445520109   -1.4288678887
Atom SCF converged after  19 iterations to a total energy of     -5.39730551

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1275    0.0062794349    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   37    0  198.4463516928
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3194574941   -0.2393855288    0.2820952552   -0.2424203211
  2         -0.3951950758   -0.2377117122    0.2886403510   -0.2475147914
  3         -0.4317095448   -0.2352245104    0.2921333338   -0.2514046135
  4         -0.4470723965   -0.2341892953    0.2934391381   -0.2531009747
  5         -0.4532140959   -0.2338557386    0.2938387976   -0.2537313507
  6         -0.4556582447   -0.2337613258    0.2939448164   -0.2539550465
  7         -0.4566419571   -0.2337378053    0.2939679715   -0.2540342284
  8         -0.4570438404   -0.2337331811    0.2939707889   -0.2540627388
  9         -0.4572103117   -0.2337329021    0.2939697896   -0.2540732668
 10         -0.4572800472   -0.2337333096    0.2939686800   -0.2540772607
 11         -0.4573095098   -0.2337336483    0.2939679925   -0.2540788141
 12         -0.4573220357   -0.2337338454    0.2939676307   -0.2540794313
 13         -0.4573273850   -0.2337339467    0.2939674539   -0.2540796807
 14         -0.4573296770   -0.2337339958    0.2939673707   -0.2540797827
 15         -0.4573306613   -0.2337340187    0.2939673326   -0.2540798249
 16         -0.4573310847   -0.2337340293    0.2939673153   -0.2540798425
 17         -0.4573312671   -0.2337340341    0.2939673075   -0.2540798498
 18         -0.4573313457   -0.2337340362    0.2939673041   -0.2540798529
Atom SCF converged after  18 iterations to a total energy of     -0.45733135

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      6;  min      5;  average      6
... Projector load balancing: max      1;  min      1;  average      1
... done
Calculating Ewald energy ...
              Ewald: real-space energy =           49.096392
        Ewald: reciprocal-space energy =            4.588494
         Ewald: (sum_charge)**2 energy =            4.477628
         Ewald: (sum_charge**2) energy =            4.912480
                          Ewald energy =           44.294777
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):         20707        89522
... Nonlocal pseudopotential projector initialisation
... done

========================== Sparse matrix information ===========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling:  87.50%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  14.46%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.41905858E+01     0.91628232E+00
               2       0.38829691E+01     0.84146639E+00
               3       0.34880402E+01     0.71381751E+00
               4       0.30565263E+01     0.64381457E+00
               5       0.26706258E+01     0.62398439E+00
               6       0.23384108E+01     0.58979112E+00
               7       0.19665041E+01     0.52845939E+00
               8       0.14722821E+01     0.42727002E+00
               9       0.87940724E+00     0.28325712E+00
              10       0.33662921E+00     0.12591583E+00
              11       0.57679296E-01     0.24975607E-01
              12       0.21331519E-02     0.98285573E-03
              13       0.32054998E-05     0.15221229E-05
              14       0.73191741E-11     0.36506353E-11
              15       0.23495118E-14     0.88817842E-15
================================================================================
 WARNING: xc_energy_potential using alternative initial XC functional PBE.
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -6.49204419260782    0.5843884
               2          -6.83419590826520    0.5722307
               3          -7.26383204114246    0.5545228
               4          -7.75098140260721    0.5349716
               5          -8.20327321529599    0.5236145
               6          -8.49175914955641    0.5232915
               7          -8.59820052531691    0.5122373
               8          -8.62167701908902    0.5014659
               9          -8.62366029707120    0.5000191
              10          -8.62367788580277    0.5000006
              11          -8.62367788764568    1.0061707
Termination criterion satisfied: c_n > 1
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      28.00000000
     Final electron number for spin 1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.528860002040
             Q0:         -63.007809270274
             G0:      -0.097651946070
   RMS gradient:       0.014204232438
     Trial step:       0.500000000000
             Q1:         -63.029096103703
 Quadratic coef:       0.027539139606
 Linear coef   :      -0.048825973035
           Qmin:         -63.029450974381
Quadratic minimum step length (  0.443241634756) accepted
    Initial Ne1:      28.00000000
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001587 (step -0.4948 Ne1=     28.0000)
 RMS occupancy error at iteration   2:  0.000003 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -6.300780927027E+01     1.4204E-02     1.1160E-02
      ideal mu1:      -0.556748505383
             Q0:         -63.029637527902
             G0:      -0.013345335291
   RMS gradient:       0.005254055578
     Trial step:       0.470766202460
             Q1:         -63.032439698089
 Quadratic coef:       0.003480362628
 Linear coef   :      -0.006282532816
           Qmin:         -63.032472736672
Quadratic minimum step length (  0.424898844052) accepted
    Initial Ne1:      28.00000000
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000550 (step -0.4983 Ne1=     28.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -6.302963752790E+01     5.2541E-03     4.1282E-03    -2.1828E-02
      ideal mu1:      -0.560776511416
             Q0:         -63.032490549723
             G0:      -0.000225574171
   RMS gradient:       0.000680638947
     Trial step:       0.447244916398
             Q1:         -63.032551566752
 Quadratic coef:       0.000039869873
 Linear coef   :      -0.000100886901
           Qmin:         -63.032554370889
Quadratic minimum step length (  0.565855254101) accepted
    Initial Ne1:      28.00000000
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000019 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -6.303249054972E+01     6.8064E-04     5.3479E-04    -2.8530E-03
      ideal mu1:      -0.560129069056
             Q0:         -63.032554393896
             G0:      -0.000042353456
   RMS gradient:       0.000295746988
     Trial step:       0.503066482499
             Q1:         -63.032565751461
 Quadratic coef:       0.000009949039
 Linear coef   :      -0.000021306604
           Qmin:         -63.032565801314
Quadratic minimum step length (  0.538677078382) accepted
    Initial Ne1:      27.99999991
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -6.303255439390E+01     2.9575E-04     2.3237E-04    -6.3844E-05
      ideal mu1:      -0.560556892574
    5        -6.303256580246E+01     8.4826E-05     6.6649E-05    -1.1409E-05
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.30325658024565E+01  Eh
     Estimated bandgap           =   3.3419E-01  Eh
     RMS occupancy error         =   1.3221E-10
     [H,K] commutator            =   6.6649E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.2377E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.45746333E-02     0.12207581E-02
               2       0.46278242E-05     0.18552423E-05
               3       0.74293137E-11     0.37216896E-11
               4       0.19219737E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.63974659E-01     0.21969059E-01
               2       0.10147590E-02     0.38656778E-03
               3       0.28530385E-06     0.12189217E-06
               4       0.26417529E-13     0.12323476E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.95583345E-03     0.34559199E-03
               2       0.24659474E-06     0.10087179E-06
               3       0.17804619E-13     0.84376950E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00123770325216
Trial step length           =               0.122474
Gradient along search dir.  =         -0.69968886786
Functional at step 0        =     -63.03256580245649
Functional at step 1        =     -63.11413478352388
Rejected quadratic step     =               1.272145
Functional at new step 1    =     -63.47327669801716
Functional predicted        =     -63.47331864810311
Selected quadratic step     =               1.259854
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      28.23016974
     Final electron number for spin 1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.006431 (step -0.4870 Ne1=     28.0000)
 RMS occupancy error at iteration   2:  0.000047 (step -0.4999 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.534943720910
             Q0:         -63.472122239732
             G0:      -0.067471583333
   RMS gradient:       0.011806951249
     Trial step:       0.520567366461
             Q1:         -63.483237726737
 Quadratic coef:       0.024008017442
 Linear coef   :      -0.035123504447
           Qmin:         -63.484968579164
Quadratic minimum step length (  0.380792588457) accepted
    Initial Ne1:      27.99999959
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000827 (step -0.4972 Ne1=     28.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -6.347212223973E+01     1.1807E-02     9.2769E-03
      ideal mu1:      -0.530803334977
             Q0:         -63.484931842750
             G0:      -0.004676828977
   RMS gradient:       0.003099368420
     Trial step:       0.445228250385
             Q1:         -63.485933236083
 Quadratic coef:       0.001080863050
 Linear coef   :      -0.002082256383
           Qmin:         -63.485934696822
Quadratic minimum step length (  0.428860699136) accepted
    Initial Ne1:      27.99999997
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000186 (step -0.4994 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -6.348493184275E+01     3.0994E-03     2.4352E-03    -1.2810E-02
      ideal mu1:      -0.528372980588
             Q0:         -63.485936490588
             G0:      -0.000129159916
   RMS gradient:       0.000515838807
     Trial step:       0.436967846340
             Q1:         -63.485965251821
 Quadratic coef:       0.000027677497
 Linear coef   :      -0.000056438730
           Qmin:         -63.485965262430
Quadratic minimum step length (  0.445522778990) accepted
    Initial Ne1:      28.00000160
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -6.348593649059E+01     5.1584E-04     4.0530E-04    -1.0046E-03
      ideal mu1:      -0.527351281675
             Q0:         -63.485965267311
             G0:      -0.000010778470
   RMS gradient:       0.000149202580
     Trial step:       0.441224579133
             Q1:         -63.485968419727
 Quadratic coef:       0.000001603310
 Linear coef   :      -0.000004755726
           Qmin:         -63.485968793910
Quadratic minimum step length (  0.654378415683) accepted
    Initial Ne1:      28.00000017
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -6.348596526731E+01     1.4920E-04     1.1723E-04    -2.8777E-05
      ideal mu1:      -0.527591514239
    5        -6.348596879377E+01     3.7565E-05     2.9516E-05    -3.5265E-06
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.34859687937724E+01  Eh
     Estimated bandgap           =   3.8774E-01  Eh
     RMS occupancy error         =   1.5990E-11
     [H,K] commutator            =   2.9516E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.1941E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10915980E-01     0.28569414E-02
               2       0.35574596E-04     0.10518410E-04
               3       0.51299036E-09     0.17942470E-09
               4       0.24599592E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.30601878E-01     0.91298383E-02
               2       0.27439487E-03     0.80953635E-04
               3       0.26306487E-07     0.75790850E-08
               4       0.25402603E-14     0.83266727E-15
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00051941471869
Trial step length           =               0.392810
Gradient along search dir.  =         -0.12666574087
Functional at step 0        =     -63.48596879377244
Functional at step 1        =     -63.52811715561650
Functional predicted        =     -63.56732609053020
Selected quadratic step     =               1.284598
Conjugate gradients coeff.  =               0.176115
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      28.13411285
     Final electron number for spin 1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003716 (step -0.4934 Ne1=     28.0000)
 RMS occupancy error at iteration   2:  0.000017 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.518100538668
             Q0:         -63.567273222024
             G0:      -0.011954528629
   RMS gradient:       0.004969853048
     Trial step:       0.537334012560
             Q1:         -63.568728212431
 Quadratic coef:       0.004968584429
 Linear coef   :      -0.006423574837
           Qmin:         -63.569349382461
Quadratic minimum step length (  0.347342919444) accepted
    Initial Ne1:      27.99999999
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000126 (step -0.4996 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -6.356727322202E+01     4.9699E-03     3.9049E-03
      ideal mu1:      -0.514597797469
             Q0:         -63.569344822948
             G0:      -0.000820982561
   RMS gradient:       0.001302134374
     Trial step:       0.432017551309
             Q1:         -63.569551083675
 Quadratic coef:       0.000148418148
 Linear coef   :      -0.000354678876
           Qmin:         -63.569556719381
Quadratic minimum step length (  0.516202030729) accepted
    Initial Ne1:      28.00000095
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000042 (step -0.4999 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -6.356934482295E+01     1.3021E-03     1.0231E-03    -2.0716E-03
      ideal mu1:      -0.513321910493
             Q0:         -63.569556826922
             G0:      -0.000011238718
   RMS gradient:       0.000152318726
     Trial step:       0.472237585646
             Q1:         -63.569559930316
 Quadratic coef:       0.000002203951
 Linear coef   :      -0.000005307345
           Qmin:         -63.569560022083
Quadratic minimum step length (  0.568598880594) accepted
    Initial Ne1:      28.00000006
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -6.356955682692E+01     1.5232E-04     1.1968E-04    -2.1200E-04
      ideal mu1:      -0.513168320202
             Q0:         -63.569560022109
             G0:      -0.000001425045
   RMS gradient:       0.000054262155
     Trial step:       0.518183136133
             Q1:         -63.569560407870
 Quadratic coef:       0.000000352673
 Linear coef   :      -0.000000738434
           Qmin:         -63.569560408646
Quadratic minimum step length (  0.542491413400) accepted
    Initial Ne1:      28.00000001
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -6.356956002211E+01     5.4262E-05     4.2635E-05    -3.1952E-06
      ideal mu1:      -0.513282627103
    5        -6.356956040865E+01     7.7481E-06     6.0878E-06    -3.8654E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.35695604086499E+01  Eh
     Estimated bandgap           =   3.8225E-01  Eh
     RMS occupancy error         =   2.1627E-13
     [H,K] commutator            =   6.0878E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3617E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14782636E-01     0.39402693E-02
               2       0.72777806E-04     0.20174702E-04
               3       0.21703469E-08     0.64135497E-09
               4       0.26386282E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13276532E-01     0.33605303E-02
               2       0.57785447E-04     0.14545802E-04
               3       0.12833217E-08     0.33314174E-09
               4       0.20792062E-14     0.58965690E-15
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00023616898988
Trial step length           =               0.710354
Gradient along search dir.  =         -0.02623367309
Functional at step 0        =     -63.56956040864986
Functional at step 1        =     -63.58298422733434
Functional predicted        =     -63.58621964240103
Selected quadratic step     =               1.270065
Conjugate gradients coeff.  =               0.206737
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      28.06052136
     Final electron number for spin 1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001802 (step -0.4972 Ne1=     28.0000)
 RMS occupancy error at iteration   2:  0.000005 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.512780344983
             Q0:         -63.586194532150
             G0:      -0.001931412142
   RMS gradient:       0.001997628833
     Trial step:       0.530197983701
             Q1:         -63.586471552464
 Quadratic coef:       0.000747010509
 Linear coef   :      -0.001024030823
           Qmin:         -63.586545477389
Quadratic minimum step length (  0.363407924689) accepted
    Initial Ne1:      28.00000000
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000021 (step -0.4999 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -6.358619453215E+01     1.9976E-03     1.5696E-03
      ideal mu1:      -0.511423047968
             Q0:         -63.586545104415
             G0:      -0.000141280467
   RMS gradient:       0.000540225037
     Trial step:       0.438951191969
             Q1:         -63.586580223928
 Quadratic coef:       0.000026895716
 Linear coef   :      -0.000062015229
           Qmin:         -63.586580852568
Quadratic minimum step length (  0.506059389398) accepted
    Initial Ne1:      28.00000003
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000007 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -6.358654510441E+01     5.4023E-04     4.2446E-04    -3.5057E-04
      ideal mu1:      -0.510889005198
             Q0:         -63.586580857013
             G0:      -0.000002801978
   RMS gradient:       0.000076073087
     Trial step:       0.471312393411
             Q1:         -63.586581562612
 Quadratic coef:       0.000000615009
 Linear coef   :      -0.000001320607
           Qmin:         -63.586581565948
Quadratic minimum step length (  0.506024200091) accepted
    Initial Ne1:      27.99999999
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -6.358658085701E+01     7.6073E-05     5.9772E-05    -3.5753E-05
      ideal mu1:      -0.510763818217
             Q0:         -63.586581565951
             G0:      -0.000000263490
   RMS gradient:       0.000023332242
     Trial step:       0.488359986966
             Q1:         -63.586581643697
 Quadratic coef:       0.000000050932
 Linear coef   :      -0.000000128678
           Qmin:         -63.586581647226
Quadratic minimum step length (  0.616915514315) accepted
    Initial Ne1:      28.00000000
      Final Ne1:      28.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     28.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     28.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -6.358658156595E+01     2.3332E-05     1.8332E-05    -7.0894E-07
      ideal mu1:      -0.510803179773
    5        -6.358658164722E+01     3.0937E-06     2.4308E-06    -8.1269E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -6.35865816472204E+01  Eh
     Estimated bandgap           =   3.7719E-01  Eh
     RMS occupancy error         =   1.0349E-14
     [H,K] commutator            =   2.4308E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       45.19311732618529 |
           | Pseudopotential (local)    :     -244.39592464936081 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        8.24299156085977 |
           | Hartree                    :       98.05829950512683 |
           | Exchange-correlation       :      -14.97984271863878 |
           | Ewald                      :       44.29477732860730 |
           | Total                      :      -63.58658164722040 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -244.39592464936061 |
           | Hartree                    :       98.05829950512526 |
           --------------------------------------------------------
           Integrated density           :       27.99999999999943
           Integrated density tr(KS)    :       28.00000000000000
================================================================================

WARNING: maximum number of NGWF CG iterations (   3) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00123770325216    -63.03256580245649   1.259854    -63.47331864810311        
   1     0.00051941471869    -63.48596879377244   1.284598    -63.56732609053020        
   2     0.00023616898988    -63.58658164722041  <-- CG                                 
 
<QC>        [NGWF iterations]:                      3
<QC>           [total_energy]:       -63.586581647220
<QC>           [rms_gradient]:         0.000236168990

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     115.309s on      4 proc(s)                                    
TOTAL TIME:       115.310s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                :    53        0.00s   0.001%  ------ ||
|| basis_extract_function_from_box      :    33        0.00s   0.001%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.002%  ------ ||
|| pseudopotentials_nonlocal_mat        :     8        0.00s   0.003%  ------ ||
|| ewald_calculate_energy               :     1        0.01s   0.009%  ------ ||
|| ngwf_gradient_coeffs                 :     3        0.01s   0.009%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     8        0.01s   0.009%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.01s   0.010%  ------ ||
|| sparse_init                          :     1        0.01s   0.011%  ------ ||
|| pseudo_make_structure_factor         :     1        0.02s   0.016%  ------ ||
|| lnv_gradient_norm                    :    20        0.03s   0.027%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.04s   0.034%  ------ ||
|| basis_dot_function_with_box          :  4708        0.05s   0.041%  ------ ||
|| kernel_purify                        :    63        0.05s   0.042%  ------ ||
|| sparse_trace                         :   730        0.05s   0.043%  ------ ||
|| kernel_fix                           :    20        0.06s   0.049%  ------ ||
|| function_ops_brappd_ketppd           :     8        0.06s   0.051%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.07s   0.065%  ------ ||
|| basis_add_function_to_box            : 11374        0.10s   0.084%  ------ ||
|| sparse_product                       :   979        0.11s   0.095%  ------ ||
|| basis_copy_function_to_box           :   731        0.18s   0.155%  ------ ||
|| energy_and_force_init_cell           :     1        0.26s   0.228%  ------ ||
|| projectors_gradient_batch            :     3        0.27s   0.230%  ------ ||
|| density_init_guess_real              :     1        0.28s   0.239%  ------ ||
|| ke_density_batch_row_sums            :    41        0.30s   0.257%  ------ ||
|| projectors_init_fftbox_recip         :    11        0.32s   0.273%  ------ ||
|| density_batch_row_sums               :    41        0.33s   0.287%  ------ ||
|| fourier_apply_box_pair               :   282        0.34s   0.299% 205.224 ||
|| integrals_locpot_mat_els_batch       :    23        0.36s   0.314%  ------ ||
|| integrals_kinetic                    :     8        0.36s   0.315%  ------ ||
|| projectors_func_ovlp_box             :     8        0.38s   0.332%  ------ ||
|| cell_grid_extract_box_real           :   534        0.51s   0.439%  ------ ||
|| cell_grid_deposit_box_real           :   495        0.94s   0.819%  ------ ||
|| ke_density_fftbox_deposit_to_cell    :   246        1.27s   1.098%  ------ ||
|| density_fftbox_deposit_to_cell       :   246        1.42s   1.235%  ------ ||
|| hamiltonian_energy_components        :     1        2.42s   2.101%  ------ ||
|| hartree_on_grid                      :    42        2.47s   2.139%  ------ ||
|| ke_density_batch_grad_apply          :    41        2.86s   2.477%  ------ ||
|| density_fftbox_interpolate_multiply  :   246        3.38s   2.935%  ------ ||
|| ngwf_gradient_build_batch            :     3        5.04s   4.375%  ------ ||
|| fourier_apply_cell_backward          :   211        5.18s   4.496%  11.892 ||
|| fourier_apply_cell_forward           :   210        5.62s   4.878%  10.910 ||
|| ngwf_gradient_batch                  :     3        5.83s   5.058%  ------ ||
|| ngwf_gradient_lnv                    :     3        6.37s   5.523%  ------ ||
|| potential_apply_to_ngwf_batch        :    23        8.41s   7.295%  ------ ||
|| integrals_locpot_dbl_grid            :    23        8.86s   7.682%  ------ ||
|| ke_density_fftbox_interpolate_multipl:   246       11.33s   9.829%  ------ ||
|| xc_energy_potential                  :    42       11.97s  10.385%  ------ ||
|| density_batch_interp_deposit         :    41       13.42s  11.635%  ------ ||
|| density_on_dbl_grid                  :    41       15.16s  13.150%  ------ ||
|| fourier_apply_box                    :  5381       17.89s  15.512% 252.564 ||
|| potential_apply_to_fftbox_batch      :    60       20.99s  18.206%  ------ ||
|| ke_density_batch_interp_deposit      :    41       27.59s  23.926%  ------ ||
|| integrals_div_locpot_grad_functions  :    20       31.28s  27.125%  ------ ||
|| ke_density_on_dbl_grid               :    41       31.72s  27.512%  ------ ||
|| hamiltonian_lhxc_calculate           :    40       63.63s  55.179%  ------ ||
|| lnv_denskernel_optimise_cg           :     4       97.04s  84.157%  ------ ||
|| ngwf_cg_optimise                     :     1      113.33s  98.279%  ------ ||
|| energy_and_force_calculate           :     1      114.74s  99.502%  ------ ||
|| total_time                           :     1      115.31s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 1 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 3 ms printing in order.

Job completed: 21-09-2022 11:06 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
