==================================================================================
It's Wed Sep 21 10:33:35 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 3697 3698 3699 3700)...
    - ONETEP arguments: ethene_relax_lbfgs.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test37
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test37/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test37/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack ethene_relax_lbfgs.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 10:33 (+0100)
 
Reading parameters from file "ethene_relax_lbfgs.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 10
   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "ethene_relax_lbfgs.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task                : GEOMETRYOPTIMIZATION                                      
geom_lbfgs : T                                                                  
geom_lbfgs_max_updates : 2                                                      
geom_max_iter       : 4                                                         
write_forces        : TRUE                                                      
maxit_pen           : 3                                                         
cutoff_energy       : 550 eV                                                    
xc_functional       : LDA                                                       
ngwf_threshold_orig : 1e-5                                                      
timings_level       : 0                                                         
print_qc            : TRUE                                                      
%block  lattice_cart                                                            
40.000    0.000    0.000                                                        
0.000   40.000    0.000                                                         
0.000    0.000   40.000                                                         
%endblock  lattice_cart                                                         
%block  positions_abs                                                           
     Hash =   000003073891830956016749
%endblock  positions_abs                                                        
%block  species                                                                 
H     H   1  1  5.50                                                            
C     C   6  4  6.00                                                            
%endblock  species                                                              
%block  species_pot                                                             
H     "../../pseudo/hydrogen.recpot"                                            
C     "../../pseudo/carbon.recpot"                                              
%endblock  species_pot                                                          

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
WARNING in pseudopotentials_read_species: string "GGA" found in pseudopotential
file "../../pseudo/carbon.recpot", yet xc_functional = "LDA".
 
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          2         8         2
  H          4         4         0
.......   ......    ......    ......
Totals:      6        12         2
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   65 x  65 x  65
                              FFT-box:   63 x  63 x  63
                                  PPD:    5 x   5 x   1
Grid space d1=  0.615384615385a0 (KE cutoff=  20.05907Eh = 545.83499eV)
Grid space d2=  0.615384615385a0 (KE cutoff=  20.05907Eh = 545.83499eV)
Grid space d3=  0.615384615385a0 (KE cutoff=  20.05907Eh = 545.83499eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     65    65    65
          Real-space ('12') slabs/proc (min max mean):     16    17    16
         Recip-space ('23') slabs/proc (min max mean):      8     9     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    130   130   130
          Real-space ('12') slabs/proc (min max mean):     32    33    32
         Recip-space ('23') slabs/proc (min max mean):     16    17    16
********************************************************************************

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Atom SCF converged after  39 iterations to a total energy of     -0.41130076

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  37 iterations to a total energy of     -5.30502903

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

================================================================================
<<<<<<<<<<<<<<<<<<<< Starting ONETEP Geometry Optimisation >>>>>>>>>>>>>>>>>>>>>
================================================================================

 Geometry Optimisation: output file is "ethene_relax_lbfgs.geom"
 
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.131469   19.862216   20.048416   x
            x    H         2       22.316684   21.381117   21.086741   x
            x    H         3       22.305600   18.474510   19.097577   x
            x    C         4       18.868395   20.137541   19.951432   x
            x    H         5       17.694385   21.525477   20.902418   x
            x    H         6       17.683467   18.617139   18.913416   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.949500 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done
NGWF initialisation ...... done
Up spin density kernel initialisation ...... done

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.40055058488439 0.24893442877 0.01291645337 0.0246  0.000   12.00000000
 2    -13.62003108422273 0.19529551121 0.01195341767 0.8210 -0.784   12.00000000
WARNING: internal_polak_cg_coeff =  6.38985
WARNING: setting internal_polak_cg_coeff to zero
 3    -13.62404492116282 0.19579660337 0.00945892297 0.0593  0.000   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.037638856382
   Final penalty energy   :       0.212644620297
   RMS occupancy error    :       0.066559
   Occupancy bounds       : [-0.117, 1.096]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.340373151638E+01     7.2708E-03     7.2708E-03
    2        -1.340521643558E+01     7.4367E-04     7.4367E-04    -1.4849E-03
    3        -1.340524142643E+01     1.5781E-04     1.5781E-04    -2.4991E-05
    4        -1.340524246445E+01     3.5512E-05     3.5512E-05    -1.0380E-06
    5        -1.340524251509E+01     1.1707E-05     1.1707E-05    -5.0646E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.34052425150943E+01  Eh
     Estimated bandgap           =   2.9477E-01  Eh
     RMS occupancy error         =   6.0567E-15
     [H,K] commutator            =   1.1707E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5443E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36277815009402E+01 Eh
   Predicted gain in energy  =      -2.22538985845839E-01 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.362726095292E+01     6.8559E-03     6.8559E-03
    2        -1.362864547189E+01     1.1677E-03     1.1677E-03    -1.3845E-03
    3        -1.362870595895E+01     2.1053E-04     2.1053E-04    -6.0487E-05
    4        -1.362870776453E+01     4.7511E-05     4.7511E-05    -1.8056E-06
    5        -1.362870783946E+01     7.9606E-06     7.9606E-06    -7.4927E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36287078394617E+01  Eh
     Estimated bandgap           =   2.9931E-01  Eh
     RMS occupancy error         =   1.3124E-14
     [H,K] commutator            =   7.9606E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4757E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36536146437441E+01 Eh
   Predicted gain in energy  =      -2.49068042823541E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.365367819216E+01     2.5842E-03     2.5842E-03
    2        -1.365389033670E+01     5.5176E-04     5.5176E-04    -2.1214E-04
    3        -1.365390289320E+01     9.9471E-05     9.9471E-05    -1.2557E-05
    4        -1.365390339553E+01     2.2828E-05     2.2828E-05    -5.0233E-07
    5        -1.365390341387E+01     6.8273E-06     6.8273E-06    -1.8336E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36539034138661E+01  Eh
     Estimated bandgap           =   2.9504E-01  Eh
     RMS occupancy error         =   9.3283E-16
     [H,K] commutator            =   6.8273E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.8813E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36607618966143E+01 Eh
   Predicted gain in energy  =      -6.85848274823719E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366075921366E+01     7.6976E-04     7.6976E-04
    2        -1.366078353905E+01     2.0746E-04     2.0746E-04    -2.4325E-05
    3        -1.366078518644E+01     5.0112E-05     5.0112E-05    -1.6474E-06
    4        -1.366078530816E+01     8.8568E-06     8.8568E-06    -1.2172E-07
    5        -1.366078531240E+01     2.2982E-06     2.2982E-06    -4.2318E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36607853123952E+01  Eh
     Estimated bandgap           =   2.8935E-01  Eh
     RMS occupancy error         =   1.2009E-16
     [H,K] commutator            =   2.2982E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5297E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36636948614297E+01 Eh
   Predicted gain in energy  =      -2.90954903453944E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366368776310E+01     5.9790E-04     5.9790E-04
    2        -1.366370268586E+01     1.7180E-04     1.7180E-04    -1.4923E-05
    3        -1.366370411085E+01     5.0412E-05     5.0412E-05    -1.4250E-06
    4        -1.366370419812E+01     1.2361E-05     1.2361E-05    -8.7264E-08
    5        -1.366370420579E+01     3.0296E-06     3.0296E-06    -7.6750E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36637042057939E+01  Eh
     Estimated bandgap           =   2.8417E-01  Eh
     RMS occupancy error         =   2.2890E-16
     [H,K] commutator            =   3.0296E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4076E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36644178018609E+01 Eh
   Predicted gain in energy  =      -7.13596067056343E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366441762144E+01     3.2252E-04     3.2252E-04
    2        -1.366442126727E+01     9.5238E-05     9.5238E-05    -3.6458E-06
    3        -1.366442177973E+01     2.2395E-05     2.2395E-05    -5.1247E-07
    4        -1.366442179577E+01     5.1882E-06     5.1882E-06    -1.6036E-08
    5        -1.366442179705E+01     1.5679E-06     1.5679E-06    -1.2800E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36644217970508E+01  Eh
     Estimated bandgap           =   2.8153E-01  Eh
     RMS occupancy error         =   1.4138E-16
     [H,K] commutator            =   1.5679E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4986E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36647525730111E+01 Eh
   Predicted gain in energy  =      -3.30775960295071E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366475274539E+01     3.7250E-04     3.7250E-04
    2        -1.366475755842E+01     1.1255E-04     1.1255E-04    -4.8130E-06
    3        -1.366475847282E+01     1.6971E-05     1.6971E-05    -9.1440E-07
    4        -1.366475848505E+01     6.1389E-06     6.1389E-06    -1.2233E-08
    5        -1.366475848672E+01     1.3558E-06     1.3558E-06    -1.6659E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36647584867191E+01  Eh
     Estimated bandgap           =   2.7782E-01  Eh
     RMS occupancy error         =   1.7197E-16
     [H,K] commutator            =   1.3558E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.1727E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36647922162078E+01 Eh
   Predicted gain in energy  =      -3.37294886669781E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366479197313E+01     1.1165E-04     1.1165E-04
    2        -1.366479254756E+01     3.3844E-05     3.3844E-05    -5.7443E-07
    3        -1.366479259462E+01     6.3387E-06     6.3387E-06    -4.7055E-08
    4        -1.366479259684E+01     1.5906E-06     1.5906E-06    -2.2146E-09
    5        -1.366479259696E+01     4.4227E-07     4.4227E-07    -1.2823E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36647925969633E+01  Eh
     Estimated bandgap           =   2.7659E-01  Eh
     RMS occupancy error         =   9.8015E-17
     [H,K] commutator            =   4.4227E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4907E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36647927679475E+01 Eh
   Predicted gain in energy  =      -1.70984179703737E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366479276522E+01     9.6144E-06     9.6144E-06
    2        -1.366479276937E+01     2.7665E-06     2.7665E-06    -4.1513E-09
    3        -1.366479276969E+01     5.4756E-07     5.4756E-07    -3.2250E-10
    4        -1.366479276971E+01     1.7737E-07     1.7737E-07    -1.6353E-11
    5        -1.366479276971E+01     7.9198E-08     7.9198E-08    -7.3719E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36647927697089E+01  Eh
     Estimated bandgap           =   2.7669E-01  Eh
     RMS occupancy error         =   8.3862E-17
     [H,K] commutator            =   7.9198E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000622134739              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.45889167784561 |
           | Pseudopotential (local)    :      -60.80585254206422 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56705729803969 |
           | Hartree                    :       24.96616640626970 |
           | Exchange-correlation       :       -4.80055544923065 |
           | Ewald                      :       14.94949983943091 |
           | Total                      :      -13.66479276970895 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000007
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00454429879074    -13.40524251509434   0.500982    -13.62778150094018        
   1     0.00147569748044    -13.62870783946173   0.528348    -13.65361464374408        
   2     0.00068813015966    -13.65390341386608   0.665064    -13.66076189661431        
   3     0.00045297017080    -13.66078531239520   0.657586    -13.66369486142974        
   4     0.00024075941471    -13.66370420579388   0.572315    -13.66441780186093        
   5     0.00014985837002    -13.66442179705079   0.682248    -13.66475257301108        
   6     0.00007172741125    -13.66475848671911   0.299652    -13.66479221620778        
   7     0.00001490665166    -13.66479259696327   0.035772    -13.66479276794745        
   8     0.00000622134739    -13.66479276970894  <-- CG                                 
 
<QC>        [NGWF iterations]:                      9
<QC>           [total_energy]:       -13.664792769709
<QC>           [rms_gradient]:         0.000006221347

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1      0.20395525   0.03182300   0.02657598 *
*    H       2     -0.01220656  -0.02128279  -0.01171911 *
*    H       3     -0.00206699  -0.00905678  -0.00366511 *
*    C       4     -0.20401178  -0.03193168  -0.02659628 *
*    H       5      0.00207531   0.00899291   0.00362843 *
*    H       6      0.01225477   0.02145532   0.01177610 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000   0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:         0.203955249700
<QC>       [total_force(1,2)]:        -0.012206562635
<QC>       [total_force(1,3)]:        -0.002066991206
<QC>       [total_force(1,4)]:        -0.204011778204
<QC>       [total_force(1,5)]:         0.002075308394
<QC>       [total_force(1,6)]:         0.012254773951
<QC>       [total_force(2,1)]:         0.031822999033
<QC>       [total_force(2,2)]:        -0.021282785886
<QC>       [total_force(2,3)]:        -0.009056775337
<QC>       [total_force(2,4)]:        -0.031931675978
<QC>       [total_force(2,5)]:         0.008992913857
<QC>       [total_force(2,6)]:         0.021455324311
<QC>       [total_force(3,1)]:         0.026575979596
<QC>       [total_force(3,2)]:        -0.011719113757
<QC>       [total_force(3,3)]:        -0.003665114154
<QC>       [total_force(3,4)]:        -0.026596282779
<QC>       [total_force(3,5)]:         0.003628428889
<QC>       [total_force(3,6)]:         0.011776102206
 Geometry Optimisation: read_denskern parameter over-ridden to T
 Geometry Optimisation: read_tightbox_ngwfs parameter over-ridden to TRUE
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.131469   19.862216   20.048416   x
            x    H         2       22.316684   21.381117   21.086741   x
            x    H         3       22.305600   18.474510   19.097577   x
            x    C         4       18.868395   20.137541   19.951432   x
            x    H         5       17.694385   21.525477   20.902418   x
            x    H         6       17.683467   18.617139   18.913416   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

LBFGS: continuation file name is "ethene_relax_lbfgs.continuation"
 LBFGS: finished iteration   0  with enthalpy= -1.366479276971E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 |  dE/ion   |   0.000000E+000 |   1.000000E-006 |         Ha | No  | <-- LBFGS
 |  |F|max   |   2.082013E-001 |   2.000000E-003 |    Ha/Bohr | No  | <-- LBFGS
 |  |dR|max  |   0.000000E+000 |   5.000000E-003 |       Bohr | No  | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
  

================================================================================
 Starting LBFGS iteration    1 ...
================================================================================

 Writing continuation file "ethene_relax_lbfgs.continuation" ...done
 Backing up NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs.bfgs_back" ... done
 Backing up density kernel to file "ethene_relax_lbfgs.dkn.bfgs_back" ... done
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.179471 |      -13.664793 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  

--------------------------------------------------------------------------------
 LBFGS: starting iteration   1 with trial guess (lambda=    1.000000)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.545771   19.926859   20.102401   x
            x    H         2       22.291888   21.337884   21.062936   x
            x    H         3       22.301401   18.456113   19.090132   x
            x    C         4       18.453978   20.072677   19.897406   x
            x    H         5       17.698601   21.543745   20.909789   x
            x    H         6       17.708361   18.660722   18.937337   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...               13.629813 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax_lbfgs.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax_lbfgs.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.339451603967E+01     1.9678E-02     1.9677E-02
    2        -1.341115113104E+01     4.4939E-03     4.4939E-03    -1.6635E-02
    3        -1.341195848440E+01     1.1204E-03     1.1204E-03    -8.0735E-04
    4        -1.341203170298E+01     4.8900E-04     4.8900E-04    -7.3219E-05
    5        -1.341204754389E+01     2.2003E-04     2.2003E-04    -1.5841E-05
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.34120475438941E+01  Eh
     Estimated bandgap           =   1.1913E-01  Eh
     RMS occupancy error         =   2.1835E-09
     [H,K] commutator            =   2.2003E-04
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4322E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35734012030036E+01 Eh
   Predicted gain in energy  =      -1.61353659109441E-01 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.357366125413E+01     5.5656E-03     5.5656E-03
    2        -1.357473897966E+01     1.1784E-03     1.1784E-03    -1.0777E-03
    3        -1.357481108434E+01     3.4038E-04     3.4038E-04    -7.2105E-05
    4        -1.357481672889E+01     5.8660E-05     5.8660E-05    -5.6445E-06
    5        -1.357481691483E+01     1.3218E-05     1.3218E-05    -1.8595E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35748169148327E+01  Eh
     Estimated bandgap           =   1.3240E-01  Eh
     RMS occupancy error         =   2.0397E-13
     [H,K] commutator            =   1.3218E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.9793E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35867604099664E+01 Eh
   Predicted gain in energy  =      -1.19434951337460E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.358674748398E+01     1.9828E-03     1.9828E-03
    2        -1.358688046821E+01     2.5647E-04     2.5647E-04    -1.3298E-04
    3        -1.358688337519E+01     5.7219E-05     5.7219E-05    -2.9070E-06
    4        -1.358688357588E+01     2.1360E-05     2.1360E-05    -2.0069E-07
    5        -1.358688361947E+01     8.1895E-06     8.1895E-06    -4.3594E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35868836194730E+01  Eh
     Estimated bandgap           =   1.3355E-01  Eh
     RMS occupancy error         =   1.2877E-14
     [H,K] commutator            =   8.1895E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7826E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35903972717544E+01 Eh
   Predicted gain in energy  =      -3.51365228132394E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359038600993E+01     1.4175E-03     1.4175E-03
    2        -1.359045261634E+01     1.2975E-04     1.2975E-04    -6.6606E-05
    3        -1.359045344158E+01     2.0865E-05     2.0865E-05    -8.2524E-07
    4        -1.359045346351E+01     4.7176E-06     4.7176E-06    -2.1923E-08
    5        -1.359045346498E+01     1.3267E-06     1.3267E-06    -1.4719E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35904534649772E+01  Eh
     Estimated bandgap           =   1.3315E-01  Eh
     RMS occupancy error         =   1.1667E-16
     [H,K] commutator            =   1.3267E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8418E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35914886310709E+01 Eh
   Predicted gain in energy  =      -1.03516609373777E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359148351240E+01     6.7018E-04     6.7018E-04
    2        -1.359149875119E+01     6.7426E-05     6.7426E-05    -1.5239E-05
    3        -1.359149898102E+01     7.6975E-06     7.6975E-06    -2.2983E-07
    4        -1.359149898397E+01     2.0188E-06     2.0188E-06    -2.9462E-09
    5        -1.359149898431E+01     1.1203E-06     1.1203E-06    -3.4267E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35914989843117E+01  Eh
     Estimated bandgap           =   1.3262E-01  Eh
     RMS occupancy error         =   5.4500E-17
     [H,K] commutator            =   1.1203E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1792E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35915993017234E+01 Eh
   Predicted gain in energy  =      -1.00317411686035E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359159926444E+01     1.0236E-04     1.0236E-04
    2        -1.359159970929E+01     2.3528E-05     2.3528E-05    -4.4485E-07
    3        -1.359159973464E+01     5.2010E-06     5.2010E-06    -2.5350E-08
    4        -1.359159973618E+01     1.4016E-06     1.4016E-06    -1.5463E-09
    5        -1.359159973628E+01     2.3128E-07     2.3128E-07    -9.3113E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35915997362758E+01  Eh
     Estimated bandgap           =   1.3250E-01  Eh
     RMS occupancy error         =   1.2553E-16
     [H,K] commutator            =   2.3128E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7057E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35916107924682E+01 Eh
   Predicted gain in energy  =      -1.10561923918340E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359161073624E+01     8.7082E-05     8.7082E-05
    2        -1.359161104035E+01     1.8870E-05     1.8870E-05    -3.0411E-07
    3        -1.359161105691E+01     3.4913E-06     3.4913E-06    -1.6563E-08
    4        -1.359161105764E+01     9.5588E-07     9.5588E-07    -7.2168E-10
    5        -1.359161105768E+01     1.3274E-07     1.3274E-07    -4.4523E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35916110576796E+01  Eh
     Estimated bandgap           =   1.3241E-01  Eh
     RMS occupancy error         =   1.1121E-16
     [H,K] commutator            =   1.3274E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7908E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35916114674980E+01 Eh
   Predicted gain in energy  =      -4.09818383673155E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359161146211E+01     2.2820E-05     2.2820E-05
    2        -1.359161148253E+01     4.7267E-06     4.7267E-06    -2.0421E-08
    3        -1.359161148357E+01     7.9582E-07     7.9582E-07    -1.0445E-09
    4        -1.359161148361E+01     2.2231E-07     2.2231E-07    -3.7591E-11
    5        -1.359161148361E+01     5.0397E-08     5.0397E-08    -2.3590E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35916114836114E+01  Eh
     Estimated bandgap           =   1.3239E-01  Eh
     RMS occupancy error         =   1.0051E-16
     [H,K] commutator            =   5.0397E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000994665169              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.16294871384585 |
           | Pseudopotential (local)    :      -57.81420246694293 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.55826094128213 |
           | Hartree                    :       23.60141582411792 |
           | Exchange-correlation       :       -4.72984784500938 |
           | Ewald                      :       13.62981334909497 |
           | Total                      :      -13.59161148361144 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999996
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00443224615840    -13.41204754389413   0.381839    -13.57340120300357        
   1     0.00099792898644    -13.57481691483268   0.552127    -13.58676040996643        
   2     0.00047825855229    -13.58688361947305   0.707523    -13.59039727175437        
   3     0.00028418496190    -13.59045346497716   0.586919    -13.59148863107090        
   4     0.00011792434857    -13.59149898431171   0.335366    -13.59159930172339        
   5     0.00004705688204    -13.59159973627581   0.231105    -13.59161079246820        
   6     0.00001790754992    -13.59161105767960   0.058005    -13.59161146749798        
   7     0.00000994665169    -13.59161148361143  <-- CG                                 
 
<QC>        [NGWF iterations]:                      8
<QC>           [total_energy]:       -13.591611483611
<QC>           [rms_gradient]:         0.000009946652

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1     -0.21162167  -0.02079367  -0.03648442 *
*    H       2      0.04725343   0.06637739   0.04680259 *
*    H       3      0.02929517  -0.03614924  -0.02290447 *
*    C       4      0.21152520   0.02078021   0.03643742 *
*    H       5     -0.02926406   0.03606048   0.02285118 *
*    H       6     -0.04718807  -0.06627516  -0.04670229 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000   0.00000000  -0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.211621671493
<QC>       [total_force(1,2)]:         0.047253432966
<QC>       [total_force(1,3)]:         0.029295169667
<QC>       [total_force(1,4)]:         0.211525202990
<QC>       [total_force(1,5)]:        -0.029264062319
<QC>       [total_force(1,6)]:        -0.047188071811
<QC>       [total_force(2,1)]:        -0.020793673964
<QC>       [total_force(2,2)]:         0.066377385663
<QC>       [total_force(2,3)]:        -0.036149237338
<QC>       [total_force(2,4)]:         0.020780209921
<QC>       [total_force(2,5)]:         0.036060476682
<QC>       [total_force(2,6)]:        -0.066275160964
<QC>       [total_force(3,1)]:        -0.036484421653
<QC>       [total_force(3,2)]:         0.046802591505
<QC>       [total_force(3,3)]:        -0.022904473754
<QC>       [total_force(3,4)]:         0.036437419148
<QC>       [total_force(3,5)]:         0.022851176772
<QC>       [total_force(3,6)]:        -0.046702292017
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.179471 |      -13.664793 | <-- min LBFGS
 | trial step |    1.000000 |   -0.190885 |      -13.591611 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  

--------------------------------------------------------------------------------
 LBFGS: improving iteration   1 with line minimization (lambda=    0.484591)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.332236   19.893542   20.074577   x
            x    H         2       22.304668   21.360167   21.075205   x
            x    H         3       22.303565   18.465595   19.093969   x
            x    C         4       18.667572   20.106108   19.925251   x
            x    H         5       17.696428   21.534329   20.905990   x
            x    H         6       17.695530   18.638259   18.925008   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.171689 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax_lbfgs.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax_lbfgs.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.362179762644E+01     1.3348E-02     1.3348E-02
    2        -1.362856023489E+01     2.7417E-03     2.7417E-03    -6.7626E-03
    3        -1.362895338971E+01     4.4322E-04     4.4322E-04    -3.9315E-04
    4        -1.362896159564E+01     8.7436E-05     8.7436E-05    -8.2059E-06
    5        -1.362896204850E+01     2.8755E-05     2.8755E-05    -4.5286E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36289620485011E+01  Eh
     Estimated bandgap           =   1.9473E-01  Eh
     RMS occupancy error         =   7.1086E-13
     [H,K] commutator            =   2.8755E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1205E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36674284236872E+01 Eh
   Predicted gain in energy  =      -3.84663751860845E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366741984725E+01     1.1597E-03     1.1597E-03
    2        -1.366747602834E+01     2.6129E-04     2.6129E-04    -5.6181E-05
    3        -1.366747959370E+01     3.1244E-05     3.1244E-05    -3.5654E-06
    4        -1.366747964054E+01     9.2371E-06     9.2371E-06    -4.6836E-08
    5        -1.366747964522E+01     3.5484E-06     3.5484E-06    -4.6804E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36674796452185E+01  Eh
     Estimated bandgap           =   1.9277E-01  Eh
     RMS occupancy error         =   1.2613E-16
     [H,K] commutator            =   3.5484E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8280E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36700653935004E+01 Eh
   Predicted gain in energy  =      -2.58574828188252E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367007350084E+01     6.8043E-04     6.8043E-04
    2        -1.367009080089E+01     1.4456E-04     1.4456E-04    -1.7300E-05
    3        -1.367009190664E+01     2.0749E-05     2.0749E-05    -1.1057E-06
    4        -1.367009192944E+01     5.4789E-06     5.4789E-06    -2.2799E-08
    5        -1.367009193090E+01     1.3466E-06     1.3466E-06    -1.4626E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36700919309022E+01  Eh
     Estimated bandgap           =   1.9180E-01  Eh
     RMS occupancy error         =   1.0259E-16
     [H,K] commutator            =   1.3466E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9359E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36705241910549E+01 Eh
   Predicted gain in energy  =      -4.32260152653186E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367052553199E+01     2.9886E-04     2.9886E-04
    2        -1.367052979585E+01     8.8614E-05     8.8614E-05    -4.2639E-06
    3        -1.367053013655E+01     1.1567E-05     1.1567E-05    -3.4070E-07
    4        -1.367053014448E+01     2.1599E-06     2.1599E-06    -7.9299E-09
    5        -1.367053014471E+01     6.5715E-07     6.5715E-07    -2.3268E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36705301447137E+01  Eh
     Estimated bandgap           =   1.9122E-01  Eh
     RMS occupancy error         =   1.1233E-16
     [H,K] commutator            =   6.5715E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.5910E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706069172891E+01 Eh
   Predicted gain in energy  =      -7.67725754098336E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367060587189E+01     1.7555E-04     1.7555E-04
    2        -1.367060765976E+01     2.3183E-05     2.3183E-05    -1.7879E-06
    3        -1.367060768275E+01     5.5404E-06     5.5404E-06    -2.2987E-08
    4        -1.367060768427E+01     9.8431E-07     9.8431E-07    -1.5251E-09
    5        -1.367060768432E+01     3.1897E-07     3.1897E-07    -5.0985E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706076843246E+01  Eh
     Estimated bandgap           =   1.9078E-01  Eh
     RMS occupancy error         =   1.1834E-16
     [H,K] commutator            =   3.1897E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.8813E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706236750012E+01 Eh
   Predicted gain in energy  =      -1.59906766477036E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367062274804E+01     1.4599E-04     1.4599E-04
    2        -1.367062378632E+01     4.1394E-05     4.1394E-05    -1.0383E-06
    3        -1.367062385857E+01     3.7688E-06     3.7688E-06    -7.2248E-08
    4        -1.367062385934E+01     3.8094E-07     3.8094E-07    -7.6370E-10
    5        -1.367062385934E+01     9.6937E-08     9.6937E-08    -8.0060E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706238593432E+01  Eh
     Estimated bandgap           =   1.9047E-01  Eh
     RMS occupancy error         =   1.1612E-16
     [H,K] commutator            =   9.6937E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.2921E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706846745908E+01 Eh
   Predicted gain in energy  =      -6.08152475969348E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367067521426E+01     4.4666E-04     4.4666E-04
    2        -1.367068482635E+01     1.3006E-04     1.3006E-04    -9.6121E-06
    3        -1.367068553188E+01     1.0910E-05     1.0910E-05    -7.0552E-07
    4        -1.367068553809E+01     1.4349E-06     1.4349E-06    -6.2160E-09
    5        -1.367068553819E+01     3.8586E-07     3.8586E-07    -9.7355E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706855381885E+01  Eh
     Estimated bandgap           =   1.9139E-01  Eh
     RMS occupancy error         =   7.4856E-17
     [H,K] commutator            =   3.8586E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.9691E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706939862978E+01 Eh
   Predicted gain in energy  =      -8.44810926103889E-06 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367069355227E+01     9.4242E-05     9.4242E-05
    2        -1.367069400017E+01     2.5996E-05     2.5996E-05    -4.4790E-07
    3        -1.367069402735E+01     2.5606E-06     2.5606E-06    -2.7180E-08
    4        -1.367069402769E+01     3.5306E-07     3.5306E-07    -3.4476E-10
    5        -1.367069402770E+01     1.0416E-07     1.0416E-07    -5.5493E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706940276981E+01  Eh
     Estimated bandgap           =   1.9116E-01  Eh
     RMS occupancy error         =   1.2411E-16
     [H,K] commutator            =   1.0416E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4424E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36706947871686E+01 Eh
   Predicted gain in energy  =      -7.59470518474359E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367069475911E+01     2.5302E-05     2.5302E-05
    2        -1.367069479228E+01     6.6219E-06     6.6219E-06    -3.3167E-08
    3        -1.367069479401E+01     7.3855E-07     7.3855E-07    -1.7284E-09
    4        -1.367069479403E+01     1.1144E-07     1.1144E-07    -2.8740E-11
    5        -1.367069479403E+01     4.3787E-08     4.3787E-08    -5.2580E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36706947940344E+01  Eh
     Estimated bandgap           =   1.9110E-01  Eh
     RMS occupancy error         =   1.5606E-16
     [H,K] commutator            =   4.3787E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000605645434              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.18138058072226 |
           | Pseudopotential (local)    :      -58.99723221210576 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.52737853143920 |
           | Hartree                    :       24.19066533895869 |
           | Exchange-correlation       :       -4.74457578787626 |
           | Ewald                      :       14.17168875482743 |
           | Total                      :      -13.67069479403443 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000001
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00212047855862    -13.62896204850107   0.397707    -13.66742842368716        
   1     0.00048279907075    -13.66747964521853   0.514834    -13.67006539350041        
   2     0.00019359253291    -13.67009193090222   0.530377    -13.67052419105487        
   3     0.00008591027667    -13.67053014471371   0.475339    -13.67060691728912        
   4     0.00003881263728    -13.67060768432458   0.493481    -13.67062367500123        
   5     0.00004292123694    -13.67062385934320   1.534679    -13.67068467459080        
   6     0.00005969117508    -13.67068553818854   0.111817    -13.67069398629780        
   7     0.00002442402419    -13.67069402769811   0.058898    -13.67069478716862        
   8     0.00000605645434    -13.67069479403444  <-- CG                                 
 
<QC>        [NGWF iterations]:                      9
<QC>           [total_energy]:       -13.670694794034
<QC>           [rms_gradient]:         0.000006056454

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1     -0.12680015   0.03138321   0.00083568 *
*    H       2      0.01273339   0.00827611   0.00744491 *
*    H       3      0.01576196  -0.02251046  -0.01345548 *
*    C       4      0.12672279  -0.03147593  -0.00087811 *
*    H       5     -0.01575120   0.02243772   0.01341129 *
*    H       6     -0.01266680  -0.00811064  -0.00735829 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000  -0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.126800151478
<QC>       [total_force(1,2)]:         0.012733390161
<QC>       [total_force(1,3)]:         0.015761964556
<QC>       [total_force(1,4)]:         0.126722791315
<QC>       [total_force(1,5)]:        -0.015751196859
<QC>       [total_force(1,6)]:        -0.012666797696
<QC>       [total_force(2,1)]:         0.031383207650
<QC>       [total_force(2,2)]:         0.008276106423
<QC>       [total_force(2,3)]:        -0.022510464364
<QC>       [total_force(2,4)]:        -0.031475933487
<QC>       [total_force(2,5)]:         0.022437721521
<QC>       [total_force(2,6)]:        -0.008110637743
<QC>       [total_force(3,1)]:         0.000835675620
<QC>       [total_force(3,2)]:         0.007444909312
<QC>       [total_force(3,3)]:        -0.013455476917
<QC>       [total_force(3,4)]:        -0.000878112019
<QC>       [total_force(3,5)]:         0.013411291271
<QC>       [total_force(3,6)]:        -0.007358287266
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.179471 |      -13.664793 | <-- min LBFGS
 | trial step |    1.000000 |   -0.190885 |      -13.591611 | <-- min LBFGS
 |  line step |    0.484591 |   -0.101692 |      -13.670695 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  
 LBFGS: finished iteration   1  with enthalpy= -1.367069479403E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 |  dE/ion   |   9.836707E-004 |   1.000000E-006 |         Ha | No  | <-- LBFGS
 |  |F|max   |   1.306288E-001 |   2.000000E-003 |    Ha/Bohr | No  | <-- LBFGS
 |  |dR|max  |   2.049467E-001 |   5.000000E-003 |       Bohr | No  | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
  

================================================================================
 Starting LBFGS iteration    2 ...
================================================================================

 Writing continuation file "ethene_relax_lbfgs.continuation" ...done
 Backing up NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs.bfgs_back" ... done
 Backing up density kernel to file "ethene_relax_lbfgs.dkn.bfgs_back" ... done
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.024596 |      -13.670695 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  

--------------------------------------------------------------------------------
 LBFGS: starting iteration   2 with trial guess (lambda=    1.000000)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.260688   19.948724   20.087761   x
            x    H         2       22.315621   21.361207   21.079522   x
            x    H         3       22.323062   18.432283   19.074853   x
            x    C         4       18.738995   20.050756   19.912003   x
            x    H         5       17.676949   21.567518   20.925031   x
            x    H         6       17.684686   18.637511   18.920829   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.315279 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax_lbfgs.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax_lbfgs.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.366897440572E+01     5.4819E-03     5.4819E-03
    2        -1.367026427189E+01     1.5683E-03     1.5683E-03    -1.2899E-03
    3        -1.367038511367E+01     2.4404E-04     2.4404E-04    -1.2084E-04
    4        -1.367038853440E+01     6.3147E-05     6.3147E-05    -3.4207E-06
    5        -1.367038874090E+01     2.3819E-05     2.3819E-05    -2.0650E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36703887409021E+01  Eh
     Estimated bandgap           =   2.2067E-01  Eh
     RMS occupancy error         =   1.9779E-13
     [H,K] commutator            =   2.3819E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.2196E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36830767255175E+01 Eh
   Predicted gain in energy  =      -1.26879846153880E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368306141298E+01     1.1587E-03     1.1587E-03
    2        -1.368311508106E+01     2.4894E-04     2.4894E-04    -5.3668E-05
    3        -1.368311829363E+01     4.5124E-05     4.5124E-05    -3.2126E-06
    4        -1.368311839497E+01     1.3256E-05     1.3256E-05    -1.0134E-07
    5        -1.368311840488E+01     6.3580E-06     6.3580E-06    -9.9121E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36831184048833E+01  Eh
     Estimated bandgap           =   2.1849E-01  Eh
     RMS occupancy error         =   3.5410E-16
     [H,K] commutator            =   6.3580E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8848E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36840636436781E+01 Eh
   Predicted gain in energy  =      -9.45238794816561E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368406758629E+01     4.7170E-04     4.7170E-04
    2        -1.368407683717E+01     1.2679E-04     1.2679E-04    -9.2509E-06
    3        -1.368407763430E+01     1.7574E-05     1.7574E-05    -7.9713E-07
    4        -1.368407765097E+01     4.7308E-06     4.7308E-06    -1.6673E-08
    5        -1.368407765237E+01     1.8934E-06     1.8934E-06    -1.3942E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36840776523655E+01  Eh
     Estimated bandgap           =   2.1749E-01  Eh
     RMS occupancy error         =   1.0660E-16
     [H,K] commutator            =   1.8934E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1872E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842510319719E+01 Eh
   Predicted gain in energy  =      -1.73379606383861E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368424913398E+01     2.4598E-04     2.4598E-04
    2        -1.368425285344E+01     6.3427E-05     6.3427E-05    -3.7195E-06
    3        -1.368425299023E+01     1.1386E-05     1.1386E-05    -1.3680E-07
    4        -1.368425299721E+01     3.2874E-06     3.2874E-06    -6.9751E-09
    5        -1.368425299764E+01     1.0056E-06     1.0056E-06    -4.2861E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842529976369E+01  Eh
     Estimated bandgap           =   2.1684E-01  Eh
     RMS occupancy error         =   9.3959E-17
     [H,K] commutator            =   1.0056E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.1604E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842742714117E+01 Eh
   Predicted gain in energy  =      -2.12737748004344E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368427337533E+01     1.4062E-04     1.4062E-04
    2        -1.368427455130E+01     3.0154E-05     3.0154E-05    -1.1760E-06
    3        -1.368427458514E+01     3.5139E-06     3.5139E-06    -3.3838E-08
    4        -1.368427458581E+01     4.7307E-07     4.7307E-07    -6.6844E-10
    5        -1.368427458582E+01     2.2938E-07     2.2938E-07    -1.3243E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842745858185E+01  Eh
     Estimated bandgap           =   2.1651E-01  Eh
     RMS occupancy error         =   7.5535E-17
     [H,K] commutator            =   2.2938E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1552E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842748348159E+01 Eh
   Predicted gain in energy  =      -2.48997363172521E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368427479963E+01     2.8038E-05     2.8038E-05
    2        -1.368427484104E+01     8.6128E-06     8.6128E-06    -4.1413E-08
    3        -1.368427484411E+01     6.6576E-07     6.6576E-07    -3.0626E-09
    4        -1.368427484413E+01     1.5575E-07     1.5575E-07    -2.1773E-11
    5        -1.368427484413E+01     6.7348E-08     6.7348E-08    -5.0449E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842748441276E+01  Eh
     Estimated bandgap           =   2.1656E-01  Eh
     RMS occupancy error         =   1.2994E-16
     [H,K] commutator            =   6.7348E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.5820E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36842749364542E+01 Eh
   Predicted gain in energy  =      -9.23266050278926E-08 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368427492405E+01     1.6546E-05     1.6546E-05
    2        -1.368427493850E+01     5.0698E-06     5.0698E-06    -1.4452E-08
    3        -1.368427493956E+01     3.8963E-07     3.8963E-07    -1.0596E-09
    4        -1.368427493957E+01     7.5180E-08     7.5180E-08    -7.7769E-12
    5        -1.368427493957E+01     3.9228E-08     3.9228E-08     2.8422E-14
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36842749395652E+01  Eh
     Estimated bandgap           =   2.1653E-01  Eh
     RMS occupancy error         =   3.0221E-17
     [H,K] commutator            =   3.9228E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000324314441              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.19992583729481 |
           | Pseudopotential (local)    :      -59.33103322857120 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.52771840373022 |
           | Hartree                    :       24.34798129174887 |
           | Exchange-correlation       :       -4.74414655634848 |
           | Ewald                      :       14.31527931258061 |
           | Total                      :      -13.68427493956516 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999999
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00121964821278    -13.67038874090212   0.396527    -13.68307672551751        
   1     0.00028848194269    -13.68311840488332   0.526214    -13.68406364367814        
   2     0.00011871950376    -13.68407765236554   0.562462    -13.68425103197193        
   3     0.00005160359643    -13.68425299763691   0.367094    -13.68427427141171        
   4     0.00001155227096    -13.68427458581849   0.086738    -13.68427483481585        
   5     0.00001582015908    -13.68427484412763   0.017815    -13.68427493645423        
   6     0.00000324314441    -13.68427493956516  <-- CG                                 
 
<QC>        [NGWF iterations]:                      7
<QC>           [total_energy]:       -13.684274939565
<QC>           [rms_gradient]:         0.000003243144

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1     -0.04068773  -0.01697359  -0.02439186 *
*    H       2      0.00898156   0.01091114   0.00848029 *
*    H       3     -0.00525195   0.00939171   0.00791723 *
*    C       4      0.04073927   0.01703597   0.02444922 *
*    H       5      0.00524977  -0.00945579  -0.00795047 *
*    H       6     -0.00903092  -0.01090944  -0.00850440 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000   0.00000000  -0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.040687732068
<QC>       [total_force(1,2)]:         0.008981560647
<QC>       [total_force(1,3)]:        -0.005251952562
<QC>       [total_force(1,4)]:         0.040739267599
<QC>       [total_force(1,5)]:         0.005249772183
<QC>       [total_force(1,6)]:        -0.009030915798
<QC>       [total_force(2,1)]:        -0.016973588616
<QC>       [total_force(2,2)]:         0.010911136848
<QC>       [total_force(2,3)]:         0.009391714873
<QC>       [total_force(2,4)]:         0.017035968795
<QC>       [total_force(2,5)]:        -0.009455787370
<QC>       [total_force(2,6)]:        -0.010909444530
<QC>       [total_force(3,1)]:        -0.024391863223
<QC>       [total_force(3,2)]:         0.008480289552
<QC>       [total_force(3,3)]:         0.007917227799
<QC>       [total_force(3,4)]:         0.024449216370
<QC>       [total_force(3,5)]:        -0.007950471203
<QC>       [total_force(3,6)]:        -0.008504399295
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.024596 |      -13.670695 | <-- min LBFGS
 | trial step |    1.000000 |    0.002450 |      -13.684275 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  
 LBFGS: finished iteration   2  with enthalpy= -1.368427493957E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 |  dE/ion   |   2.263358E-003 |   1.000000E-006 |         Ha | No  | <-- LBFGS
 |  |F|max   |   5.047451E-002 |   2.000000E-003 |    Ha/Bohr | No  | <-- LBFGS
 |  |dR|max  |   9.132652E-002 |   5.000000E-003 |       Bohr | No  | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
  

================================================================================
 Starting LBFGS iteration    3 ...
================================================================================

 Writing continuation file "ethene_relax_lbfgs.continuation" ...done
 Backing up NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs.bfgs_back" ... done
 Backing up density kernel to file "ethene_relax_lbfgs.dkn.bfgs_back" ... done
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.009280 |      -13.684275 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  

--------------------------------------------------------------------------------
 LBFGS: starting iteration   3 with trial guess (lambda=    1.000000)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.206557   19.923859   20.040201   x
            x    H         2       22.334389   21.381162   21.096514   x
            x    H         3       22.312968   18.447645   19.089716   x
            x    C         4       18.793215   20.075718   19.959680   x
            x    H         5       17.687042   21.551982   20.910077   x
            x    H         6       17.665830   18.617633   18.903812   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.521907 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax_lbfgs.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax_lbfgs.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.367249656974E+01     4.7912E-03     4.7912E-03
    2        -1.367361259748E+01     1.3420E-03     1.3420E-03    -1.1160E-03
    3        -1.367369322637E+01     2.8082E-04     2.8082E-04    -8.0629E-05
    4        -1.367369773136E+01     6.4821E-05     6.4821E-05    -4.5050E-06
    5        -1.367369795700E+01     1.8598E-05     1.8598E-05    -2.2564E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36736979569989E+01  Eh
     Estimated bandgap           =   2.4133E-01  Eh
     RMS occupancy error         =   2.5236E-13
     [H,K] commutator            =   1.8598E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0904E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36837791022366E+01 Eh
   Predicted gain in energy  =      -1.00811452376650E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368379450028E+01     1.1614E-03     1.1614E-03
    2        -1.368384914158E+01     2.5949E-04     2.5949E-04    -5.4641E-05
    3        -1.368385264863E+01     5.0312E-05     5.0312E-05    -3.5070E-06
    4        -1.368385298622E+01     2.5353E-05     2.5353E-05    -3.3759E-07
    5        -1.368385300917E+01     1.0170E-05     1.0170E-05    -2.2949E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36838530091688E+01  Eh
     Estimated bandgap           =   2.3943E-01  Eh
     RMS occupancy error         =   5.2998E-15
     [H,K] commutator            =   1.0170E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4206E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36844674838914E+01 Eh
   Predicted gain in energy  =      -6.14474722606673E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368446727551E+01     3.9156E-04     3.9156E-04
    2        -1.368447411441E+01     1.1395E-04     1.1395E-04    -6.8389E-06
    3        -1.368447474911E+01     1.7562E-05     1.7562E-05    -6.3470E-07
    4        -1.368447476482E+01     4.4979E-06     4.4979E-06    -1.5705E-08
    5        -1.368447476600E+01     1.5456E-06     1.5456E-06    -1.1820E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36844747659992E+01  Eh
     Estimated bandgap           =   2.3870E-01  Eh
     RMS occupancy error         =   1.8089E-16
     [H,K] commutator            =   1.5456E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.8083E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36845588847687E+01 Eh
   Predicted gain in energy  =      -8.41187694753387E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368455715382E+01     2.1817E-04     2.1817E-04
    2        -1.368456016725E+01     3.1152E-05     3.1152E-05    -3.0134E-06
    3        -1.368456020615E+01     6.5909E-06     6.5909E-06    -3.8899E-08
    4        -1.368456020840E+01     1.4977E-06     1.4977E-06    -2.2525E-09
    5        -1.368456020853E+01     6.3179E-07     6.3179E-07    -1.3336E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36845602085312E+01  Eh
     Estimated bandgap           =   2.3822E-01  Eh
     RMS occupancy error         =   8.2620E-17
     [H,K] commutator            =   6.3179E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8842E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36845641298602E+01 Eh
   Predicted gain in energy  =      -3.92132900550735E-06 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368456379939E+01     8.4971E-05     8.4971E-05
    2        -1.368456423944E+01     1.9948E-05     1.9948E-05    -4.4006E-07
    3        -1.368456425426E+01     1.8405E-06     1.8405E-06    -1.4820E-08
    4        -1.368456425445E+01     4.1036E-07     4.1036E-07    -1.8492E-10
    5        -1.368456425445E+01     1.6857E-07     1.6857E-07    -5.9917E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36845642544545E+01  Eh
     Estimated bandgap           =   2.3806E-01  Eh
     RMS occupancy error         =   8.8198E-17
     [H,K] commutator            =   1.6857E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1896E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36845645117168E+01 Eh
   Predicted gain in energy  =      -2.57262337655106E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368456447138E+01     2.9937E-05     2.9937E-05
    2        -1.368456452281E+01     8.7814E-06     8.7814E-06    -5.1423E-08
    3        -1.368456452583E+01     6.0852E-07     6.0852E-07    -3.0254E-09
    4        -1.368456452585E+01     1.4132E-07     1.4132E-07    -1.9181E-11
    5        -1.368456452585E+01     4.3297E-08     4.3297E-08    -7.5673E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36845645258519E+01  Eh
     Estimated bandgap           =   2.3811E-01  Eh
     RMS occupancy error         =   1.2365E-16
     [H,K] commutator            =   4.3297E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0851E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36845645688851E+01 Eh
   Predicted gain in energy  =      -4.30332303125169E-08 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368456456271E+01     1.1663E-05     1.1663E-05
    2        -1.368456457056E+01     3.3753E-06     3.3753E-06    -7.8468E-09
    3        -1.368456457100E+01     2.3882E-07     2.3882E-07    -4.4523E-10
    4        -1.368456457101E+01     5.5393E-08     5.5393E-08    -2.7534E-12
    5        -1.368456457101E+01     1.7297E-08     1.7297E-08    -1.2790E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36845645710076E+01  Eh
     Estimated bandgap           =   2.3809E-01  Eh
     RMS occupancy error         =   9.4372E-17
     [H,K] commutator            =   1.7297E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000303409149              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.26714467339875 |
           | Pseudopotential (local)    :      -59.79734252835303 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.53830271611393 |
           | Hartree                    :       24.54174065160395 |
           | Exchange-correlation       :       -4.75631757940765 |
           | Ewald                      :       14.52190749563644 |
           | Total                      :      -13.68456457100761 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999999
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00109036771721    -13.67369795699890   0.394197    -13.68377910223657        
   1     0.00024205639794    -13.68385300916882   0.483947    -13.68446748389143        
   2     0.00008808271767    -13.68447476599920   0.497803    -13.68455888476868        
   3     0.00002884225123    -13.68456020853119   0.215666    -13.68456412986019        
   4     0.00001189627879    -13.68456425445451   0.084509    -13.68456451171684        
   5     0.00001085113485    -13.68456452585188   0.017979    -13.68456456888511        
   6     0.00000303409149    -13.68456457100762  <-- CG                                 
 
<QC>        [NGWF iterations]:                      7
<QC>           [total_energy]:       -13.684564571008
<QC>           [rms_gradient]:         0.000003034091

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1      0.05322811   0.01785597   0.01071731 *
*    H       2     -0.00723368  -0.01138538  -0.00849244 *
*    H       3     -0.00315775   0.00029317   0.00035638 *
*    C       4     -0.05318606  -0.01790706  -0.01074481 *
*    H       5      0.00312613  -0.00028052  -0.00032781 *
*    H       6      0.00722326   0.01142383   0.00849136 *
*                                                        *
**********************************************************
* TOTAL:           -0.00000000  -0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:         0.053228112526
<QC>       [total_force(1,2)]:        -0.007233684457
<QC>       [total_force(1,3)]:        -0.003157753200
<QC>       [total_force(1,4)]:        -0.053186062470
<QC>       [total_force(1,5)]:         0.003126129826
<QC>       [total_force(1,6)]:         0.007223257774
<QC>       [total_force(2,1)]:         0.017855966102
<QC>       [total_force(2,2)]:        -0.011385380643
<QC>       [total_force(2,3)]:         0.000293168558
<QC>       [total_force(2,4)]:        -0.017907055261
<QC>       [total_force(2,5)]:        -0.000280524088
<QC>       [total_force(2,6)]:         0.011423825332
<QC>       [total_force(3,1)]:         0.010717310054
<QC>       [total_force(3,2)]:        -0.008492439317
<QC>       [total_force(3,3)]:         0.000356382313
<QC>       [total_force(3,4)]:        -0.010744811913
<QC>       [total_force(3,5)]:        -0.000327805815
<QC>       [total_force(3,6)]:         0.008491364678
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.009280 |      -13.684275 | <-- min LBFGS
 | trial step |    1.000000 |   -0.008611 |      -13.684565 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  
 LBFGS: finished iteration   3  with enthalpy= -1.368456457101E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 |  dE/ion   |   4.827191E-005 |   1.000000E-006 |         Ha | No  | <-- LBFGS
 |  |F|max   |   5.715705E-002 |   2.000000E-003 |    Ha/Bohr | No  | <-- LBFGS
 |  |dR|max  |   7.639342E-002 |   5.000000E-003 |       Bohr | No  | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
  

================================================================================
 Starting LBFGS iteration    4 ...
================================================================================

 Writing continuation file "ethene_relax_lbfgs.continuation" ...done
 Backing up NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs.bfgs_back" ... done
 Backing up density kernel to file "ethene_relax_lbfgs.dkn.bfgs_back" ... done
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.004537 |      -13.684565 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  

--------------------------------------------------------------------------------
 LBFGS: starting iteration   4 with trial guess (lambda=    1.000000)
--------------------------------------------------------------------------------
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.236398   19.941381   20.051515   x
            x    H         2       22.327395   21.370726   21.088089   x
            x    H         3       22.311127   18.447299   19.089071   x
            x    C         4       18.763416   20.058147   19.948330   x
            x    H         5       17.688849   21.552361   20.910762   x
            x    H         6       17.672815   18.628087   18.912233   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.434729 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_relax_lbfgs.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_relax_lbfgs.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368380240576E+01     2.1996E-03     2.1996E-03
    2        -1.368403417248E+01     6.5256E-04     6.5256E-04    -2.3177E-04
    3        -1.368405398242E+01     9.9941E-05     9.9941E-05    -1.9810E-05
    4        -1.368405456813E+01     2.3272E-05     2.3272E-05    -5.8570E-07
    5        -1.368405459808E+01     7.0923E-06     7.0923E-06    -2.9955E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36840545980848E+01  Eh
     Estimated bandgap           =   2.2439E-01  Eh
     RMS occupancy error         =   4.9865E-15
     [H,K] commutator            =   7.0923E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.6336E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36867494179010E+01 Eh
   Predicted gain in energy  =      -2.69481981626285E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368674641922E+01     5.4089E-04     5.4089E-04
    2        -1.368675718381E+01     7.2040E-05     7.2040E-05    -1.0765E-05
    3        -1.368675744233E+01     1.3632E-05     1.3632E-05    -2.5852E-07
    4        -1.368675745240E+01     3.5791E-06     3.5791E-06    -1.0068E-08
    5        -1.368675745302E+01     1.0301E-06     1.0301E-06    -6.2222E-10
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36867574530228E+01  Eh
     Estimated bandgap           =   2.2544E-01  Eh
     RMS occupancy error         =   7.6660E-17
     [H,K] commutator            =   1.0301E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0989E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36868519439497E+01 Eh
   Predicted gain in energy  =      -9.44909268945082E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368685035108E+01     1.8656E-04     1.8656E-04
    2        -1.368685167334E+01     3.8340E-05     3.8340E-05    -1.3223E-06
    3        -1.368685175804E+01     5.3588E-06     5.3588E-06    -8.4695E-08
    4        -1.368685175941E+01     9.3494E-07     9.3494E-07    -1.3737E-09
    5        -1.368685175946E+01     3.8980E-07     3.8980E-07    -4.5947E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36868517594560E+01  Eh
     Estimated bandgap           =   2.2545E-01  Eh
     RMS occupancy error         =   7.4158E-17
     [H,K] commutator            =   3.8980E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.5166E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36868658741925E+01 Eh
   Predicted gain in energy  =      -1.41147364818295E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368686426227E+01     2.0752E-04     2.0752E-04
    2        -1.368686607718E+01     5.9238E-05     5.9238E-05    -1.8149E-06
    3        -1.368686626295E+01     4.6498E-06     4.6498E-06    -1.8577E-07
    4        -1.368686626396E+01     8.9979E-07     8.9979E-07    -1.0033E-09
    5        -1.368686626400E+01     2.8959E-07     2.8959E-07    -4.0560E-11
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36868662639964E+01  Eh
     Estimated bandgap           =   2.2560E-01  Eh
     RMS occupancy error         =   4.9549E-17
     [H,K] commutator            =   2.8959E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.6429E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36868692953326E+01 Eh
   Predicted gain in energy  =      -3.03133613144269E-06 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368686910946E+01     7.3624E-05     7.3624E-05
    2        -1.368686933590E+01     2.0603E-05     2.0603E-05    -2.2644E-07
    3        -1.368686935859E+01     1.6883E-06     1.6883E-06    -2.2693E-08
    4        -1.368686935872E+01     3.3490E-07     3.3490E-07    -1.3219E-10
    5        -1.368686935873E+01     1.2881E-07     1.2881E-07    -5.9046E-12
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36868693587263E+01  Eh
     Estimated bandgap           =   2.2555E-01  Eh
     RMS occupancy error         =   1.4223E-16
     [H,K] commutator            =   1.2881E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7371E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36868695840130E+01 Eh
   Predicted gain in energy  =      -2.25286697741467E-07 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368686957121E+01     1.9035E-05     1.9035E-05
    2        -1.368686958629E+01     5.2803E-06     5.2803E-06    -1.5075E-08
    3        -1.368686958778E+01     4.5412E-07     4.5412E-07    -1.4964E-09
    4        -1.368686958779E+01     1.0488E-07     1.0488E-07    -9.4964E-12
    5        -1.368686958779E+01     2.2994E-07     2.2994E-07     9.5390E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36868695877921E+01  Eh
     Estimated bandgap           =   2.2553E-01  Eh
     RMS occupancy error         =   7.8950E-17
     [H,K] commutator            =   2.2994E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0785E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36868696579075E+01 Eh
   Predicted gain in energy  =      -7.01154156956818E-08 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368686965340E+01     1.1295E-05     1.1295E-05
    2        -1.368686965871E+01     3.1456E-06     3.1456E-06    -5.3141E-09
    3        -1.368686965924E+01     2.8997E-07     2.8997E-07    -5.3029E-10
    4        -1.368686965924E+01     9.3618E-08     9.3618E-08    -3.0660E-12
    5        -1.368686965924E+01     3.3555E-08     3.3555E-08    -5.9508E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36868696592447E+01  Eh
     Estimated bandgap           =   2.2554E-01  Eh
     RMS occupancy error         =   1.0490E-16
     [H,K] commutator            =   3.3555E-08
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0673E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36868696749466E+01 Eh
   Predicted gain in energy  =      -1.57019499624766E-08 Eh
  ========================================================================

Writing NGWFs to file "ethene_relax_lbfgs.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.368686967398E+01     5.2216E-06     5.2216E-06
    2        -1.368686967512E+01     1.4501E-06     1.4501E-06    -1.1349E-09
    3        -1.368686967523E+01     1.2084E-07     1.2084E-07    -1.1249E-10
    4        -1.368686967523E+01     2.8760E-08     2.8760E-08    -1.0907E-12
    5        -1.368686967523E+01     2.4473E-08     2.4473E-08     3.7303E-13
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_relax_lbfgs.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36868696752322E+01  Eh
     Estimated bandgap           =   2.2554E-01  Eh
     RMS occupancy error         =   8.4155E-17
     [H,K] commutator            =   2.4473E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000189609004              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       10.24815619216350 |
           | Pseudopotential (local)    :      -59.61285631634508 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.52989662533022 |
           | Hartree                    :       24.46689461424541 |
           | Exchange-correlation       :       -4.75368969417609 |
           | Ewald                      :       14.43472890354980 |
           | Total                      :      -13.68686967523223 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999999
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00056335968362    -13.68405459808476   0.394737    -13.68674941790102        
   1     0.00010989328593    -13.68675745302282   0.362806    -13.68685194394972        
   2     0.00003516620012    -13.68685175945599   0.530605    -13.68686587419248        
   3     0.00004642886786    -13.68686626399644   0.067210    -13.68686929533257        
   4     0.00001737063348    -13.68686935872630   0.034014    -13.68686958401300        
   5     0.00001078454688    -13.68686958779205   0.028026    -13.68686965790747        
   6     0.00001067260592    -13.68686965924466   0.006533    -13.68686967494661        
   7     0.00000189609004    -13.68686967523224  <-- CG                                 
 
<QC>        [NGWF iterations]:                      8
<QC>           [total_energy]:       -13.686869675232
<QC>           [rms_gradient]:         0.000001896090

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    C       1     -0.00459825   0.00437366  -0.00189659 *
*    H       2      0.00027649  -0.00088224  -0.00103479 *
*    H       3     -0.00183510   0.00155043   0.00124902 *
*    C       4      0.00461884  -0.00440382   0.00192094 *
*    H       5      0.00182631  -0.00155931  -0.00125892 *
*    H       6     -0.00028830   0.00092128   0.00102034 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000  -0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.004598246183
<QC>       [total_force(1,2)]:         0.000276489252
<QC>       [total_force(1,3)]:        -0.001835095625
<QC>       [total_force(1,4)]:         0.004618843538
<QC>       [total_force(1,5)]:         0.001826306396
<QC>       [total_force(1,6)]:        -0.000288297378
<QC>       [total_force(2,1)]:         0.004373657187
<QC>       [total_force(2,2)]:        -0.000882235007
<QC>       [total_force(2,3)]:         0.001550429029
<QC>       [total_force(2,4)]:        -0.004403817909
<QC>       [total_force(2,5)]:        -0.001559312919
<QC>       [total_force(2,6)]:         0.000921279618
<QC>       [total_force(3,1)]:        -0.001896591492
<QC>       [total_force(3,2)]:        -0.001034790593
<QC>       [total_force(3,3)]:         0.001249021784
<QC>       [total_force(3,4)]:         0.001920942587
<QC>       [total_force(3,5)]:        -0.001258919912
<QC>       [total_force(3,6)]:         0.001020337626
  
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |    Step    |   lambda    |   F.delta   |    enthalpy     | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
 |  previous  |    0.000000 |    0.004537 |      -13.684565 | <-- min LBFGS
 | trial step |    1.000000 |   -0.000128 |      -13.686870 | <-- min LBFGS
 +------------+-------------+-------------+-----------------+ <-- min LBFGS
  
 LBFGS: finished iteration   4  with enthalpy= -1.368686967523E+001 Ha
  
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 | Parameter |      value      |    tolerance    |    units   | OK? | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
 |  dE/ion   |   3.841840E-004 |   1.000000E-006 |         Ha | No  | <-- LBFGS
 |  |F|max   |   6.664634E-003 |   2.000000E-003 |    Ha/Bohr | No  | <-- LBFGS
 |  |dR|max  |   3.640755E-002 |   5.000000E-003 |       Bohr | No  | <-- LBFGS
 +-----------+-----------------+-----------------+------------+-----+ <-- LBFGS
  
 LBFGS: Geometry optimization failed to converge after            4  steps

================================================================================
 LBFGS: Final Configuration:
================================================================================
 
                           -------------------------------
                                     Cell Contents
                           -------------------------------
 
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
            x  Element    Atom      Absolute co-ordinates of atoms     x
            x            Number        x           y           z       x
            x----------------------------------------------------------x
            x    C         1       21.236398   19.941381   20.051515   x
            x    H         2       22.327395   21.370726   21.088089   x
            x    H         3       22.311127   18.447299   19.089071   x
            x    C         4       18.763416   20.058147   19.948330   x
            x    H         5       17.688849   21.552361   20.910762   x
            x    H         6       17.672815   18.628087   18.912233   x
            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
 
 LBFGS: Final Enthalpy     = -1.36868697E+001 Ha

 Writing continuation file "ethene_relax_lbfgs.continuation" ...done

 Removing NGWF backup file "ethene_relax_lbfgs.tightbox_ngwfs.bfgs_back" ... done
 Removing density kernel backup file "ethene_relax_lbfgs.dkn.bfgs_back" ... done

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     132.952s on      4 proc(s)                                    
TOTAL TIME:       132.953s on      4 proc(s)                                    

Job completed: 21-09-2022 10:35 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
