==================================================================================
It's Wed Sep 21 10:25:14 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 1519 1520 1521 1522)...
    - ONETEP arguments: ethene_phonon.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test32
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test32/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test32/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack ethene_phonon.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 10:25 (+0100)
 
Reading parameters from file "ethene_phonon.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 10
   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "ethene_phonon.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task                   : phonon                                                 
phonon_farming_task    : 0                                                      
phonon_finite_disp     : 0.10 bohr                                              
phonon_fmax            : 0.01 'ha/bohr'                                         
cutoff_energy          : 400 eV                                                 
ngwf_threshold_orig    : 2.0e-5                                                 
maxit_pen              : 3                                                      
lnv_threshold_orig     : 1.0e-6                                                 
print_qc               : T                                                      
%block  lattice_cart                                                            
40.000    0.000    0.000                                                        
0.000   40.000    0.000                                                         
0.000    0.000   40.000                                                         
%endblock  lattice_cart                                                         
%block  positions_abs                                                           
     Hash =  -000006640039762633695957
%endblock  positions_abs                                                        
%block  species                                                                 
H H 1 1 5.50                                                                    
C C 6 4 6.00                                                                    
%endblock  species                                                              
%block  species_pot                                                             
H "../../pseudo/hydrogen.recpot"                                                
C "../../pseudo/carbon.recpot"                                                  
%endblock  species_pot                                                          

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
WARNING in pseudopotentials_read_species: string "GGA" found in pseudopotential
file "../../pseudo/carbon.recpot", yet xc_functional = "LDA".
 
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          2         8         2
  H          4         4         0
.......   ......    ......    ......
Totals:      6        12         2
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   56 x  56 x  56
                              FFT-box:   55 x  55 x  55
                                  PPD:    7 x   7 x   1
Grid space d1=  0.714285714286a0 (KE cutoff=  14.88881Eh = 405.14521eV)
Grid space d2=  0.714285714286a0 (KE cutoff=  14.88881Eh = 405.14521eV)
Grid space d3=  0.714285714286a0 (KE cutoff=  14.88881Eh = 405.14521eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     56    56    56
          Real-space ('12') slabs/proc (min max mean):     14    14    14
         Recip-space ('23') slabs/proc (min max mean):      7     8     7
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    112   112   112
          Real-space ('12') slabs/proc (min max mean):     28    28    28
         Recip-space ('23') slabs/proc (min max mean):     14    15    14
********************************************************************************

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Atom SCF converged after  39 iterations to a total energy of     -0.41130009

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  37 iterations to a total energy of     -5.30501233

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Starting phonon calculation...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Number of force constants:   18

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.122114 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done
NGWF initialisation ...... done
Up spin density kernel initialisation ...... done

Writing density kernel to file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.33612813066673 0.23035598809 0.00746677849 0.0297  0.000   12.00000000
 2    -13.56286218034180 0.17039189183 0.00694831801 0.6080 -0.739   12.00000000
WARNING: internal_polak_cg_coeff =  5.17413
WARNING: setting internal_polak_cg_coeff to zero
 3    -13.56466363494611 0.17069317320 0.00546687871 0.0691  0.000   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -13.954746613756
   Final penalty energy   :       0.234319663682
   RMS occupancy error    :       0.069869
   Occupancy bounds       : [-0.108, 1.101]
================================================================================

Finished density kernel iterations (   3)

Writing density kernel to file "ethene_phonon.dkn" ... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.333723544270E+01     4.0726E-03     4.0726E-03
    2        -1.333770999104E+01     4.4490E-04     4.4490E-04    -4.7455E-04
    3        -1.333771906289E+01     7.1523E-05     7.1523E-05    -9.0718E-06
    4        -1.333771928386E+01     1.4152E-05     1.4152E-05    -2.2097E-07
    5        -1.333771929393E+01     8.2166E-06     8.2166E-06    -1.0071E-08
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.33377192939283E+01  Eh
     Estimated bandgap           =   2.2453E-01  Eh
     RMS occupancy error         =   2.9348E-16
     [H,K] commutator            =   8.2166E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.2732E-03 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35588409247879E+01 Eh
   Predicted gain in energy  =      -2.21121630859564E-01 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.355854865378E+01     3.1989E-03     3.1989E-03
    2        -1.355886879564E+01     6.2725E-04     6.2725E-04    -3.2014E-04
    3        -1.355888631357E+01     1.3912E-04     1.3912E-04    -1.7518E-05
    4        -1.355888736864E+01     5.6663E-05     5.6663E-05    -1.0551E-06
    5        -1.355888751528E+01     1.8264E-05     1.8264E-05    -1.4664E-07
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35588875152809E+01  Eh
     Estimated bandgap           =   2.3303E-01  Eh
     RMS occupancy error         =   7.6441E-14
     [H,K] commutator            =   1.8264E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4727E-03 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35871754687410E+01 Eh
   Predicted gain in energy  =      -2.82879534601665E-02 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.358723467101E+01     2.2856E-03     2.2856E-03
    2        -1.358741038629E+01     5.5168E-04     5.5168E-04    -1.7572E-04
    3        -1.358742354645E+01     9.5587E-05     9.5587E-05    -1.3160E-05
    4        -1.358742397417E+01     1.2656E-05     1.2656E-05    -4.2772E-07
    5        -1.358742398117E+01     3.9520E-06     3.9520E-06    -7.0048E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35874239811722E+01  Eh
     Estimated bandgap           =   2.3081E-01  Eh
     RMS occupancy error         =   2.5548E-16
     [H,K] commutator            =   3.9520E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1562E-03 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35963484640959E+01 Eh
   Predicted gain in energy  =      -8.92448292372627E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359633280474E+01     7.2737E-04     7.2737E-04
    2        -1.359635752178E+01     1.0861E-04     1.0861E-04    -2.4717E-05
    3        -1.359635807461E+01     3.0352E-05     3.0352E-05    -5.5283E-07
    4        -1.359635810966E+01     6.3723E-06     6.3723E-06    -3.5042E-08
    5        -1.359635811173E+01     1.3338E-06     1.3338E-06    -2.0778E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35963581117333E+01  Eh
     Estimated bandgap           =   2.2695E-01  Eh
     RMS occupancy error         =   1.3716E-16
     [H,K] commutator            =   1.3338E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.0489E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36003240138021E+01 Eh
   Predicted gain in energy  =      -3.96590206873881E-03 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360030722588E+01     9.4213E-04     9.4213E-04
    2        -1.360033848696E+01     2.2863E-04     2.2863E-04    -3.1261E-05
    3        -1.360034115682E+01     2.3400E-05     2.3400E-05    -2.6699E-06
    4        -1.360034118113E+01     6.2325E-06     6.2325E-06    -2.4303E-08
    5        -1.360034118308E+01     2.0640E-06     2.0640E-06    -1.9542E-09
Finished density kernel iterations (   5)

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36003411830811E+01  Eh
     Estimated bandgap           =   2.2363E-01  Eh
     RMS occupancy error         =   9.3861E-17
     [H,K] commutator            =   2.0640E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3884E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011813069499E+01 Eh
   Predicted gain in energy  =      -8.40123868796283E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360118127467E+01     3.2735E-04     3.2735E-04
    2        -1.360118526213E+01     8.8472E-05     8.8472E-05    -3.9875E-06
    3        -1.360118564134E+01     9.3290E-06     9.3290E-06    -3.7921E-07
    4        -1.360118564527E+01     1.1773E-06     1.1773E-06    -3.9233E-09
    5        -1.360118564533E+01      4.297E-07      4.297E-07     -6.637E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000042974797      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011856453334E+01  Eh
     Estimated bandgap           =   2.2191E-01  Eh
     RMS occupancy error         =   8.4924E-17
     [H,K] commutator            =   4.2975E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5260E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36015754981146E+01 Eh
   Predicted gain in energy  =      -3.89852781221833E-04 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360157496215E+01     4.3216E-04     4.3216E-04
    2        -1.360158204794E+01     1.1719E-04     1.1719E-04    -7.0858E-06
    3        -1.360158272082E+01     1.0428E-05     1.0428E-05    -6.7288E-07
    4        -1.360158272604E+01     1.4508E-06     1.4508E-06    -5.2176E-09
    5        -1.360158272614E+01      4.873E-07      4.873E-07     -1.074E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000048727152      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36015827261447E+01  Eh
     Estimated bandgap           =   2.1919E-01  Eh
     RMS occupancy error         =   9.1511E-17
     [H,K] commutator            =   4.8727E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4258E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36016688781366E+01 Eh
   Predicted gain in energy  =      -8.61519918498033E-05 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360166864089E+01     1.8616E-04     1.8616E-04
    2        -1.360167018144E+01     5.7301E-05     5.7301E-05    -1.5405E-06
    3        -1.360167031994E+01     5.0479E-06     5.0479E-06    -1.3850E-07
    4        -1.360167032143E+01      7.877E-07      7.877E-07     -1.493E-09

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000078765920      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36016703214302E+01  Eh
     Estimated bandgap           =   2.1760E-01  Eh
     RMS occupancy error         =   1.1200E-16
     [H,K] commutator            =   7.8766E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0016E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36016718216661E+01 Eh
   Predicted gain in energy  =      -1.50023589817749E-06 Eh
  ========================================================================

Writing NGWFs to file "ethene_phonon.tightbox_ngwfs"....  done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360167181174E+01     2.3323E-05     2.3323E-05
    2        -1.360167183921E+01     5.9020E-06     5.9020E-06    -2.7476E-08
    3        -1.360167184052E+01      8.511E-07      8.511E-07     -1.307E-09

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000085112401      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Writing density kernel to file "ethene_phonon.dkn" ... done


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36016718405190E+01  Eh
     Estimated bandgap           =   2.1738E-01  Eh
     RMS occupancy error         =   1.0415E-16
     [H,K] commutator            =   8.5112E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000553495257              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.86460360464204 |
           | Pseudopotential (local)    :      -58.54502459517918 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56416515145027 |
           | Hartree                    :       24.10225961107598 |
           | Exchange-correlation       :       -4.70978918331783 |
           | Ewald                      :       14.12211357080968 |
           | Total                      :      -13.60167184051904 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00727324018634    -13.33771929392829   0.303878    -13.55884092478786        
   1     0.00247270858670    -13.55888751528086   0.336005    -13.58717546874103        
   2     0.00115621002105    -13.58742398117221   0.480375    -13.59634846409594        
   3     0.00080488772174    -13.59635811173334   0.445182    -13.60032401380208        
   4     0.00043883549439    -13.60034118308114   0.317149    -13.60118130694993        
   5     0.00025260055325    -13.60118564533338   0.442014    -13.60157549811461        
   6     0.00014257780375    -13.60158272614470   0.302755    -13.60166887813655        
   7     0.00004001628567    -13.60167032143021   0.066997    -13.60167182166611        
   8     0.00000553495257    -13.60167184051904  <-- CG                                 
 
<QC>        [NGWF iterations]:                      9
<QC>           [total_energy]:       -13.601671840519
<QC>           [rms_gradient]:         0.000005534953
<QC>       [total_force(1,1)]:        -0.002085345511
<QC>       [total_force(1,2)]:        -0.000131897633
<QC>       [total_force(1,3)]:         0.001367059579
<QC>       [total_force(1,4)]:         0.002007155656
<QC>       [total_force(1,5)]:        -0.001071195960
<QC>       [total_force(1,6)]:        -0.000085776130
<QC>       [total_force(2,1)]:         0.001790636224
<QC>       [total_force(2,2)]:         0.000309246297
<QC>       [total_force(2,3)]:        -0.001240181994
<QC>       [total_force(2,4)]:        -0.001098396588
<QC>       [total_force(2,5)]:         0.000856677572
<QC>       [total_force(2,6)]:        -0.000617981511
<QC>       [total_force(3,1)]:         0.001095583220
<QC>       [total_force(3,2)]:         0.000859103773
<QC>       [total_force(3,3)]:        -0.001153377352
<QC>       [total_force(3,4)]:        -0.000615097051
<QC>       [total_force(3,5)]:         0.000909160066
<QC>       [total_force(3,6)]:        -0.001095372655
Phonon calculation: read_denskern parameter over-ridden to TRUE
Phonon calculation: read_tightbox_ngwfs parameter over-ridden to TRUE
Phonon calculation: write_denskern parameter over-ridden to FALSE
Phonon calculation: write_tightbox_ngwfs parameter over-ridden to FALSE

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    1 of   18 :
  displacing atom    1 in the +ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               13.938100 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.58421978703857 0.19364740503 0.00335067696 0.0356  0.000   12.00000000
 2    -13.77123109399365 0.13390477211 0.00248327304 0.5345 -0.691   12.00000000
 3    -13.77088542046745 0.13400931145 0.00270594880 0.0774  2.971   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.051414055270
   Final penalty energy   :       0.187774637299
   RMS occupancy error    :       0.062546
   Occupancy bounds       : [-0.087, 1.096]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359181296928E+01     2.8318E-03     2.8318E-03
    2        -1.359209330478E+01     6.2699E-04     6.2699E-04    -2.8034E-04
    3        -1.359211416635E+01     2.0496E-04     2.0496E-04    -2.0862E-05
    4        -1.359211542197E+01     6.3300E-05     6.3300E-05    -1.2556E-06
    5        -1.359211566508E+01     1.8902E-05     1.8902E-05    -2.4312E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35921156650827E+01  Eh
     Estimated bandgap           =   1.9684E-01  Eh
     RMS occupancy error         =   1.6307E-13
     [H,K] commutator            =   1.8902E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1424E-03 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35964672866445E+01 Eh
   Predicted gain in energy  =      -4.35162156181335E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359646760378E+01     7.8348E-04     7.8348E-04
    2        -1.359649011817E+01     1.4662E-04     1.4662E-04    -2.2514E-05
    3        -1.359649116928E+01     4.6846E-05     4.6846E-05    -1.0511E-06
    4        -1.359649124528E+01     1.6698E-05     1.6698E-05    -7.5998E-08
    5        -1.359649125693E+01     5.8258E-06     5.8258E-06    -1.1650E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35964912569264E+01  Eh
     Estimated bandgap           =   1.9769E-01  Eh
     RMS occupancy error         =   3.6391E-16
     [H,K] commutator            =   5.8258E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2703E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967074030848E+01 Eh
   Predicted gain in energy  =      -2.16146158404484E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359670711605E+01     3.7655E-04     3.7655E-04
    2        -1.359671112522E+01     7.7149E-05     7.7149E-05    -4.0092E-06
    3        -1.359671139216E+01     3.4402E-05     3.4402E-05    -2.6694E-07
    4        -1.359671144217E+01     9.2906E-06     9.2906E-06    -5.0003E-08
    5        -1.359671144632E+01     3.9845E-06     3.9845E-06    -4.1494E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967114463166E+01  Eh
     Estimated bandgap           =   1.9725E-01  Eh
     RMS occupancy error         =   9.0196E-17
     [H,K] commutator            =   3.9845E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.6870E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967374428457E+01 Eh
   Predicted gain in energy  =      -2.59965290219100E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359673679420E+01     1.8888E-04     1.8888E-04
    2        -1.359673831243E+01     6.1308E-05     6.1308E-05    -1.5182E-06
    3        -1.359673842959E+01     1.9672E-05     1.9672E-05    -1.1716E-07
    4        -1.359673844128E+01     3.9959E-06     3.9959E-06    -1.1690E-08
    5        -1.359673844227E+01     1.7879E-06     1.7879E-06    -9.9410E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967384422739E+01  Eh
     Estimated bandgap           =   1.9673E-01  Eh
     RMS occupancy error         =   1.4163E-16
     [H,K] commutator            =   1.7879E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7117E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967411806176E+01 Eh
   Predicted gain in energy  =      -2.73834373487603E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359674109572E+01     6.8685E-05     6.8685E-05
    2        -1.359674126198E+01     1.4113E-05     1.4113E-05    -1.6626E-07
    3        -1.359674127100E+01     5.0698E-06     5.0698E-06    -9.0156E-09
    4        -1.359674127177E+01     1.0300E-06     1.0300E-06    -7.7159E-10
    5        -1.359674127184E+01      2.685E-07      2.685E-07     -6.820E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000026853137      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967412718388E+01  Eh
     Estimated bandgap           =   1.9699E-01  Eh
     RMS occupancy error         =   8.8798E-17
     [H,K] commutator            =   2.6853E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0214E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967415940477E+01 Eh
   Predicted gain in energy  =      -3.22208860481510E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359674159343E+01     2.1258E-05     2.1258E-05
    2        -1.359674160949E+01     4.4647E-06     4.4647E-06    -1.6063E-08
    3        -1.359674161041E+01     1.5584E-06     1.5584E-06    -9.2276E-10
    4        -1.359674161048E+01      3.472E-07      3.472E-07     -7.261E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000034716036      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967416104841E+01  Eh
     Estimated bandgap           =   1.9691E-01  Eh
     RMS occupancy error         =   1.3178E-16
     [H,K] commutator            =   3.4716E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000613596403              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.82166936518229 |
           | Pseudopotential (local)    :      -58.13656203027836 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.55598115959602 |
           | Hartree                    :       23.92251141036803 |
           | Exchange-correlation       :       -4.69844193544385 |
           | Ewald                      :       13.93810042009178 |
           | Total                      :      -13.59674161048409 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000002
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00114237428177    -13.59211566508270   0.242414    -13.59646728664451        
   1     0.00022702610621    -13.59649125692638   0.303205    -13.59670740308479        
   2     0.00008686960157    -13.59671144631663   0.245074    -13.59673744284565        
   3     0.00003711670210    -13.59673844227386   0.144502    -13.59674118061759        
   4     0.00003021359141    -13.59674127183883   0.026540    -13.59674159404769        
   5     0.00000613596403    -13.59674161048408  <-- CG                                 
 
<QC>        [NGWF iterations]:                      6
<QC>           [total_energy]:       -13.596741610484
<QC>           [rms_gradient]:         0.000006135964
<QC>       [total_force(1,1)]:        -0.093399912400
<QC>       [total_force(1,2)]:         0.011757299207
<QC>       [total_force(1,3)]:         0.013611964042
<QC>       [total_force(1,4)]:         0.065624119405
<QC>       [total_force(1,5)]:         0.000716606807
<QC>       [total_force(1,6)]:         0.001689922940
<QC>       [total_force(2,1)]:         0.004500236733
<QC>       [total_force(2,2)]:         0.010244675386
<QC>       [total_force(2,3)]:        -0.012055077694
<QC>       [total_force(2,4)]:        -0.002697950230
<QC>       [total_force(2,5)]:         0.000925829887
<QC>       [total_force(2,6)]:        -0.000917714082
<QC>       [total_force(3,1)]:        -0.001961619870
<QC>       [total_force(3,2)]:         0.008552746737
<QC>       [total_force(3,3)]:        -0.008498036248
<QC>       [total_force(3,4)]:         0.001859788533
<QC>       [total_force(3,5)]:         0.001152760897
<QC>       [total_force(3,6)]:        -0.001105640048

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    1 of   18 :
  displacing atom    1 in the -ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.325114 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59921159345986 0.19583651676 0.00351006628 0.0354  0.000   12.00000000
 2    -13.79399970026186 0.13482986628 0.00428962162 0.3764 -0.686   12.00000000
 3    -13.79320990190657 0.13509850898 0.00252908386 0.0800  2.307   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.097490542885
   Final penalty energy   :       0.213791445316
   RMS occupancy error    :       0.066738
   Occupancy bounds       : [-0.101, 1.099]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359135689245E+01     2.5358E-03     2.5358E-03
    2        -1.359161988838E+01     8.5469E-04     8.5469E-04    -2.6300E-04
    3        -1.359164989631E+01     3.0084E-04     3.0084E-04    -3.0008E-05
    4        -1.359165264983E+01     7.3110E-05     7.3110E-05    -2.7535E-06
    5        -1.359165290859E+01     1.9875E-05     1.9875E-05    -2.5875E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35916529085860E+01  Eh
     Estimated bandgap           =   2.4017E-01  Eh
     RMS occupancy error         =   2.3066E-13
     [H,K] commutator            =   1.9875E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1638E-03 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35961858345793E+01 Eh
   Predicted gain in energy  =      -4.53292599328137E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359618760052E+01     7.5572E-04     7.5572E-04
    2        -1.359620892477E+01     1.8647E-04     1.8647E-04    -2.1324E-05
    3        -1.359621027427E+01     6.6498E-05     6.6498E-05    -1.3495E-06
    4        -1.359621041829E+01     1.5715E-05     1.5715E-05    -1.4402E-07
    5        -1.359621042915E+01     2.2971E-06     2.2971E-06    -1.0865E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35962104291549E+01  Eh
     Estimated bandgap           =   2.3792E-01  Eh
     RMS occupancy error         =   3.0518E-16
     [H,K] commutator            =   2.2971E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1898E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35963976568194E+01 Eh
   Predicted gain in energy  =      -1.87227664575573E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359639743608E+01     3.0944E-04     3.0944E-04
    2        -1.359640070466E+01     7.8353E-05     7.8353E-05    -3.2686E-06
    3        -1.359640093921E+01     3.0091E-05     3.0091E-05    -2.3455E-07
    4        -1.359640097174E+01     6.7064E-06     6.7064E-06    -3.2526E-08
    5        -1.359640097433E+01     1.6582E-06     1.6582E-06    -2.5927E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35964009743331E+01  Eh
     Estimated bandgap           =   2.3673E-01  Eh
     RMS occupancy error         =   8.7732E-17
     [H,K] commutator            =   1.6582E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4787E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35964032734569E+01 Eh
   Predicted gain in energy  =      -2.29912373050922E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359640320326E+01     3.3730E-05     3.3730E-05
    2        -1.359640324674E+01     1.2476E-05     1.2476E-05    -4.3483E-08
    3        -1.359640325235E+01     3.6355E-06     3.6355E-06    -5.6097E-09
    4        -1.359640325285E+01      9.861E-07      9.861E-07     -4.962E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000098614910      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35964032528493E+01  Eh
     Estimated bandgap           =   2.3647E-01  Eh
     RMS occupancy error         =   7.1621E-17
     [H,K] commutator            =   9.8615E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8288E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35964038089249E+01 Eh
   Predicted gain in energy  =      -5.56075516300325E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359640380104E+01     1.7272E-05     1.7272E-05
    2        -1.359640381313E+01     6.8203E-06     6.8203E-06    -1.2085E-08
    3        -1.359640381468E+01     1.5150E-06     1.5150E-06    -1.5489E-09
    4        -1.359640381476E+01      3.703E-07      3.703E-07     -8.449E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000037029225      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35964038147595E+01  Eh
     Estimated bandgap           =   2.3662E-01  Eh
     RMS occupancy error         =   4.6261E-17
     [H,K] commutator            =   3.7029E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0082E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35964038676913E+01 Eh
   Predicted gain in energy  =      -5.29317194519763E-08 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359640386704E+01     5.0768E-06     5.0768E-06
    2        -1.359640386807E+01     1.9744E-06     1.9744E-06    -1.0282E-09
    3        -1.359640386820E+01      4.510E-07      4.510E-07     -1.312E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000045098394      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35964038682019E+01  Eh
     Estimated bandgap           =   2.3658E-01  Eh
     RMS occupancy error         =   8.4426E-17
     [H,K] commutator            =   4.5098E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000284132472              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.91180309161802 |
           | Pseudopotential (local)    :      -58.96733400153793 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.57946949725556 |
           | Hartree                    :       24.27568862052851 |
           | Exchange-correlation       :       -4.72114531062190 |
           | Ewald                      :       14.32511423455589 |
           | Total                      :      -13.59640386820185 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999999
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00116375108224    -13.59165290858599   0.243322    -13.59618583457928        
   1     0.00021897629056    -13.59621042915487   0.282329    -13.59639765681944        
   2     0.00004478671536    -13.59640097433314   0.081862    -13.59640327345687        
   3     0.00002828778299    -13.59640325284935   0.050520    -13.59640380892486        
   4     0.00002008173822    -13.59640381475953   0.009641    -13.59640386769125        
   5     0.00000284132472    -13.59640386820185  <-- CG                                 
 
<QC>        [NGWF iterations]:                      6
<QC>           [total_energy]:       -13.596403868202
<QC>           [rms_gradient]:         0.000002841325
<QC>       [total_force(1,1)]:         0.107912871505
<QC>       [total_force(1,2)]:        -0.013006457305
<QC>       [total_force(1,3)]:        -0.011793901036
<QC>       [total_force(1,4)]:        -0.076174695815
<QC>       [total_force(1,5)]:        -0.003969847575
<QC>       [total_force(1,6)]:        -0.002967969775
<QC>       [total_force(2,1)]:        -0.001661342156
<QC>       [total_force(2,2)]:        -0.008426947791
<QC>       [total_force(2,3)]:         0.008209665894
<QC>       [total_force(2,4)]:         0.001487890514
<QC>       [total_force(2,5)]:         0.000633463947
<QC>       [total_force(2,6)]:        -0.000242730408
<QC>       [total_force(3,1)]:         0.005490456887
<QC>       [total_force(3,2)]:        -0.005784617679
<QC>       [total_force(3,3)]:         0.005339706495
<QC>       [total_force(3,4)]:        -0.004543677264
<QC>       [total_force(3,5)]:         0.000525986922
<QC>       [total_force(3,6)]:        -0.001027855361

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    2 of   18 :
  displacing atom    1 in the +ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.123992 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59585335428204 0.19421078713 0.00315469369 0.0356  0.000   12.00000000
 2    -13.78687193473952 0.13375159852 0.00334055827 0.4260 -0.687   12.00000000
 3    -13.78664060007379 0.13395083395 0.00239364765 0.0794  2.630   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.080321130235
   Final penalty energy   :       0.202359779989
   RMS occupancy error    :       0.064929
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359627960164E+01     2.5813E-03     2.5813E-03
    2        -1.359653354110E+01     6.6268E-04     6.6268E-04    -2.5394E-04
    3        -1.359655570546E+01     1.5411E-04     1.5411E-04    -2.2164E-05
    4        -1.359655736070E+01     4.9489E-05     4.9489E-05    -1.6552E-06
    5        -1.359655706792E+01     3.4872E-05     3.4872E-05     2.9278E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35965570679211E+01  Eh
     Estimated bandgap           =   2.1729E-01  Eh
     RMS occupancy error         =   4.9355E-15
     [H,K] commutator            =   3.4872E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.4276E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35996021048924E+01 Eh
   Predicted gain in energy  =      -3.04503697136127E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359959799388E+01     5.0991E-04     5.0991E-04
    2        -1.359960806494E+01     1.0023E-04     1.0023E-04    -1.0071E-05
    3        -1.359960858239E+01     3.3692E-05     3.3692E-05    -5.1744E-07
    4        -1.359960862757E+01     1.6928E-05     1.6928E-05    -4.5184E-08
    5        -1.359960864035E+01     5.0078E-06     5.0078E-06    -1.2776E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35996086403484E+01  Eh
     Estimated bandgap           =   2.1660E-01  Eh
     RMS occupancy error         =   7.7946E-16
     [H,K] commutator            =   5.0078E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9433E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35997579706775E+01 Eh
   Predicted gain in energy  =      -1.49330329167086E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359975752380E+01     1.6867E-04     1.6867E-04
    2        -1.359975884553E+01     3.6479E-05     3.6479E-05    -1.3217E-06
    3        -1.359975890381E+01     8.8840E-06     8.8840E-06    -5.8281E-08
    4        -1.359975890791E+01     3.6635E-06     3.6635E-06    -4.1034E-09
    5        -1.359975890842E+01     1.4617E-06     1.4617E-06    -5.0814E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35997589084217E+01  Eh
     Estimated bandgap           =   2.1580E-01  Eh
     RMS occupancy error         =   1.7957E-16
     [H,K] commutator            =   1.4617E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4413E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35997615698803E+01 Eh
   Predicted gain in energy  =      -2.66145868543788E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359976147114E+01     3.6331E-05     3.6331E-05
    2        -1.359976152992E+01     9.5397E-06     9.5397E-06    -5.8780E-08
    3        -1.359976153366E+01     1.5931E-06     1.5931E-06    -3.7404E-09
    4        -1.359976153380E+01      7.865E-07      7.865E-07     -1.407E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000078654133      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35997615338003E+01  Eh
     Estimated bandgap           =   2.1555E-01  Eh
     RMS occupancy error         =   8.6037E-17
     [H,K] commutator            =   7.8654E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7573E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35997621792433E+01 Eh
   Predicted gain in energy  =      -6.45443064328788E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359976216711E+01     2.0779E-05     2.0779E-05
    2        -1.359976218563E+01     5.5315E-06     5.5315E-06    -1.8526E-08
    3        -1.359976218691E+01      7.730E-07      7.730E-07     -1.276E-09

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000077297232      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35997621869094E+01  Eh
     Estimated bandgap           =   2.1569E-01  Eh
     RMS occupancy error         =   6.5343E-17
     [H,K] commutator            =   7.7297E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0475E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35997622624084E+01 Eh
   Predicted gain in energy  =      -7.54990239215658E-08 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359976225438E+01     7.0380E-06     7.0380E-06
    2        -1.359976225652E+01     1.8089E-06     1.8089E-06    -2.1338E-09
    3        -1.359976225665E+01      2.448E-07      2.448E-07     -1.319E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000024476292      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35997622566481E+01  Eh
     Estimated bandgap           =   2.1565E-01  Eh
     RMS occupancy error         =   1.0584E-16
     [H,K] commutator            =   2.4476E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000523905362              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.86542816378211 |
           | Pseudopotential (local)    :      -58.54200262573621 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56538191161699 |
           | Hartree                    :       24.09643446234040 |
           | Exchange-correlation       :       -4.70899629852365 |
           | Ewald                      :       14.12399212987220 |
           | Total                      :      -13.59976225664816 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00094275517284    -13.59655706792106   0.249068    -13.59960210489242        
   1     0.00019433194546    -13.59960864034837   0.286883    -13.59975797067754        
   2     0.00004441309702    -13.59975890842165   0.097926    -13.59976156988034        
   3     0.00002757336569    -13.59976153380025   0.061717    -13.59976217924332        
   4     0.00002047456234    -13.59976218690935   0.013251    -13.59976226240838        
   5     0.00000523905362    -13.59976225664815  <-- CG                                 
 
<QC>        [NGWF iterations]:                      6
<QC>           [total_energy]:       -13.599762256648
<QC>           [rms_gradient]:         0.000005239054
<QC>       [total_force(1,1)]:        -0.002657544941
<QC>       [total_force(1,2)]:         0.010034894713
<QC>       [total_force(1,3)]:        -0.007154252172
<QC>       [total_force(1,4)]:         0.000952314802
<QC>       [total_force(1,5)]:        -0.003299795395
<QC>       [total_force(1,6)]:         0.002124382994
<QC>       [total_force(2,1)]:        -0.040590436478
<QC>       [total_force(2,2)]:         0.017780071425
<QC>       [total_force(2,3)]:         0.015537026523
<QC>       [total_force(2,4)]:         0.009100831814
<QC>       [total_force(2,5)]:        -0.000258307325
<QC>       [total_force(2,6)]:        -0.001569185959
<QC>       [total_force(3,1)]:        -0.022889625098
<QC>       [total_force(3,2)]:         0.012605922904
<QC>       [total_force(3,3)]:         0.007983870400
<QC>       [total_force(3,4)]:         0.002401231884
<QC>       [total_force(3,5)]:         0.000824806768
<QC>       [total_force(3,6)]:        -0.000926206857

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    2 of   18 :
  displacing atom    1 in the -ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.114292 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59489118935595 0.19417707962 0.00315843165 0.0356  0.000   12.00000000
 2    -13.78575298975644 0.13372756682 0.00327959686 0.4309 -0.687   12.00000000
 3    -13.78554086615265 0.13392486560 0.00240506337 0.0793  2.670   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.078537784415
   Final penalty energy   :       0.201605626570
   RMS occupancy error    :       0.064808
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359583886491E+01     2.6070E-03     2.6070E-03
    2        -1.359609474483E+01     6.5607E-04     6.5607E-04    -2.5588E-04
    3        -1.359611758850E+01     1.6411E-04     1.6411E-04    -2.2844E-05
    4        -1.359611919698E+01     4.6327E-05     4.6327E-05    -1.6085E-06
    5        -1.359611928881E+01     2.0909E-05     2.0909E-05    -9.1830E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35961192888080E+01  Eh
     Estimated bandgap           =   2.1627E-01  Eh
     RMS occupancy error         =   3.4805E-14
     [H,K] commutator            =   2.0909E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.4373E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35991558800929E+01 Eh
   Predicted gain in energy  =      -3.03659128490708E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359915422201E+01     5.1219E-04     5.1219E-04
    2        -1.359916431961E+01     9.7011E-05     9.7011E-05    -1.0098E-05
    3        -1.359916480664E+01     3.1250E-05     3.1250E-05    -4.8702E-07
    4        -1.359916484744E+01     1.6111E-05     1.6111E-05    -4.0807E-08
    5        -1.359916485848E+01     4.9583E-06     4.9583E-06    -1.1036E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35991648584787E+01  Eh
     Estimated bandgap           =   2.1571E-01  Eh
     RMS occupancy error         =   5.5026E-16
     [H,K] commutator            =   4.9583E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9406E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35993125409445E+01 Eh
   Predicted gain in energy  =      -1.47682465811982E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359931175421E+01     1.7377E-04     1.7377E-04
    2        -1.359931312274E+01     4.0646E-05     4.0646E-05    -1.3685E-06
    3        -1.359931319185E+01     1.1593E-05     1.1593E-05    -6.9102E-08
    4        -1.359931319710E+01     5.2958E-06     5.2958E-06    -5.2517E-09
    5        -1.359931319831E+01     1.5969E-06     1.5969E-06    -1.2134E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35993131983116E+01  Eh
     Estimated bandgap           =   2.1494E-01  Eh
     RMS occupancy error         =   5.9607E-17
     [H,K] commutator            =   1.5969E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4784E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35993158946136E+01 Eh
   Predicted gain in energy  =      -2.69630195326442E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359931586145E+01     3.7788E-05     3.7788E-05
    2        -1.359931592416E+01     1.0033E-05     1.0033E-05    -6.2713E-08
    3        -1.359931592834E+01     1.7930E-06     1.7930E-06    -4.1748E-09
    4        -1.359931592849E+01      9.723E-07      9.723E-07     -1.540E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000097228921      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35993159284911E+01  Eh
     Estimated bandgap           =   2.1470E-01  Eh
     RMS occupancy error         =   1.0176E-16
     [H,K] commutator            =   9.7229E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6128E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35993164477449E+01 Eh
   Predicted gain in energy  =      -5.19253761765981E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359931643762E+01     1.9465E-05     1.9465E-05
    2        -1.359931645371E+01     5.2077E-06     5.2077E-06    -1.6087E-08
    3        -1.359931645483E+01      8.737E-07      8.737E-07     -1.122E-09

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000087374466      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35993164548337E+01  Eh
     Estimated bandgap           =   2.1483E-01  Eh
     RMS occupancy error         =   1.6518E-16
     [H,K] commutator            =   8.7374E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00001920086290              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.86380354726305 |
           | Pseudopotential (local)    :      -58.52126087945249 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56492976830405 |
           | Hartree                    :       24.08748622347715 |
           | Exchange-correlation       :       -4.70856741090333 |
           | Ewald                      :       14.11429229647783 |
           | Total                      :      -13.59931645483374 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00094373080488    -13.59611928880804   0.247864    -13.59915588009294        
   1     0.00019406201219    -13.59916485847871   0.284128    -13.59931254094453        
   2     0.00004478366876    -13.59931319831160   0.097524    -13.59931589461356        
   3     0.00002612828378    -13.59931592849114   0.055294    -13.59931644774490        
   4     0.00001920086290    -13.59931645483374  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.599316454834
<QC>           [rms_gradient]:         0.000019200863
<QC>       [total_force(1,1)]:        -0.008892265215
<QC>       [total_force(1,2)]:        -0.007928092407
<QC>       [total_force(1,3)]:         0.012672408392
<QC>       [total_force(1,4)]:         0.005186420693
<QC>       [total_force(1,5)]:         0.001196196574
<QC>       [total_force(1,6)]:        -0.002234668037
<QC>       [total_force(2,1)]:         0.045643147089
<QC>       [total_force(2,2)]:        -0.015665013246
<QC>       [total_force(2,3)]:        -0.020339858122
<QC>       [total_force(2,4)]:        -0.011461561915
<QC>       [total_force(2,5)]:         0.001471225545
<QC>       [total_force(2,6)]:         0.000352060648
<QC>       [total_force(3,1)]:         0.025134965301
<QC>       [total_force(3,2)]:        -0.008412319483
<QC>       [total_force(3,3)]:        -0.012823501484
<QC>       [total_force(3,4)]:        -0.003595788670
<QC>       [total_force(3,5)]:         0.000934612533
<QC>       [total_force(3,6)]:        -0.001237968198

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    3 of   18 :
  displacing atom    1 in the +ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.107041 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59568058468453 0.19394585594 0.00273055908 0.0357  0.000   12.00000000
 2    -13.78706917707661 0.13328471694 0.00302380639 0.4488 -0.686   12.00000000
 3    -13.78756593270612 0.13348623046 0.00217330601 0.0789  2.952   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.078676008212
   Final penalty energy   :       0.200534516882
   RMS occupancy error    :       0.064636
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359750385399E+01     2.6066E-03     2.6066E-03
    2        -1.359776036372E+01     7.0467E-04     7.0467E-04    -2.5651E-04
    3        -1.359778862141E+01     1.8131E-04     1.8131E-04    -2.8258E-05
    4        -1.359779083403E+01     4.0730E-05     4.0730E-05    -2.2126E-06
    5        -1.359779091512E+01     1.3405E-05     1.3405E-05    -8.1092E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35977909151248E+01  Eh
     Estimated bandgap           =   2.1588E-01  Eh
     RMS occupancy error         =   3.5114E-14
     [H,K] commutator            =   1.3405E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.6088E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36002898192976E+01 Eh
   Predicted gain in energy  =      -2.49890417279630E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360029138973E+01     3.8262E-04     3.8262E-04
    2        -1.360029721550E+01     8.5879E-05     8.5879E-05    -5.8258E-06
    3        -1.360029764647E+01     3.3608E-05     3.3608E-05    -4.3096E-07
    4        -1.360029769778E+01     1.7715E-05     1.7715E-05    -5.1313E-08
    5        -1.360029771011E+01     4.8355E-06     4.8355E-06    -1.2331E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002977101118E+01  Eh
     Estimated bandgap           =   2.1533E-01  Eh
     RMS occupancy error         =   1.0731E-15
     [H,K] commutator            =   4.8355E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7803E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36004166631140E+01 Eh
   Predicted gain in energy  =      -1.18953002187894E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360041732763E+01     1.4022E-04     1.4022E-04
    2        -1.360041822801E+01     3.4571E-05     3.4571E-05    -9.0038E-07
    3        -1.360041827976E+01     8.5767E-06     8.5767E-06    -5.1752E-08
    4        -1.360041828363E+01     4.1999E-06     4.1999E-06    -3.8623E-09
    5        -1.360041828430E+01     1.6135E-06     1.6135E-06    -6.6956E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004182842953E+01  Eh
     Estimated bandgap           =   2.1459E-01  Eh
     RMS occupancy error         =   1.4494E-16
     [H,K] commutator            =   1.6135E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4149E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36004185659262E+01 Eh
   Predicted gain in energy  =      -2.81630972764901E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360041856206E+01     1.2214E-05     1.2214E-05
    2        -1.360041856855E+01     3.3079E-06     3.3079E-06    -6.4943E-09
    3        -1.360041856901E+01      7.702E-07      7.702E-07     -4.562E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000077015981      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004185690076E+01  Eh
     Estimated bandgap           =   2.1450E-01  Eh
     RMS occupancy error         =   1.0750E-16
     [H,K] commutator            =   7.7016E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00001634944115              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.85971497127776 |
           | Pseudopotential (local)    :      -58.50645274632751 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56441692850988 |
           | Hartree                    :       24.08270113525704 |
           | Exchange-correlation       :       -4.70784018332539 |
           | Ewald                      :       14.10704132560057 |
           | Total                      :      -13.60041856900764 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999997
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00086087611753    -13.59779091512484   0.245127    -13.60028981929763        
   1     0.00017803400922    -13.60029771011178   0.271874    -13.60041666311397        
   2     0.00002414921306    -13.60041828429526   0.034631    -13.60041856592623        
   3     0.00001634944115    -13.60041856900765  <-- CG                                 
 
<QC>        [NGWF iterations]:                      4
<QC>           [total_energy]:       -13.600418569008
<QC>           [rms_gradient]:         0.000016349441
<QC>       [total_force(1,1)]:        -0.007837436949
<QC>       [total_force(1,2)]:         0.007471501398
<QC>       [total_force(1,3)]:        -0.004790075333
<QC>       [total_force(1,4)]:         0.006162354719
<QC>       [total_force(1,5)]:        -0.002524463321
<QC>       [total_force(1,6)]:         0.001518119486
<QC>       [total_force(2,1)]:        -0.022302089529
<QC>       [total_force(2,2)]:         0.011600117248
<QC>       [total_force(2,3)]:         0.008493125304
<QC>       [total_force(2,4)]:         0.001914112913
<QC>       [total_force(2,5)]:         0.000899787670
<QC>       [total_force(2,6)]:        -0.000605053606
<QC>       [total_force(3,1)]:        -0.026766453737
<QC>       [total_force(3,2)]:         0.011731590515
<QC>       [total_force(3,3)]:         0.008991807615
<QC>       [total_force(3,4)]:         0.007767945763
<QC>       [total_force(3,5)]:        -0.000027108719
<QC>       [total_force(3,6)]:        -0.001697781438

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    3 of   18 :
  displacing atom    1 in the -ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.124215 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59641674803852 0.19401572290 0.00274203949 0.0357  0.000   12.00000000
 2    -13.78811393738845 0.13331864407 0.00312019337 0.4375 -0.686   12.00000000
 3    -13.78856772435309 0.13352470350 0.00216058386 0.0791  2.871   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.081115328878
   Final penalty energy   :       0.202071391509
   RMS occupancy error    :       0.064883
   Occupancy bounds       : [-0.094, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359736599090E+01     2.5776E-03     2.5776E-03
    2        -1.359761897183E+01     7.0894E-04     7.0894E-04    -2.5298E-04
    3        -1.359764716330E+01     1.9169E-04     1.9169E-04    -2.8191E-05
    4        -1.359764937098E+01     6.9753E-05     6.9753E-05    -2.2077E-06
    5        -1.359764951954E+01     2.2994E-05     2.2994E-05    -1.4856E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35976495195406E+01  Eh
     Estimated bandgap           =   2.1746E-01  Eh
     RMS occupancy error         =   9.4224E-14
     [H,K] commutator            =   2.2994E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.5816E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36001329119037E+01 Eh
   Predicted gain in energy  =      -2.48339236303430E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360013423664E+01     3.8045E-04     3.8045E-04
    2        -1.360014008311E+01     8.9488E-05     8.9488E-05    -5.8465E-06
    3        -1.360014050873E+01     3.5736E-05     3.5736E-05    -4.2563E-07
    4        -1.360014056132E+01     1.8250E-05     1.8250E-05    -5.2588E-08
    5        -1.360014057582E+01     4.4319E-06     4.4319E-06    -1.4499E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36001405758218E+01  Eh
     Estimated bandgap           =   2.1674E-01  Eh
     RMS occupancy error         =   1.3683E-15
     [H,K] commutator            =   4.4319E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7437E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36002535891602E+01 Eh
   Predicted gain in energy  =      -1.13013338351564E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360025340974E+01     1.3189E-04     1.3189E-04
    2        -1.360025423182E+01     3.0767E-05     3.0767E-05    -8.2208E-07
    3        -1.360025427168E+01     9.1117E-06     9.1117E-06    -3.9856E-08
    4        -1.360025427522E+01     4.6236E-06     4.6236E-06    -3.5384E-09
    5        -1.360025427613E+01     1.4605E-06     1.4605E-06    -9.1791E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002542761337E+01  Eh
     Estimated bandgap           =   2.1595E-01  Eh
     RMS occupancy error         =   5.0909E-17
     [H,K] commutator            =   1.4605E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2710E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36002544972473E+01 Eh
   Predicted gain in energy  =      -2.21113658938066E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360025449427E+01     1.0221E-05     1.0221E-05
    2        -1.360025449895E+01     2.7814E-06     2.7814E-06    -4.6819E-09
    3        -1.360025449926E+01      7.351E-07      7.351E-07     -3.077E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000073511040      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002544992570E+01  Eh
     Estimated bandgap           =   2.1587E-01  Eh
     RMS occupancy error         =   8.4014E-17
     [H,K] commutator            =   7.3511E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00001520367626              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.86395589644675 |
           | Pseudopotential (local)    :      -58.54296710492724 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56539874270840 |
           | Hartree                    :       24.09795977855293 |
           | Exchange-correlation       :       -4.70881655391591 |
           | Ewald                      :       14.12421474187802 |
           | Total                      :      -13.60025449925704 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000000
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00085815558009    -13.59764951954064   0.245153    -13.60013291190367        
   1     0.00017436522441    -13.60014057582181   0.269406    -13.60025358916016        
   2     0.00002271011678    -13.60025427613367   0.030977    -13.60025449724733        
   3     0.00001520367626    -13.60025449925704  <-- CG                                 
 
<QC>        [NGWF iterations]:                      4
<QC>           [total_energy]:       -13.600254499257
<QC>           [rms_gradient]:         0.000015203676
<QC>       [total_force(1,1)]:        -0.000347915166
<QC>       [total_force(1,2)]:        -0.006595289881
<QC>       [total_force(1,3)]:         0.008438939314
<QC>       [total_force(1,4)]:        -0.000284338302
<QC>       [total_force(1,5)]:         0.000437659502
<QC>       [total_force(1,6)]:        -0.001649055467
<QC>       [total_force(2,1)]:         0.025523428250
<QC>       [total_force(2,2)]:        -0.009381791277
<QC>       [total_force(2,3)]:        -0.012189790687
<QC>       [total_force(2,4)]:        -0.004033786572
<QC>       [total_force(2,5)]:         0.000682757499
<QC>       [total_force(2,6)]:        -0.000600817213
<QC>       [total_force(3,1)]:         0.027291384208
<QC>       [total_force(3,2)]:        -0.009927740611
<QC>       [total_force(3,3)]:        -0.010503204053
<QC>       [total_force(3,4)]:        -0.008706779714
<QC>       [total_force(3,5)]:         0.001865230433
<QC>       [total_force(3,6)]:        -0.000018890263

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    4 of   18 :
  displacing atom    2 in the +ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.046704 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59503773868170 0.19376679236 0.00162229040 0.0355  0.000   12.00000000
 2    -13.78507537418421 0.13354759780 0.00272880255 0.4640 -0.688   12.00000000
 3    -13.78601283274417 0.13373357462 0.00105619284 0.0785  3.054   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.075692861625
   Final penalty energy   :       0.197266192994
   RMS occupancy error    :       0.064107
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360010518225E+01     1.9876E-03     1.9876E-03
    2        -1.360023482979E+01     2.6570E-04     2.6570E-04    -1.2965E-04
    3        -1.360023828259E+01     1.1508E-04     1.1508E-04    -3.4528E-06
    4        -1.360023871016E+01     3.5448E-05     3.5448E-05    -4.2757E-07
    5        -1.360023877595E+01     8.5344E-06     8.5344E-06    -6.5799E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002387759550E+01  Eh
     Estimated bandgap           =   2.1751E-01  Eh
     RMS occupancy error         =   1.4216E-14
     [H,K] commutator            =   8.5344E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8608E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010234096072E+01 Eh
   Predicted gain in energy  =      -7.84633652221700E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360102448493E+01     1.9941E-04     1.9941E-04
    2        -1.360102591854E+01     4.9143E-05     4.9143E-05    -1.4336E-06
    3        -1.360102600286E+01     1.9095E-05     1.9095E-05    -8.4322E-08
    4        -1.360102601822E+01     4.5765E-06     4.5765E-06    -1.5356E-08
    5        -1.360102601931E+01     1.3292E-06     1.3292E-06    -1.0903E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010260193064E+01  Eh
     Estimated bandgap           =   2.1666E-01  Eh
     RMS occupancy error         =   7.5871E-17
     [H,K] commutator            =   1.3292E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.3700E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010431447426E+01 Eh
   Predicted gain in energy  =      -1.71254362104634E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360104306942E+01     7.7181E-05     7.7181E-05
    2        -1.360104328912E+01     2.8045E-05     2.8045E-05    -2.1970E-07
    3        -1.360104331764E+01     8.4183E-06     8.4183E-06    -2.8522E-08
    4        -1.360104332052E+01     2.3714E-06     2.3714E-06    -2.8819E-09
    5        -1.360104332084E+01      6.714E-07      6.714E-07     -3.169E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000067142829      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010433208411E+01  Eh
     Estimated bandgap           =   2.1614E-01  Eh
     RMS occupancy error         =   1.3667E-16
     [H,K] commutator            =   6.7143E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3390E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010475791602E+01 Eh
   Predicted gain in energy  =      -4.25831910355612E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360104750605E+01     5.8016E-05     5.8016E-05
    2        -1.360104763640E+01     2.0062E-05     2.0062E-05    -1.3035E-07
    3        -1.360104765097E+01     6.1308E-06     6.1308E-06    -1.4570E-08
    4        -1.360104765230E+01     1.5745E-06     1.5745E-06    -1.3287E-09
    5        -1.360104765244E+01      4.129E-07      4.129E-07     -1.487E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000041285755      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010476524441E+01  Eh
     Estimated bandgap           =   2.1658E-01  Eh
     RMS occupancy error         =   1.0353E-16
     [H,K] commutator            =   4.1286E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.2873E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010480545079E+01 Eh
   Predicted gain in energy  =      -4.02063800919450E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360104804980E+01     1.6063E-05     1.6063E-05
    2        -1.360104805974E+01     5.7924E-06     5.7924E-06    -9.9335E-09
    3        -1.360104806094E+01     1.7095E-06     1.7095E-06    -1.2040E-09
    4        -1.360104806105E+01      4.468E-07      4.468E-07     -1.068E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000044680503      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010480610460E+01  Eh
     Estimated bandgap           =   2.1646E-01  Eh
     RMS occupancy error         =   5.9015E-17
     [H,K] commutator            =   4.4681E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000447110402              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83455232497740 |
           | Pseudopotential (local)    :      -58.37763908150837 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56321263887921 |
           | Hartree                    :       24.03319825211973 |
           | Exchange-correlation       :       -4.70107613951076 |
           | Ewald                      :       14.04670394399683 |
           | Total                      :      -13.60104806104595 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00048607571425    -13.60023877595496   0.241425    -13.60102340960718        
   1     0.00008369974175    -13.60102601930635   0.177013    -13.60104314474257        
   2     0.00004339019710    -13.60104332084109   0.164429    -13.60104757916020        
   3     0.00003287347533    -13.60104765244409   0.027524    -13.60104805450789        
   4     0.00000447110402    -13.60104806104596  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601048061046
<QC>           [rms_gradient]:         0.000004471104
<QC>       [total_force(1,1)]:         0.010007402169
<QC>       [total_force(1,2)]:        -0.012744628758
<QC>       [total_force(1,3)]:         0.000668182661
<QC>       [total_force(1,4)]:         0.003225074258
<QC>       [total_force(1,5)]:        -0.001399247849
<QC>       [total_force(1,6)]:         0.000243217518
<QC>       [total_force(2,1)]:         0.010488288559
<QC>       [total_force(2,2)]:        -0.009379278435
<QC>       [total_force(2,3)]:        -0.002243788171
<QC>       [total_force(2,4)]:         0.001003524981
<QC>       [total_force(2,5)]:         0.000875536626
<QC>       [total_force(2,6)]:        -0.000744283560
<QC>       [total_force(3,1)]:         0.007897914032
<QC>       [total_force(3,2)]:        -0.006708359921
<QC>       [total_force(3,3)]:        -0.001856565938
<QC>       [total_force(3,4)]:         0.000879167295
<QC>       [total_force(3,5)]:         0.000869739880
<QC>       [total_force(3,6)]:        -0.001081895348

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    4 of   18 :
  displacing atom    2 in the -ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.197456 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60484334306321 0.19267532015 0.00157119385 0.0360  0.000   12.00000000
 2    -13.79785482507832 0.13136721366 0.00154083816 0.3932 -0.681   12.00000000
 3    -13.79870063648186 0.13153635924 0.00127504979 0.0802  2.735   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.092127603435
   Final penalty energy   :       0.208416485371
   RMS occupancy error    :       0.065894
   Occupancy bounds       : [-0.095, 1.099]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359998316583E+01     2.4542E-03     2.4542E-03
    2        -1.360018198456E+01     3.3257E-04     3.3257E-04    -1.9882E-04
    3        -1.360018728356E+01     1.2159E-04     1.2159E-04    -5.2990E-06
    4        -1.360018775354E+01     4.1713E-05     4.1713E-05    -4.6998E-07
    5        -1.360018784382E+01     9.6636E-06     9.6636E-06    -9.0279E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36001878438238E+01  Eh
     Estimated bandgap           =   2.1731E-01  Eh
     RMS occupancy error         =   2.3098E-14
     [H,K] commutator            =   9.6636E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8978E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009748514891E+01 Eh
   Predicted gain in energy  =      -7.87007665291384E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360097518002E+01     2.0288E-04     2.0288E-04
    2        -1.360097685867E+01     6.2759E-05     6.2759E-05    -1.6787E-06
    3        -1.360097699996E+01     2.2715E-05     2.2715E-05    -1.4129E-07
    4        -1.360097701998E+01     6.4243E-06     6.4243E-06    -2.0022E-08
    5        -1.360097702215E+01     1.8105E-06     1.8105E-06    -2.1688E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009770221505E+01  Eh
     Estimated bandgap           =   2.1677E-01  Eh
     RMS occupancy error         =   1.2177E-16
     [H,K] commutator            =   1.8105E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.8858E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009983780860E+01 Eh
   Predicted gain in energy  =      -2.13559354680370E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360099826906E+01     8.9613E-05     8.9613E-05
    2        -1.360099858006E+01     3.4513E-05     3.4513E-05    -3.1100E-07
    3        -1.360099862160E+01     9.3016E-06     9.3016E-06    -4.1539E-08
    4        -1.360099862526E+01     2.7911E-06     2.7911E-06    -3.6595E-09
    5        -1.360099862569E+01      7.857E-07      7.857E-07     -4.295E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000078567514      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009986256906E+01  Eh
     Estimated bandgap           =   2.1626E-01  Eh
     RMS occupancy error         =   1.2649E-16
     [H,K] commutator            =   7.8568E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7532E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010011581863E+01 Eh
   Predicted gain in energy  =      -2.53249573489711E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360100110703E+01     4.6123E-05     4.6123E-05
    2        -1.360100119307E+01     1.6219E-05     1.6219E-05    -8.6036E-08
    3        -1.360100120234E+01     4.6387E-06     4.6387E-06    -9.2755E-09
    4        -1.360100120310E+01     1.2525E-06     1.2525E-06    -7.5370E-10
    5        -1.360100120319E+01      3.145E-07      3.145E-07     -9.319E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000031445197      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010012031917E+01  Eh
     Estimated bandgap           =   2.1658E-01  Eh
     RMS occupancy error         =   9.5393E-17
     [H,K] commutator            =   3.1445E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7537E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010014422715E+01 Eh
   Predicted gain in energy  =      -2.39079771091610E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360100143856E+01     1.3120E-05     1.3120E-05
    2        -1.360100144553E+01     4.8172E-06     4.8172E-06    -6.9654E-09
    3        -1.360100144633E+01     1.3185E-06     1.3185E-06    -8.0437E-10
    4        -1.360100144640E+01      3.674E-07      3.674E-07     -6.355E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000036739709      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010014463951E+01  Eh
     Estimated bandgap           =   2.1649E-01  Eh
     RMS occupancy error         =   1.0296E-16
     [H,K] commutator            =   3.6740E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000407571016              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.89475692547371 |
           | Pseudopotential (local)    :      -58.70672648012654 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56584291012602 |
           | Hartree                    :       24.16540791745276 |
           | Exchange-correlation       :       -4.71773884596377 |
           | Ewald                      :       14.19745612664276 |
           | Total                      :      -13.60100144639506 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999994
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00048978483046    -13.60018784382381   0.238502    -13.60097485148911        
   1     0.00008885797086    -13.60097702215054   0.195947    -13.60099837808601        
   2     0.00003753180985    -13.60099862569057   0.130699    -13.60100115818630        
   3     0.00002753668188    -13.60100120319171   0.023337    -13.60100144227148        
   4     0.00000407571016    -13.60100144639506  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601001446395
<QC>           [rms_gradient]:         0.000004075710
<QC>       [total_force(1,1)]:        -0.013979215246
<QC>       [total_force(1,2)]:         0.013002011045
<QC>       [total_force(1,3)]:         0.001879090894
<QC>       [total_force(1,4)]:         0.000278319535
<QC>       [total_force(1,5)]:        -0.000744050896
<QC>       [total_force(1,6)]:        -0.000436155333
<QC>       [total_force(2,1)]:        -0.008472734653
<QC>       [total_force(2,2)]:         0.011495034282
<QC>       [total_force(2,3)]:        -0.000022017686
<QC>       [total_force(2,4)]:        -0.003266486418
<QC>       [total_force(2,5)]:         0.000685597028
<QC>       [total_force(2,6)]:        -0.000419392553
<QC>       [total_force(3,1)]:        -0.006856648712
<QC>       [total_force(3,2)]:         0.009538385186
<QC>       [total_force(3,3)]:        -0.000270214356
<QC>       [total_force(3,4)]:        -0.002233928757
<QC>       [total_force(3,5)]:         0.000864316474
<QC>       [total_force(3,6)]:        -0.001041909835

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    5 of   18 :
  displacing atom    2 in the +ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.043868 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59225377083337 0.19416241131 0.00176065645 0.0355  0.000   12.00000000
 2    -13.78230336057625 0.13394310451 0.00278277879 0.4473 -0.689   12.00000000
 3    -13.78329915356116 0.13411978811 0.00123369176 0.0789  2.920   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.074940818675
   Final penalty energy   :       0.197713195901
   RMS occupancy error    :       0.064180
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359969619186E+01     1.9373E-03     1.9373E-03
    2        -1.359982240328E+01     3.6649E-04     3.6649E-04    -1.2621E-04
    3        -1.359983036472E+01     2.1541E-04     2.1541E-04    -7.9614E-06
    4        -1.359983204873E+01     8.1765E-05     8.1765E-05    -1.6840E-06
    5        -1.359983242308E+01     2.5005E-05     2.5005E-05    -3.7434E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35998324230757E+01  Eh
     Estimated bandgap           =   2.1789E-01  Eh
     RMS occupancy error         =   9.1225E-13
     [H,K] commutator            =   2.5005E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.2964E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36007714263915E+01 Eh
   Predicted gain in energy  =      -9.39003315833631E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360077335272E+01     2.6224E-04     2.6224E-04
    2        -1.360077581482E+01     6.0557E-05     6.0557E-05    -2.4621E-06
    3        -1.360077596745E+01     2.5398E-05     2.5398E-05    -1.5264E-07
    4        -1.360077599386E+01     7.0192E-06     7.0192E-06    -2.6406E-08
    5        -1.360077599618E+01     2.5686E-06     2.5686E-06    -2.3188E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36007759961791E+01  Eh
     Estimated bandgap           =   2.1702E-01  Eh
     RMS occupancy error         =   8.4555E-17
     [H,K] commutator            =   2.5686E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0043E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008049970000E+01 Eh
   Predicted gain in energy  =      -2.90008209553605E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360080488767E+01     1.0588E-04     1.0588E-04
    2        -1.360080528335E+01     3.5310E-05     3.5310E-05    -3.9568E-07
    3        -1.360080532921E+01     1.1263E-05     1.1263E-05    -4.5863E-08
    4        -1.360080533421E+01     2.8479E-06     2.8479E-06    -4.9994E-09
    5        -1.360080533470E+01      8.198E-07      8.198E-07     -4.875E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000081981783      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008053346969E+01  Eh
     Estimated bandgap           =   2.1640E-01  Eh
     RMS occupancy error         =   1.3039E-16
     [H,K] commutator            =   8.1982E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3726E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008099036818E+01 Eh
   Predicted gain in energy  =      -4.56898496103975E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360080981720E+01     6.4117E-05     6.4117E-05
    2        -1.360080997057E+01     2.1047E-05     2.1047E-05    -1.5337E-07
    3        -1.360080998683E+01     6.5480E-06     6.5480E-06    -1.6261E-08
    4        -1.360080998829E+01     1.3926E-06     1.3926E-06    -1.4599E-09
    5        -1.360080998842E+01      3.440E-07      3.440E-07     -1.234E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000034402448      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008099884167E+01  Eh
     Estimated bandgap           =   2.1685E-01  Eh
     RMS occupancy error         =   9.2927E-17
     [H,K] commutator            =   3.4402E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1061E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008103549397E+01 Eh
   Predicted gain in energy  =      -3.66523021710918E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360081035017E+01     1.6522E-05     1.6522E-05
    2        -1.360081036030E+01     5.6414E-06     5.6414E-06    -1.0125E-08
    3        -1.360081036146E+01     1.7087E-06     1.7087E-06    -1.1603E-09
    4        -1.360081036156E+01      3.832E-07      3.832E-07     -1.030E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000038315929      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008103615605E+01  Eh
     Estimated bandgap           =   2.1674E-01  Eh
     RMS occupancy error         =   7.7231E-17
     [H,K] commutator            =   3.8316E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000475649769              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.82835159597193 |
           | Pseudopotential (local)    :      -58.37350944301149 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56395710173129 |
           | Hartree                    :       24.03575114200214 |
           | Exchange-correlation       :       -4.69922832186768 |
           | Ewald                      :       14.04386756361329 |
           | Total                      :      -13.60081036156053 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00052963619697    -13.59983242307570   0.243352    -13.60077142639154        
   1     0.00010043005363    -13.60077599617905   0.208026    -13.60080499700001        
   2     0.00004372641190    -13.60080533469689   0.173722    -13.60080990368185        
   3     0.00003106060922    -13.60080998841671   0.028142    -13.60081035493973        
   4     0.00000475649769    -13.60081036156052  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600810361561
<QC>           [rms_gradient]:         0.000004756498
<QC>       [total_force(1,1)]:         0.006604508367
<QC>       [total_force(1,2)]:        -0.009375909894
<QC>       [total_force(1,3)]:         0.002432555905
<QC>       [total_force(1,4)]:         0.001577037473
<QC>       [total_force(1,5)]:        -0.001045036978
<QC>       [total_force(1,6)]:        -0.000193154873
<QC>       [total_force(2,1)]:         0.018972743468
<QC>       [total_force(2,2)]:        -0.017424484200
<QC>       [total_force(2,3)]:        -0.000396739467
<QC>       [total_force(2,4)]:        -0.001232558505
<QC>       [total_force(2,5)]:         0.001035444633
<QC>       [total_force(2,6)]:        -0.000954405930
<QC>       [total_force(3,1)]:         0.010783452527
<QC>       [total_force(3,2)]:        -0.009610036832
<QC>       [total_force(3,3)]:        -0.000470048148
<QC>       [total_force(3,4)]:        -0.000549280840
<QC>       [total_force(3,5)]:         0.000471356676
<QC>       [total_force(3,6)]:        -0.000625443383

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    5 of   18 :
  displacing atom    2 in the -ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.201952 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60686866754587 0.19230630955 0.00177644829 0.0360  0.000   12.00000000
 2    -13.79990685896355 0.13096023266 0.00176044177 0.4149 -0.680   12.00000000
 3    -13.80081687779842 0.13114438194 0.00139046607 0.0797  2.942   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.091790513099
   Final penalty energy   :       0.207770024265
   RMS occupancy error    :       0.065792
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359937625409E+01     2.6223E-03     2.6223E-03
    2        -1.359960410073E+01     4.2094E-04     4.2094E-04    -2.2785E-04
    3        -1.359961448549E+01     2.1533E-04     2.1533E-04    -1.0385E-05
    4        -1.359961618410E+01     9.4336E-05     9.4336E-05    -1.6986E-06
    5        -1.359961665301E+01     2.6929E-05     2.6929E-05    -4.6891E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35996166530147E+01  Eh
     Estimated bandgap           =   2.1667E-01  Eh
     RMS occupancy error         =   1.3920E-12
     [H,K] commutator            =   2.6929E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4594E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36006191522151E+01 Eh
   Predicted gain in energy  =      -1.00249920035722E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360062182063E+01     2.7380E-04     2.7380E-04
    2        -1.360062472662E+01     8.0012E-05     8.0012E-05    -2.9060E-06
    3        -1.360062496652E+01     3.0947E-05     3.0947E-05    -2.3991E-07
    4        -1.360062500310E+01     8.6319E-06     8.6319E-06    -3.6580E-08
    5        -1.360062500725E+01     2.5607E-06     2.5607E-06    -4.1436E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36006250072470E+01  Eh
     Estimated bandgap           =   2.1618E-01  Eh
     RMS occupancy error         =   1.0622E-16
     [H,K] commutator            =   2.5607E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1247E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36006669573816E+01 Eh
   Predicted gain in energy  =      -4.19501346300422E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360066680429E+01     1.3002E-04     1.3002E-04
    2        -1.360066741951E+01     4.8232E-05     4.8232E-05    -6.1523E-07
    3        -1.360066750367E+01     1.3380E-05     1.3380E-05    -8.4158E-08
    4        -1.360066751117E+01     3.8651E-06     3.8651E-06    -7.4995E-09
    5        -1.360066751205E+01     1.1247E-06     1.1247E-06    -8.7721E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36006675120459E+01  Eh
     Estimated bandgap           =   2.1558E-01  Eh
     RMS occupancy error         =   1.1181E-16
     [H,K] commutator            =   1.1247E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3795E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36006691976988E+01 Eh
   Predicted gain in energy  =      -1.68565292213430E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360066916418E+01     3.8483E-05     3.8483E-05
    2        -1.360066922226E+01     1.3614E-05     1.3614E-05    -5.8084E-08
    3        -1.360066922879E+01     3.7564E-06     3.7564E-06    -6.5243E-09
    4        -1.360066922928E+01      9.628E-07      9.628E-07     -4.970E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000096282884      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36006692292832E+01  Eh
     Estimated bandgap           =   2.1583E-01  Eh
     RMS occupancy error         =   9.1664E-17
     [H,K] commutator            =   9.6283E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5187E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36006694014194E+01 Eh
   Predicted gain in energy  =      -1.72136179088511E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360066939866E+01     1.1570E-05     1.1570E-05
    2        -1.360066940390E+01     4.2159E-06     4.2159E-06    -5.2414E-09
    3        -1.360066940450E+01     1.0116E-06     1.0116E-06    -6.0225E-10
    4        -1.360066940454E+01      2.308E-07      2.308E-07     -3.643E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000023077398      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36006694045367E+01  Eh
     Estimated bandgap           =   2.1576E-01  Eh
     RMS occupancy error         =   1.0827E-16
     [H,K] commutator            =   2.3077E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000362098186              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.90295119715748 |
           | Pseudopotential (local)    :      -58.71416979793238 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56560393520756 |
           | Hartree                    :       24.16294779654899 |
           | Exchange-correlation       :       -4.71995488063797 |
           | Ewald                      :       14.20195234511959 |
           | Total                      :      -13.60066940453672 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000002
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00054593586899    -13.59961665301474   0.244526    -13.60061915221509        
   1     0.00011247447353    -13.60062500724699   0.239485    -13.60066695738162        
   2     0.00003379487208    -13.60066751204589   0.107298    -13.60066919769881        
   3     0.00002518736731    -13.60066922928320   0.020100    -13.60066940141938        
   4     0.00000362098186    -13.60066940453673  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600669404537
<QC>           [rms_gradient]:         0.000003620982
<QC>       [total_force(1,1)]:        -0.012868004988
<QC>       [total_force(1,2)]:         0.011275157622
<QC>       [total_force(1,3)]:         0.000189659841
<QC>       [total_force(1,4)]:         0.002228659912
<QC>       [total_force(1,5)]:        -0.000988879247
<QC>       [total_force(1,6)]:         0.000163406860
<QC>       [total_force(2,1)]:        -0.016929875632
<QC>       [total_force(2,2)]:         0.019343951219
<QC>       [total_force(2,3)]:        -0.002029314571
<QC>       [total_force(2,4)]:        -0.000760396117
<QC>       [total_force(2,5)]:         0.000517054229
<QC>       [total_force(2,6)]:        -0.000141419128
<QC>       [total_force(3,1)]:        -0.010833117183
<QC>       [total_force(3,2)]:         0.013614413518
<QC>       [total_force(3,3)]:        -0.001876668376
<QC>       [total_force(3,4)]:        -0.000645092888
<QC>       [total_force(3,5)]:         0.001256053890
<QC>       [total_force(3,6)]:        -0.001515588962

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    6 of   18 :
  displacing atom    2 in the +ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.061768 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59466895520100 0.19391604212 0.00150966523 0.0356  0.000   12.00000000
 2    -13.78517997382284 0.13350696399 0.00256745688 0.4510 -0.688   12.00000000
 3    -13.78623381391526 0.13369368483 0.00110431427 0.0789  3.042   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.077120080750
   Final penalty energy   :       0.198501923187
   RMS occupancy error    :       0.064308
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360025015389E+01     2.0296E-03     2.0296E-03
    2        -1.360038990171E+01     4.2086E-04     4.2086E-04    -1.3975E-04
    3        -1.360040297167E+01     2.3727E-04     2.3727E-04    -1.3070E-05
    4        -1.360040491421E+01     9.3660E-05     9.3660E-05    -1.9425E-06
    5        -1.360040535234E+01     2.6027E-05     2.6027E-05    -4.3813E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004053523407E+01  Eh
     Estimated bandgap           =   2.1764E-01  Eh
     RMS occupancy error         =   1.5478E-12
     [H,K] commutator            =   2.6027E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9312E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012156899333E+01 Eh
   Predicted gain in energy  =      -8.10337592556110E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360121575090E+01     2.0941E-04     2.0941E-04
    2        -1.360121656876E+01     6.0644E-05     6.0644E-05    -8.1786E-07
    3        -1.360121673533E+01     2.4254E-05     2.4254E-05    -1.6657E-07
    4        -1.360121676377E+01     8.9312E-06     8.9312E-06    -2.8447E-08
    5        -1.360121676712E+01     4.2777E-06     4.2777E-06    -3.3517E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012167671248E+01  Eh
     Estimated bandgap           =   2.1681E-01  Eh
     RMS occupancy error         =   1.1254E-16
     [H,K] commutator            =   4.2777E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.9250E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012388778024E+01 Eh
   Predicted gain in energy  =      -2.21106775963875E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360123852123E+01     8.7273E-05     8.7273E-05
    2        -1.360123880053E+01     2.9110E-05     2.9110E-05    -2.7929E-07
    3        -1.360123883192E+01     9.6423E-06     9.6423E-06    -3.1395E-08
    4        -1.360123883548E+01     2.6995E-06     2.6995E-06    -3.5534E-09
    5        -1.360123883596E+01      8.796E-07      8.796E-07     -4.803E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000087962690      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012388359556E+01  Eh
     Estimated bandgap           =   2.1623E-01  Eh
     RMS occupancy error         =   5.4297E-17
     [H,K] commutator            =   8.7963E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.6334E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012446316653E+01 Eh
   Predicted gain in energy  =      -5.79570973080479E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360124448576E+01     6.7686E-05     6.7686E-05
    2        -1.360124493919E+01     5.6231E-05     5.6231E-05    -4.5343E-07
    3        -1.360124495487E+01     5.0125E-05     5.0125E-05    -1.5679E-08
    4        -1.360124497428E+01     4.2568E-05     4.2568E-05    -1.9413E-08
    5        -1.360124467401E+01     1.4563E-05     1.4563E-05     3.0028E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012446740077E+01  Eh
     Estimated bandgap           =   2.1674E-01  Eh
     RMS occupancy error         =   2.9199E-15
     [H,K] commutator            =   1.4563E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0938E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012450364740E+01 Eh
   Predicted gain in energy  =      -3.62466316516930E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360124537196E+01     2.5829E-05     2.5829E-05
    2        -1.360124540082E+01     7.2132E-06     7.2132E-06    -2.8861E-08
    3        -1.360124540289E+01     1.4859E-06     1.4859E-06    -2.0726E-09
    4        -1.360124540296E+01      4.963E-07      4.963E-07     -6.629E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000049628803      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012454029570E+01  Eh
     Estimated bandgap           =   2.1662E-01  Eh
     RMS occupancy error         =   9.0465E-17
     [H,K] commutator            =   4.9629E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000331854460              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83723891170825 |
           | Pseudopotential (local)    :      -58.41306274546646 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56397183894553 |
           | Hartree                    :       24.05060401638604 |
           | Exchange-correlation       :       -4.70176571493162 |
           | Ewald                      :       14.06176829040126 |
           | Total                      :      -13.60124540295699 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999993
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00049312202188    -13.60040535234074   0.242259    -13.60121568993330        
   1     0.00008925036956    -13.60121676712480   0.201310    -13.60123887780239        
   2     0.00004633392923    -13.60123883595558   0.196260    -13.60124463166531        
   3     0.00003093837734    -13.60124467400772   0.029728    -13.60124503647404        
   4     0.00000331854460    -13.60124540295699  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601245402957
<QC>           [rms_gradient]:         0.000003318545
<QC>       [total_force(1,1)]:         0.004975359247
<QC>       [total_force(1,2)]:        -0.007717259982
<QC>       [total_force(1,3)]:         0.002074684930
<QC>       [total_force(1,4)]:         0.001838200313
<QC>       [total_force(1,5)]:        -0.001109746306
<QC>       [total_force(1,6)]:        -0.000061238202
<QC>       [total_force(2,1)]:         0.011930402076
<QC>       [total_force(2,2)]:        -0.010642633137
<QC>       [total_force(2,3)]:        -0.000689192173
<QC>       [total_force(2,4)]:        -0.000849286824
<QC>       [total_force(2,5)]:         0.000404504811
<QC>       [total_force(2,6)]:        -0.000153794752
<QC>       [total_force(3,1)]:         0.012865357889
<QC>       [total_force(3,2)]:        -0.010151872766
<QC>       [total_force(3,3)]:        -0.000948790409
<QC>       [total_force(3,4)]:        -0.000993544364
<QC>       [total_force(3,5)]:         0.001211420704
<QC>       [total_force(3,6)]:        -0.001982571056

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    6 of   18 :
  displacing atom    2 in the -ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.180934 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60534607263426 0.19256501147 0.00142683413 0.0360  0.000   12.00000000
 2    -13.79814561896623 0.13129531859 0.00167296946 0.4232 -0.681   12.00000000
 3    -13.79913596057008 0.13148557473 0.00120167361 0.0795  3.052   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.089900018227
   Final penalty energy   :       0.206289645022
   RMS occupancy error    :       0.065557
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359993615473E+01     2.5291E-03     2.5291E-03
    2        -1.360015103836E+01     4.6816E-04     4.6816E-04    -2.1488E-04
    3        -1.360016668016E+01     2.2882E-04     2.2882E-04    -1.5642E-05
    4        -1.360016867363E+01     1.0884E-04     1.0884E-04    -1.9935E-06
    5        -1.360016920083E+01     2.8365E-05     2.8365E-05    -5.2720E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36001692008317E+01  Eh
     Estimated bandgap           =   2.1682E-01  Eh
     RMS occupancy error         =   2.1944E-12
     [H,K] commutator            =   2.8365E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9924E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009926177760E+01 Eh
   Predicted gain in energy  =      -8.23416944299993E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360099331438E+01     2.0905E-04     2.0905E-04
    2        -1.360099512689E+01     6.6380E-05     6.6380E-05    -1.8125E-06
    3        -1.360099529671E+01     2.6372E-05     2.6372E-05    -1.6981E-07
    4        -1.360099532380E+01     8.8635E-06     8.8635E-06    -2.7096E-08
    5        -1.360099532817E+01     2.4940E-06     2.4940E-06    -4.3676E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009953281714E+01  Eh
     Estimated bandgap           =   2.1628E-01  Eh
     RMS occupancy error         =   1.2652E-16
     [H,K] commutator            =   2.4940E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.4355E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010209580003E+01 Eh
   Predicted gain in energy  =      -2.56298288405787E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360102084224E+01     9.4019E-05     9.4019E-05
    2        -1.360102118716E+01     3.5467E-05     3.5467E-05    -3.4492E-07
    3        -1.360102123095E+01     9.6294E-06     9.6294E-06    -4.3785E-08
    4        -1.360102123469E+01     2.8704E-06     2.8704E-06    -3.7437E-09
    5        -1.360102123518E+01      8.850E-07      8.850E-07     -4.946E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000088495309      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010212351838E+01  Eh
     Estimated bandgap           =   2.1574E-01  Eh
     RMS occupancy error         =   1.4774E-16
     [H,K] commutator            =   8.8495E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6987E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010236629608E+01 Eh
   Predicted gain in energy  =      -2.42777701764396E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360102361544E+01     4.4064E-05     4.4064E-05
    2        -1.360102369424E+01     1.5168E-05     1.5168E-05    -7.8800E-08
    3        -1.360102370233E+01     4.2091E-06     4.2091E-06    -8.0880E-09
    4        -1.360102370292E+01     1.0239E-06     1.0239E-06    -5.9432E-10
    5        -1.360102370299E+01      2.600E-07      2.600E-07     -6.490E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000026000521      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010237029852E+01  Eh
     Estimated bandgap           =   2.1606E-01  Eh
     RMS occupancy error         =   1.7786E-16
     [H,K] commutator            =   2.6001E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6880E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010239289393E+01 Eh
   Predicted gain in energy  =      -2.25954114085880E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360102392553E+01     1.2466E-05     1.2466E-05
    2        -1.360102393185E+01     4.4634E-06     4.4634E-06    -6.3220E-09
    3        -1.360102393254E+01     1.1953E-06     1.1953E-06    -6.8856E-10
    4        -1.360102393259E+01      3.023E-07      3.023E-07     -4.963E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000030227582      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010239325861E+01  Eh
     Estimated bandgap           =   2.1597E-01  Eh
     RMS occupancy error         =   6.2333E-17
     [H,K] commutator            =   3.0228E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000383911802              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.89193743965667 |
           | Pseudopotential (local)    :      -58.66856190544277 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56512745881674 |
           | Hartree                    :       24.14653358024183 |
           | Exchange-correlation       :       -4.71699471854982 |
           | Ewald                      :       14.18093421269128 |
           | Total                      :      -13.60102393258608 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00049924135932    -13.60016920083168   0.240172    -13.60099261777598        
   1     0.00009435542478    -13.60099532817144   0.208553    -13.60102095800028        
   2     0.00003698678656    -13.60102123518382   0.129015    -13.60102366296084        
   3     0.00002687997183    -13.60102370298519   0.023116    -13.60102392893931        
   4     0.00000383911802    -13.60102393258608  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601023932586
<QC>           [rms_gradient]:         0.000003839118
<QC>       [total_force(1,1)]:        -0.010046153995
<QC>       [total_force(1,2)]:         0.008473657298
<QC>       [total_force(1,3)]:         0.000562226111
<QC>       [total_force(1,4)]:         0.001922807338
<QC>       [total_force(1,5)]:        -0.000921250067
<QC>       [total_force(1,6)]:         0.000008713316
<QC>       [total_force(2,1)]:        -0.009911778764
<QC>       [total_force(2,2)]:         0.012731101803
<QC>       [total_force(2,3)]:        -0.001745868751
<QC>       [total_force(2,4)]:        -0.001228535201
<QC>       [total_force(2,5)]:         0.001188905988
<QC>       [total_force(2,6)]:        -0.001033825074
<QC>       [total_force(3,1)]:        -0.010564937168
<QC>       [total_force(3,2)]:         0.011473383034
<QC>       [total_force(3,3)]:        -0.001194713337
<QC>       [total_force(3,4)]:        -0.000155499769
<QC>       [total_force(3,5)]:         0.000508104701
<QC>       [total_force(3,6)]:        -0.000066337460

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    7 of   18 :
  displacing atom    3 in the +ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.045884 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59511234851188 0.19377246015 0.00163898295 0.0355  0.000   12.00000000
 2    -13.78511917736235 0.13356510900 0.00274419843 0.4646 -0.688   12.00000000
 3    -13.78605431334027 0.13375083632 0.00106600737 0.0785  3.053   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.075688515439
   Final penalty energy   :       0.197170505013
   RMS occupancy error    :       0.064091
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360023672393E+01     1.9859E-03     1.9859E-03
    2        -1.360036659907E+01     2.6844E-04     2.6844E-04    -1.2988E-04
    3        -1.360037010206E+01     1.1621E-04     1.1621E-04    -3.5030E-06
    4        -1.360037053856E+01     3.5823E-05     3.5823E-05    -4.3651E-07
    5        -1.360037060599E+01     8.6400E-06     8.6400E-06    -6.7428E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36003706059889E+01  Eh
     Estimated bandgap           =   2.1751E-01  Eh
     RMS occupancy error         =   1.5076E-14
     [H,K] commutator            =   8.6400E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8830E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011614147457E+01 Eh
   Predicted gain in energy  =      -7.90808756720551E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360116079121E+01     2.0284E-04     2.0284E-04
    2        -1.360116227294E+01     4.9934E-05     4.9934E-05    -1.4817E-06
    3        -1.360116235965E+01     1.9242E-05     1.9242E-05    -8.6711E-08
    4        -1.360116237523E+01     4.5792E-06     4.5792E-06    -1.5587E-08
    5        -1.360116237631E+01     1.2994E-06     1.2994E-06    -1.0791E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011623763131E+01  Eh
     Estimated bandgap           =   2.1666E-01  Eh
     RMS occupancy error         =   1.2948E-16
     [H,K] commutator            =   1.2994E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.3140E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011789117639E+01 Eh
   Predicted gain in energy  =      -1.65354508094850E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360117918687E+01     7.6415E-05     7.6415E-05
    2        -1.360117899498E+01     4.1844E-05     4.1844E-05     1.9189E-07
    3        -1.360117906903E+01     1.9659E-05     1.9659E-05    -7.4049E-08
    4        -1.360117908099E+01     8.4240E-06     8.4240E-06    -1.1957E-08
    5        -1.360117943133E+01     6.2859E-06     6.2859E-06    -3.5034E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011794313272E+01  Eh
     Estimated bandgap           =   2.1616E-01  Eh
     RMS occupancy error         =   1.2299E-16
     [H,K] commutator            =   6.2859E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.2822E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011830911588E+01 Eh
   Predicted gain in energy  =      -3.65983158445715E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360118293078E+01     5.0530E-05     5.0530E-05
    2        -1.360118303935E+01     1.6813E-05     1.6813E-05    -1.0856E-07
    3        -1.360118304937E+01     4.9137E-06     4.9137E-06    -1.0026E-08
    4        -1.360118305020E+01     1.4208E-06     1.4208E-06    -8.2229E-10
    5        -1.360118305031E+01      3.827E-07      3.827E-07     -1.165E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000038271712      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011830503122E+01  Eh
     Estimated bandgap           =   2.1654E-01  Eh
     RMS occupancy error         =   9.1618E-17
     [H,K] commutator            =   3.8272E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8718E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011832919571E+01 Eh
   Predicted gain in energy  =      -2.41644892540194E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360118328154E+01     1.2612E-05     1.2612E-05
    2        -1.360118328767E+01     4.5362E-06     4.5362E-06    -6.1340E-09
    3        -1.360118328841E+01     1.3320E-06     1.3320E-06    -7.3763E-10
    4        -1.360118328848E+01      3.459E-07      3.459E-07     -6.468E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000034590938      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011832884767E+01  Eh
     Estimated bandgap           =   2.1645E-01  Eh
     RMS occupancy error         =   7.3058E-17
     [H,K] commutator            =   3.4591E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000284564686              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83411104389504 |
           | Pseudopotential (local)    :      -58.37602884892843 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56319236135413 |
           | Hartree                    :       24.03263963653895 |
           | Exchange-correlation       :       -4.70098137689466 |
           | Ewald                      :       14.04588389555826 |
           | Total                      :      -13.60118328847671 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999999
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00048830368121    -13.60037060598893   0.241110    -13.60116141474565        
   1     0.00008314037779    -13.60116237631311   0.173511    -13.60117891176392        
   2     0.00004282152119    -13.60117943132722   0.145098    -13.60118309115880        
   3     0.00002871792467    -13.60118305031223   0.023243    -13.60118329195712        
   4     0.00000284564686    -13.60118328847670  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601183288477
<QC>           [rms_gradient]:         0.000002845647
<QC>       [total_force(1,1)]:         0.010345716587
<QC>       [total_force(1,2)]:        -0.000836645634
<QC>       [total_force(1,3)]:        -0.011572857405
<QC>       [total_force(1,4)]:         0.003224527496
<QC>       [total_force(1,5)]:        -0.000743463504
<QC>       [total_force(1,6)]:        -0.000417277540
<QC>       [total_force(2,1)]:        -0.007855983973
<QC>       [total_force(2,2)]:         0.001370257932
<QC>       [total_force(2,3)]:         0.009403393898
<QC>       [total_force(2,4)]:        -0.003165449847
<QC>       [total_force(2,5)]:         0.000866409783
<QC>       [total_force(2,6)]:        -0.000618627793
<QC>       [total_force(3,1)]:        -0.005313174527
<QC>       [total_force(3,2)]:         0.001569137086
<QC>       [total_force(3,3)]:         0.005901081193
<QC>       [total_force(3,4)]:        -0.002011816376
<QC>       [total_force(3,5)]:         0.000997635733
<QC>       [total_force(3,6)]:        -0.001142863109

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    7 of   18 :
  displacing atom    3 in the -ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.198332 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60472236175518 0.19267498958 0.00158460688 0.0360  0.000   12.00000000
 2    -13.79776241443867 0.13135883145 0.00154312676 0.3917 -0.681   12.00000000
 3    -13.79859914872022 0.13152695243 0.00128199596 0.0803  2.721   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.092161842095
   Final penalty energy   :       0.208575371893
   RMS occupancy error    :       0.065919
   Occupancy bounds       : [-0.095, 1.099]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359981187962E+01     2.4558E-03     2.4558E-03
    2        -1.360001129843E+01     3.3435E-04     3.3435E-04    -1.9942E-04
    3        -1.360001662271E+01     1.2256E-04     1.2256E-04    -5.3243E-06
    4        -1.360001709991E+01     4.1766E-05     4.1766E-05    -4.7719E-07
    5        -1.360001719070E+01     9.6985E-06     9.6985E-06    -9.0791E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36000171906960E+01  Eh
     Estimated bandgap           =   2.1732E-01  Eh
     RMS occupancy error         =   2.3133E-14
     [H,K] commutator            =   9.6985E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9499E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008184404957E+01 Eh
   Predicted gain in energy  =      -8.01249799696535E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360081974554E+01     2.0574E-04     2.0574E-04
    2        -1.360082146545E+01     6.3880E-05     6.3880E-05    -1.7199E-06
    3        -1.360082161094E+01     2.3054E-05     2.3054E-05    -1.4549E-07
    4        -1.360082163179E+01     6.5112E-06     6.5112E-06    -2.0851E-08
    5        -1.360082163404E+01     1.8282E-06     1.8282E-06    -2.2508E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008216340431E+01  Eh
     Estimated bandgap           =   2.1678E-01  Eh
     RMS occupancy error         =   1.6593E-16
     [H,K] commutator            =   1.8282E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.9588E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008432309292E+01 Eh
   Predicted gain in energy  =      -2.15968860821647E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360084312968E+01     9.0291E-05     9.0291E-05
    2        -1.360084344433E+01     3.4776E-05     3.4776E-05    -3.1466E-07
    3        -1.360084348650E+01     9.3760E-06     9.3760E-06    -4.2165E-08
    4        -1.360084349027E+01     2.8388E-06     2.8388E-06    -3.7679E-09
    5        -1.360084349071E+01      7.800E-07      7.800E-07     -4.438E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000078002581      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008434907100E+01  Eh
     Estimated bandgap           =   2.1627E-01  Eh
     RMS occupancy error         =   1.2236E-16
     [H,K] commutator            =   7.8003E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7058E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008458197090E+01 Eh
   Predicted gain in energy  =      -2.32899903096495E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360084577658E+01     4.3807E-05     4.3807E-05
    2        -1.360084585426E+01     1.5532E-05     1.5532E-05    -7.7679E-08
    3        -1.360084586270E+01     4.4061E-06     4.4061E-06    -8.4450E-09
    4        -1.360084586339E+01     1.2191E-06     1.2191E-06    -6.9147E-10
    5        -1.360084586348E+01      3.020E-07      3.020E-07     -8.820E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000030204504      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008458634804E+01  Eh
     Estimated bandgap           =   2.1657E-01  Eh
     RMS occupancy error         =   9.1612E-17
     [H,K] commutator            =   3.0205E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6684E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008460737734E+01 Eh
   Predicted gain in energy  =      -2.10292983027216E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360084607076E+01     1.2229E-05     1.2229E-05
    2        -1.360084607681E+01     4.5158E-06     4.5158E-06    -6.0492E-09
    3        -1.360084607752E+01     1.2258E-06     1.2258E-06    -7.0329E-10
    4        -1.360084607757E+01      3.474E-07      3.474E-07     -5.590E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000034738817      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008460775719E+01  Eh
     Estimated bandgap           =   2.1649E-01  Eh
     RMS occupancy error         =   1.0035E-16
     [H,K] commutator            =   3.4739E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000409649578              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.89518202939173 |
           | Pseudopotential (local)    :      -58.70833815425959 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56590300587399 |
           | Hartree                    :       24.16591035522105 |
           | Exchange-correlation       :       -4.71783511985779 |
           | Ewald                      :       14.19833180605869 |
           | Total                      :      -13.60084607757191 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000000
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00049499438137    -13.60001719069599   0.237734    -13.60081844049569        
   1     0.00008958763944    -13.60082163404309   0.194620    -13.60084323092918        
   2     0.00003705846244    -13.60084349070998   0.123287    -13.60084581970901        
   3     0.00002668401089    -13.60084586348040   0.021882    -13.60084607377338        
   4     0.00000409649578    -13.60084607757191  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600846077572
<QC>           [rms_gradient]:         0.000004096496
<QC>       [total_force(1,1)]:        -0.014325907863
<QC>       [total_force(1,2)]:         0.000379560003
<QC>       [total_force(1,3)]:         0.014846788430
<QC>       [total_force(1,4)]:         0.000273733487
<QC>       [total_force(1,5)]:        -0.001421475501
<QC>       [total_force(1,6)]:         0.000247301443
<QC>       [total_force(2,1)]:         0.012958763462
<QC>       [total_force(2,2)]:        -0.000912008590
<QC>       [total_force(2,3)]:        -0.013417395124
<QC>       [total_force(2,4)]:         0.001218293521
<QC>       [total_force(2,5)]:         0.000710995724
<QC>       [total_force(2,6)]:        -0.000558648993
<QC>       [total_force(3,1)]:         0.008646394116
<QC>       [total_force(3,2)]:         0.000030848614
<QC>       [total_force(3,3)]:        -0.009304792477
<QC>       [total_force(3,4)]:         0.000887151490
<QC>       [total_force(3,5)]:         0.000704832506
<QC>       [total_force(3,6)]:        -0.000964434248

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    8 of   18 :
  displacing atom    3 in the +ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.207009 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60692554956250 0.19228809677 0.00184536675 0.0360  0.000   12.00000000
 2    -13.80007388477630 0.13090941377 0.00177461389 0.4110 -0.680   12.00000000
 3    -13.80096386281169 0.13109145151 0.00143078584 0.0798  2.911   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.092244961847
   Final penalty energy   :       0.208251795925
   RMS occupancy error    :       0.065868
   Occupancy bounds       : [-0.095, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359914553377E+01     2.6409E-03     2.6409E-03
    2        -1.359937688482E+01     4.2621E-04     4.2621E-04    -2.3135E-04
    3        -1.359938725210E+01     2.2044E-04     2.2044E-04    -1.0367E-05
    4        -1.359938903322E+01     9.4809E-05     9.4809E-05    -1.7811E-06
    5        -1.359938951375E+01     2.6843E-05     2.6843E-05    -4.8053E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35993895137502E+01  Eh
     Estimated bandgap           =   2.1667E-01  Eh
     RMS occupancy error         =   1.4307E-12
     [H,K] commutator            =   2.6843E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.5899E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36004419869811E+01 Eh
   Predicted gain in energy  =      -1.05247323083368E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360044254611E+01     2.8820E-04     2.8820E-04
    2        -1.360044574654E+01     8.3922E-05     8.3922E-05    -3.2004E-06
    3        -1.360044600803E+01     3.2271E-05     3.2271E-05    -2.6149E-07
    4        -1.360044604825E+01     8.9888E-06     8.9888E-06    -4.0216E-08
    5        -1.360044605275E+01     2.6491E-06     2.6491E-06    -4.4956E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004460527450E+01  Eh
     Estimated bandgap           =   2.1619E-01  Eh
     RMS occupancy error         =   1.5674E-16
     [H,K] commutator            =   2.6491E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1604E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36004911425605E+01 Eh
   Predicted gain in energy  =      -4.50898154884527E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360049098744E+01     1.3690E-04     1.3690E-04
    2        -1.360049166487E+01     5.0786E-05     5.0786E-05    -6.7743E-07
    3        -1.360049175821E+01     1.3907E-05     1.3907E-05    -9.3333E-08
    4        -1.360049176643E+01     4.0912E-06     4.0912E-06    -8.2290E-09
    5        -1.360049176741E+01     1.1691E-06     1.1691E-06    -9.7266E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004917674071E+01  Eh
     Estimated bandgap           =   2.1558E-01  Eh
     RMS occupancy error         =   7.1451E-17
     [H,K] commutator            =   1.1691E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1304E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36004929783331E+01 Eh
   Predicted gain in energy  =      -1.21092606342188E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360049295500E+01     3.2716E-05     3.2716E-05
    2        -1.360049299689E+01     1.1670E-05     1.1670E-05    -4.1889E-08
    3        -1.360049300165E+01     3.1446E-06     3.1446E-06    -4.7645E-09
    4        -1.360049300201E+01      8.064E-07      8.064E-07     -3.508E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000080644041      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004930020052E+01  Eh
     Estimated bandgap           =   2.1580E-01  Eh
     RMS occupancy error         =   6.2013E-17
     [H,K] commutator            =   8.0644E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3348E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36004931290264E+01 Eh
   Predicted gain in energy  =      -1.27021255735826E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360049312698E+01     1.0042E-05     1.0042E-05
    2        -1.360049313092E+01     3.6726E-06     3.6726E-06    -3.9380E-09
    3        -1.360049313138E+01      8.655E-07      8.655E-07     -4.561E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000086548263      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004931313778E+01  Eh
     Estimated bandgap           =   2.1574E-01  Eh
     RMS occupancy error         =   1.2260E-16
     [H,K] commutator            =   8.6548E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000330507838              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.90548041298675 |
           | Pseudopotential (local)    :      -58.72527376212330 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56581058429218 |
           | Hartree                    :       24.16704756865037 |
           | Exchange-correlation       :       -4.72056667252064 |
           | Ewald                      :       14.20700873733680 |
           | Total                      :      -13.60049313137784 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999997
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00055899293927    -13.59938951375024   0.244862    -13.60044198698108        
   1     0.00011604062395    -13.60044605274501   0.242483    -13.60049114256050        
   2     0.00003130421759    -13.60049176740708   0.089833    -13.60049297833314        
   3     0.00002334799149    -13.60049300200516   0.017274    -13.60049312902642        
   4     0.00000330507838    -13.60049313137784  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600493131378
<QC>           [rms_gradient]:         0.000003305078
<QC>       [total_force(1,1)]:        -0.013791036091
<QC>       [total_force(1,2)]:        -0.001286217385
<QC>       [total_force(1,3)]:         0.013874931215
<QC>       [total_force(1,4)]:         0.002040692936
<QC>       [total_force(1,5)]:        -0.000907803457
<QC>       [total_force(1,6)]:         0.000069432782
<QC>       [total_force(2,1)]:         0.021889053204
<QC>       [total_force(2,2)]:         0.001162983389
<QC>       [total_force(2,3)]:        -0.021951806580
<QC>       [total_force(2,4)]:        -0.001212424718
<QC>       [total_force(2,5)]:         0.000379196610
<QC>       [total_force(2,6)]:        -0.000267001906
<QC>       [total_force(3,1)]:         0.012929015402
<QC>       [total_force(3,2)]:         0.001443131968
<QC>       [total_force(3,3)]:        -0.013710164181
<QC>       [total_force(3,4)]:        -0.000502499881
<QC>       [total_force(3,5)]:         0.001299107132
<QC>       [total_force(3,6)]:        -0.001458590440

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    8 of   18 :
  displacing atom    3 in the -ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.039446 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59200317229272 0.19418255887 0.00181479919 0.0355  0.000   12.00000000
 2    -13.78192838306489 0.13400760861 0.00283586382 0.4489 -0.689   12.00000000
 3    -13.78292006032120 0.13418359767 0.00125728308 0.0789  2.920   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.074457050059
   Final penalty energy   :       0.197394867977
   RMS occupancy error    :       0.064128
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359970381526E+01     1.9289E-03     1.9289E-03
    2        -1.359982863900E+01     3.6722E-04     3.6722E-04    -1.2482E-04
    3        -1.359983647817E+01     2.1684E-04     2.1684E-04    -7.8392E-06
    4        -1.359983820232E+01     8.1864E-05     8.1864E-05    -1.7242E-06
    5        -1.359983857972E+01     2.5007E-05     2.5007E-05    -3.7739E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35998385797169E+01  Eh
     Estimated bandgap           =   2.1789E-01  Eh
     RMS occupancy error         =   9.1802E-13
     [H,K] commutator            =   2.5007E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4367E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008308942398E+01 Eh
   Predicted gain in energy  =      -9.92314522957116E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360083320354E+01     2.7209E-04     2.7209E-04
    2        -1.360083587278E+01     6.4960E-05     6.4960E-05    -2.6692E-06
    3        -1.360083602588E+01     2.6837E-05     2.6837E-05    -1.5309E-07
    4        -1.360083605536E+01     6.5500E-06     6.5500E-06    -2.9484E-08
    5        -1.360083605768E+01     2.1270E-06     2.1270E-06    -2.3176E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008360576774E+01  Eh
     Estimated bandgap           =   2.1700E-01  Eh
     RMS occupancy error         =   7.0365E-17
     [H,K] commutator            =   2.1270E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0347E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008677598121E+01 Eh
   Predicted gain in energy  =      -3.17021347093771E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360086745337E+01     1.1062E-04     1.1062E-04
    2        -1.360086788817E+01     3.7840E-05     3.7840E-05    -4.3479E-07
    3        -1.360086794091E+01     1.1907E-05     1.1907E-05    -5.2745E-08
    4        -1.360086794657E+01     3.1970E-06     3.1970E-06    -5.6608E-09
    5        -1.360086794719E+01      9.214E-07      9.214E-07     -6.171E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000092144561      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008679471898E+01  Eh
     Estimated bandgap           =   2.1636E-01  Eh
     RMS occupancy error         =   8.0083E-17
     [H,K] commutator            =   9.2145E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4581E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008728965084E+01 Eh
   Predicted gain in energy  =      -4.94931854966296E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360087279905E+01     6.7023E-05     6.7023E-05
    2        -1.360087296766E+01     2.2359E-05     2.2359E-05    -1.6861E-07
    3        -1.360087298602E+01     6.9496E-06     6.9496E-06    -1.8356E-08
    4        -1.360087298768E+01     1.6114E-06     1.6114E-06    -1.6647E-09
    5        -1.360087298785E+01      4.015E-07      4.015E-07     -1.684E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000040151245      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008729878528E+01  Eh
     Estimated bandgap           =   2.1684E-01  Eh
     RMS occupancy error         =   7.6176E-17
     [H,K] commutator            =   4.0151E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0996E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008733588262E+01 Eh
   Predicted gain in energy  =      -3.70973419094867E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360087335387E+01     1.6657E-05     1.6657E-05
    2        -1.360087336423E+01     5.7921E-06     5.7921E-06    -1.0352E-08
    3        -1.360087336545E+01     1.7449E-06     1.7449E-06    -1.2234E-09
    4        -1.360087336556E+01      4.204E-07      4.204E-07     -1.088E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000042044582      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008733655583E+01  Eh
     Estimated bandgap           =   2.1672E-01  Eh
     RMS occupancy error         =   1.0442E-16
     [H,K] commutator            =   4.2045E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000491656508              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.82634290423667 |
           | Pseudopotential (local)    :      -58.36377766083963 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56384738895216 |
           | Hartree                    :       24.03198137093483 |
           | Exchange-correlation       :       -4.69871326231040 |
           | Ewald                      :       14.03944589346807 |
           | Total                      :      -13.60087336555830 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000001
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00054366719444    -13.59983857971686   0.244066    -13.60083089423982        
   1     0.00010346614192    -13.60083605767735   0.214246    -13.60086775981206        
   2     0.00004458129679    -13.60086794718980   0.181035    -13.60087289650835        
   3     0.00003099556782    -13.60087298785283   0.028601    -13.60087335882625        
   4     0.00000491656508    -13.60087336555831  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600873365558
<QC>           [rms_gradient]:         0.000004916565
<QC>       [total_force(1,1)]:         0.007262705638
<QC>       [total_force(1,2)]:         0.000898200374
<QC>       [total_force(1,3)]:        -0.008683499670
<QC>       [total_force(1,4)]:         0.001752466303
<QC>       [total_force(1,5)]:        -0.001099226155
<QC>       [total_force(1,6)]:        -0.000130646491
<QC>       [total_force(2,1)]:        -0.016367269413
<QC>       [total_force(2,2)]:        -0.000457575785
<QC>       [total_force(2,3)]:         0.017296700330
<QC>       [total_force(2,4)]:        -0.000919208352
<QC>       [total_force(2,5)]:         0.001220339446
<QC>       [total_force(2,6)]:        -0.000772986225
<QC>       [total_force(3,1)]:        -0.008392255208
<QC>       [total_force(3,2)]:         0.000346589034
<QC>       [total_force(3,3)]:         0.009040907693
<QC>       [total_force(3,4)]:        -0.000760284090
<QC>       [total_force(3,5)]:         0.000431509790
<QC>       [total_force(3,6)]:        -0.000666467219

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    9 of   18 :
  displacing atom    3 in the +ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.174165 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60496412901673 0.19261651423 0.00134164466 0.0360  0.000   12.00000000
 2    -13.79765447995212 0.13138624953 0.00169383705 0.4262 -0.681   12.00000000
 3    -13.79865143158504 0.13157743393 0.00114809927 0.0794  3.070   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.089278630704
   Final penalty energy   :       0.205827326324
   RMS occupancy error    :       0.065483
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360000706394E+01     2.4976E-03     2.4976E-03
    2        -1.360021623730E+01     4.6051E-04     4.6051E-04    -2.0917E-04
    3        -1.360023175271E+01     2.1720E-04     2.1720E-04    -1.5515E-05
    4        -1.360023358372E+01     1.0582E-04     1.0582E-04    -1.8310E-06
    5        -1.360023406826E+01     2.8198E-05     2.8198E-05    -4.8454E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002340682621E+01  Eh
     Estimated bandgap           =   2.1681E-01  Eh
     RMS occupancy error         =   1.9038E-12
     [H,K] commutator            =   2.8198E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8383E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010057749255E+01 Eh
   Predicted gain in energy  =      -7.71706663382332E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360100383216E+01     1.9774E-04     1.9774E-04
    2        -1.360100548786E+01     6.3403E-05     6.3403E-05    -1.6557E-06
    3        -1.360100564357E+01     2.5148E-05     2.5148E-05    -1.5571E-07
    4        -1.360100566824E+01     8.8445E-06     8.8445E-06    -2.4672E-08
    5        -1.360100567254E+01     2.4483E-06     2.4483E-06    -4.3000E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010056725404E+01  Eh
     Estimated bandgap           =   2.1626E-01  Eh
     RMS occupancy error         =   1.3144E-16
     [H,K] commutator            =   2.4483E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.0854E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010280735068E+01 Eh
   Predicted gain in energy  =      -2.24009664879787E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360102773709E+01     8.5547E-05     8.5547E-05
    2        -1.360102787380E+01     6.3012E-05     6.3012E-05    -1.3670E-07
    3        -1.360102804143E+01     2.6827E-05     2.6827E-05    -1.6764E-07
    4        -1.360102806330E+01     1.1191E-05     1.1191E-05    -2.1866E-08
    5        -1.360102806692E+01     5.8084E-06     5.8084E-06    -3.6206E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010280669196E+01  Eh
     Estimated bandgap           =   2.1575E-01  Eh
     RMS occupancy error         =   1.7458E-16
     [H,K] commutator            =   5.8084E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.5808E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010302846257E+01 Eh
   Predicted gain in energy  =      -2.21770610764338E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360103042574E+01     4.5164E-05     4.5164E-05
    2        -1.360103051490E+01     1.3554E-05     1.3554E-05    -8.9165E-08
    3        -1.360103052152E+01     3.5585E-06     3.5585E-06    -6.6169E-09
    4        -1.360103052191E+01      9.740E-07      9.740E-07     -3.941E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000097398180      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010305219122E+01  Eh
     Estimated bandgap           =   2.1606E-01  Eh
     RMS occupancy error         =   1.0533E-16
     [H,K] commutator            =   9.7398E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.8684E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010307989329E+01 Eh
   Predicted gain in energy  =      -2.77020760108826E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360103080316E+01     1.3368E-05     1.3368E-05
    2        -1.360103081054E+01     4.7029E-06     4.7029E-06    -7.3800E-09
    3        -1.360103081128E+01     1.1977E-06     1.1977E-06    -7.4209E-10
    4        -1.360103081133E+01      2.982E-07      2.982E-07     -4.997E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000029823007      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010308113286E+01  Eh
     Estimated bandgap           =   2.1596E-01  Eh
     RMS occupancy error         =   8.4419E-17
     [H,K] commutator            =   2.9823E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000625705828              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.88920562394195 |
           | Pseudopotential (local)    :      -58.65355551483292 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56500217111618 |
           | Hartree                    :       24.14036185536569 |
           | Exchange-correlation       :       -4.71621003701117 |
           | Ewald                      :       14.17416509009166 |
           | Total                      :      -13.60103081132860 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000001
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00048383227858    -13.60023406826209   0.239655    -13.60100577492547        
   1     0.00009085440963    -13.60100567254035   0.197266    -13.60102807350684        
   2     0.00003580829398    -13.60102806691963   0.125736    -13.60103028462574        
   3     0.00002868377099    -13.60103052191215   0.023240    -13.60103079893291        
   4     0.00000625705828    -13.60103081132861  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601030811329
<QC>           [rms_gradient]:         0.000006257058
<QC>       [total_force(1,1)]:        -0.009673782633
<QC>       [total_force(1,2)]:        -0.000984323829
<QC>       [total_force(1,3)]:         0.009342379912
<QC>       [total_force(1,4)]:         0.002226314768
<QC>       [total_force(1,5)]:        -0.000860851442
<QC>       [total_force(1,6)]:        -0.000049736777
<QC>       [total_force(2,1)]:         0.013123245815
<QC>       [total_force(2,2)]:         0.000980106273
<QC>       [total_force(2,3)]:        -0.013237766552
<QC>       [total_force(2,4)]:        -0.001104050497
<QC>       [total_force(2,5)]:         0.001239231633
<QC>       [total_force(2,6)]:        -0.001000766672
<QC>       [total_force(3,1)]:         0.011747355035
<QC>       [total_force(3,2)]:         0.001101223520
<QC>       [total_force(3,3)]:        -0.011366634763
<QC>       [total_force(3,4)]:        -0.001010448264
<QC>       [total_force(3,5)]:         0.000060583494
<QC>       [total_force(3,6)]:        -0.000532079022

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation    9 of   18 :
  displacing atom    3 in the -ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.067849 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59518390531450 0.19387058415 0.00143874202 0.0356  0.000   12.00000000
 2    -13.78582713852696 0.13341037514 0.00249536160 0.4480 -0.687   12.00000000
 3    -13.78688821709473 0.13359627974 0.00108457497 0.0789  3.035   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.077935939227
   Final penalty energy   :       0.198978698147
   RMS occupancy error    :       0.064385
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360036414483E+01     2.0409E-03     2.0409E-03
    2        -1.360050579101E+01     4.2159E-04     4.2159E-04    -1.4165E-04
    3        -1.360051905923E+01     2.2993E-04     2.2993E-04    -1.3268E-05
    4        -1.360052088615E+01     9.2880E-05     9.2880E-05    -1.8269E-06
    5        -1.360052131055E+01     2.6016E-05     2.6016E-05    -4.2440E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36005213105479E+01  Eh
     Estimated bandgap           =   2.1765E-01  Eh
     RMS occupancy error         =   1.4706E-12
     [H,K] commutator            =   2.6016E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7663E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012700942094E+01 Eh
   Predicted gain in energy  =      -7.48783661476793E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360127011185E+01     1.9612E-04     1.9612E-04
    2        -1.360127114054E+01     5.0947E-05     5.0947E-05    -1.0287E-06
    3        -1.360127126376E+01     2.2744E-05     2.2744E-05    -1.2322E-07
    4        -1.360127128731E+01     7.9974E-06     7.9974E-06    -2.3551E-08
    5        -1.360127129047E+01     3.4658E-06     3.4658E-06    -3.1634E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012712904731E+01  Eh
     Estimated bandgap           =   2.1685E-01  Eh
     RMS occupancy error         =   1.2461E-16
     [H,K] commutator            =   3.4658E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.0402E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012865557986E+01 Eh
   Predicted gain in energy  =      -1.52653254694712E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360128648308E+01     7.2454E-05     7.2454E-05
    2        -1.360128667781E+01     2.4744E-05     2.4744E-05    -1.9473E-07
    3        -1.360128670053E+01     8.1586E-06     8.1586E-06    -2.2726E-08
    4        -1.360128670309E+01     2.4721E-06     2.4721E-06    -2.5551E-09
    5        -1.360128670351E+01      8.273E-07      8.273E-07     -4.244E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000082725099      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012867035114E+01  Eh
     Estimated bandgap           =   2.1635E-01  Eh
     RMS occupancy error         =   1.2178E-16
     [H,K] commutator            =   8.2725E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.2349E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012901431510E+01 Eh
   Predicted gain in energy  =      -3.43963962023963E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360128997225E+01     4.8777E-05     4.8777E-05
    2        -1.360129006473E+01     1.6149E-05     1.6149E-05    -9.2479E-08
    3        -1.360129007449E+01     5.1225E-06     5.1225E-06    -9.7639E-09
    4        -1.360129007537E+01     1.3788E-06     1.3788E-06    -8.8525E-10
    5        -1.360129007551E+01      3.699E-07      3.699E-07     -1.337E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000036985205      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012900755083E+01  Eh
     Estimated bandgap           =   2.1672E-01  Eh
     RMS occupancy error         =   9.3088E-17
     [H,K] commutator            =   3.6985E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7870E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012902947304E+01 Eh
   Predicted gain in energy  =      -2.19222146213838E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360129028482E+01     1.1649E-05     1.1649E-05
    2        -1.360129029009E+01     4.0057E-06     4.0057E-06    -5.2679E-09
    3        -1.360129029068E+01     1.2393E-06     1.2393E-06    -5.9148E-10
    4        -1.360129029074E+01      3.257E-07      3.257E-07     -5.298E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000032573905      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012902907356E+01  Eh
     Estimated bandgap           =   2.1663E-01  Eh
     RMS occupancy error         =   8.7974E-17
     [H,K] commutator            =   3.2574E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000316348591              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83925143013610 |
           | Pseudopotential (local)    :      -58.42628943175361 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56409440763482 |
           | Hartree                    :       24.05624459140990 |
           | Exchange-correlation       :       -4.70243991826695 |
           | Ewald                      :       14.06784863010413 |
           | Total                      :      -13.60129029073562 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000002
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00047662758385    -13.60052131054793   0.239619    -13.60127009420940        
   1     0.00008040170764    -13.60127129047310   0.171291    -13.60128655579857        
   2     0.00004234936414    -13.60128670351143   0.139426    -13.60129014315105        
   3     0.00002786980649    -13.60129007550827   0.022345    -13.60129029473042        
   4     0.00000316348591    -13.60129029073561  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601290290736
<QC>           [rms_gradient]:         0.000003163486
<QC>       [total_force(1,1)]:         0.004901382974
<QC>       [total_force(1,2)]:         0.000613339158
<QC>       [total_force(1,3)]:        -0.005829990476
<QC>       [total_force(1,4)]:         0.001528529497
<QC>       [total_force(1,5)]:        -0.001179952909
<QC>       [total_force(1,6)]:        -0.000033308245
<QC>       [total_force(2,1)]:        -0.008558348603
<QC>       [total_force(2,2)]:        -0.000299028521
<QC>       [total_force(2,3)]:         0.009722194386
<QC>       [total_force(2,4)]:        -0.001049911380
<QC>       [total_force(2,5)]:         0.000370140474
<QC>       [total_force(2,6)]:        -0.000185046355
<QC>       [total_force(3,1)]:        -0.009967482035
<QC>       [total_force(3,2)]:         0.000662208266
<QC>       [total_force(3,3)]:         0.009213699816
<QC>       [total_force(3,4)]:        -0.000179598780
<QC>       [total_force(3,5)]:         0.001726821601
<QC>       [total_force(3,6)]:        -0.001455648868

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   10 of   18 :
  displacing atom    4 in the +ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.325121 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59920058020581 0.19583682500 0.00350975892 0.0354  0.000   12.00000000
 2    -13.79399014895924 0.13482989825 0.00428928827 0.3761 -0.686   12.00000000
 3    -13.79319999298660 0.13509786548 0.00252973351 0.0801  2.305   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.097508472817
   Final penalty energy   :       0.213816457628
   RMS occupancy error    :       0.066742
   Occupancy bounds       : [-0.101, 1.099]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359134722431E+01     2.5353E-03     2.5353E-03
    2        -1.359161014452E+01     8.5493E-04     8.5493E-04    -2.6292E-04
    3        -1.359164015651E+01     3.0095E-04     3.0095E-04    -3.0012E-05
    4        -1.359164291312E+01     7.3121E-05     7.3121E-05    -2.7566E-06
    5        -1.359164317199E+01     1.9882E-05     1.9882E-05    -2.5886E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35916431719873E+01  Eh
     Estimated bandgap           =   2.4017E-01  Eh
     RMS occupancy error         =   2.3087E-13
     [H,K] commutator            =   1.9882E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1637E-03 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35961771683521E+01 Eh
   Predicted gain in energy  =      -4.53399636481144E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359617755496E+01     7.5601E-04     7.5601E-04
    2        -1.359619924077E+01     1.8937E-04     1.8937E-04    -2.1686E-05
    3        -1.359620059536E+01     6.6543E-05     6.6543E-05    -1.3546E-06
    4        -1.359620073950E+01     1.5745E-05     1.5745E-05    -1.4413E-07
    5        -1.359620075041E+01     2.3145E-06     2.3145E-06    -1.0909E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35962007504062E+01  Eh
     Estimated bandgap           =   2.3792E-01  Eh
     RMS occupancy error         =   3.1219E-16
     [H,K] commutator            =   2.3145E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.1904E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35963870523976E+01 Eh
   Predicted gain in energy  =      -1.86301991345061E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359638740738E+01     3.0766E-04     3.0766E-04
    2        -1.359639063935E+01     7.7972E-05     7.7972E-05    -3.2320E-06
    3        -1.359639087167E+01     2.9944E-05     2.9944E-05    -2.3231E-07
    4        -1.359639090387E+01     6.6808E-06     6.6808E-06    -3.2205E-08
    5        -1.359639090645E+01     1.6515E-06     1.6515E-06    -2.5729E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35963909064456E+01  Eh
     Estimated bandgap           =   2.3674E-01  Eh
     RMS occupancy error         =   9.7294E-17
     [H,K] commutator            =   1.6515E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4641E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35963931690465E+01 Eh
   Predicted gain in energy  =      -2.26260090308017E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359639314744E+01     3.3437E-05     3.3437E-05
    2        -1.359639319013E+01     1.2346E-05     1.2346E-05    -4.2684E-08
    3        -1.359639319563E+01     3.6098E-06     3.6098E-06    -5.4984E-09
    4        -1.359639319612E+01      9.797E-07      9.797E-07     -4.895E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000097973779      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35963931961151E+01  Eh
     Estimated bandgap           =   2.3648E-01  Eh
     RMS occupancy error         =   1.2474E-16
     [H,K] commutator            =   9.7974E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7447E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35963936880529E+01 Eh
   Predicted gain in energy  =      -4.91937745650262E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359639368110E+01     1.6345E-05     1.6345E-05
    2        -1.359639369190E+01     6.4442E-06     6.4442E-06    -1.0805E-08
    3        -1.359639369329E+01     1.4344E-06     1.4344E-06    -1.3838E-09
    4        -1.359639369336E+01      3.477E-07      3.477E-07     -7.578E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000034773895      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35963936933637E+01  Eh
     Estimated bandgap           =   2.3662E-01  Eh
     RMS occupancy error         =   1.2303E-16
     [H,K] commutator            =   3.4774E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00001937681270              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.91169848472327 |
           | Pseudopotential (local)    :      -58.96724789178747 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.57949175148712 |
           | Hartree                    :       24.27569082133869 |
           | Exchange-correlation       :       -4.72114789031873 |
           | Ewald                      :       14.32512103119344 |
           | Total                      :      -13.59639369336367 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00116370283399    -13.59164317198727   0.243400    -13.59617716835208        
   1     0.00021903668900    -13.59620075040625   0.280862    -13.59638705239759        
   2     0.00004464069898    -13.59639090644558   0.080704    -13.59639316904649        
   3     0.00002744718411    -13.59639319611514   0.047472    -13.59639368805289        
   4     0.00001937681270    -13.59639369336367  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.596393693364
<QC>           [rms_gradient]:         0.000019376813
<QC>       [total_force(1,1)]:         0.076110155359
<QC>       [total_force(1,2)]:         0.002759590923
<QC>       [total_force(1,3)]:         0.004273165121
<QC>       [total_force(1,4)]:        -0.108031320358
<QC>       [total_force(1,5)]:         0.012054680926
<QC>       [total_force(1,6)]:         0.012833728029
<QC>       [total_force(2,1)]:        -0.000802857499
<QC>       [total_force(2,2)]:        -0.000060455663
<QC>       [total_force(2,3)]:        -0.001020707226
<QC>       [total_force(2,4)]:         0.002236260068
<QC>       [total_force(2,5)]:        -0.008533087192
<QC>       [total_force(2,6)]:         0.008180847511
<QC>       [total_force(3,1)]:         0.005018546305
<QC>       [total_force(3,2)]:         0.000797262681
<QC>       [total_force(3,3)]:        -0.000771042333
<QC>       [total_force(3,4)]:        -0.005108376085
<QC>       [total_force(3,5)]:        -0.005536440912
<QC>       [total_force(3,6)]:         0.005600050344

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   10 of   18 :
  displacing atom    4 in the -ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               13.938096 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.58422787878939 0.19364750158 0.00335043624 0.0356  0.000   12.00000000
 2    -13.77123872389424 0.13390500310 0.00248302276 0.5345 -0.691   12.00000000
 3    -13.77089392237841 0.13400955980 0.00270607125 0.0774  2.972   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.051422322505
   Final penalty energy   :       0.187776000893
   RMS occupancy error    :       0.062546
   Occupancy bounds       : [-0.087, 1.096]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359181922961E+01     2.8316E-03     2.8316E-03
    2        -1.359209951940E+01     6.2629E-04     6.2629E-04    -2.8029E-04
    3        -1.359212035413E+01     2.1361E-04     2.1361E-04    -2.0835E-05
    4        -1.359212161132E+01     6.4218E-05     6.4218E-05    -1.2572E-06
    5        -1.359212184335E+01     4.0298E-05     4.0298E-05    -2.3203E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35921218433512E+01  Eh
     Estimated bandgap           =   1.9684E-01  Eh
     RMS occupancy error         =   1.1360E-13
     [H,K] commutator            =   4.0298E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1422E-03 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35964722111461E+01 Eh
   Predicted gain in energy  =      -4.35036779490439E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359647218176E+01     7.8577E-04     7.8577E-04
    2        -1.359649403789E+01     1.4617E-04     1.4617E-04    -2.1856E-05
    3        -1.359649509060E+01     5.1785E-05     5.1785E-05    -1.0527E-06
    4        -1.359649517999E+01     1.6669E-05     1.6669E-05    -8.9395E-08
    5        -1.359649519200E+01     5.5932E-06     5.5932E-06    -1.2009E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35964951920028E+01  Eh
     Estimated bandgap           =   1.9769E-01  Eh
     RMS occupancy error         =   2.9499E-16
     [H,K] commutator            =   5.5932E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2702E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967137827581E+01 Eh
   Predicted gain in energy  =      -2.18590755290293E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359671127767E+01     3.8154E-04     3.8154E-04
    2        -1.359671578670E+01     7.5524E-05     7.5524E-05    -4.5090E-06
    3        -1.359671603394E+01     3.4701E-05     3.4701E-05    -2.4725E-07
    4        -1.359671608180E+01     8.6914E-06     8.6914E-06    -4.7858E-08
    5        -1.359671608580E+01     3.3837E-06     3.3837E-06    -3.9993E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967160858001E+01  Eh
     Estimated bandgap           =   1.9724E-01  Eh
     RMS occupancy error         =   1.6096E-16
     [H,K] commutator            =   3.3837E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.7555E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967420866636E+01 Eh
   Predicted gain in energy  =      -2.60008635155629E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359674178807E+01     1.8693E-04     1.8693E-04
    2        -1.359674298793E+01     3.8374E-05     3.8374E-05    -1.1999E-06
    3        -1.359674305202E+01     1.6801E-05     1.6801E-05    -6.4084E-08
    4        -1.359674306182E+01     3.7906E-06     3.7906E-06    -9.8046E-09
    5        -1.359674306276E+01     1.0084E-06     1.0084E-06    -9.4055E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967430627642E+01  Eh
     Estimated bandgap           =   1.9672E-01  Eh
     RMS occupancy error         =   1.0496E-16
     [H,K] commutator            =   1.0084E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7455E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967458960964E+01 Eh
   Predicted gain in energy  =      -2.83333221062776E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359674580820E+01     6.8868E-05     6.8868E-05
    2        -1.359674597657E+01     1.4159E-05     1.4159E-05    -1.6837E-07
    3        -1.359674598593E+01     4.7706E-06     4.7706E-06    -9.3570E-09
    4        -1.359674598660E+01     1.0857E-06     1.0857E-06    -6.7071E-10
    5        -1.359674598667E+01      2.834E-07      2.834E-07     -7.544E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000028339813      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967459866749E+01  Eh
     Estimated bandgap           =   1.9699E-01  Eh
     RMS occupancy error         =   1.2455E-16
     [H,K] commutator            =   2.8340E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0700E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35967463323498E+01 Eh
   Predicted gain in energy  =      -3.45674941115703E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359674632382E+01     2.2050E-05     2.2050E-05
    2        -1.359674634112E+01     4.6326E-06     4.6326E-06    -1.7298E-08
    3        -1.359674634211E+01     1.6065E-06     1.6065E-06    -9.9661E-10
    4        -1.359674634219E+01      3.599E-07      3.599E-07     -7.665E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000035985184      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35967463421914E+01  Eh
     Estimated bandgap           =   1.9690E-01  Eh
     RMS occupancy error         =   1.0365E-16
     [H,K] commutator            =   3.5985E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000432355654              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.82165501958825 |
           | Pseudopotential (local)    :      -58.13651211667545 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.55598165777003 |
           | Hartree                    :       23.92247199367850 |
           | Exchange-correlation       :       -4.69843888324032 |
           | Ewald                      :       13.93809598668759 |
           | Total                      :      -13.59674634219139 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999996
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00114215976751    -13.59212184335123   0.242435    -13.59647221114614        
   1     0.00022702446027    -13.59649519200277   0.306640    -13.59671378275806        
   2     0.00008755538943    -13.59671608580013   0.243649    -13.59674208666364        
   3     0.00003745479646    -13.59674306276415   0.146827    -13.59674589609636        
   4     0.00003069954365    -13.59674598667486   0.027547    -13.59674633234980        
   5     0.00000432355654    -13.59674634219138  <-- CG                                 
 
<QC>        [NGWF iterations]:                      6
<QC>           [total_energy]:       -13.596746342191
<QC>           [rms_gradient]:         0.000004323557
<QC>       [total_force(1,1)]:        -0.065663234863
<QC>       [total_force(1,2)]:        -0.001910156973
<QC>       [total_force(1,3)]:        -0.000422628383
<QC>       [total_force(1,4)]:         0.093261496471
<QC>       [total_force(1,5)]:        -0.013265234542
<QC>       [total_force(1,6)]:        -0.012000241710
<QC>       [total_force(2,1)]:         0.003393245189
<QC>       [total_force(2,2)]:         0.000602793446
<QC>       [total_force(2,3)]:        -0.001309272471
<QC>       [total_force(2,4)]:        -0.003667664469
<QC>       [total_force(2,5)]:         0.011588366888
<QC>       [total_force(2,6)]:        -0.010607468583
<QC>       [total_force(3,1)]:        -0.001373043336
<QC>       [total_force(3,2)]:         0.000865579413
<QC>       [total_force(3,3)]:        -0.001397890187
<QC>       [total_force(3,4)]:         0.002552227457
<QC>       [total_force(3,5)]:         0.008189486872
<QC>       [total_force(3,6)]:        -0.008836360219

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   11 of   18 :
  displacing atom    4 in the +ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.114160 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59496852234071 0.19417328726 0.00315805284 0.0356  0.000   12.00000000
 2    -13.78582034320604 0.13372617265 0.00328023361 0.4290 -0.687   12.00000000
 3    -13.78561140499353 0.13392070439 0.00240625067 0.0794  2.655   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.078763136211
   Final penalty energy   :       0.201749656815
   RMS occupancy error    :       0.064831
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359591161295E+01     2.6008E-03     2.6008E-03
    2        -1.359616663614E+01     6.5628E-04     6.5628E-04    -2.5502E-04
    3        -1.359618946823E+01     1.6422E-04     1.6422E-04    -2.2832E-05
    4        -1.359619108213E+01     4.5552E-05     4.5552E-05    -1.6139E-06
    5        -1.359619117351E+01     2.0263E-05     2.0263E-05    -9.1376E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35961911735059E+01  Eh
     Estimated bandgap           =   2.1628E-01  Eh
     RMS occupancy error         =   3.4636E-14
     [H,K] commutator            =   2.0263E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.4354E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35992259714824E+01 Eh
   Predicted gain in energy  =      -3.03479797650930E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359922466066E+01     5.1232E-04     5.1232E-04
    2        -1.359923440449E+01     9.5465E-05     9.5465E-05    -9.7438E-06
    3        -1.359923489433E+01     3.1408E-05     3.1408E-05    -4.8985E-07
    4        -1.359923493562E+01     1.6133E-05     1.6133E-05    -4.1285E-08
    5        -1.359923494667E+01     5.0476E-06     5.0476E-06    -1.1055E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35992349466717E+01  Eh
     Estimated bandgap           =   2.1571E-01  Eh
     RMS occupancy error         =   5.6999E-16
     [H,K] commutator            =   5.0476E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9389E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35993822094505E+01 Eh
   Predicted gain in energy  =      -1.47262778783741E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359938142484E+01     1.7381E-04     1.7381E-04
    2        -1.359938279212E+01     4.0627E-05     4.0627E-05    -1.3673E-06
    3        -1.359938286131E+01     1.1494E-05     1.1494E-05    -6.9198E-08
    4        -1.359938286649E+01     5.2690E-06     5.2690E-06    -5.1810E-09
    5        -1.359938286769E+01     1.5936E-06     1.5936E-06    -1.1952E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35993828676901E+01  Eh
     Estimated bandgap           =   2.1495E-01  Eh
     RMS occupancy error         =   9.2215E-17
     [H,K] commutator            =   1.5936E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4848E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35993855831316E+01 Eh
   Predicted gain in energy  =      -2.71544148588987E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359938554974E+01     3.7979E-05     3.7979E-05
    2        -1.359938561309E+01     1.0085E-05     1.0085E-05    -6.3350E-08
    3        -1.359938561731E+01     1.8072E-06     1.8072E-06    -4.2177E-09
    4        -1.359938561746E+01      9.808E-07      9.808E-07     -1.559E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000098083975      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35993856174613E+01  Eh
     Estimated bandgap           =   2.1470E-01  Eh
     RMS occupancy error         =   5.7486E-17
     [H,K] commutator            =   9.8084E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6150E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35993861398458E+01 Eh
   Predicted gain in energy  =      -5.22384526746578E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359938612965E+01     1.9551E-05     1.9551E-05
    2        -1.359938614588E+01     5.2325E-06     5.2325E-06    -1.6231E-08
    3        -1.359938614701E+01      8.832E-07      8.832E-07     -1.132E-09

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000088324545      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35993861470146E+01  Eh
     Estimated bandgap           =   2.1483E-01  Eh
     RMS occupancy error         =   1.3200E-16
     [H,K] commutator            =   8.8325E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00001921775074              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.86366461094708 |
           | Pseudopotential (local)    :      -58.52104066834568 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56490331458879 |
           | Hartree                    :       24.08748109932023 |
           | Exchange-correlation       :       -4.70855401976618 |
           | Ewald                      :       14.11415951624120 |
           | Total                      :      -13.59938614701456 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00094354010338    -13.59619117350586   0.247818    -13.59922597148237        
   1     0.00019389463775    -13.59923494667170   0.283811    -13.59938220945048        
   2     0.00004484848938    -13.59938286769012   0.097933    -13.59938558313161        
   3     0.00002615012093    -13.59938561746131   0.055535    -13.59938613984583        
   4     0.00001921775074    -13.59938614701456  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.599386147015
<QC>           [rms_gradient]:         0.000019217751
<QC>       [total_force(1,1)]:        -0.005261842251
<QC>       [total_force(1,2)]:         0.002017723740
<QC>       [total_force(1,3)]:        -0.000900636811
<QC>       [total_force(1,4)]:         0.008683818598
<QC>       [total_force(1,5)]:        -0.012302995259
<QC>       [total_force(1,6)]:         0.007763931983
<QC>       [total_force(2,1)]:         0.012147780419
<QC>       [total_force(2,2)]:        -0.000666833201
<QC>       [total_force(2,3)]:        -0.001863857510
<QC>       [total_force(2,4)]:        -0.044898151339
<QC>       [total_force(2,5)]:         0.019888079188
<QC>       [total_force(2,6)]:         0.015392982443
<QC>       [total_force(3,1)]:         0.004078293546
<QC>       [total_force(3,2)]:         0.001002547740
<QC>       [total_force(3,3)]:        -0.001178137220
<QC>       [total_force(3,4)]:        -0.024641058791
<QC>       [total_force(3,5)]:         0.012515366694
<QC>       [total_force(3,6)]:         0.008222988030

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   11 of   18 :
  displacing atom    4 in the -ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.124123 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59577603753412 0.19421505292 0.00315451327 0.0356  0.000   12.00000000
 2    -13.78680459203121 0.13375352172 0.00333922173 0.4252 -0.687   12.00000000
 3    -13.78657079723863 0.13395186886 0.00239349016 0.0794  2.625   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.080333743431
   Final penalty energy   :       0.202430190963
   RMS occupancy error    :       0.064941
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359620832121E+01     2.5807E-03     2.5807E-03
    2        -1.359646185356E+01     6.6209E-04     6.6209E-04    -2.5353E-04
    3        -1.359648444751E+01     1.6466E-04     1.6466E-04    -2.2594E-05
    4        -1.359648607139E+01     4.5089E-05     4.5089E-05    -1.6239E-06
    5        -1.359648616491E+01     1.9622E-05     1.9622E-05    -9.3529E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35964861649143E+01  Eh
     Estimated bandgap           =   2.1729E-01  Eh
     RMS occupancy error         =   3.4178E-14
     [H,K] commutator            =   1.9622E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.4257E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35995260628339E+01 Eh
   Predicted gain in energy  =      -3.03989791957981E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359952626620E+01     5.1300E-04     5.1300E-04
    2        -1.359953608869E+01     9.5480E-05     9.5480E-05    -9.8225E-06
    3        -1.359953658497E+01     2.8433E-05     2.8433E-05    -4.9628E-07
    4        -1.359953662329E+01     1.4854E-05     1.4854E-05    -3.8318E-08
    5        -1.359953663172E+01     4.9235E-06     4.9235E-06    -8.4242E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35995366317153E+01  Eh
     Estimated bandgap           =   2.1660E-01  Eh
     RMS occupancy error         =   3.9425E-16
     [H,K] commutator            =   4.9235E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9412E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35996870977223E+01 Eh
   Predicted gain in energy  =      -1.50466006992644E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359968567278E+01     1.7066E-04     1.7066E-04
    2        -1.359968702428E+01     3.7005E-05     3.7005E-05    -1.3515E-06
    3        -1.359968708412E+01     9.1252E-06     9.1252E-06    -5.9846E-08
    4        -1.359968708829E+01     4.0028E-06     4.0028E-06    -4.1710E-09
    5        -1.359968708889E+01     1.4958E-06     1.4958E-06    -5.9165E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35996870888861E+01  Eh
     Estimated bandgap           =   2.1579E-01  Eh
     RMS occupancy error         =   7.9435E-17
     [H,K] commutator            =   1.4958E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4416E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35996896980883E+01 Eh
   Predicted gain in energy  =      -2.60920215389149E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359968960238E+01     3.5674E-05     3.5674E-05
    2        -1.359968965909E+01     9.3769E-06     9.3769E-06    -5.6702E-08
    3        -1.359968966269E+01     1.5935E-06     1.5935E-06    -3.6073E-09
    4        -1.359968966283E+01      8.245E-07      8.245E-07     -1.360E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000082451168      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35996896628300E+01  Eh
     Estimated bandgap           =   2.1554E-01  Eh
     RMS occupancy error         =   7.4171E-17
     [H,K] commutator            =   8.2451E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7600E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35996903045864E+01 Eh
   Predicted gain in energy  =      -6.41756429331508E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359969029261E+01     2.0576E-05     2.0576E-05
    2        -1.359969031077E+01     5.4838E-06     5.4838E-06    -1.8167E-08
    3        -1.359969031202E+01      7.998E-07      7.998E-07     -1.249E-09

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000079979070      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35996903120235E+01  Eh
     Estimated bandgap           =   2.1569E-01  Eh
     RMS occupancy error         =   1.3677E-16
     [H,K] commutator            =   7.9979E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.0682E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.35996903825530E+01 Eh
   Predicted gain in energy  =      -7.05295075675849E-08 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359969038143E+01     6.4821E-06     6.4821E-06
    2        -1.359969038323E+01     1.6693E-06     1.6693E-06    -1.8056E-09
    3        -1.359969038334E+01      2.429E-07      2.429E-07     -1.116E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000024288330      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35996903833430E+01  Eh
     Estimated bandgap           =   2.1564E-01  Eh
     RMS occupancy error         =   9.6173E-17
     [H,K] commutator            =   2.4288E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000287134634              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.86559967403845 |
           | Pseudopotential (local)    :      -58.54228392252732 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56540942761057 |
           | Hartree                    :       24.09647837295818 |
           | Exchange-correlation       :       -4.70901677391771 |
           | Ewald                      :       14.12412283849485 |
           | Total                      :      -13.59969038334297 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999996
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00094256978909    -13.59648616491433   0.248746    -13.59952606283391        
   1     0.00019411923835    -13.59953663171527   0.289287    -13.59968709772227        
   2     0.00004441647369    -13.59968708888614   0.096599    -13.59968969808829        
   3     0.00002759957680    -13.59968966283000   0.061248    -13.59969030458643        
   4     0.00002068193637    -13.59969031202347   0.012128    -13.59969038255297        
   5     0.00000287134634    -13.59969038334296  <-- CG                                 
 
<QC>        [NGWF iterations]:                      6
<QC>           [total_energy]:       -13.599690383343
<QC>           [rms_gradient]:         0.000002871346
<QC>       [total_force(1,1)]:        -0.001036412548
<QC>       [total_force(1,2)]:        -0.002343992334
<QC>       [total_force(1,3)]:         0.003595644816
<QC>       [total_force(1,4)]:         0.002713635933
<QC>       [total_force(1,5)]:         0.007380905739
<QC>       [total_force(1,6)]:        -0.010309781605
<QC>       [total_force(2,1)]:        -0.008400054129
<QC>       [total_force(2,2)]:         0.001256983640
<QC>       [total_force(2,3)]:        -0.000121554870
<QC>       [total_force(2,4)]:         0.041231458349
<QC>       [total_force(2,5)]:        -0.015846131865
<QC>       [total_force(2,6)]:        -0.018120701125
<QC>       [total_force(3,1)]:        -0.001921852742
<QC>       [total_force(3,2)]:         0.000688284623
<QC>       [total_force(3,3)]:        -0.001068639027
<QC>       [total_force(3,4)]:         0.023360217107
<QC>       [total_force(3,5)]:        -0.008169234072
<QC>       [total_force(3,6)]:        -0.012888775889

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   12 of   18 :
  displacing atom    4 in the +ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.124058 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59645808467831 0.19401392209 0.00274208484 0.0357  0.000   12.00000000
 2    -13.78814905553693 0.13331848471 0.00312140723 0.4377 -0.686   12.00000000
 3    -13.78860376425617 0.13352454678 0.00216074813 0.0791  2.872   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.081132701451
   Final penalty energy   :       0.202052672599
   RMS occupancy error    :       0.064880
   Occupancy bounds       : [-0.094, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359741243097E+01     2.5768E-03     2.5768E-03
    2        -1.359766493393E+01     7.0791E-04     7.0791E-04    -2.5250E-04
    3        -1.359769279506E+01     1.8577E-04     1.8577E-04    -2.7861E-05
    4        -1.359769497809E+01     7.1022E-05     7.1022E-05    -2.1830E-06
    5        -1.359769513139E+01     2.2961E-05     2.2961E-05    -1.5331E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35976951313950E+01  Eh
     Estimated bandgap           =   2.1746E-01  Eh
     RMS occupancy error         =   1.0962E-13
     [H,K] commutator            =   2.2961E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.5852E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36001836994480E+01 Eh
   Predicted gain in energy  =      -2.48856805302999E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360018257505E+01     3.8106E-04     3.8106E-04
    2        -1.360018841644E+01     8.7351E-05     8.7351E-05    -5.8414E-06
    3        -1.360018885900E+01     3.6409E-05     3.6409E-05    -4.4256E-07
    4        -1.360018891468E+01     1.8619E-05     1.8619E-05    -5.5685E-08
    5        -1.360018892959E+01     4.9900E-06     4.9900E-06    -1.4914E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36001889295943E+01  Eh
     Estimated bandgap           =   2.1674E-01  Eh
     RMS occupancy error         =   1.6557E-15
     [H,K] commutator            =   4.9900E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7459E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36003017492441E+01 Eh
   Predicted gain in energy  =      -1.12819649737972E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360030157067E+01     1.3156E-04     1.3156E-04
    2        -1.360030238431E+01     3.0865E-05     3.0865E-05    -8.1365E-07
    3        -1.360030242425E+01     9.1348E-06     9.1348E-06    -3.9941E-08
    4        -1.360030242773E+01     4.5795E-06     4.5795E-06    -3.4808E-09
    5        -1.360030242865E+01     1.4458E-06     1.4458E-06    -9.1844E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36003024286528E+01  Eh
     Estimated bandgap           =   2.1595E-01  Eh
     RMS occupancy error         =   1.0215E-16
     [H,K] commutator            =   1.4458E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.2634E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36003026469009E+01 Eh
   Predicted gain in energy  =      -2.18248176864222E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360030264396E+01     1.0167E-05     1.0167E-05
    2        -1.360030264859E+01     2.7716E-06     2.7716E-06    -4.6301E-09
    3        -1.360030264890E+01      7.358E-07      7.358E-07     -3.057E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000073580623      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36003026488964E+01  Eh
     Estimated bandgap           =   2.1587E-01  Eh
     RMS occupancy error         =   1.1225E-16
     [H,K] commutator            =   7.3581E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00001509517112              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.86383546690689 |
           | Pseudopotential (local)    :      -58.54267522045134 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56537948427757 |
           | Hartree                    :       24.09789539209840 |
           | Exchange-correlation       :       -4.70879624385339 |
           | Ewald                      :       14.12405847212547 |
           | Total                      :      -13.60030264889640 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000004
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00085851843966    -13.59769513139495   0.245456    -13.60018369944798        
   1     0.00017459281908    -13.60018892959434   0.268546    -13.60030174924408        
   2     0.00002263418359    -13.60030242865277   0.030783    -13.60030264690094        
   3     0.00001509517112    -13.60030264889640  <-- CG                                 
 
<QC>        [NGWF iterations]:                      4
<QC>           [total_energy]:       -13.600302648896
<QC>           [rms_gradient]:         0.000015095171
<QC>       [total_force(1,1)]:         0.000209394240
<QC>       [total_force(1,2)]:         0.001432193882
<QC>       [total_force(1,3)]:        -0.000141587064
<QC>       [total_force(1,4)]:         0.000163697102
<QC>       [total_force(1,5)]:        -0.008088094417
<QC>       [total_force(1,6)]:         0.006424396257
<QC>       [total_force(2,1)]:         0.004726132251
<QC>       [total_force(2,2)]:         0.000293136175
<QC>       [total_force(2,3)]:        -0.001065089138
<QC>       [total_force(2,4)]:        -0.024824001341
<QC>       [total_force(2,5)]:         0.011745615691
<QC>       [total_force(2,6)]:         0.009124206363
<QC>       [total_force(3,1)]:         0.009191794431
<QC>       [total_force(3,2)]:        -0.000215216616
<QC>       [total_force(3,3)]:        -0.002111222442
<QC>       [total_force(3,4)]:        -0.026828586674
<QC>       [total_force(3,5)]:         0.010241085065
<QC>       [total_force(3,6)]:         0.009722146236

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   12 of   18 :
  displacing atom    4 in the -ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.107197 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59563667684761 0.19394669017 0.00273027116 0.0357  0.000   12.00000000
 2    -13.78703256070129 0.13328348250 0.00302251763 0.4477 -0.686   12.00000000
 3    -13.78752667341468 0.13348393353 0.00217300855 0.0789  2.944   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.078732405003
   Final penalty energy   :       0.200623573397
   RMS occupancy error    :       0.064650
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359745597149E+01     2.6047E-03     2.6047E-03
    2        -1.359771153084E+01     7.0494E-04     7.0494E-04    -2.5556E-04
    3        -1.359774039011E+01     1.9682E-04     1.9682E-04    -2.8859E-05
    4        -1.359774269721E+01     4.3609E-05     4.3609E-05    -2.3071E-06
    5        -1.359774278752E+01     1.3304E-05     1.3304E-05    -9.0312E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35977427875227E+01  Eh
     Estimated bandgap           =   2.1588E-01  Eh
     RMS occupancy error         =   3.6117E-14
     [H,K] commutator            =   1.3304E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.6071E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36002409643488E+01 Eh
   Predicted gain in energy  =      -2.49817682607123E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360024218780E+01     3.8370E-04     3.8370E-04
    2        -1.360024804434E+01     8.8120E-05     8.8120E-05    -5.8565E-06
    3        -1.360024847031E+01     3.3815E-05     3.3815E-05    -4.2597E-07
    4        -1.360024852121E+01     1.7789E-05     1.7789E-05    -5.0899E-08
    5        -1.360024853384E+01     4.6902E-06     4.6902E-06    -1.2637E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002485338448E+01  Eh
     Estimated bandgap           =   2.1533E-01  Eh
     RMS occupancy error         =   1.0004E-15
     [H,K] commutator            =   4.6902E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.7813E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36003695755362E+01 Eh
   Predicted gain in energy  =      -1.21041691453883E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360036883870E+01     1.4205E-04     1.4205E-04
    2        -1.360036976367E+01     3.5063E-05     3.5063E-05    -9.2496E-07
    3        -1.360036981685E+01     8.7693E-06     8.7693E-06    -5.3182E-08
    4        -1.360036982088E+01     4.3439E-06     4.3439E-06    -4.0299E-09
    5        -1.360036982159E+01     1.6402E-06     1.6402E-06    -7.1281E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36003698215901E+01  Eh
     Estimated bandgap           =   2.1458E-01  Eh
     RMS occupancy error         =   7.8294E-17
     [H,K] commutator            =   1.6402E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.4007E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36003700855858E+01 Eh
   Predicted gain in energy  =      -2.63995726612620E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360037008201E+01     1.1608E-05     1.1608E-05
    2        -1.360037008786E+01     3.1485E-06     3.1485E-06    -5.8509E-09
    3        -1.360037008828E+01      7.444E-07      7.444E-07     -4.137E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000074438588      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36003700882783E+01  Eh
     Estimated bandgap           =   2.1449E-01  Eh
     RMS occupancy error         =   8.0731E-17
     [H,K] commutator            =   7.4439E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00001611469749              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.85986515704683 |
           | Pseudopotential (local)    :      -58.50677839474195 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56443932154969 |
           | Hartree                    :       24.08276967250109 |
           | Exchange-correlation       :       -4.70786316091299 |
           | Ewald                      :       14.10719731627898 |
           | Total                      :      -13.60037008827835 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999996
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00086071418285    -13.59774278752275   0.245148    -13.60024096434882        
   1     0.00017813487749    -13.60024853384479   0.276334    -13.60036957553625        
   2     0.00002400691591    -13.60036982159009   0.033326    -13.60037008558581        
   3     0.00001611469749    -13.60037008827834  <-- CG                                 
 
<QC>        [NGWF iterations]:                      4
<QC>           [total_energy]:       -13.600370088278
<QC>           [rms_gradient]:         0.000016114697
<QC>       [total_force(1,1)]:        -0.006244295872
<QC>       [total_force(1,2)]:        -0.001739909558
<QC>       [total_force(1,3)]:         0.002818473005
<QC>       [total_force(1,4)]:         0.007871319531
<QC>       [total_force(1,5)]:         0.005025637796
<QC>       [total_force(1,6)]:        -0.007731224902
<QC>       [total_force(2,1)]:        -0.001227248804
<QC>       [total_force(2,2)]:         0.000294733804
<QC>       [total_force(2,3)]:        -0.001276424381
<QC>       [total_force(2,4)]:         0.022956015239
<QC>       [total_force(2,5)]:        -0.008806015223
<QC>       [total_force(2,6)]:        -0.011941060635
<QC>       [total_force(3,1)]:        -0.007270674772
<QC>       [total_force(3,2)]:         0.001457326300
<QC>       [total_force(3,3)]:        -0.000215147958
<QC>       [total_force(3,4)]:         0.027201089597
<QC>       [total_force(3,5)]:        -0.009197531667
<QC>       [total_force(3,6)]:        -0.011975061501

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   13 of   18 :
  displacing atom    5 in the +ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.198211 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60475460551194 0.19267363329 0.00158077072 0.0360  0.000   12.00000000
 2    -13.79778872986876 0.13135885481 0.00154179949 0.3918 -0.681   12.00000000
 3    -13.79862677523514 0.13152701888 0.00127913850 0.0803  2.722   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.092173891540
   Final penalty energy   :       0.208558987020
   RMS occupancy error    :       0.065916
   Occupancy bounds       : [-0.095, 1.099]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359984607675E+01     2.4543E-03     2.4543E-03
    2        -1.360004524268E+01     3.3372E-04     3.3372E-04    -1.9917E-04
    3        -1.360005055039E+01     1.2223E-04     1.2223E-04    -5.3077E-06
    4        -1.360005102512E+01     4.1715E-05     4.1715E-05    -4.7473E-07
    5        -1.360005111563E+01     9.6908E-06     9.6908E-06    -9.0509E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36000511156250E+01  Eh
     Estimated bandgap           =   2.1732E-01  Eh
     RMS occupancy error         =   2.3000E-14
     [H,K] commutator            =   9.6908E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9419E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008511284143E+01 Eh
   Predicted gain in energy  =      -8.00012789264670E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360085112227E+01     2.0557E-04     2.0557E-04
    2        -1.360085283932E+01     6.3790E-05     6.3790E-05    -1.7170E-06
    3        -1.360085298452E+01     2.3038E-05     2.3038E-05    -1.4520E-07
    4        -1.360085300531E+01     6.4999E-06     6.4999E-06    -2.0795E-08
    5        -1.360085300755E+01     1.8253E-06     1.8253E-06    -2.2424E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008530075528E+01  Eh
     Estimated bandgap           =   2.1678E-01  Eh
     RMS occupancy error         =   1.2027E-16
     [H,K] commutator            =   1.8253E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.9524E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008744862533E+01 Eh
   Predicted gain in energy  =      -2.14787004324535E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360087438547E+01     8.9804E-05     8.9804E-05
    2        -1.360087469672E+01     3.4580E-05     3.4580E-05    -3.1125E-07
    3        -1.360087473841E+01     9.3143E-06     9.3143E-06    -4.1687E-08
    4        -1.360087474212E+01     2.8164E-06     2.8164E-06    -3.7127E-09
    5        -1.360087474256E+01      7.741E-07      7.741E-07     -4.372E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000077407431      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008747425592E+01  Eh
     Estimated bandgap           =   2.1627E-01  Eh
     RMS occupancy error         =   9.6132E-17
     [H,K] commutator            =   7.7407E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7090E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008770785933E+01 Eh
   Predicted gain in energy  =      -2.33603415900063E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360087703536E+01     4.3812E-05     4.3812E-05
    2        -1.360087711304E+01     1.5521E-05     1.5521E-05    -7.7683E-08
    3        -1.360087712147E+01     4.3993E-06     4.3993E-06    -8.4325E-09
    4        -1.360087712216E+01     1.2124E-06     1.2124E-06    -6.8805E-10
    5        -1.360087712225E+01      3.002E-07      3.002E-07     -8.709E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000030018732      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008771222489E+01  Eh
     Estimated bandgap           =   2.1657E-01  Eh
     RMS occupancy error         =   1.1295E-16
     [H,K] commutator            =   3.0019E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6739E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008773337160E+01 Eh
   Predicted gain in energy  =      -2.11467058974790E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360087733069E+01     1.2241E-05     1.2241E-05
    2        -1.360087733675E+01     4.5168E-06     4.5168E-06    -6.0590E-09
    3        -1.360087733746E+01     1.2259E-06     1.2259E-06    -7.0411E-10
    4        -1.360087733751E+01      3.460E-07      3.460E-07     -5.536E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000034595037      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008773375124E+01  Eh
     Estimated bandgap           =   2.1649E-01  Eh
     RMS occupancy error         =   7.4244E-17
     [H,K] commutator            =   3.4595E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000409615453              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.89510489965684 |
           | Pseudopotential (local)    :      -58.70810354241894 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56588996713608 |
           | Hartree                    :       24.16584184149826 |
           | Exchange-correlation       :       -4.71782114912119 |
           | Ewald                      :       14.19821064573654 |
           | Total                      :      -13.60087733751240 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999998
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00049418679453    -13.60005111562501   0.238143    -13.60085112841428        
   1     0.00008952439320    -13.60085300755284   0.194145    -13.60087448625327        
   2     0.00003709039541    -13.60087474255916   0.123447    -13.60087707859332        
   3     0.00002673851549    -13.60087712224894   0.021912    -13.60087733371600        
   4     0.00000409615453    -13.60087733751241  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600877337512
<QC>           [rms_gradient]:         0.000004096155
<QC>       [total_force(1,1)]:        -0.000351889500
<QC>       [total_force(1,2)]:        -0.000464679679
<QC>       [total_force(1,3)]:         0.001716995907
<QC>       [total_force(1,4)]:         0.014201890491
<QC>       [total_force(1,5)]:        -0.014505083733
<QC>       [total_force(1,6)]:        -0.000597233487
<QC>       [total_force(2,1)]:        -0.000525408381
<QC>       [total_force(2,2)]:         0.000249462462
<QC>       [total_force(2,3)]:        -0.001093777284
<QC>       [total_force(2,4)]:        -0.012192330620
<QC>       [total_force(2,5)]:         0.012961168902
<QC>       [total_force(2,6)]:         0.000600884920
<QC>       [total_force(3,1)]:        -0.000406074618
<QC>       [total_force(3,2)]:         0.000727861992
<QC>       [total_force(3,3)]:        -0.000948554111
<QC>       [total_force(3,4)]:        -0.008108256544
<QC>       [total_force(3,5)]:         0.009003966446
<QC>       [total_force(3,6)]:        -0.000268943164

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   13 of   18 :
  displacing atom    5 in the -ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.046002 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59509157445095 0.19377279647 0.00163514815 0.0355  0.000   12.00000000
 2    -13.78510411399043 0.13356357638 0.00274036777 0.4644 -0.688   12.00000000
 3    -13.78603832203655 0.13374927854 0.00106358633 0.0785  3.053   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.075692588293
   Final penalty energy   :       0.197192620940
   RMS occupancy error    :       0.064095
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360021209356E+01     1.9858E-03     1.9858E-03
    2        -1.360034193033E+01     2.6794E-04     2.6794E-04    -1.2984E-04
    3        -1.360034542093E+01     1.1610E-04     1.1610E-04    -3.4906E-06
    4        -1.360034585653E+01     3.5757E-05     3.5757E-05    -4.3560E-07
    5        -1.360034592376E+01     8.6274E-06     8.6274E-06    -6.7231E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36003459237581E+01  Eh
     Estimated bandgap           =   2.1751E-01  Eh
     RMS occupancy error         =   1.4963E-14
     [H,K] commutator            =   8.6274E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8755E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011343751945E+01 Eh
   Predicted gain in energy  =      -7.88451436370963E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360113444744E+01     2.0238E-04     2.0238E-04
    2        -1.360113554644E+01     5.1331E-05     5.1331E-05    -1.0990E-06
    3        -1.360113566057E+01     1.9004E-05     1.9004E-05    -1.1413E-07
    4        -1.360113567673E+01     5.4823E-06     5.4823E-06    -1.6161E-08
    5        -1.360113567806E+01     1.9708E-06     1.9708E-06    -1.3265E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011356780551E+01  Eh
     Estimated bandgap           =   2.1666E-01  Eh
     RMS occupancy error         =   5.2695E-17
     [H,K] commutator            =   1.9708E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.3015E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011525027452E+01 Eh
   Predicted gain in energy  =      -1.68246900766889E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360115240449E+01     7.8190E-05     7.8190E-05
    2        -1.360115262799E+01     2.8237E-05     2.8237E-05    -2.2350E-07
    3        -1.360115265704E+01     8.5136E-06     8.5136E-06    -2.9052E-08
    4        -1.360115265998E+01     2.3876E-06     2.3876E-06    -2.9419E-09
    5        -1.360115266030E+01      6.875E-07      6.875E-07     -3.236E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000068745142      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011526603025E+01  Eh
     Estimated bandgap           =   2.1615E-01  Eh
     RMS occupancy error         =   1.4743E-16
     [H,K] commutator            =   6.8745E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4099E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011571834789E+01 Eh
   Predicted gain in energy  =      -4.52317639343391E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360115710475E+01     6.0418E-05     6.0418E-05
    2        -1.360115724588E+01     2.0920E-05     2.0920E-05    -1.4112E-07
    3        -1.360115726171E+01     6.3619E-06     6.3619E-06    -1.5836E-08
    4        -1.360115726314E+01     1.6268E-06     1.6268E-06    -1.4274E-09
    5        -1.360115726330E+01      4.370E-07      4.370E-07     -1.600E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000043703804      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011572632997E+01  Eh
     Estimated bandgap           =   2.1659E-01  Eh
     RMS occupancy error         =   1.0128E-16
     [H,K] commutator            =   4.3704E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3175E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36011576787480E+01 Eh
   Predicted gain in energy  =      -4.15448345947311E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360115767387E+01     1.6445E-05     1.6445E-05
    2        -1.360115768426E+01     5.9399E-06     5.9399E-06    -1.0386E-08
    3        -1.360115768552E+01     1.7441E-06     1.7441E-06    -1.2668E-09
    4        -1.360115768563E+01      4.550E-07      4.550E-07     -1.113E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000045496565      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36011576856346E+01  Eh
     Estimated bandgap           =   2.1647E-01  Eh
     RMS occupancy error         =   1.1512E-16
     [H,K] commutator            =   4.5497E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000458530979              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83425560442425 |
           | Pseudopotential (local)    :      -58.37641545467006 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56318659019485 |
           | Hartree                    :       24.03283102974134 |
           | Exchange-correlation       :       -4.70101782727109 |
           | Ewald                      :       14.04600237194610 |
           | Total                      :      -13.60115768563461 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999996
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00048754767126    -13.60034592375813   0.241137    -13.60113437519450        
   1     0.00008301525730    -13.60113567805512   0.177081    -13.60115250274519        
   2     0.00004409929650    -13.60115266030252   0.169085    -13.60115718347891        
   3     0.00003317479138    -13.60115726329967   0.027938    -13.60115767874801        
   4     0.00000458530979    -13.60115768563462  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601157685635
<QC>           [rms_gradient]:         0.000004585310
<QC>       [total_force(1,1)]:        -0.003310659911
<QC>       [total_force(1,2)]:         0.000201210046
<QC>       [total_force(1,3)]:         0.001040928300
<QC>       [total_force(1,4)]:        -0.010379660058
<QC>       [total_force(1,5)]:         0.011829622341
<QC>       [total_force(1,6)]:         0.000618559283
<QC>       [total_force(2,1)]:         0.003858248552
<QC>       [total_force(2,2)]:         0.000311415418
<QC>       [total_force(2,3)]:        -0.001250993285
<QC>       [total_force(2,4)]:         0.008483619140
<QC>       [total_force(2,5)]:        -0.009724485752
<QC>       [total_force(2,6)]:        -0.001677804073
<QC>       [total_force(3,1)]:         0.002492263023
<QC>       [total_force(3,2)]:         0.000907955146
<QC>       [total_force(3,3)]:        -0.001243210542
<QC>       [total_force(3,4)]:         0.005744737773
<QC>       [total_force(3,5)]:        -0.006097317470
<QC>       [total_force(3,6)]:        -0.001804427929

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   14 of   18 :
  displacing atom    5 in the +ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.039524 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59196630699212 0.19418454671 0.00181211003 0.0355  0.000   12.00000000
 2    -13.78189674011483 0.13400832697 0.00283309403 0.4497 -0.689   12.00000000
 3    -13.78288881890543 0.13418528351 0.00125360452 0.0789  2.926   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.074365979359
   Final penalty energy   :       0.197341948191
   RMS occupancy error    :       0.064119
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359966818779E+01     1.9319E-03     1.9319E-03
    2        -1.359979334470E+01     3.6637E-04     3.6637E-04    -1.2516E-04
    3        -1.359980115864E+01     2.1635E-04     2.1635E-04    -7.8139E-06
    4        -1.359980287396E+01     8.1717E-05     8.1717E-05    -1.7153E-06
    5        -1.359980325007E+01     2.4963E-05     2.4963E-05    -3.7610E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35998032500660E+01  Eh
     Estimated bandgap           =   2.1788E-01  Eh
     RMS occupancy error         =   9.0963E-13
     [H,K] commutator            =   2.4963E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4296E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36007931534905E+01 Eh
   Predicted gain in energy  =      -9.89903424480687E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360079580917E+01     2.7161E-04     2.7161E-04
    2        -1.360079845795E+01     6.3287E-05     6.3287E-05    -2.6488E-06
    3        -1.360079862364E+01     2.6670E-05     2.6670E-05    -1.6569E-07
    4        -1.360079865277E+01     7.3496E-06     7.3496E-06    -2.9125E-08
    5        -1.360079865537E+01     2.6836E-06     2.6836E-06    -2.6001E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36007986553667E+01  Eh
     Estimated bandgap           =   2.1700E-01  Eh
     RMS occupancy error         =   9.1909E-17
     [H,K] commutator            =   2.6836E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0336E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008297431687E+01 Eh
   Predicted gain in energy  =      -3.10878019202931E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360082962775E+01     1.0920E-04     1.0920E-04
    2        -1.360083005009E+01     3.7155E-05     3.7155E-05    -4.2234E-07
    3        -1.360083010101E+01     1.1782E-05     1.1782E-05    -5.0925E-08
    4        -1.360083010656E+01     3.1556E-06     3.1556E-06    -5.5525E-09
    5        -1.360083010717E+01      9.135E-07      9.135E-07     -6.017E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000091345052      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008301071667E+01  Eh
     Estimated bandgap           =   2.1637E-01  Eh
     RMS occupancy error         =   9.1044E-17
     [H,K] commutator            =   9.1345E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3475E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008344976874E+01 Eh
   Predicted gain in energy  =      -4.39052073453183E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360083441319E+01     6.2817E-05     6.2817E-05
    2        -1.360083456119E+01     2.0996E-05     2.0996E-05    -1.4800E-07
    3        -1.360083457737E+01     6.5232E-06     6.5232E-06    -1.6183E-08
    4        -1.360083457884E+01     1.5186E-06     1.5186E-06    -1.4712E-09
    5        -1.360083457899E+01      3.776E-07      3.776E-07     -1.497E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000037760597      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008345789907E+01  Eh
     Estimated bandgap           =   2.1681E-01  Eh
     RMS occupancy error         =   8.8945E-17
     [H,K] commutator            =   3.7761E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0345E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008349167359E+01 Eh
   Predicted gain in energy  =      -3.37745129641576E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360083491224E+01     1.5891E-05     1.5891E-05
    2        -1.360083492165E+01     5.5204E-06     5.5204E-06    -9.4136E-09
    3        -1.360083492276E+01     1.6655E-06     1.6655E-06    -1.1122E-09
    4        -1.360083492286E+01      4.010E-07      4.010E-07     -9.877E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000040098211      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008349228628E+01  Eh
     Estimated bandgap           =   2.1670E-01  Eh
     RMS occupancy error         =   1.1278E-16
     [H,K] commutator            =   4.0098E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000477148919              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.82636371883778 |
           | Pseudopotential (local)    :      -58.36382145766570 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56388400624263 |
           | Hartree                    :       24.03192588139710 |
           | Exchange-correlation       :       -4.69871087759642 |
           | Ewald                      :       14.03952380592183 |
           | Total                      :      -13.60083492286278 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999997
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00054296189252    -13.59980325006601   0.244106    -13.60079315349049        
   1     0.00010336297976    -13.60079865536674   0.210516    -13.60082974316866        
   2     0.00004347495200    -13.60083010716670   0.168873    -13.60083449768743        
   3     0.00003034474811    -13.60083457899074   0.027169    -13.60083491673587        
   4     0.00000477148919    -13.60083492286277  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600834922863
<QC>           [rms_gradient]:         0.000004771489
<QC>       [total_force(1,1)]:        -0.001827124335
<QC>       [total_force(1,2)]:        -0.000087030128
<QC>       [total_force(1,3)]:         0.001394085882
<QC>       [total_force(1,4)]:        -0.007284725018
<QC>       [total_force(1,5)]:         0.008922481418
<QC>       [total_force(1,6)]:        -0.001117687819
<QC>       [total_force(2,1)]:         0.001611478702
<QC>       [total_force(2,2)]:         0.000462987349
<QC>       [total_force(2,3)]:        -0.001602744056
<QC>       [total_force(2,4)]:         0.017009592570
<QC>       [total_force(2,5)]:        -0.017626531025
<QC>       [total_force(2,6)]:         0.000145216460
<QC>       [total_force(3,1)]:         0.001240300695
<QC>       [total_force(3,2)]:         0.000430125390
<QC>       [total_force(3,3)]:        -0.000675489601
<QC>       [total_force(3,4)]:         0.008825888639
<QC>       [total_force(3,5)]:        -0.009235388251
<QC>       [total_force(3,6)]:        -0.000585436871

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   14 of   18 :
  displacing atom    5 in the -ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.206932 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60697686590043 0.19228540814 0.00184269521 0.0360  0.000   12.00000000
 2    -13.80011894387457 0.13090818577 0.00177221390 0.4101 -0.680   12.00000000
 3    -13.80100808885230 0.13108921228 0.00142729389 0.0798  2.904   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.092356990483
   Final penalty energy   :       0.208315122635
   RMS occupancy error    :       0.065878
   Occupancy bounds       : [-0.095, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359919289703E+01     2.6367E-03     2.6367E-03
    2        -1.359942352330E+01     4.2576E-04     4.2576E-04    -2.3063E-04
    3        -1.359943386611E+01     2.2022E-04     2.2022E-04    -1.0343E-05
    4        -1.359943564440E+01     9.4761E-05     9.4761E-05    -1.7783E-06
    5        -1.359943612435E+01     2.6817E-05     2.6817E-05    -4.7994E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35994361243454E+01  Eh
     Estimated bandgap           =   2.1668E-01  Eh
     RMS occupancy error         =   1.4263E-12
     [H,K] commutator            =   2.6817E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.5826E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36004860074820E+01 Eh
   Predicted gain in energy  =      -1.04988313664656E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360048656761E+01     2.8773E-04     2.8773E-04
    2        -1.360048975794E+01     8.3720E-05     8.3720E-05    -3.1903E-06
    3        -1.360049001828E+01     3.2206E-05     3.2206E-05    -2.6035E-07
    4        -1.360049005830E+01     8.9581E-06     8.9581E-06    -4.0016E-08
    5        -1.360049006277E+01     2.6431E-06     2.6431E-06    -4.4662E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004900627666E+01  Eh
     Estimated bandgap           =   2.1619E-01  Eh
     RMS occupancy error         =   1.1047E-16
     [H,K] commutator            =   2.6431E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1593E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36005350496223E+01 Eh
   Predicted gain in energy  =      -4.49868556469113E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360053489459E+01     1.3668E-04     1.3668E-04
    2        -1.360053556997E+01     5.0686E-05     5.0686E-05    -6.7538E-07
    3        -1.360053566293E+01     1.3885E-05     1.3885E-05    -9.2952E-08
    4        -1.360053567112E+01     4.0780E-06     4.0780E-06    -8.1956E-09
    5        -1.360053567209E+01     1.1679E-06     1.1679E-06    -9.6673E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36005356720888E+01  Eh
     Estimated bandgap           =   2.1559E-01  Eh
     RMS occupancy error         =   9.6801E-17
     [H,K] commutator            =   1.1679E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1365E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36005368932127E+01 Eh
   Predicted gain in energy  =      -1.22112387401785E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360053686967E+01     3.2855E-05     3.2855E-05
    2        -1.360053691191E+01     1.1711E-05     1.1711E-05    -4.2242E-08
    3        -1.360053691671E+01     3.1574E-06     3.1574E-06    -4.7984E-09
    4        -1.360053691706E+01      8.080E-07      8.080E-07     -3.538E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000080796710      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36005369170622E+01  Eh
     Estimated bandgap           =   2.1581E-01  Eh
     RMS occupancy error         =   1.2471E-16
     [H,K] commutator            =   8.0797E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.3389E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36005370450273E+01 Eh
   Predicted gain in energy  =      -1.27965062546309E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360053704297E+01     1.0078E-05     1.0078E-05
    2        -1.360053704694E+01     3.6838E-06     3.6838E-06    -3.9658E-09
    3        -1.360053704739E+01      8.692E-07      8.692E-07     -4.589E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000086918268      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36005370473944E+01  Eh
     Estimated bandgap           =   2.1574E-01  Eh
     RMS occupancy error         =   8.4901E-17
     [H,K] commutator            =   8.6918E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000330917050              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.90540853798665 |
           | Pseudopotential (local)    :      -58.72515038086672 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56579390980678 |
           | Hartree                    :       24.16703705310029 |
           | Exchange-correlation       :       -4.72055773145802 |
           | Ewald                      :       14.20693156403663 |
           | Total                      :      -13.60053704739439 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000000
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00055825836987    -13.59943612434539   0.244903    -13.60048600748204        
   1     0.00011593420897    -13.60049006276663   0.242373    -13.60053504962228        
   2     0.00003136471111    -13.60053567208878   0.090240    -13.60053689321266        
   3     0.00002338912613    -13.60053691706219   0.017341    -13.60053704502726        
   4     0.00000330917050    -13.60053704739438  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600537047394
<QC>           [rms_gradient]:         0.000003309171
<QC>       [total_force(1,1)]:        -0.002117380625
<QC>       [total_force(1,2)]:        -0.000286841460
<QC>       [total_force(1,3)]:         0.001203787633
<QC>       [total_force(1,4)]:         0.013635991833
<QC>       [total_force(1,5)]:        -0.013506194141
<QC>       [total_force(1,6)]:         0.001070636759
<QC>       [total_force(2,1)]:         0.001902497105
<QC>       [total_force(2,2)]:        -0.000041374940
<QC>       [total_force(2,3)]:        -0.000761916192
<QC>       [total_force(2,4)]:        -0.021134156110
<QC>       [total_force(2,5)]:         0.021507334921
<QC>       [total_force(2,6)]:        -0.001472384784
<QC>       [total_force(3,1)]:         0.000982858076
<QC>       [total_force(3,2)]:         0.001221873496
<QC>       [total_force(3,3)]:        -0.001542833349
<QC>       [total_force(3,4)]:        -0.012384112301
<QC>       [total_force(3,5)]:         0.013401675859
<QC>       [total_force(3,6)]:        -0.001679461780

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   15 of   18 :
  displacing atom    5 in the +ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.067941 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59516720512081 0.19387063909 0.00143561010 0.0356  0.000   12.00000000
 2    -13.78581365430847 0.13340941498 0.00249263818 0.4489 -0.687   12.00000000
 3    -13.78687616620652 0.13359638567 0.00108189367 0.0789  3.043   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.077847368673
   Final penalty energy   :       0.198915376370
   RMS occupancy error    :       0.064374
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360034250257E+01     2.0449E-03     2.0449E-03
    2        -1.360048463565E+01     4.2091E-04     4.2091E-04    -1.4213E-04
    3        -1.360049788241E+01     2.2937E-04     2.2937E-04    -1.3247E-05
    4        -1.360049970050E+01     9.2751E-05     9.2751E-05    -1.8181E-06
    5        -1.360050012336E+01     2.5957E-05     2.5957E-05    -4.2286E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36005001233588E+01  Eh
     Estimated bandgap           =   2.1765E-01  Eh
     RMS occupancy error         =   1.4577E-12
     [H,K] commutator            =   2.5957E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.7589E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012466573551E+01 Eh
   Predicted gain in energy  =      -7.46533996341725E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360124667618E+01     1.9563E-04     1.9563E-04
    2        -1.360124804770E+01     5.0902E-05     5.0902E-05    -1.3715E-06
    3        -1.360124817079E+01     2.2704E-05     2.2704E-05    -1.2309E-07
    4        -1.360124819426E+01     7.9859E-06     7.9859E-06    -2.3473E-08
    5        -1.360124819742E+01     3.4642E-06     3.4642E-06    -3.1571E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012481974159E+01  Eh
     Estimated bandgap           =   2.1685E-01  Eh
     RMS occupancy error         =   1.2958E-16
     [H,K] commutator            =   3.4642E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.0256E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012630399712E+01 Eh
   Predicted gain in energy  =      -1.48425553216924E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360126297066E+01     7.0637E-05     7.0637E-05
    2        -1.360126315587E+01     2.4143E-05     2.4143E-05    -1.8521E-07
    3        -1.360126317750E+01     7.9604E-06     7.9604E-06    -2.1628E-08
    4        -1.360126317993E+01     2.4201E-06     2.4201E-06    -2.4341E-09
    5        -1.360126318034E+01      8.076E-07      8.076E-07     -4.067E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000080763948      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012631803385E+01  Eh
     Estimated bandgap           =   2.1636E-01  Eh
     RMS occupancy error         =   1.0716E-16
     [H,K] commutator            =   8.0764E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.0963E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012663241500E+01 Eh
   Predicted gain in energy  =      -3.14381147603626E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360126627359E+01     4.7769E-05     4.7769E-05
    2        -1.360126636230E+01     1.5857E-05     1.5857E-05    -8.8711E-08
    3        -1.360126637170E+01     5.0244E-06     5.0244E-06    -9.3996E-09
    4        -1.360126637256E+01     1.3569E-06     1.3569E-06    -8.5354E-10
    5        -1.360126637269E+01      3.643E-07      3.643E-07     -1.295E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000036429064      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012663726871E+01  Eh
     Estimated bandgap           =   2.1673E-01  Eh
     RMS occupancy error         =   9.1760E-17
     [H,K] commutator            =   3.6429E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0505E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012666684182E+01 Eh
   Predicted gain in energy  =      -2.95731101829233E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360126666500E+01     1.3261E-05     1.3261E-05
    2        -1.360126667183E+01     4.5543E-06     4.5543E-06    -6.8267E-09
    3        -1.360126667260E+01     1.4120E-06     1.4120E-06    -7.6466E-10
    4        -1.360126667266E+01      3.764E-07      3.764E-07     -6.890E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000037635996      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012666726642E+01  Eh
     Estimated bandgap           =   2.1663E-01  Eh
     RMS occupancy error         =   7.3429E-17
     [H,K] commutator            =   3.7636E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000415831392              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83928601032459 |
           | Pseudopotential (local)    :      -58.42641060737537 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56411377396590 |
           | Hartree                    :       24.05624925634308 |
           | Exchange-correlation       :       -4.70244574260381 |
           | Ewald                      :       14.06794063668137 |
           | Total                      :      -13.60126667266423 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000001
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00047589482709    -13.60050012335878   0.239636    -13.60124665735512        
   1     0.00008025613478    -13.60124819741587   0.167151    -13.60126303997120        
   2     0.00004096302446    -13.60126318033848   0.136206    -13.60126632414996        
   3     0.00003050451779    -13.60126637268714   0.023468    -13.60126666841824        
   4     0.00000415831392    -13.60126667266423  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601266672664
<QC>           [rms_gradient]:         0.000004158314
<QC>       [total_force(1,1)]:        -0.001606110057
<QC>       [total_force(1,2)]:        -0.000184042137
<QC>       [total_force(1,3)]:         0.001475080621
<QC>       [total_force(1,4)]:        -0.004931602001
<QC>       [total_force(1,5)]:         0.006079067224
<QC>       [total_force(1,6)]:        -0.000832393649
<QC>       [total_force(2,1)]:         0.001741703869
<QC>       [total_force(2,2)]:        -0.000124111958
<QC>       [total_force(2,3)]:        -0.000752472822
<QC>       [total_force(2,4)]:         0.009199648734
<QC>       [total_force(2,5)]:        -0.010053443300
<QC>       [total_force(2,6)]:        -0.000011324523
<QC>       [total_force(3,1)]:         0.000661825562
<QC>       [total_force(3,2)]:         0.001218727957
<QC>       [total_force(3,3)]:        -0.001970738495
<QC>       [total_force(3,4)]:         0.010426008026
<QC>       [total_force(3,5)]:        -0.009435806909
<QC>       [total_force(3,6)]:        -0.000900016141

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   15 of   18 :
  displacing atom    5 in the -ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.174075 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60498975415594 0.19261533390 0.00133879918 0.0360  0.000   12.00000000
 2    -13.79767653021626 0.13138576327 0.00169247682 0.4262 -0.681   12.00000000
 3    -13.79867435385871 0.13157694915 0.00114626315 0.0794  3.070   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.089292218333
   Final penalty energy   :       0.205818266511
   RMS occupancy error    :       0.065482
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360003611313E+01     2.4967E-03     2.4967E-03
    2        -1.360024477369E+01     4.5938E-04     4.5938E-04    -2.0866E-04
    3        -1.360026026442E+01     2.1682E-04     2.1682E-04    -1.5491E-05
    4        -1.360026209297E+01     1.0574E-04     1.0574E-04    -1.8285E-06
    5        -1.360026257552E+01     2.8255E-05     2.8255E-05    -4.8255E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002625755206E+01  Eh
     Estimated bandgap           =   2.1681E-01  Eh
     RMS occupancy error         =   1.9000E-12
     [H,K] commutator            =   2.8255E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8305E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010318392121E+01 Eh
   Predicted gain in energy  =      -7.69263691488220E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360103024507E+01     1.9737E-04     1.9737E-04
    2        -1.360103189502E+01     6.3249E-05     6.3249E-05    -1.6500E-06
    3        -1.360103205026E+01     2.5109E-05     2.5109E-05    -1.5524E-07
    4        -1.360103207482E+01     8.8441E-06     8.8441E-06    -2.4560E-08
    5        -1.360103207912E+01     2.4527E-06     2.4527E-06    -4.3008E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010320791221E+01  Eh
     Estimated bandgap           =   2.1626E-01  Eh
     RMS occupancy error         =   1.3192E-16
     [H,K] commutator            =   2.4527E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.0688E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010543617982E+01 Eh
   Predicted gain in energy  =      -2.22826760971628E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360105437295E+01     8.5277E-05     8.5277E-05
    2        -1.360105466349E+01     3.1892E-05     3.1892E-05    -2.9054E-07
    3        -1.360105469859E+01     8.8201E-06     8.8201E-06    -3.5102E-08
    4        -1.360105470171E+01     2.7374E-06     2.7374E-06    -3.1189E-09
    5        -1.360105470217E+01      8.380E-07      8.380E-07     -4.554E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000083795449      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010547021675E+01  Eh
     Estimated bandgap           =   2.1575E-01  Eh
     RMS occupancy error         =   6.4804E-17
     [H,K] commutator            =   8.3795E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.5901E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010567897263E+01 Eh
   Predicted gain in energy  =      -2.08755882269429E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360105675087E+01     4.0016E-05     4.0016E-05
    2        -1.360105681691E+01     1.3626E-05     1.3626E-05    -6.6049E-08
    3        -1.360105682347E+01     3.8305E-06     3.8305E-06    -6.5521E-09
    4        -1.360105682396E+01     1.0132E-06     1.0132E-06    -4.9332E-10
    5        -1.360105682402E+01      2.568E-07      2.568E-07     -6.409E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000025678877      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010568240235E+01  Eh
     Estimated bandgap           =   2.1604E-01  Eh
     RMS occupancy error         =   1.1211E-16
     [H,K] commutator            =   2.5679E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5971E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010570108448E+01 Eh
   Predicted gain in energy  =      -1.86821388581393E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360105701499E+01     1.0896E-05     1.0896E-05
    2        -1.360105701990E+01     3.8463E-06     3.8463E-06    -4.9122E-09
    3        -1.360105702041E+01     1.0500E-06     1.0500E-06    -5.1216E-10
    4        -1.360105702045E+01      2.829E-07      2.829E-07     -3.831E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000028286612      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010570204498E+01  Eh
     Estimated bandgap           =   2.1596E-01  Eh
     RMS occupancy error         =   9.9997E-17
     [H,K] commutator            =   2.8287E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000608821640              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.88914071225054 |
           | Pseudopotential (local)    :      -58.65338106920706 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56499194840184 |
           | Hartree                    :       24.14031383659657 |
           | Exchange-correlation       :       -4.71619757665661 |
           | Ewald                      :       14.17407512816495 |
           | Total                      :      -13.60105702044977 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000005
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00048305301091    -13.60026257552062   0.239668    -13.60103183921211        
   1     0.00009068797726    -13.60103207912215   0.196947    -13.60105436179824        
   2     0.00003590126548    -13.60105470216745   0.117745    -13.60105678972628        
   3     0.00002597095925    -13.60105682402345   0.020472    -13.60105701084484        
   4     0.00000608821640    -13.60105702044977  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601057020450
<QC>           [rms_gradient]:         0.000006088216
<QC>       [total_force(1,1)]:        -0.002302698425
<QC>       [total_force(1,2)]:        -0.000167917928
<QC>       [total_force(1,3)]:         0.001157211750
<QC>       [total_force(1,4)]:         0.009537753034
<QC>       [total_force(1,5)]:        -0.008992593157
<QC>       [total_force(1,6)]:         0.000768244727
<QC>       [total_force(2,1)]:         0.001796015509
<QC>       [total_force(2,2)]:         0.000691532442
<QC>       [total_force(2,3)]:        -0.001622474052
<QC>       [total_force(2,4)]:        -0.012369186512
<QC>       [total_force(2,5)]:         0.012793796817
<QC>       [total_force(2,6)]:        -0.001289684204
<QC>       [total_force(3,1)]:         0.001489324189
<QC>       [total_force(3,2)]:         0.000296302604
<QC>       [total_force(3,3)]:        -0.000304651149
<QC>       [total_force(3,4)]:        -0.011243606709
<QC>       [total_force(3,5)]:         0.011099992322
<QC>       [total_force(3,6)]:        -0.001337361256

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   16 of   18 :
  displacing atom    6 in the +ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.197573 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60482151061335 0.19267624294 0.00157463503 0.0360  0.000   12.00000000
 2    -13.79783733368186 0.13136699333 0.00154177186 0.3930 -0.681   12.00000000
 3    -13.79868229817723 0.13153608419 0.00127765096 0.0802  2.733   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.092123630550
   Final penalty energy   :       0.208432346793
   RMS occupancy error    :       0.065896
   Occupancy bounds       : [-0.095, 1.099]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359995659339E+01     2.4555E-03     2.4555E-03
    2        -1.360015563344E+01     3.3307E-04     3.3307E-04    -1.9904E-04
    3        -1.360016094833E+01     1.2173E-04     1.2173E-04    -5.3149E-06
    4        -1.360016141943E+01     4.1784E-05     4.1784E-05    -4.7110E-07
    5        -1.360016151004E+01     9.6835E-06     9.6835E-06    -9.0605E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36001615100368E+01  Eh
     Estimated bandgap           =   2.1731E-01  Eh
     RMS occupancy error         =   2.3323E-14
     [H,K] commutator            =   9.6835E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9053E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009508590031E+01 Eh
   Predicted gain in energy  =      -7.89348966282688E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360095118653E+01     2.0328E-04     2.0328E-04
    2        -1.360095287178E+01     6.2889E-05     6.2889E-05    -1.6853E-06
    3        -1.360095301355E+01     2.2745E-05     2.2745E-05    -1.4177E-07
    4        -1.360095303364E+01     6.4314E-06     6.4314E-06    -2.0089E-08
    5        -1.360095303582E+01     1.8123E-06     1.8123E-06    -2.1739E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009530358160E+01  Eh
     Estimated bandgap           =   2.1677E-01  Eh
     RMS occupancy error         =   6.3139E-17
     [H,K] commutator            =   1.8123E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.9001E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009744863811E+01 Eh
   Predicted gain in energy  =      -2.14505651534580E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360097437709E+01     8.9823E-05     8.9823E-05
    2        -1.360097468949E+01     3.4599E-05     3.4599E-05    -3.1239E-07
    3        -1.360097473123E+01     9.3155E-06     9.3155E-06    -4.1741E-08
    4        -1.360097473490E+01     2.7926E-06     2.7926E-06    -3.6716E-09
    5        -1.360097473533E+01      7.845E-07      7.845E-07     -4.296E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000078446218      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009747353284E+01  Eh
     Estimated bandgap           =   2.1626E-01  Eh
     RMS occupancy error         =   1.0203E-16
     [H,K] commutator            =   7.8446E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.7512E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009772625194E+01 Eh
   Predicted gain in energy  =      -2.52719103421839E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360097721146E+01     4.6089E-05     4.6089E-05
    2        -1.360097729737E+01     1.6213E-05     1.6213E-05    -8.5909E-08
    3        -1.360097730663E+01     4.6332E-06     4.6332E-06    -9.2664E-09
    4        -1.360097730738E+01     1.2489E-06     1.2489E-06    -7.5172E-10
    5        -1.360097730748E+01      3.180E-07      3.180E-07     -9.258E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000031798461      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009773074769E+01  Eh
     Estimated bandgap           =   2.1658E-01  Eh
     RMS occupancy error         =   7.7841E-17
     [H,K] commutator            =   3.1798E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.7514E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009775459389E+01 Eh
   Predicted gain in energy  =      -2.38461968393722E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360097754224E+01     1.3109E-05     1.3109E-05
    2        -1.360097754919E+01     4.8144E-06     4.8144E-06    -6.9533E-09
    3        -1.360097754999E+01     1.3187E-06     1.3187E-06    -8.0373E-10
    4        -1.360097755006E+01      3.659E-07      3.659E-07     -6.344E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000036591936      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009775500569E+01  Eh
     Estimated bandgap           =   2.1649E-01  Eh
     RMS occupancy error         =   1.8069E-16
     [H,K] commutator            =   3.6592E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000407499607              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.89483277546337 |
           | Pseudopotential (local)    :      -58.70696042974894 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56585165497179 |
           | Hartree                    :       24.16547958385661 |
           | Exchange-correlation       :       -4.71775372787038 |
           | Ewald                      :       14.19757259327069 |
           | Total                      :      -13.60097755005688 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999999
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00049053247538    -13.60016151003677   0.238483    -13.60095085900306        
   1     0.00008900122294    -13.60095303581598   0.196183    -13.60097448638113        
   2     0.00003751156790    -13.60097473532836   0.130566    -13.60097726251940        
   3     0.00002751383160    -13.60097730747691   0.023315    -13.60097754593887        
   4     0.00000407499607    -13.60097755005688  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600977550057
<QC>           [rms_gradient]:         0.000004074996
<QC>       [total_force(1,1)]:        -0.000357627076
<QC>       [total_force(1,2)]:         0.000218786274
<QC>       [total_force(1,3)]:         0.001039587976
<QC>       [total_force(1,4)]:         0.013937286314
<QC>       [total_force(1,5)]:        -0.001583175227
<QC>       [total_force(1,6)]:        -0.013254858260
<QC>       [total_force(2,1)]:         0.003958943628
<QC>       [total_force(2,2)]:         0.000110480088
<QC>       [total_force(2,3)]:        -0.001068574356
<QC>       [total_force(2,4)]:         0.009223897620
<QC>       [total_force(2,5)]:        -0.000362663514
<QC>       [total_force(2,6)]:        -0.011862083467
<QC>       [total_force(3,1)]:         0.002714610174
<QC>       [total_force(3,2)]:         0.000805761907
<QC>       [total_force(3,3)]:        -0.001108709285
<QC>       [total_force(3,4)]:         0.007387926497
<QC>       [total_force(3,5)]:         0.000024651237
<QC>       [total_force(3,6)]:        -0.009824240529

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   16 of   18 :
  displacing atom    6 in the -ve x-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.046592 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59505014263655 0.19376676796 0.00162576299 0.0355  0.000   12.00000000
 2    -13.78508396193159 0.13354912632 0.00273222473 0.4620 -0.688   12.00000000
 3    -13.78601737328412 0.13373285624 0.00106020346 0.0785  3.038   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.075861183048
   Final penalty energy   :       0.197403351345
   RMS occupancy error    :       0.064129
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360012416499E+01     1.9789E-03     1.9789E-03
    2        -1.360025273350E+01     2.6663E-04     2.6663E-04    -1.2857E-04
    3        -1.360025620160E+01     1.1576E-04     1.1576E-04    -3.4681E-06
    4        -1.360025663473E+01     3.5562E-05     3.5562E-05    -4.3313E-07
    5        -1.360025670102E+01     8.5753E-06     8.5753E-06    -6.6287E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36002567010223E+01  Eh
     Estimated bandgap           =   2.1751E-01  Eh
     RMS occupancy error         =   1.4491E-14
     [H,K] commutator            =   8.5753E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.8677E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010435307882E+01 Eh
   Predicted gain in energy  =      -7.86829765980102E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360104460820E+01     1.9990E-04     1.9990E-04
    2        -1.360104604758E+01     4.9227E-05     4.9227E-05    -1.4394E-06
    3        -1.360104613208E+01     1.9097E-05     1.9097E-05    -8.4503E-08
    4        -1.360104614747E+01     4.5830E-06     4.5830E-06    -1.5384E-08
    5        -1.360104614856E+01     1.3331E-06     1.3331E-06    -1.0934E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010461485585E+01  Eh
     Estimated bandgap           =   2.1666E-01  Eh
     RMS occupancy error         =   9.4299E-17
     [H,K] commutator            =   1.3331E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.3821E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010633459909E+01 Eh
   Predicted gain in energy  =      -1.71974324274515E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360106327047E+01     7.7376E-05     7.7376E-05
    2        -1.360106349107E+01     2.8111E-05     2.8111E-05    -2.2060E-07
    3        -1.360106351974E+01     8.4413E-06     8.4413E-06    -2.8670E-08
    4        -1.360106352264E+01     2.3811E-06     2.3811E-06    -2.9007E-09
    5        -1.360106352296E+01      6.741E-07      6.741E-07     -3.191E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000067412297      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010635229626E+01  Eh
     Estimated bandgap           =   2.1614E-01  Eh
     RMS occupancy error         =   7.7136E-17
     [H,K] commutator            =   6.7412E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3426E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010677978845E+01 Eh
   Predicted gain in energy  =      -4.27492191157341E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360106772444E+01     5.8174E-05     5.8174E-05
    2        -1.360106785542E+01     2.0119E-05     2.0119E-05    -1.3098E-07
    3        -1.360106787007E+01     6.1495E-06     6.1495E-06    -1.4653E-08
    4        -1.360106787141E+01     1.5811E-06     1.5811E-06    -1.3379E-09
    5        -1.360106787156E+01      4.173E-07      4.173E-07     -1.501E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000041734237      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010678715573E+01  Eh
     Estimated bandgap           =   2.1658E-01  Eh
     RMS occupancy error         =   1.0541E-16
     [H,K] commutator            =   4.1734E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.2896E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36010682748625E+01 Eh
   Predicted gain in energy  =      -4.03305170593171E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360106827014E+01     1.6101E-05     1.6101E-05
    2        -1.360106828011E+01     5.8068E-06     5.8068E-06    -9.9725E-09
    3        -1.360106828132E+01     1.7150E-06     1.7150E-06    -1.2107E-09
    4        -1.360106828143E+01      4.487E-07      4.487E-07     -1.077E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000044865233      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36010682814318E+01  Eh
     Estimated bandgap           =   2.1646E-01  Eh
     RMS occupancy error         =   1.0611E-16
     [H,K] commutator            =   4.4865E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000447489583              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83448234806243 |
           | Pseudopotential (local)    :      -58.37741574723781 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56320540342467 |
           | Hartree                    :       24.03312961898727 |
           | Exchange-correlation       :       -4.70106190862491 |
           | Ewald                      :       14.04659200395657 |
           | Total                      :      -13.60106828143178 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999995
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00048677211489    -13.60025670102226   0.241409    -13.60104353078824        
   1     0.00008382120434    -13.60104614855846   0.177243    -13.60106334599089        
   2     0.00004342618957    -13.60106352296259   0.164797    -13.60106779788450        
   3     0.00003289601581    -13.60106787155734   0.027572    -13.60106827486251        
   4     0.00000447489583    -13.60106828143178  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601068281432
<QC>           [rms_gradient]:         0.000004474896
<QC>       [total_force(1,1)]:        -0.003302503476
<QC>       [total_force(1,2)]:        -0.000460591290
<QC>       [total_force(1,3)]:         0.001695348127
<QC>       [total_force(1,4)]:        -0.010124482788
<QC>       [total_force(1,5)]:        -0.000372228630
<QC>       [total_force(1,6)]:         0.012564458057
<QC>       [total_force(2,1)]:        -0.000311819706
<QC>       [total_force(2,2)]:         0.000435075277
<QC>       [total_force(2,3)]:        -0.001258576844
<QC>       [total_force(2,4)]:        -0.009848087961
<QC>       [total_force(2,5)]:         0.001862260814
<QC>       [total_force(2,6)]:         0.009121148419
<QC>       [total_force(3,1)]:        -0.000398672763
<QC>       [total_force(3,2)]:         0.000845289382
<QC>       [total_force(3,3)]:        -0.001113595087
<QC>       [total_force(3,4)]:        -0.007461960347
<QC>       [total_force(3,5)]:         0.001613711443
<QC>       [total_force(3,6)]:         0.006515227371

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   17 of   18 :
  displacing atom    6 in the +ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.202005 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60682675577917 0.19230866467 0.00177856477 0.0360  0.000   12.00000000
 2    -13.79987052426265 0.13096148556 0.00176258259 0.4139 -0.680   12.00000000
 3    -13.80077718948226 0.13114465738 0.00139032866 0.0797  2.934   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.091846261552
   Final penalty energy   :       0.207851698361
   RMS occupancy error    :       0.065805
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359933884271E+01     2.6199E-03     2.6199E-03
    2        -1.359956630399E+01     4.2157E-04     4.2157E-04    -2.2746E-04
    3        -1.359957671534E+01     2.1584E-04     2.1584E-04    -1.0411E-05
    4        -1.359957842088E+01     9.4360E-05     9.4360E-05    -1.7055E-06
    5        -1.359957889059E+01     2.6971E-05     2.6971E-05    -4.6971E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35995788905907E+01  Eh
     Estimated bandgap           =   2.1667E-01  Eh
     RMS occupancy error         =   1.3978E-12
     [H,K] commutator            =   2.6971E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.4655E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36005835596074E+01 Eh
   Predicted gain in energy  =      -1.00466901673180E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360058622932E+01     2.7410E-04     2.7410E-04
    2        -1.360058914133E+01     8.0094E-05     8.0094E-05    -2.9120E-06
    3        -1.360058938169E+01     3.0971E-05     3.0971E-05    -2.4036E-07
    4        -1.360058941833E+01     8.6432E-06     8.6432E-06    -3.6640E-08
    5        -1.360058942248E+01     2.5631E-06     2.5631E-06    -4.1526E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36005894224787E+01  Eh
     Estimated bandgap           =   2.1618E-01  Eh
     RMS occupancy error         =   1.3935E-16
     [H,K] commutator            =   2.5631E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.1253E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36006314144841E+01 Eh
   Predicted gain in energy  =      -4.19920053502665E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360063126137E+01     1.3007E-04     1.3007E-04
    2        -1.360063187695E+01     4.8230E-05     4.8230E-05    -6.1558E-07
    3        -1.360063196110E+01     1.3375E-05     1.3375E-05    -8.4147E-08
    4        -1.360063196859E+01     3.8590E-06     3.8590E-06    -7.4892E-09
    5        -1.360063196946E+01     1.1233E-06     1.1233E-06    -8.7490E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36006319694600E+01  Eh
     Estimated bandgap           =   2.1558E-01  Eh
     RMS occupancy error         =   1.1121E-16
     [H,K] commutator            =   1.1233E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3783E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36006336512981E+01 Eh
   Predicted gain in energy  =      -1.68183811233291E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360063361787E+01     3.8416E-05     3.8416E-05
    2        -1.360063367574E+01     1.3590E-05     1.3590E-05    -5.7865E-08
    3        -1.360063368224E+01     3.7463E-06     3.7463E-06    -6.5002E-09
    4        -1.360063368273E+01      9.573E-07      9.573E-07     -4.943E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000095728998      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36006336827323E+01  Eh
     Estimated bandgap           =   2.1583E-01  Eh
     RMS occupancy error         =   5.9076E-17
     [H,K] commutator            =   9.5729E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.5172E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36006338543910E+01 Eh
   Predicted gain in energy  =      -1.71658760095283E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360063385164E+01     1.1547E-05     1.1547E-05
    2        -1.360063385686E+01     4.2063E-06     4.2063E-06    -5.2183E-09
    3        -1.360063385746E+01     1.0094E-06     1.0094E-06    -6.0007E-10
    4        -1.360063385749E+01      2.309E-07      2.309E-07     -3.617E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000023089822      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36006338574919E+01  Eh
     Estimated bandgap           =   2.1576E-01  Eh
     RMS occupancy error         =   6.9422E-17
     [H,K] commutator            =   2.3090E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000363212619              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.90300132414353 |
           | Pseudopotential (local)    :      -58.71424072258183 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56561583052390 |
           | Hartree                    :       24.16294435691070 |
           | Exchange-correlation       :       -4.71995999937203 |
           | Ewald                      :       14.20200535288383 |
           | Total                      :      -13.60063385749190 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000000
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00054655454577    -13.59957889059071   0.244500    -13.60058355960744        
   1     0.00011253206665    -13.60058942247873   0.239480    -13.60063141448408        
   2     0.00003378276369    -13.60063196945998   0.107132    -13.60063365129810        
   3     0.00002517167021    -13.60063368273229   0.020069    -13.60063385439105        
   4     0.00000363212619    -13.60063385749190  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600633857492
<QC>           [rms_gradient]:         0.000003632126
<QC>       [total_force(1,1)]:        -0.002309843902
<QC>       [total_force(1,2)]:        -0.000380890348
<QC>       [total_force(1,3)]:         0.001284893089
<QC>       [total_force(1,4)]:         0.012853613994
<QC>       [total_force(1,5)]:         0.000104218891
<QC>       [total_force(1,6)]:        -0.011551991724
<QC>       [total_force(2,1)]:         0.001450281197
<QC>       [total_force(2,2)]:        -0.000167787604
<QC>       [total_force(2,3)]:        -0.000899603528
<QC>       [total_force(2,4)]:         0.017667413409
<QC>       [total_force(2,5)]:         0.001646758197
<QC>       [total_force(2,6)]:        -0.019697061671
<QC>       [total_force(3,1)]:         0.001125151556
<QC>       [total_force(3,2)]:         0.001279623102
<QC>       [total_force(3,3)]:        -0.001500172290
<QC>       [total_force(3,4)]:         0.011365922306
<QC>       [total_force(3,5)]:         0.001633528295
<QC>       [total_force(3,6)]:        -0.013904052969

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   17 of   18 :
  displacing atom    6 in the -ve y-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.043812 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59228447053401 0.19416070687 0.00176290993 0.0355  0.000   12.00000000
 2    -13.78233055514451 0.13394238426 0.00278496080 0.4474 -0.689   12.00000000
 3    -13.78332734948429 0.13411908459 0.00123624889 0.0789  2.921   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.074952693292
   Final penalty energy   :       0.197700166156
   RMS occupancy error    :       0.064178
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359972525166E+01     1.9379E-03     1.9379E-03
    2        -1.359985155210E+01     3.6707E-04     3.6707E-04    -1.2630E-04
    3        -1.359985952998E+01     2.1577E-04     2.1577E-04    -7.9779E-06
    4        -1.359986122030E+01     8.1856E-05     8.1856E-05    -1.6903E-06
    5        -1.359986159547E+01     2.5040E-05     2.5040E-05    -3.7516E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.35998615954668E+01  Eh
     Estimated bandgap           =   2.1789E-01  Eh
     RMS occupancy error         =   9.1748E-13
     [H,K] commutator            =   2.5040E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  5.3023E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008025690645E+01 Eh
   Predicted gain in energy  =      -9.40973597732153E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360080449511E+01     2.6264E-04     2.6264E-04
    2        -1.360080661437E+01     6.0615E-05     6.0615E-05    -2.1193E-06
    3        -1.360080676712E+01     2.5406E-05     2.5406E-05    -1.5275E-07
    4        -1.360080679357E+01     7.0220E-06     7.0220E-06    -2.6449E-08
    5        -1.360080679589E+01     2.5699E-06     2.5699E-06    -2.3208E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008067958911E+01  Eh
     Estimated bandgap           =   2.1702E-01  Eh
     RMS occupancy error         =   1.1610E-16
     [H,K] commutator            =   2.5699E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.0052E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008363904803E+01 Eh
   Predicted gain in energy  =      -2.95945891490845E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360083610044E+01     1.0795E-04     1.0795E-04
    2        -1.360083651143E+01     3.5973E-05     3.5973E-05    -4.1100E-07
    3        -1.360083655905E+01     1.1479E-05     1.1479E-05    -4.7620E-08
    4        -1.360083656425E+01     2.9018E-06     2.9018E-06    -5.1951E-09
    5        -1.360083656475E+01      8.378E-07      8.378E-07     -5.069E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000083779146      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008365647547E+01  Eh
     Estimated bandgap           =   2.1639E-01  Eh
     RMS occupancy error         =   1.0027E-16
     [H,K] commutator            =   8.3779E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.4835E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008417182333E+01 Eh
   Predicted gain in energy  =      -5.15347860030602E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360084161837E+01     6.8513E-05     6.8513E-05
    2        -1.360084179360E+01     2.2459E-05     2.2459E-05    -1.7523E-07
    3        -1.360084181212E+01     6.9936E-06     6.9936E-06    -1.8525E-08
    4        -1.360084181378E+01     1.4856E-06     1.4856E-06    -1.6615E-09
    5        -1.360084181392E+01      3.676E-07      3.676E-07     -1.409E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000036764168      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008418139233E+01  Eh
     Estimated bandgap           =   2.1688E-01  Eh
     RMS occupancy error         =   9.1116E-17
     [H,K] commutator            =   3.6764E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.1704E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36008422161096E+01 Eh
   Predicted gain in energy  =      -4.02186284276240E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360084221086E+01     1.7334E-05     1.7334E-05
    2        -1.360084222201E+01     5.9285E-06     5.9285E-06    -1.1151E-08
    3        -1.360084222329E+01     1.7935E-06     1.7935E-06    -1.2814E-09
    4        -1.360084222341E+01      4.022E-07      4.022E-07     -1.133E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000040218930      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36008422234078E+01  Eh
     Estimated bandgap           =   2.1676E-01  Eh
     RMS occupancy error         =   1.4320E-16
     [H,K] commutator            =   4.0219E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000487985732              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.82835227398007 |
           | Pseudopotential (local)    :      -58.37352122187487 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56392530545444 |
           | Hartree                    :       24.03582401401234 |
           | Exchange-correlation       :       -4.69923476325193 |
           | Ewald                      :       14.04381216827215 |
           | Total                      :      -13.60084222340779 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999996
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00053022968152    -13.59986159546681   0.243317    -13.60080256906454        
   1     0.00010052121938    -13.60080679589114   0.211901    -13.60083639048029        
   2     0.00004483507310    -13.60083656475469   0.186375    -13.60084171823329        
   3     0.00003170398253    -13.60084181392333   0.029641    -13.60084221610961        
   4     0.00000487985732    -13.60084222340779  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600842223408
<QC>           [rms_gradient]:         0.000004879857
<QC>       [total_force(1,1)]:        -0.001658649388
<QC>       [total_force(1,2)]:        -0.000023213266
<QC>       [total_force(1,3)]:         0.001341324690
<QC>       [total_force(1,4)]:        -0.006728912305
<QC>       [total_force(1,5)]:        -0.002134261937
<QC>       [total_force(1,6)]:         0.009203712206
<QC>       [total_force(2,1)]:         0.001926255018
<QC>       [total_force(2,2)]:         0.000646318065
<QC>       [total_force(2,3)]:        -0.001419192238
<QC>       [total_force(2,4)]:        -0.018314803283
<QC>       [total_force(2,5)]:         0.000009700859
<QC>       [total_force(2,6)]:         0.017151721579
<QC>       [total_force(3,1)]:         0.001029463272
<QC>       [total_force(3,2)]:         0.000389384141
<QC>       [total_force(3,3)]:        -0.000715881041
<QC>       [total_force(3,4)]:        -0.010338981969
<QC>       [total_force(3,5)]:         0.000222370497
<QC>       [total_force(3,6)]:         0.009413645100

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   18 of   18 :
  displacing atom    6 in the +ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.180998 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.60531779429246 0.19256670323 0.00142931864 0.0360  0.000   12.00000000
 2    -13.79812181196595 0.13129618450 0.00167433217 0.4221 -0.681   12.00000000
 3    -13.79910864630104 0.13148537527 0.00120132798 0.0795  3.043   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.089973372829
   Final penalty energy   :       0.206377611564
   RMS occupancy error    :       0.065571
   Occupancy bounds       : [-0.094, 1.098]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.359990766658E+01     2.5262E-03     2.5262E-03
    2        -1.360012245030E+01     4.6880E-04     4.6880E-04    -2.1478E-04
    3        -1.360013766203E+01     2.1366E-04     2.1366E-04    -1.5212E-05
    4        -1.360013974659E+01     1.1255E-04     1.1255E-04    -2.0846E-06
    5        -1.360014030202E+01     2.9293E-05     2.9293E-05    -5.5543E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36001403020218E+01  Eh
     Estimated bandgap           =   2.1682E-01  Eh
     RMS occupancy error         =   2.9417E-12
     [H,K] commutator            =   2.9293E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9989E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009671561601E+01 Eh
   Predicted gain in energy  =      -8.26854138232136E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360096684995E+01     2.0946E-04     2.0946E-04
    2        -1.360096867606E+01     6.5451E-05     6.5451E-05    -1.8261E-06
    3        -1.360096884279E+01     2.6025E-05     2.6025E-05    -1.6673E-07
    4        -1.360096886878E+01     8.7959E-06     8.7959E-06    -2.5999E-08
    5        -1.360096887306E+01     2.4721E-06     2.4721E-06    -4.2748E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009688730591E+01  Eh
     Estimated bandgap           =   2.1628E-01  Eh
     RMS occupancy error         =   1.2195E-16
     [H,K] commutator            =   2.4721E-06
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.4552E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009945478411E+01 Eh
   Predicted gain in energy  =      -2.56747819502579E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360099443221E+01     9.3901E-05     9.3901E-05
    2        -1.360099477650E+01     3.5395E-05     3.5395E-05    -3.4429E-07
    3        -1.360099482009E+01     9.6097E-06     9.6097E-06    -4.3587E-08
    4        -1.360099482381E+01     2.8572E-06     2.8572E-06    -3.7229E-09
    5        -1.360099482430E+01      8.775E-07      8.775E-07     -4.893E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000087750878      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009948242979E+01  Eh
     Estimated bandgap           =   2.1574E-01  Eh
     RMS occupancy error         =   7.4463E-17
     [H,K] commutator            =   8.7751E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.6997E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009972542352E+01 Eh
   Predicted gain in energy  =      -2.42993734111963E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360099720666E+01     4.4099E-05     4.4099E-05
    2        -1.360099728561E+01     1.5148E-05     1.5148E-05    -7.8953E-08
    3        -1.360099729369E+01     4.2093E-06     4.2093E-06    -8.0735E-09
    4        -1.360099729428E+01     1.0227E-06     1.0227E-06    -5.9391E-10
    5        -1.360099729434E+01      2.581E-07      2.581E-07     -6.455E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000025808821      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009972943435E+01  Eh
     Estimated bandgap           =   2.1606E-01  Eh
     RMS occupancy error         =   8.0730E-17
     [H,K] commutator            =   2.5809E-07
     Occupancy bounds            = [ -0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  2.6926E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36009975212300E+01 Eh
   Predicted gain in energy  =      -2.26886481158317E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360099751780E+01     1.2491E-05     1.2491E-05
    2        -1.360099752415E+01     4.4631E-06     4.4631E-06    -6.3517E-09
    3        -1.360099752484E+01     1.1968E-06     1.1968E-06    -6.8824E-10
    4        -1.360099752489E+01      3.009E-07      3.009E-07     -4.974E-11

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000030094730      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36009975248925E+01  Eh
     Estimated bandgap           =   2.1597E-01  Eh
     RMS occupancy error         =   1.2572E-16
     [H,K] commutator            =   3.0095E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000385981415              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.89199848511269 |
           | Pseudopotential (local)    :      -58.66869196430994 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56513623194206 |
           | Hartree                    :       24.14656615804768 |
           | Exchange-correlation       :       -4.71700468123682 |
           | Ewald                      :       14.18099824555179 |
           | Total                      :      -13.60099752489253 |
           --------------------------------------------------------
           Integrated density           :       11.99999999999999
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00049989351253    -13.60014030202182   0.240546    -13.60096715616005        
   1     0.00009455249034    -13.60096887305912   0.208390    -13.60099454784107        
   2     0.00003699724171    -13.60099482429785   0.129057    -13.60099725423520        
   3     0.00002692557218    -13.60099729434351   0.023133    -13.60099752122999        
   4     0.00000385981415    -13.60099752489254  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.600997524893
<QC>           [rms_gradient]:         0.000003859814
<QC>       [total_force(1,1)]:        -0.002003530576
<QC>       [total_force(1,2)]:        -0.000226357442
<QC>       [total_force(1,3)]:         0.001217297770
<QC>       [total_force(1,4)]:         0.010017668828
<QC>       [total_force(1,5)]:        -0.000267884635
<QC>       [total_force(1,6)]:        -0.008737193945
<QC>       [total_force(2,1)]:         0.001919541633
<QC>       [total_force(2,2)]:         0.000723606852
<QC>       [total_force(2,3)]:        -0.001573483951
<QC>       [total_force(2,4)]:         0.010649742955
<QC>       [total_force(2,5)]:         0.001361961208
<QC>       [total_force(2,6)]:        -0.013081368697
<QC>       [total_force(3,1)]:         0.000632834505
<QC>       [total_force(3,2)]:        -0.000171563642
<QC>       [total_force(3,3)]:        -0.000753355902
<QC>       [total_force(3,4)]:         0.011060568276
<QC>       [total_force(3,5)]:         0.000949178990
<QC>       [total_force(3,6)]:        -0.011717662227

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Force constant calculation   18 of   18 :
  displacing atom    6 in the -ve z-direction by  0.100000 bohr
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Determining parallel strategy ...... done
Calculating Ewald energy ...               14.061702 Hartree
Basis initialisation ...... done
Sparse matrix initialisation ... done

Reading NGWFs from file "ethene_phonon.tightbox_ngwfs" ...  done

Reading density kernel from file "ethene_phonon.dkn" ... done
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
 1    -13.59468783682881 0.19391544860 0.00151214541 0.0356  0.000   12.00000000
 2    -13.78519578033793 0.13350727514 0.00256972048 0.4521 -0.688   12.00000000
 3    -13.78625248865527 0.13369511004 0.00110615008 0.0788  3.051   12.00000000

======================== Penalty functional minimisation =======================
   Final total energy     :     -14.077038944612
   Final penalty energy   :       0.198412916382
   RMS occupancy error    :       0.064293
   Occupancy bounds       : [-0.093, 1.097]
================================================================================

Finished density kernel iterations (   3)

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360027077054E+01     2.0341E-03     2.0341E-03
    2        -1.360041076051E+01     4.2035E-04     4.2035E-04    -1.3999E-04
    3        -1.360042384101E+01     2.3753E-04     2.3753E-04    -1.3080E-05
    4        -1.360042579046E+01     9.3848E-05     9.3848E-05    -1.9494E-06
    5        -1.360042622956E+01     2.6245E-05     2.6245E-05    -4.3910E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36004262295566E+01  Eh
     Estimated bandgap           =   2.1764E-01  Eh
     RMS occupancy error         =   1.5664E-12
     [H,K] commutator            =   2.6245E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.9373E-04 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012384656861E+01 Eh
   Predicted gain in energy  =      -8.12236129426935E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360123852662E+01     2.0997E-04     2.0997E-04
    2        -1.360123975206E+01     5.1927E-05     5.1927E-05    -1.2254E-06
    3        -1.360123987509E+01     2.2479E-05     2.2479E-05    -1.2303E-07
    4        -1.360123989752E+01     7.6393E-06     7.6393E-06    -2.2427E-08
    5        -1.360123990032E+01     3.2269E-06     3.2269E-06    -2.8024E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012399003220E+01  Eh
     Estimated bandgap           =   2.1681E-01  Eh
     RMS occupancy error         =   6.2822E-17
     [H,K] commutator            =   3.2269E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  8.9340E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012616106504E+01 Eh
   Predicted gain in energy  =      -2.17103283279840E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360126140461E+01     8.6654E-05     8.6654E-05
    2        -1.360126167805E+01     2.9190E-05     2.9190E-05    -2.7344E-07
    3        -1.360126170951E+01     9.4903E-06     9.4903E-06    -3.1464E-08
    4        -1.360126171298E+01     2.6368E-06     2.6368E-06    -3.4656E-09
    5        -1.360126171344E+01      8.627E-07      8.627E-07     -4.574E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000086270470      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012617134371E+01  Eh
     Estimated bandgap           =   2.1624E-01  Eh
     RMS occupancy error         =   1.2620E-16
     [H,K] commutator            =   8.6270E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.5112E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012670870370E+01 Eh
   Predicted gain in energy  =      -5.37359990460118E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360126698282E+01     6.6499E-05     6.6499E-05
    2        -1.360126715300E+01     2.1670E-05     2.1670E-05    -1.7018E-07
    3        -1.360126717058E+01     6.9044E-06     6.9044E-06    -1.7577E-08
    4        -1.360126717217E+01     1.7680E-06     1.7680E-06    -1.5979E-09
    5        -1.360126717239E+01      4.701E-07      4.701E-07     -2.157E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000047013464      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012671723898E+01  Eh
     Estimated bandgap           =   2.1674E-01  Eh
     RMS occupancy error         =   9.1422E-17
     [H,K] commutator            =   4.7013E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.3679E-05 >  2.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
  ========================================================================
   Predicted total energy    =      -1.36012676549977E+01 Eh
   Predicted gain in energy  =      -4.82607964258364E-07 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -1.360126764874E+01     1.7786E-05     1.7786E-05
    2        -1.360126766090E+01     6.0796E-06     6.0796E-06    -1.2155E-08
    3        -1.360126766226E+01     1.8827E-06     1.8827E-06    -1.3600E-09
    4        -1.360126766238E+01      4.792E-07      4.792E-07     -1.228E-10

                 ..............................................
                 | RMS LNV GRADIENT=    0.00000047918298      |
                 | LNV density kernel optimisation converged! |
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -1.36012676623821E+01  Eh
     Estimated bandgap           =   2.1661E-01  Eh
     RMS occupancy error         =   1.4974E-16
     [H,K] commutator            =   4.7918E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000424215716              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :        9.83714153033891 |
           | Pseudopotential (local)    :      -58.41285357624327 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        1.56398094879513 |
           | Hartree                    :       24.05050649577944 |
           | Exchange-correlation       :       -4.70174509238714 |
           | Ewald                      :       14.06170203133480 |
           | Total                      :      -13.60126766238215 |
           --------------------------------------------------------
           Integrated density           :       12.00000000000000
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00049372720792    -13.60042622955663   0.242232    -13.60123846568606        
   1     0.00008934033483    -13.60123990032204   0.197268    -13.60126161065036        
   2     0.00004511244825    -13.60126171343709   0.191954    -13.60126708703700        
   3     0.00003367882934    -13.60126717238978   0.031434    -13.60126765499774        
   4     0.00000424215716    -13.60126766238214  <-- CG                                 
 
<QC>        [NGWF iterations]:                      5
<QC>           [total_energy]:       -13.601267662382
<QC>           [rms_gradient]:         0.000004242157
<QC>       [total_force(1,1)]:        -0.001910517830
<QC>       [total_force(1,2)]:        -0.000156312020
<QC>       [total_force(1,3)]:         0.001405043278
<QC>       [total_force(1,4)]:        -0.005108216319
<QC>       [total_force(1,5)]:        -0.001777418423
<QC>       [total_force(1,6)]:         0.007547421315
<QC>       [total_force(2,1)]:         0.001541577787
<QC>       [total_force(2,2)]:        -0.000155666862
<QC>       [total_force(2,3)]:        -0.000786884266
<QC>       [total_force(2,4)]:        -0.011292580330
<QC>       [total_force(2,5)]:         0.000308392616
<QC>       [total_force(2,6)]:         0.010385161055
<QC>       [total_force(3,1)]:         0.001476748435
<QC>       [total_force(3,2)]:         0.001746194960
<QC>       [total_force(3,3)]:        -0.001455604037
<QC>       [total_force(3,4)]:        -0.012418385002
<QC>       [total_force(3,5)]:         0.000706599222
<QC>       [total_force(3,6)]:         0.009944446422
(P)ZHEGVX in subroutine dense_eigensolve returned info=    1
 ifail=           1
 iclustr=           0
 gap=  -1.00000000000000     

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Gamma phonon frequencies         (cm^-1)                 (THz)

                1:       -73.93219071568        -2.21643131800
                2:       -70.58686668437        -2.11614102658
                3:       -59.14037068172        -1.77298370937
                4:       -50.64770843583        -1.51838010040
                5:       299.79969366235         8.98776870707
                6:       348.64413241449        10.45208814238
                7:       810.22309149192        24.28987721267
                8:       941.54134058029        28.22669928012
                9:       946.32016904699        28.36996495336
               10:      1045.53706508277        31.34441266713
               11:      1204.28261012172        36.10348438150
               12:      1338.26955731207        40.12031200532
               13:      1422.21037599839        42.63679444137
               14:      1826.57867681376        54.75945112524
               15:      3099.47804780864        92.92001424696
               16:      3103.82022172350        93.05018934606
               17:      3202.94970173085        96.02201639323
               18:      3217.21440248963        96.44966136354
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
<QC>          [phonon_freq_1]:        -0.000053612918
<QC>         [phonon_freq_3N]:         0.002333006083
WARNING: Imaginary phonon frequencies excluded from the computation of the zero-point energy

Zero-point energy =    0.05195787840 Eh
<QC>      [zero_point_energy]:         0.051957878405

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
                             Helmholtz                                    Internal              Specific
 Temperature (K)      free energy (Eh)        Entropy (Eh/K)           energy (Eh)           heat (Eh/K)

   0.00000000000         0.05195787840         0.00000000000         0.05195787840         0.00000000000
WARNING: Low phonon frequencie excluded from the computation of thermodynamic quantities
   4.73662535561         0.05195787840         0.00000000000         0.05195787840         0.00000000000
   9.47325071121         0.05195787840         0.00000000000         0.05195787840         0.00000000000
  14.20987606682         0.05195787840         0.00000000000         0.05195787840         0.00000000000
  18.94650142243         0.05195787840         0.00000000000         0.05195787840         0.00000000000
  23.68312677804         0.05195787840         0.00000000000         0.05195787842         0.00000000001
  28.41975213364         0.05195787838         0.00000000001         0.05195787879         0.00000000021
  33.15637748925         0.05195787814         0.00000000011         0.05195788189         0.00000000140
  37.89300284486         0.05195787682         0.00000000053         0.05195789679         0.00000000566
  42.62962820047         0.05195787191         0.00000000173         0.05195794582         0.00000001648
  47.36625355607         0.05195785799         0.00000000447         0.05195806992         0.00000003808
  52.10287891168         0.05195782564         0.00000000968         0.05195832994         0.00000007447
  56.83950426729         0.05195776083         0.00000001835         0.05195880357         0.00000012865
  61.57612962290         0.05195764489         0.00000003142         0.05195957935         0.00000020219
  66.31275497850         0.05195745500         0.00000004969         0.05196074977         0.00000029519
  71.04938033411         0.05195716505         0.00000007375         0.05196240486         0.00000040657
  75.78600568972         0.05195674660         0.00000010399         0.05196462730         0.00000053438
  80.52263104533         0.05195616993         0.00000014057         0.05196748922         0.00000067616
  85.25925640093         0.05195540489         0.00000018351         0.05197105058         0.00000082926
  89.99588175654         0.05195442172         0.00000023265         0.05197535881         0.00000099110
  94.73250711215         0.05195319158         0.00000028774         0.05198044947         0.00000115926
  99.46913246776         0.05195168704         0.00000034845         0.05198634741         0.00000133164
 104.20575782336         0.05194988229         0.00000041443         0.05199306832         0.00000150649
 108.94238317897         0.05194775335         0.00000048528         0.05200062040         0.00000168239
 113.67900853458         0.05194527809         0.00000056059         0.05200900597         0.00000185827
 118.41563389018         0.05194243623         0.00000064001         0.05201822299         0.00000203336
 123.15225924579         0.05193920926         0.00000072315         0.05202826642         0.00000220715
 127.88888460140         0.05193558033         0.00000080968         0.05203912936         0.00000237936
 132.62550995701         0.05193153410         0.00000089930         0.05205080402         0.00000254989
 137.36213531261         0.05192705661         0.00000099173         0.05206328249         0.00000271878
 142.09876066822         0.05192213516         0.00000108672         0.05207655733         0.00000288618
 146.83538602383         0.05191675809         0.00000118407         0.05209062199         0.00000305232
 151.57201137944         0.05191091471         0.00000128359         0.05210547113         0.00000321747
 156.30863673504         0.05190459514         0.00000138512         0.05212110083         0.00000338195
 161.04526209065         0.05189779019         0.00000148852         0.05213750866         0.00000354608
 165.78188744626         0.05189049128         0.00000159367         0.05215469372         0.00000371019
 170.51851280187         0.05188269029         0.00000170050         0.05217265662         0.00000387457
 175.25513815747         0.05187437954         0.00000180890         0.05219139941         0.00000403953
 179.99176351308         0.05186555168         0.00000191883         0.05221092544         0.00000420533
 184.72838886869         0.05185619966         0.00000203022         0.05223123930         0.00000437222
 189.46501422430         0.05184631663         0.00000214303         0.05225234661         0.00000454039
 194.20163957990         0.05183589597         0.00000225723         0.05227425391         0.00000471004
 198.93826493551         0.05182493118         0.00000237278         0.05229696851         0.00000488129
 203.67489029112         0.05181341590         0.00000248967         0.05232049834         0.00000505428
 208.41151564673         0.05180134388         0.00000260786         0.05234485181         0.00000522908
 213.14814100233         0.05178870895         0.00000272735         0.05237003768         0.00000540576
 217.88476635794         0.05177550503         0.00000284811         0.05239606492         0.00000558434
 222.62139171355         0.05176172609         0.00000297014         0.05242294259         0.00000576485
 227.35801706915         0.05174736618         0.00000309342         0.05245067979         0.00000594726
 232.09464242476         0.05173241941         0.00000321794         0.05247928548         0.00000613156
 236.83126778037         0.05171687992         0.00000334368         0.05250876846         0.00000631768
 241.56789313598         0.05170074195         0.00000347064         0.05253913727         0.00000650558
 246.30451849158         0.05168399978         0.00000359880         0.05257040014         0.00000669518
 251.04114384719         0.05166664775         0.00000372814         0.05260256492         0.00000688639
 255.77776920280         0.05164868030         0.00000385866         0.05263563903         0.00000707912
 260.51439455841         0.05163009190         0.00000399033         0.05266962944         0.00000727327
 265.25101991401         0.05161087714         0.00000412313         0.05270454263         0.00000746874
 269.98764526962         0.05159103065         0.00000425706         0.05274038455         0.00000766541
 274.72427062523         0.05157054719         0.00000439209         0.05277716065         0.00000786316
 279.46089598084         0.05154942159         0.00000452820         0.05281487581         0.00000806190
 284.19752133644         0.05152764877         0.00000466537         0.05285353436         0.00000826148
 288.93414669205         0.05150522376         0.00000480357         0.05289314008         0.00000846181
 293.67077204766         0.05148214171         0.00000494280         0.05293369619         0.00000866276
 298.40739740327         0.05145839786         0.00000508301         0.05297520538         0.00000886422
 303.14402275887         0.05143398756         0.00000522419         0.05301766977         0.00000906607
 307.88064811448         0.05140890630         0.00000536632         0.05306109096         0.00000926820
 312.61727347009         0.05138314966         0.00000550936         0.05310547005         0.00000947051
 317.35389882570         0.05135671336         0.00000565329         0.05315080760         0.00000967289
 322.09052418130         0.05132959324         0.00000579809         0.05319710370         0.00000987524
 326.82714953691         0.05130178526         0.00000594373         0.05324435797         0.00001007745
 331.56377489252         0.05127328550         0.00000609018         0.05329256957         0.00001027944
 336.30040024813         0.05124409019         0.00000623742         0.05334173722         0.00001048112
 341.03702560373         0.05121419566         0.00000638542         0.05339185923         0.00001068240
 345.77365095934         0.05118359838         0.00000653414         0.05344293350         0.00001088320
 350.51027631495         0.05115229495         0.00000668358         0.05349495759         0.00001108343
 355.24690167055         0.05112028210         0.00000683369         0.05354792866         0.00001128304
 359.98352702616         0.05108755668         0.00000698445         0.05360184356         0.00001148195
 364.72015238177         0.05105411567         0.00000713584         0.05365669881         0.00001168009
 369.45677773738         0.05101995618         0.00000728782         0.05371249064         0.00001187740
 374.19340309298         0.05098507542         0.00000744038         0.05376921501         0.00001207383
 378.93002844859         0.05094947077         0.00000759348         0.05382686762         0.00001226933
 383.66665380420         0.05091313968         0.00000774710         0.05388544391         0.00001246384
 388.40327915981         0.05087607976         0.00000790122         0.05394493912         0.00001265733
 393.13990451541         0.05083828871         0.00000805581         0.05400534828         0.00001284975
 397.87652987102         0.05079976436         0.00000821084         0.05406666624         0.00001304106
 402.61315522663         0.05076050466         0.00000836630         0.05412888767         0.00001323122
 407.34978058224         0.05072050766         0.00000852216         0.05419200708         0.00001342022
 412.08640593784         0.05067977153         0.00000867839         0.05425601886         0.00001360801
 416.82303129345         0.05063829452         0.00000883498         0.05432091725         0.00001379458
 421.55965664906         0.05059607503         0.00000899190         0.05438669641         0.00001397990
 426.29628200467         0.05055311153         0.00000914913         0.05445335037         0.00001416396
 431.03290736027         0.05050940260         0.00000930665         0.05452087309         0.00001434673
 435.76953271588         0.05046494692         0.00000946443         0.05458925846         0.00001452820
 440.50615807149         0.05041974326         0.00000962247         0.05465850030         0.00001470836
 445.24278342710         0.05037379049         0.00000978074         0.05472859237         0.00001488720
 449.97940878270         0.05032708757         0.00000993921         0.05479952842         0.00001506472
 454.71603413831         0.05027963354         0.00001009788         0.05487130213         0.00001524090
 459.45265949392         0.05023142753         0.00001025673         0.05494390717         0.00001541574
 464.18928484953         0.05018246876         0.00001041573         0.05501733721         0.00001558925
 468.92591020513         0.05013275652         0.00001057487         0.05509158589         0.00001576141
 473.66253556074         0.05008229019         0.00001073413         0.05516664686         0.00001593223
 478.39916091635         0.05003106922         0.00001089351         0.05524251378         0.00001610171
 483.13578627195         0.04997909313         0.00001105297         0.05531918032         0.00001626986
 487.87241162756         0.04992636150         0.00001121252         0.05539664016         0.00001643668
 492.60903698317         0.04987287402         0.00001137213         0.05547488702         0.00001660217
 497.34566233878         0.04981863041         0.00001153179         0.05555391464         0.00001676635
 502.08228769438         0.04976363045         0.00001169148         0.05563371678         0.00001692921
 506.81891304999         0.04970787402         0.00001185120         0.05571428727         0.00001709078
 511.55553840560         0.04965136103         0.00001201093         0.05579561996         0.00001725105
 516.29216376121         0.04959409145         0.00001217066         0.05587770873         0.00001741003
 521.02878911681         0.04953606532         0.00001233038         0.05596054754         0.00001756774
 525.76541447242         0.04947728272         0.00001249007         0.05604413037         0.00001772419
 530.50203982803         0.04941774380         0.00001264973         0.05612845129         0.00001787939
 535.23866518364         0.04935744873         0.00001280934         0.05621350438         0.00001803335
 539.97529053924         0.04929639777         0.00001296890         0.05629928381         0.00001818608
 544.71191589485         0.04923459118         0.00001312839         0.05638578380         0.00001833760
 549.44854125046         0.04917202932         0.00001328781         0.05647299862         0.00001848792
 554.18516660607         0.04910871253         0.00001344715         0.05656092261         0.00001863705
 558.92179196167         0.04904464125         0.00001360639         0.05664955018         0.00001878500
 563.65841731728         0.04897981593         0.00001376554         0.05673887578         0.00001893179
 568.39504267289         0.04891423706         0.00001392457         0.05682889394         0.00001907743
 573.13166802850         0.04884790517         0.00001408349         0.05691959926         0.00001922194
 577.86829338410         0.04878082082         0.00001424229         0.05701098639         0.00001936532
 582.60491873971         0.04871298462         0.00001440095         0.05710305005         0.00001950760
 587.34154409532         0.04864439721         0.00001455948         0.05719578502         0.00001964878
 592.07816945092         0.04857505924         0.00001471787         0.05728918615         0.00001978888
 596.81479480653         0.04850497142         0.00001487610         0.05738324835         0.00001992791
 601.55142016214         0.04843413446         0.00001503418         0.05747796660         0.00002006589
 606.28804551775         0.04836254912         0.00001519210         0.05757333595         0.00002020283
 611.02467087335         0.04829021618         0.00001534985         0.05766935148         0.00002033874
 615.76129622896         0.04821713644         0.00001550742         0.05776600837         0.00002047364
 620.49792158457         0.04814331074         0.00001566482         0.05786330185         0.00002060754
 625.23454694018         0.04806873992         0.00001582204         0.05796122720         0.00002074045
 629.97117229578         0.04799342486         0.00001597907         0.05805977976         0.00002087238
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-
<QC>            [temperature]:       629.971172295784
<QC>          [helmholtz_f_e]:         0.047993424860
<QC>                [entropy]:         0.000015979072
<QC>             [internal_e]:         0.058059779763
<QC>          [specific_heat]:         0.000020872379

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     330.317s on      4 proc(s)                                    
TOTAL TIME:       330.318s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :    37        0.00s   0.001%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.01s   0.002%  ------ ||
|| basis_extract_function_from_box      :  1248        0.01s   0.002%  ------ ||
|| density_init_guess_real              :     1        0.01s   0.002%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.01s   0.002%  ------ ||
|| dense_eigensolve                     :     1        0.01s   0.002%  ------ ||
|| restart_kernel_read                  :    36        0.01s   0.004%  ------ ||
|| sparse_set_to_garbage                :  1996        0.02s   0.005%  ------ ||
|| restart_kernel_write                 :    11        0.02s   0.005%  ------ ||
|| ewald_calculate_energy               :    37        0.06s   0.017%  ------ ||
|| basis_dot_function_with_box          : 45985        0.07s   0.021%  ------ ||
|| ewald_calculate_forces_recipspace    :    37        0.08s   0.025%  ------ ||
|| ewald_calculate_forces               :    37        0.11s   0.033%  ------ ||
|| sparse_init                          :    37        0.12s   0.036%  ------ ||
|| energy_and_force_init_cell           :     1        0.13s   0.039%  ------ ||
|| restart_ngwfs_tightbox_output        :     8        0.14s   0.042%  ------ ||
|| basis_add_function_to_box            : 101.8k       0.15s   0.044%  ------ ||
|| ngwf_gradient_coeffs                 :   190        0.22s   0.067%  ------ ||
|| pseudo_make_structure_factor         :    37        0.29s   0.087%  ------ ||
|| pseudopotentials_local_on_grid       :    37        0.31s   0.095%  ------ ||
|| sparse_embed_hotelling_invert_embed  :   345        0.32s   0.097%  ------ ||
|| pseudo_local_calculate_forces        :    37        0.37s   0.113%  ------ ||
|| function_ops_brappd_ketppd           :   345        0.40s   0.122%  ------ ||
|| fourier_apply_box_pair               :  1713        0.41s   0.124% 240.832 ||
|| pseudopotentials_nonlocal_mat        :   345        0.43s   0.131%  ------ ||
|| basis_copy_function_to_box           : 10362        0.48s   0.144%  ------ ||
|| lnv_gradient_norm                    :   884        0.85s   0.257%  ------ ||
|| integrals_grad                       :    37        0.99s   0.300%  ------ ||
|| nonsc_forces_ngwfs_calc              :    37        0.99s   0.300%  ------ ||
|| kernel_fix                           :   884        1.13s   0.341%  ------ ||
|| projectors_func_grad_ovlp_box        :   111        1.16s   0.352%  ------ ||
|| sparse_trace                         : 26675        1.17s   0.354%  ------ ||
|| pseudo_nl_calculate_forces           :    37        1.22s   0.369%  ------ ||
|| kernel_purify                        :  2809        1.24s   0.375%  ------ ||
|| cell_grid_extract_box_real           :  4744        1.25s   0.377%  ------ ||
|| restart_ngwfs_tightbox_input         :    36        1.85s   0.561%  ------ ||
|| density_batch_row_sums               :  2068        2.67s   0.808%  ------ ||
|| cell_grid_deposit_box_real           :  8274        2.83s   0.858%  ------ ||
|| sparse_product                       : 40851        3.05s   0.925%  ------ ||
|| projectors_gradient_batch            :   190        3.36s   1.016%  ------ ||
|| integrals_kinetic                    :   345        3.75s   1.135%  ------ ||
|| projectors_init_fftbox_recip         :   646        3.93s   1.188%  ------ ||
|| projectors_func_ovlp_box             :   345        4.27s   1.293%  ------ ||
|| hamiltonian_energy_components        :    37        4.45s   1.347%  ------ ||
|| forces_calculate                     :    37        4.80s   1.452%  ------ ||
|| density_fftbox_deposit_to_cell       :  8272        5.35s   1.619%  ------ ||
|| integrals_locpot_mat_els_batch       :   996        6.54s   1.980%  ------ ||
|| xc_energy_potential                  :  2032        6.75s   2.045%  ------ ||
|| fourier_apply_cell_forward           :  2069       11.69s   3.539%  12.845 ||
|| fourier_apply_cell_backward          :  2069       12.16s   3.681%  12.351 ||
|| fourier_apply_box                    : 23322       16.84s   5.097% 376.892 ||
|| density_fftbox_interpolate_multiply  :  8272       17.44s   5.280%  ------ ||
|| ngwf_gradient_build_batch            :   190       20.16s   6.105%  ------ ||
|| hartree_on_grid                      :  2032       24.20s   7.327%  ------ ||
|| penalty_denskernel_optimise_cg       :    37       32.60s   9.870%  ------ ||
|| ngwf_gradient_batch                  :   190       32.81s   9.932%  ------ ||
|| ngwf_gradient_lnv                    :   190       37.84s  11.456%  ------ ||
|| potential_apply_to_ngwf_batch        :   996       75.55s  22.871%  ------ ||
|| integrals_locpot_dbl_grid            :   996       83.10s  25.158%  ------ ||
|| density_batch_interp_deposit         :  2068      110.03s  33.309%  ------ ||
|| density_on_dbl_grid                  :  2068      124.20s  37.601%  ------ ||
|| hamiltonian_lhxc_calculate           :  1994      174.71s  52.891%  ------ ||
|| lnv_denskernel_optimise_cg           :   190      215.47s  65.232%  ------ ||
|| ngwf_cg_optimise                     :    37      288.02s  87.195%  ------ ||
|| energy_and_force_calculate           :    37      329.83s  99.851%  ------ ||
|| total_time                           :     1      330.32s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 1 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 3 ms printing in order.

Job completed: 21-09-2022 10:30 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
