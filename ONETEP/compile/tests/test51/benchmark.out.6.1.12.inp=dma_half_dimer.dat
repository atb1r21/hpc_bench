==================================================================================
It's Wed Sep 21 10:54:15 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 12202 12203 12204 12205)...
    - ONETEP arguments: dma_half_dimer.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test51
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test51/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test51/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack dma_half_dimer.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 10:54 (+0100)
 
Reading parameters from file "dma_half_dimer.dat" ...

WARNING: "cutoff_energy" not specified, but "psinc_spacing" specified.
         Using the latter to set the KE cutoff energy to  826.82697eV,
         thus *overriding* the default.

... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
      Default threads: 10
   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "dma_half_dimer.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

print_qc T                                                                      
%block swri                                                                     
for_dma 1 9 V 12 12 E                                                           
%endblock swri                                                                  
%block species_swri-for_dma                                                     
H1                                                                              
N1                                                                              
%endblock species_swri-for_dma                                                  
do_properties T                                                                 
ppd_npoints 5 5 5                                                               
dma_calculate T                                                                 
dma_use_ri for_dma                                                              
dma_max_l 1                                                                     
dma_max_q 8                                                                     
dma_metric ELECTROSTATIC                                                        
dma_bessel_averaging F                                                          
dma_scale_charge T                                                              
dma_target_num_val_elec 8                                                       
minit_lnv 5                                                                     
maxit_lnv 5                                                                     
write_forces T                                                                  
write_denskern F                                                                
write_tightbox_ngwfs F                                                          
xc_functional PBE                                                               
maxit_ngwf_cg 20                                                                
ngwf_threshold_orig : 0.00001                                                   
charge 0                                                                        
write_density_plot F                                                            
cube_format F                                                                   
dx_format F                                                                     
psinc_spacing 0.5 0.5 0.5                                                       
%block species                                                                  
N   N   7 4 5.0                                                                 
H   H   1 1 5.0                                                                 
N1  N   7 4 5.0                                                                 
H1  H   1 1 5.0                                                                 
%endblock species                                                               
%block species_pot                                                              
H   "../../pseudo/hydrogen.recpot"                                              
N   "../../pseudo/nitrogen.recpot"                                              
H1  "../../pseudo/hydrogen.recpot"                                              
N1  "../../pseudo/nitrogen.recpot"                                              
%endblock species_pot                                                           
%block lattice_cart                                                             
55.00000000   0.00000000   0.00000000                                           
0.00000000  55.00000000   0.00000000                                            
0.00000000   0.00000000  55.00000000                                            
%endblock lattice_cart                                                          
%block positions_abs                                                            
     Hash =  -000001386253300418802101
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/nitrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  7;  ionic charge:  5.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  N          2         8         2
  H          6         6         0
.......   ......    ......    ......
Totals:      8        14         2
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:  110 x 110 x 110
                              FFT-box:   75 x  75 x  75
                                  PPD:    5 x   5 x   5
Grid space d1=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.82697eV)
Grid space d2=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.82697eV)
Grid space d3=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.82697eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:    110   110   110
          Real-space ('12') slabs/proc (min max mean):     27    28    27
         Recip-space ('23') slabs/proc (min max mean):     14    14    14
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    220   220   220
          Real-space ('12') slabs/proc (min max mean):     55    55    55
         Recip-space ('23') slabs/proc (min max mean):     27    28    27
********************************************************************************

Atom SCF Calculation for N  : Z (AE atom) =   7 : Z (PS atom) =   5
Config String:
Orbitals (num,occ):  2     2.00 3.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  45 iterations to a total energy of     -9.49668791

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Atom SCF converged after  43 iterations to a total energy of     -0.39525197

Atom SCF Calculation for N  : Z (AE atom) =   7 : Z (PS atom) =   5
Config String:
Orbitals (num,occ):  2     2.00 3.00
Orbitals   (num,l):  2        0    1
Atom SCF converged after  45 iterations to a total energy of     -9.49668791

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Atom SCF converged after  43 iterations to a total energy of     -0.39525197

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

Determining parallel strategy ...... done
Calculating Ewald energy ...               18.303885 Hartree
Basis initialisation ...... done

Initialising remote NGWF capability... done. 

SWRI: Initialising module (stage 1)... 
SWRI: [for_dma] Initialising (stage 1)...
SWRI: [for_dma] - Using default V metric matrix evaluation scheme (2D numerical-1D analytic).
SWRI: [for_dma] - Initialising Bessels (l_max=1)... done.
SWRI: [for_dma] - SW batch size (tile width) set to 36.
SWRI: [for_dma] - Initialising persistent cache structures... done.
SWRI: [for_dma] - Initialising metric matrix... done.
SWRI: [for_dma] Done.
SWRI: Stage 1 completed.
Sparse matrix initialisation ... done

SWRI: Initializing module (stage 2)... 
SWRI: [for_dma] Initialising (stage 2)... 
SWRI: [for_dma] - NL: Populating neighbour list: SWRI_S_ATOMS... done.
SWRI: [for_dma] - Generating and communicating atomblock list.
SWRI: [for_dma]   0 atomblocks read from disk.
SWRI: [for_dma]   15 atomblocks to process.
SWRI: [for_dma]   Sorting atomblocks according to proximitiy to (0.000000,    0.000000,    0.000000).
SWRI: [for_dma] - Calculating on-site elements of the metric matrix V... done.
SWRI: [for_dma] - Calculating off-site elements of the metric matrix V.
 +----------------------------------------------------+
 |  Spherical wave res. of identity Chebyshev engine  |
 |  Estimated memory requirement per MPI rank         |
 +----------------------------------------------------+
 |  workspace atomblock                 :   10.12 kB  |
 |  vtile                               :   10.12 kB  |
 |  recvtile                            :   10.12 kB  |
 |  workers_done                        :   16.00  B  |
 |  atomblocklist                       :  300.00  B  |
 |  tilelist (root only)                :  180.00  B  |
 |  tile hash table (upper bound)       :   40.50 kB  |
 |  nodes_template                      :  162.00 kB  |
 |  swop_values                         :    1.58 MB  |
 |  swy_values                          :    1.58 MB  |
 |  swhome_all_coeffs                   :    5.70 MB  |
 |  swpot_batch_coeffs                  :    5.70 MB  |
 |  all_atomblocks (indices)            :  336.00  B  |
 |  my_atomblocks (indices)             :  336.00  B  |
 |  num_q_per_l                         :   32.00  B  |
 |  atomblock rotation matrix           :   10.12 kB  |
 +----------------------------------------------------+
 |  Estimated peak total per MPI rank   :   14.79 MB  |
 +----------------------------------------------------+
SWRI: [for_dma]   15 tiles to process (15 atomblocks x 1 batches)
SWRI: [for_dma]   Tiles completed:        0, left:       14, in progress:     1.
SWRI: [for_dma]   Tiles completed:        3, left:        8, in progress:     4.
SWRI: [for_dma]   Tiles completed:        5, left:        6, in progress:     4.
SWRI: [for_dma]   Tiles completed:        9, left:        2, in progress:     4.
SWRI: [for_dma]   Tiles completed:       13, left:        0, in progress:     2.
SWRI: [for_dma] - Filling the remainder by symmetry.
SWRI: Done.
SWX: Initialising module... 
SWX: Initialising val%[properties_dma_swex-1]->part-RI->[for_dma].
SWX: - min_l: 0, max_l: 1, max_q: 8, num_sws: 32, max_sws: 32.
SWX: Done.
done.
NGWF initialisation ...... done
SWX: Invalidating val%[properties_dma_swex-1].
Up spin density kernel initialisation ...... done

>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.304485531987E+01     3.1546E-02     2.7603E-02
    2        -2.307749510295E+01     6.3059E-03     5.5177E-03    -3.2640E-02
    3        -2.307946723655E+01     1.2334E-03     1.0792E-03    -1.9721E-03
    4        -2.307962874673E+01     3.8029E-04     3.3275E-04    -1.6151E-04
    5        -2.307963378275E+01     7.8601E-05     6.8776E-05    -5.0360E-06
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.30796337827548E+01  Eh
     Estimated bandgap           =   3.5394E-01  Eh
     RMS occupancy error         =   1.0550E-10
     [H,K] commutator            =   6.8776E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.4553E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.34113126870027E+01 Eh
   Predicted gain in energy  =      -3.31678904247852E-01 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.340861103541E+01     4.5306E-03     3.9643E-03
    2        -2.340985057142E+01     1.6049E-03     1.4043E-03    -1.2395E-03
    3        -2.340999158367E+01     8.4502E-04     7.3939E-04    -1.4101E-04
    4        -2.341002645830E+01     3.6504E-05     3.1941E-05    -3.4875E-05
    5        -2.341002655190E+01     1.6740E-05     1.4647E-05    -9.3603E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.34100265518997E+01  Eh
     Estimated bandgap           =   3.9949E-01  Eh
     RMS occupancy error         =   3.9271E-14
     [H,K] commutator            =   1.4647E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.4353E-03 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.34937612757323E+01 Eh
   Predicted gain in energy  =      -8.37347238325812E-02 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.349216875437E+01     6.6981E-03     5.8608E-03
    2        -2.349361991045E+01     1.0211E-03     8.9347E-04    -1.4512E-03
    3        -2.349368052712E+01     2.5135E-04     2.1993E-04    -6.0617E-05
    4        -2.349368628486E+01     5.4243E-05     4.7463E-05    -5.7577E-06
    5        -2.349368639445E+01     1.3848E-05     1.2117E-05    -1.0959E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.34936863944530E+01  Eh
     Estimated bandgap           =   3.9608E-01  Eh
     RMS occupancy error         =   5.5112E-14
     [H,K] commutator            =   1.2117E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  9.8175E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.35202777481278E+01 Eh
   Predicted gain in energy  =      -2.65913536747320E-02 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.351964378118E+01     4.7495E-03     4.1558E-03
    2        -2.352036764150E+01     3.3033E-04     2.8904E-04    -7.2386E-04
    3        -2.352037620683E+01     1.2143E-04     1.0625E-04    -8.5653E-06
    4        -2.352037727795E+01     3.1812E-05     2.7836E-05    -1.0711E-06
    5        -2.352037731636E+01     7.6247E-06     6.6717E-06    -3.8409E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.35203773163574E+01  Eh
     Estimated bandgap           =   3.8216E-01  Eh
     RMS occupancy error         =   9.3366E-15
     [H,K] commutator            =   6.6717E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  4.3532E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.35238644671872E+01 Eh
   Predicted gain in energy  =      -3.48715082981244E-03 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.352382582422E+01     1.0475E-03     9.1658E-04
    2        -2.352386277630E+01     1.6039E-04     1.4034E-04    -3.6952E-05
    3        -2.352386500688E+01     5.8750E-05     5.1406E-05    -2.2306E-06
    4        -2.352386524765E+01     7.5574E-06     6.6128E-06    -2.4078E-07
    5        -2.352386524993E+01     2.6254E-06     2.2972E-06    -2.2783E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.35238652499310E+01  Eh
     Estimated bandgap           =   3.7110E-01  Eh
     RMS occupancy error         =   1.1932E-16
     [H,K] commutator            =   2.2972E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.9196E-04 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.35247109064513E+01 Eh
   Predicted gain in energy  =      -8.45656520336746E-04 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.352470706028E+01     3.8390E-04     3.3591E-04
    2        -2.352471312263E+01     1.2378E-04     1.0831E-04    -6.0624E-06
    3        -2.352471408519E+01     4.4932E-05     3.9315E-05    -9.6256E-07
    4        -2.352471425266E+01     3.3899E-06     2.9661E-06    -1.6747E-07
    5        -2.352471425334E+01     1.8824E-06     1.6471E-06    -6.8017E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.35247142533396E+01  Eh
     Estimated bandgap           =   3.6173E-01  Eh
     RMS occupancy error         =   1.1893E-16
     [H,K] commutator            =   1.6471E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  6.6480E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.35247673367217E+01 Eh
   Predicted gain in energy  =      -5.30833821059673E-05 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.352476598981E+01     1.6695E-04     1.4608E-04
    2        -2.352476704218E+01     4.3103E-05     3.7715E-05    -1.0524E-06
    3        -2.352476715778E+01     1.4018E-05     1.2266E-05    -1.1561E-07
    4        -2.352476717506E+01     1.4514E-06     1.2700E-06    -1.7273E-08
    5        -2.352476717518E+01     8.2606E-07     7.2280E-07    -1.2141E-10
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.35247671751793E+01  Eh
     Estimated bandgap           =   3.6825E-01  Eh
     RMS occupancy error         =   1.7394E-16
     [H,K] commutator            =   7.2280E-07
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0797E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.35247685516033E+01 Eh
   Predicted gain in energy  =      -1.37642395614535E-06 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.352476853400E+01     2.1386E-05     1.8713E-05
    2        -2.352476855158E+01     5.9283E-06     5.1873E-06    -1.7570E-08
    3        -2.352476855381E+01     2.0552E-06     1.7983E-06    -2.2331E-09
    4        -2.352476855417E+01     1.8802E-07     1.6452E-07    -3.6368E-10
    5        -2.352476855417E+01     1.0433E-07     9.1293E-08    -1.8723E-12
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.35247685541738E+01  Eh
     Estimated bandgap           =   3.6653E-01  Eh
     RMS occupancy error         =   1.0883E-16
     [H,K] commutator            =   9.1293E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.2853E-05 >  1.0000E-05  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
SWX: Invalidating val%[properties_dma_swex-1].
  ========================================================================
   Predicted total energy    =      -2.35247685920209E+01 Eh
   Predicted gain in energy  =      -3.78470481621207E-08 Eh
  ========================================================================


>>> Optimising kernel for current NGWFs:
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
    1        -2.352476859157E+01     3.3945E-06     2.9702E-06
    2        -2.352476859202E+01     9.4853E-07     8.2996E-07    -4.4327E-10
    3        -2.352476859207E+01     3.3362E-07     2.9192E-07    -5.7643E-11
    4        -2.352476859208E+01     7.9141E-08     6.9248E-08    -7.9901E-12
    5        -2.352476859208E+01     8.8338E-08     7.7295E-08    -1.3216E-12
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -2.35247685920824E+01  Eh
     Estimated bandgap           =   3.6662E-01  Eh
     RMS occupancy error         =   6.0425E-17
     [H,K] commutator            =   7.7295E-08
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################

>>> Checking for convergence of NGWFs: 
           ........................................................
           |         *** NGWF optimisation converged ***          |
           | RMS NGWF gradient =    0.00000521609936              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       17.88619097773759 |
           | Pseudopotential (local)    :      -92.05847593498078 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        2.63577549759585 |
           | Hartree                    :       37.04835659182253 |
           | Exchange-correlation       :       -7.34050048526491 |
           | Ewald                      :       18.30388476100728 |
           | Total                      :      -23.52476859208244 |
           --------------------------------------------------------
           Integrated density           :       15.99999999999996
================================================================================


                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00345532354809    -23.07963378275480   0.947445    -23.41131268700266        
   1     0.00143527548704    -23.41002655189975   1.393364    -23.49376127573233        
   2     0.00098174713069    -23.49368639445302   0.945902    -23.52027774812775        
   3     0.00043532268663    -23.52037731635739   0.624474    -23.52386446718721        
   4     0.00019196393845    -23.52386524993101   0.782652    -23.52471090645134        
   5     0.00006648035625    -23.52471425333960   0.409624    -23.52476733672170        
   6     0.00003079670660    -23.52476717517931   0.049495    -23.52476855160326        
   7     0.00001285321186    -23.52476855417381   0.007813    -23.52476859202086        
   8     0.00000521609936    -23.52476859208242  <-- CG                                 
 
<QC>        [NGWF iterations]:                      9
<QC>           [total_energy]:       -23.524768592082
<QC>           [rms_gradient]:         0.000005216099
SWX: val%[properties_dma_swex-1]: Fitting local NGWF pairs (V).
<QC>      [atom_1_population]:         5.585599893019
<QC>          [atom_1_charge]:        -0.585599893019
<QC>      [atom_2_population]:         0.805931456735
<QC>          [atom_2_charge]:         0.194068543265
<QC>      [atom_3_population]:         0.806208175988
<QC>          [atom_3_charge]:         0.193791824012

    Mulliken Atomic Populations
    ---------------------------
Species  Ion    Total   Charge (e)
==================================
  N      1       5.586     -0.586
  H      2       0.806      0.194
  H      3       0.806      0.194
  H      4       0.802      0.198
  N      5       5.586     -0.586
  H      6       0.798      0.202
  H      7       0.797      0.203
  H      8       0.819      0.181
==================================

        Bond         Population      Length (bohr)
==================================================
 N     5 -- H     6        0.71      1.85469
 N     1 -- H     4        0.70      1.88722
 N     1 -- H     2        0.70      1.88896
 N     1 -- H     3        0.70      1.89441
 N     5 -- H     7        0.70      1.90403
 N     5 -- H     8        0.70      1.94989
 H     2 -- H     3       -0.04      3.01420
 H     6 -- H     7       -0.04      3.01602
 H     2 -- H     4       -0.04      3.02197
 H     3 -- H     4       -0.04      3.06367
 H     6 -- H     8       -0.04      3.10328
 H     7 -- H     8       -0.03      3.18302
==================================================


=================== Orbital energy and occupancy information ===================

      Total number of orbitals:      14
   Number of occupied orbitals:       8.000000000
   Occupancy sum (eigenvalues):       8.000000000
                 HOMO-LUMO gap:       0.366597605 Eh
                 Mid-gap level:      -0.000431019 Eh

                        Orbital | Energy (Eh) | Occupancy
                            1    -0.762397324   1.0000000
                            2    -0.742472427   1.0000000
                            3    -0.405223589   1.0000000
                            4    -0.399636091   1.0000000
                            5    -0.391967096   1.0000000
                            6    -0.388133519   1.0000000
                            7    -0.203535314   1.0000000
                            8    -0.183729821   1.0000000
                        .......   --- gap ---   .........
                            9     0.182867784   0.0000000
                           10     0.185102131   0.0000000
                           11     0.244173323   0.0000000
                           12     0.248977454   0.0000000
                           13     0.255049420   0.0000000
                           14     0.266531027   0.0000000
 
<QC>    [energy_eigenvalue_1]:        -0.762397324498
<QC>    [energy_eigenvalue_n]:         0.266531026779
<QC>            [occupancy_1]:         1.000000000000
<QC>            [occupancy_n]:         0.000000000000

================================================================================

===================== Writing canonical molecular orbitals =====================
| Orbital  Energy (eV)  Norm     |
| HOMO-5  -11.02669492  1.000000 | 
| HOMO-4  -10.87465138  1.000000 | 
| HOMO-3  -10.66596741  1.000000 | 
| HOMO-2  -10.56165047  1.000000 | 
| HOMO-1   -5.53847771  1.000000 | 
| HOMO     -4.99954283  1.000000 | 
| LUMO      4.97608559  1.000000 | 
| LUMO+1    5.03688529  1.000000 | 
| LUMO+2    6.64429420  1.000000 | 
| LUMO+3    6.77502127  1.000000 | 
| LUMO+4    6.94024787  1.000000 | 
| LUMO+5    7.25267828  1.000000 | 
================================================================================
 
===================== Density of States (DOS) calculation ======================
Writing "dma_half_dimer_DOS.txt" ...  done
================================================================================
 
Writing bands to file "dma_half_dimer.val_bands" ... done
DMA: total charge contribution from the monopoles:     8.002565
DMA: expected charge:                                  8.000000
DMA: charge scaling factor:                            0.999679
<QC>           [DMA_mp_5_0_0]:         4.981229773361
<QC>          [DMA_mp_5_1_m1]:        -0.413640497102
<QC>           [DMA_mp_5_1_0]:        -0.209661670049
<QC>           [DMA_mp_5_1_1]:         0.171356366820
<QC>             [DMA_mp_5_0]:        -4.981229773361
<QC>           [DMA_mp_5_1_x]:      -119.812263053694
<QC>           [DMA_mp_5_1_y]:      -138.983527306751
<QC>           [DMA_mp_5_1_z]:      -138.615106428802
<QC>           [DMA_mp_6_0_0]:         1.017999319712
<QC>          [DMA_mp_6_1_m1]:        -0.140107704136
<QC>           [DMA_mp_6_1_0]:         0.134159308329
<QC>           [DMA_mp_6_1_1]:        -0.062803945950
<QC>             [DMA_mp_6_0]:        -1.017999319712
<QC>           [DMA_mp_6_1_x]:       -24.096798107656
<QC>           [DMA_mp_6_1_y]:       -26.933703166331
<QC>           [DMA_mp_6_1_z]:       -29.151700367966
<QC>           [DMA_mp_7_0_0]:         0.997656366285
<QC>          [DMA_mp_7_1_m1]:         0.034589443927
<QC>           [DMA_mp_7_1_0]:         0.022190776980
<QC>           [DMA_mp_7_1_1]:         0.201678377899
<QC>             [DMA_mp_7_0]:        -0.997656366285
<QC>           [DMA_mp_7_1_x]:       -25.727512871563
<QC>           [DMA_mp_7_1_y]:       -27.754443977315
<QC>           [DMA_mp_7_1_z]:       -27.645298687938
<QC>           [DMA_mp_8_0_0]:         1.003114540642
<QC>          [DMA_mp_8_1_m1]:         0.021437951542
<QC>           [DMA_mp_8_1_0]:        -0.173533738564
<QC>           [DMA_mp_8_1_1]:        -0.100560973147
<QC>             [DMA_mp_8_0]:        -1.003114540642
<QC>           [DMA_mp_8_1_x]:       -23.502589117557
<QC>           [DMA_mp_8_1_y]:       -27.747128478326
<QC>           [DMA_mp_8_1_z]:       -26.248428948801
SWX: Destroying [properties_dma_swex-1]... done

********************* Unconstrained **********************
************************* Forces *************************
*                                                        *
* Element  Atom         Cartesian components (Eh/a)      *
* ------------------------------------------------------ *
*                       x            y            z      *
*                                                        *
*    N       1     -0.00812771  -0.00358634  -0.00334012 *
*    H       2      0.00290081   0.00683396  -0.01305161 *
*    H       3      0.00549268  -0.00880992   0.00537104 *
*    H       4      0.00088188   0.00887626   0.01253829 *
*    N       5     -0.00180933   0.02202830  -0.02255859 *
*    H       6     -0.01146261  -0.02539896   0.01315411 *
*    H       7      0.00234872   0.00156595  -0.00587172 *
*    H       8      0.00977556  -0.00150925   0.01375860 *
*                                                        *
**********************************************************
* TOTAL:            0.00000000  -0.00000000   0.00000000 *
**********************************************************
<QC>       [total_force(1,1)]:        -0.008127709169
<QC>       [total_force(1,2)]:         0.002900810173
<QC>       [total_force(1,3)]:         0.005492680024
<QC>       [total_force(1,4)]:         0.000881881519
<QC>       [total_force(1,5)]:        -0.001809331044
<QC>       [total_force(1,6)]:        -0.011462611849
<QC>       [total_force(1,7)]:         0.002348718655
<QC>       [total_force(1,8)]:         0.009775561691
<QC>       [total_force(2,1)]:        -0.003586335793
<QC>       [total_force(2,2)]:         0.006833957834
<QC>       [total_force(2,3)]:        -0.008809923264
<QC>       [total_force(2,4)]:         0.008876261037
<QC>       [total_force(2,5)]:         0.022028295773
<QC>       [total_force(2,6)]:        -0.025398959317
<QC>       [total_force(2,7)]:         0.001565954637
<QC>       [total_force(2,8)]:        -0.001509250905
<QC>       [total_force(3,1)]:        -0.003340119124
<QC>       [total_force(3,2)]:        -0.013051612960
<QC>       [total_force(3,3)]:         0.005371038874
<QC>       [total_force(3,4)]:         0.012538291771
<QC>       [total_force(3,5)]:        -0.022558587632
<QC>       [total_force(3,6)]:         0.013154114908
<QC>       [total_force(3,7)]:        -0.005871721758
<QC>       [total_force(3,8)]:         0.013758595921

Cleaning up after remote NGWF capability... done. 
SWX: Clean-up... done.
SWRI: Clean-up... done.

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     100.111s on      4 proc(s)                                    
TOTAL TIME:       100.111s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| compute_multipole_elms               :     2        0.00s   0.000%  ------ || (2 procs only)
|| swri_metric_mat_consistency          :     3        0.00s   0.000%  ------ ||
|| swri_vmatrixblock_sc                 :     5        0.00s   0.000%  ------ ||
|| ewald_calculate_forces_realspace     :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_sc                   :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_RSH_rotation         :     3        0.00s   0.000%  ------ ||
|| swri_metric_mat_wait_req_master      :     5        0.00s   0.000%  ------ || (1 procs only)
|| swri_metric_mat_wait_send            :     3        0.00s   0.000%  ------ ||
|| neighbour_list_populate              :     1        0.00s   0.000%  ------ ||
|| swri_metric_mat_oc_work_imbalance    :     2        0.00s   0.000%  ------ ||
|| swri_metric_mat_cheb_gen_nodes       :     1        0.00s   0.000%  ------ ||
|| remote_unpack_ngwf                   :    39        0.00s   0.000%  ------ ||
|| remote_pack_ngwf                     :    26        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    63        0.00s   0.000%  ------ ||
|| swri_extract_matrix_2                :    12        0.00s   0.001%  ------ || (2 procs only)
|| sparse_set_to_garbage                :   106        0.00s   0.001%  ------ ||
|| hash_table_purge_[COEFFS]            :    19        0.00s   0.001%  ------ ||
|| hash_table_purge_[TILES]             :     1        0.00s   0.001%  ------ ||
|| remote_obtain_coeffs                 :    56        0.00s   0.001%  ------ ||
|| linalg_dgesv                         :    39        0.00s   0.002%  ------ || (2 procs only)
|| ngwfs_initialise_from_radial         :     1        0.00s   0.001%  ------ ||
|| ewald_calculate_forces_recipspace    :     1        0.00s   0.001%  ------ ||
|| swri_metric_mat_allocs               :     1        0.00s   0.001%  ------ ||
|| swri_metric_mat_dispatch             :  2323        0.00s   0.002%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.002%  ------ ||
|| swx_communicate_coeffs               :     1        0.00s   0.002%  ------ ||
|| ewald_calculate_forces               :     1        0.00s   0.002%  ------ ||
|| hash_table_purge_[SWOPS_IN_PPDS]     :     1        0.00s   0.002%  ------ ||
|| swri_swop_calc_all_in_ppd            :   158        0.00s   0.003%  ------ ||
|| swri_metric_mat_symmetry             :     1        0.00s   0.003%  ------ ||
|| dense_eigensolve                     :     1        0.00s   0.005%  ------ ||
|| hash_table_list                      :     6        0.00s   0.005%  ------ ||
|| dma_calculate                        :     1        0.01s   0.005%  ------ ||
|| sparse_init                          :     1        0.01s   0.006%  ------ ||
|| basis_dot_function_with_box          :  2588        0.01s   0.006%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.01s   0.007%  ------ ||
|| remote_obtain_ngwf                   :    23        0.02s   0.017%  ------ || (2 procs only)
|| swri_metric_mat_wait_req_worker      :     4        0.01s   0.012%  ------ || (3 procs only)
|| ngwf_gradient_coeffs                 :     9        0.01s   0.010%  ------ ||
|| basis_add_function_to_box            :  5720        0.01s   0.013%  ------ ||
|| swx_swop_quantity_overlap_ppd        :    39        0.03s   0.029%  ------ || (2 procs only)
|| swri_metric_mat_eval_swpot           :   135        0.02s   0.016%  ------ ||
|| swri_metric_mat_cheb_int_product     :  2497        0.02s   0.016%  ------ ||
|| swri_metric_mat_home_sws             :     1        0.02s   0.017%  ------ ||
|| sparse_embed_hotelling_invert_embed  :    18        0.02s   0.019%  ------ ||
|| swri_metric_mat_cheb_expand          :   135        0.02s   0.022%  ------ ||
|| function_ops_brappd_ketppd           :    18        0.02s   0.022%  ------ ||
|| hash_table_free                      :     9        0.02s   0.022%  ------ ||
|| hash_table_purge_[NGWFS]             :    25        0.02s   0.024%  ------ ||
|| density_init_guess_real              :     1        0.03s   0.025%  ------ ||
|| pseudo_make_structure_factor         :     1        0.03s   0.031%  ------ ||
|| eigenstates_calculate                :     1        0.04s   0.036%  ------ ||
|| lnv_gradient_norm                    :    45        0.04s   0.037%  ------ ||
|| integrals_grad                       :     1        0.05s   0.046%  ------ ||
|| nonsc_forces_ngwfs_calc              :     1        0.05s   0.047%  ------ ||
|| basis_copy_function_to_box           :   602        0.05s   0.049%  ------ ||
|| kernel_fix                           :    45        0.06s   0.058%  ------ ||
|| internal_tile_by_chebs               :     3        0.06s   0.060%  ------ ||
|| fourier_apply_box_pair               :    96        0.06s   0.064% 235.999 ||
|| kernel_purify                        :   146        0.07s   0.066%  ------ ||
|| swx_local_ngwf_pair_fitting          :     1        0.07s   0.072%  ------ ||
|| swri_metric_mat_main_loop            :     1        0.07s   0.072%  ------ ||
|| projectors_func_grad_ovlp_box        :     3        0.07s   0.073%  ------ ||
|| swx_expand_local_ngwf_pairs          :     1        0.07s   0.074%  ------ ||
|| dma_expand_ngwf_pairs                :     1        0.07s   0.074%  ------ ||
|| pseudo_nl_calculate_forces           :     1        0.07s   0.074%  ------ ||
|| sparse_trace                         :  1329        0.08s   0.077%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.08s   0.078%  ------ ||
|| pseudo_local_calculate_forces        :     1        0.09s   0.094%  ------ ||
|| pseudopotentials_nonlocal_mat        :    18        0.10s   0.096%  ------ ||
|| swri_metric_mat_oc                   :     1        0.11s   0.107%  ------ ||
|| swri_init_container_stage_2          :     1        0.11s   0.108%  ------ ||
|| cell_grid_extract_box_real           :   224        0.18s   0.179%  ------ ||
|| sparse_product                       :  2033        0.20s   0.197%  ------ ||
|| energy_and_force_init_cell           :     1        0.20s   0.198%  ------ ||
|| density_batch_row_sums               :    94        0.32s   0.316%  ------ ||
|| integrals_kinetic                    :    18        0.35s   0.350%  ------ ||
|| projectors_func_ovlp_box             :    18        0.41s   0.409%  ------ ||
|| sw_init                              :     1        0.42s   0.418%  ------ ||
|| forces_calculate                     :     1        0.43s   0.425%  ------ ||
|| projectors_gradient_batch            :     9        0.43s   0.434%  ------ ||
|| projectors_init_fftbox_recip         :    30        0.47s   0.467%  ------ ||
|| cell_grid_deposit_box_real           :   428        0.47s   0.471%  ------ ||
|| integrals_locpot_mat_els_batch       :    47        0.61s   0.611%  ------ ||
|| hamiltonian_energy_components        :     1        0.88s   0.875%  ------ ||
|| density_fftbox_deposit_to_cell       :   376        1.06s   1.060%  ------ ||
|| properties_calculate                 :     1        1.17s   1.172%  ------ ||
|| fourier_apply_box                    :  1254        2.40s   2.398% 385.151 ||
|| density_fftbox_interpolate_multiply  :   376        2.56s   2.552%  ------ ||
|| ngwf_gradient_build_batch            :     9        2.68s   2.674%  ------ ||
|| ngwf_gradient_batch                  :     9        3.86s   3.860%  ------ ||
|| ngwf_gradient_lnv                    :     9        4.61s   4.604%  ------ ||
|| hartree_on_grid                      :    94       10.16s  10.148%  ------ ||
|| potential_apply_to_ngwf_batch        :    47       10.87s  10.857%  ------ ||
|| integrals_locpot_dbl_grid            :    47       11.54s  11.522%  ------ ||
|| density_batch_interp_deposit         :    94       15.61s  15.591%  ------ ||
|| density_on_dbl_grid                  :    94       18.72s  18.695%  ------ ||
|| fourier_apply_cell_backward          :   471       21.83s  21.803%  13.491 ||
|| fourier_apply_cell_forward           :   471       22.11s  22.088%  13.317 ||
|| xc_energy_potential                  :    94       42.80s  42.748%  ------ ||
|| hamiltonian_lhxc_calculate           :    92       77.59s  77.500%  ------ ||
|| lnv_denskernel_optimise_cg           :     9       81.94s  81.849%  ------ ||
|| ngwf_cg_optimise                     :     1       96.07s  95.963%  ------ ||
|| energy_and_force_calculate           :     1       99.60s  99.488%  ------ ||
|| total_time                           :     1      100.11s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 1 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 5 ms printing in order.

Job completed: 21-09-2022 10:55 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
