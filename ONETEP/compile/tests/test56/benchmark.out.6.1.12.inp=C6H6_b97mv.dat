==================================================================================
It's Wed Sep 21 10:58:33 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 16213 16214 16215 16216)...
    - ONETEP arguments: C6H6_b97mv.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test56
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test56/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test56/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack C6H6_b97mv.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 10:58 (+0100)
 
Reading parameters from file "C6H6_b97mv.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 10 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 10
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "C6H6_b97mv.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
    
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task: SINGLEPOINT                                                               
print_qc: TRUE                                                                  
output_detail: VERBOSE                                                          
maxit_lnv: 5                                                                    
maxit_ngwf_cg: 3                                                                
write_denskern       : FALSE                                                    
write_tightbox_ngwfs : FALSE                                                    
write_xyz            : FALSE                                                    
%block lattice_cart                                                             
ang                                                                             
18.000  0.000  0.000                                                            
0.000 26.000  0.000                                                             
0.000  0.000 22.300                                                             
%endblock lattice_cart                                                          
xc_functional        : B97M-V                                                   
cutoff_energy: 600 eV                                                           
%block species_pot                                                              
C "../../pseudo/carbon.recpot"                                                  
H "../../pseudo/hydrogen.recpot"                                                
%endblock species_pot                                                           
%block species                                                                  
C      C    6    4   8.00                                                       
H      H    1    1   8.00                                                       
%endblock species                                                               
%block positions_abs                                                            
     Hash =   000006691520887667119518
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          6        24         6
  H          6         6         0
.......   ......    ......    ......
Totals:     12        30         6
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   63 x  91 x  75
                              FFT-box:   63 x  91 x  75
                                  PPD:    7 x   7 x   1
Grid space d1=  0.539921752738a0 (KE cutoff=  26.05808Eh = 709.07634eV)
Grid space d2=  0.539921752738a0 (KE cutoff=  26.05808Eh = 709.07634eV)
Grid space d3=  0.561878570683a0 (KE cutoff=  24.06130Eh = 654.74125eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     63    91    75
          Real-space ('12') slabs/proc (min max mean):     18    19    18
         Recip-space ('23') slabs/proc (min max mean):      8     8     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    126   182   150
          Real-space ('12') slabs/proc (min max mean):     37    38    37
         Recip-space ('23') slabs/proc (min max mean):     16    16    16
********************************************************************************
 WARNING: meta-GGA functionality under development.
          Using this functional is experimental.
          Minimum tau threshold, xc_min_tau =   1.00000000E-12
 WARNING: Using alternative XC functional PBE for 
          radial densities (xc_radial).

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1041    0.0076923077    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   41    1  132.2975677952
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.2973663538   -1.3069566731    4.5135277964   -1.4493313812
  2         -5.3720262531   -1.3429710603    4.4750103002   -1.4361589062
  3         -5.3809346257   -1.3617316623    4.4541606084   -1.4305906804
  4         -5.3918644122   -1.3667880799    4.4484682621   -1.4294626934
  5         -5.3955923713   -1.3688493282    4.4461321037   -1.4290707441
  6         -5.3968147690   -1.3696807399    4.4451854602   -1.4289338594
  7         -5.3971923456   -1.3700133504    4.4448055434   -1.4288871609
  8         -5.3972970518   -1.3701455826    4.4446541247   -1.4288720066
  9         -5.3973192509   -1.3701979652    4.4445940066   -1.4288674984
 10         -5.3973196570   -1.3702186713    4.4445701900   -1.4288663801
 11         -5.3973161430   -1.3702268435    4.4445607681   -1.4288662349
 12         -5.3973131343   -1.3702300645    4.4445570451   -1.4288663102
 13         -5.3973116101   -1.3702310787    4.4445558695   -1.4288663816
 14         -5.3973106205   -1.3702316002    4.4445552638   -1.4288664355
 15         -5.3973099970   -1.3702318683    4.4445549518   -1.4288664728
 16         -5.3973096127   -1.3702320059    4.4445547913   -1.4288664974
 17         -5.3973093796   -1.3702320765    4.4445547087   -1.4288665131
 18         -5.3973092400   -1.3702321126    4.4445546663   -1.4288665228
 19         -5.3973091572   -1.3702321311    4.4445546446   -1.4288665288
Atom SCF converged after  19 iterations to a total energy of     -5.39730916

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1041    0.0076923077    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   41    0  132.2975677952
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3193387718   -0.2393850252    0.2820954873   -0.2424203204
  2         -0.3951476166   -0.2377112057    0.2886405187   -0.2475146999
  3         -0.4316904404   -0.2352240293    0.2921334450   -0.2514044523
  4         -0.4470645883   -0.2341888338    0.2934392149   -0.2531007745
  5         -0.4532107906   -0.2338552880    0.2938388567   -0.2537311312
  6         -0.4556567355   -0.2337608805    0.2939448671   -0.2539548182
  7         -0.4566411647   -0.2337373624    0.2939680185   -0.2540339963
  8         -0.4570433341   -0.2337327393    0.2939708343   -0.2540625049
  9         -0.4572099197   -0.2337324607    0.2939698343   -0.2540730322
 10         -0.4572797007   -0.2337328684    0.2939687244   -0.2540770258
 11         -0.4573091815   -0.2337332072    0.2939680368   -0.2540785792
 12         -0.4573217147   -0.2337334043    0.2939676750   -0.2540791963
 13         -0.4573270669   -0.2337335056    0.2939674981   -0.2540794456
 14         -0.4573293600   -0.2337335547    0.2939674150   -0.2540795477
 15         -0.4573303448   -0.2337335777    0.2939673768   -0.2540795899
 16         -0.4573307684   -0.2337335882    0.2939673595   -0.2540796074
 17         -0.4573309509   -0.2337335930    0.2939673518   -0.2540796148
 18         -0.4573310296   -0.2337335952    0.2939673483   -0.2540796179
Atom SCF converged after  18 iterations to a total energy of     -0.45733103

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      9;  min      6;  average      8
... Projector load balancing: max      2;  min      1;  average      2
... done
Calculating Ewald energy ...
              Ewald: real-space energy =           74.905690
        Ewald: reciprocal-space energy =            7.123157
         Ewald: (sum_charge)**2 energy =            4.759591
         Ewald: (sum_charge**2) energy =            3.737214
                          Ewald energy =           73.532042
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):         27737       117706
... Nonlocal pseudopotential projector initialisation
... done

========================== Sparse matrix information ===========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  11.33%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.51250467E+01     0.95124972E+00
               2       0.48819501E+01     0.90686115E+00
               3       0.45640695E+01     0.82922568E+00
               4       0.42087593E+01     0.70805583E+00
               5       0.38506542E+01     0.64909726E+00
               6       0.35209356E+01     0.61938286E+00
               7       0.32051925E+01     0.58853511E+00
               8       0.28193061E+01     0.54216939E+00
               9       0.22820965E+01     0.46264103E+00
              10       0.15669538E+01     0.33934807E+00
              11       0.81127360E+00     0.18699264E+00
              12       0.26952171E+00     0.60909207E-01
              13       0.45167917E-01     0.79391728E-02
              14       0.18723612E-02     0.23698035E-03
              15       0.34986304E-05     0.40874053E-06
              16       0.12239904E-10     0.14261925E-11
              17       0.39095420E-14     0.11102230E-14
================================================================================
 WARNING: xc_energy_potential using alternative initial XC functional PBE.
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -6.69950355112969    0.5047832
               2          -7.47024168162255    0.5196425
               3          -8.07448531654268    0.5555735
               4          -8.42078317268198    0.6000713
               5          -8.57282992176769    0.6075163
               6          -8.64906093714793    0.5697766
               7          -8.70003602291141    0.5247629
               8          -8.72854279508089    0.5031844
               9          -8.73588507282772    0.5000530
              10          -8.73629558536364    0.5000000
              11          -8.73629686068485    0.5000138
              12          -8.73629686069750    0.5000138
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [   -0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      30.00000000
     Final electron number for spin 1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.556074699013
             Q0:         -37.152865521995
             G0:      -0.044804997546
   RMS gradient:       0.007055730338
     Trial step:       0.500000000000
             Q1:         -37.162395901787
 Quadratic coef:       0.012872118981
 Linear coef   :      -0.022402498773
           Qmin:         -37.162612789558
Quadratic minimum step length (  0.435097337247) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000438 (step -0.4989 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    1        -3.715286552199E+01     7.0557E-03     7.0557E-03
      ideal mu1:      -0.580868431330
             Q0:         -37.162636206558
             G0:      -0.001171794904
   RMS gradient:       0.001141165459
     Trial step:       0.466421127977
             Q1:         -37.162958015749
 Quadratic coef:       0.000224740710
 Linear coef   :      -0.000546549901
           Qmin:         -37.162968497039
Quadratic minimum step length (  0.567147850696) accepted
    Initial Ne1:      30.00000363
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000045 (step -0.4999 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [ -0.0000,  1.0000]
================================================================================

    2        -3.716263620656E+01     1.1412E-03     1.1412E-03    -9.7707E-03
      ideal mu1:      -0.580017201259
             Q0:         -37.162968639618
             G0:      -0.000037678724
   RMS gradient:       0.000204546274
     Trial step:       0.514324547588
             Q1:         -37.162978414247
 Quadratic coef:       0.000009604464
 Linear coef   :      -0.000019379093
           Qmin:         -37.162978415000
Quadratic minimum step length (  0.518880732574) accepted
    Initial Ne1:      30.00000022
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -3.716296863962E+01     2.0455E-04     2.0455E-04    -3.3243E-04
      ideal mu1:      -0.580101236598
             Q0:         -37.162978415399
             G0:      -0.000001844332
   RMS gradient:       0.000045267563
     Trial step:       0.516597617139
             Q1:         -37.162978879259
 Quadratic coef:       0.000000488917
 Linear coef   :      -0.000000952778
           Qmin:         -37.162978879580
Quadratic minimum step length (  0.503359866617) accepted
    Initial Ne1:      30.00000001
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -3.716297841540E+01     4.5268E-05     4.5268E-05    -9.7758E-06
      ideal mu1:      -0.580103142107
    5        -3.716297887959E+01     1.1910E-05     1.1910E-05    -4.6419E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.71629788795857E+01  Eh
     Estimated bandgap           =   2.1826E-01  Eh
     RMS occupancy error         =   1.2648E-13
     [H,K] commutator            =   1.1910E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8953E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.74202092E-02     0.17019160E-02
               2       0.12542401E-04     0.39686123E-05
               3       0.49890549E-10     0.19159785E-10
               4       0.38684705E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.64948910E-01     0.17427713E-01
               2       0.10220936E-02     0.29481763E-03
               3       0.26048819E-06     0.86586118E-07
               4       0.19791207E-13     0.84376950E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00189534164526
Trial step length           =               0.122474
Gradient along search dir.  =         -1.41107764652
Functional at step 0        =     -37.16297887958567
Functional at step 1        =     -37.32265812313878
Functional predicted        =     -37.73115020484786
Selected quadratic step     =               0.805301
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      30.18106651
     Final electron number for spin 1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003755 (step -0.4924 Ne1=     30.0000)
 RMS occupancy error at iteration   2:  0.000021 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.486878740213
             Q0:         -37.728227719028
             G0:      -0.008512184803
   RMS gradient:       0.003075383409
     Trial step:       0.509935787779
             Q1:         -37.729948359993
 Quadratic coef:       0.002620026699
 Linear coef   :      -0.004340667663
           Qmin:         -37.730025543815
Quadratic minimum step length (  0.422412066488) accepted
    Initial Ne1:      29.99999982
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000073 (step -0.4998 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -3.772822771903E+01     3.0754E-03     3.0754E-03
      ideal mu1:      -0.496648020810
             Q0:         -37.730025866609
             G0:      -0.000134391772
   RMS gradient:       0.000386344614
     Trial step:       0.464115319605
             Q1:         -37.730062756891
 Quadratic coef:       0.000025482999
 Linear coef   :      -0.000062373280
           Qmin:         -37.730064033489
Quadratic minimum step length (  0.567994283257) accepted
    Initial Ne1:      30.00000034
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000005 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -3.773002586661E+01     3.8634E-04     3.8634E-04    -1.7981E-03
      ideal mu1:      -0.496488427935
             Q0:         -37.730064034713
             G0:      -0.000010131525
   RMS gradient:       0.000106098376
     Trial step:       0.513434366115
             Q1:         -37.730065909853
 Quadratic coef:       0.000003326733
 Linear coef   :      -0.000005201873
           Qmin:         -37.730066068201
Quadratic minimum step length (  0.401417968152) accepted
    Initial Ne1:      30.00000001
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -3.773006403471E+01     1.0610E-04     1.0610E-04    -3.8168E-05
      ideal mu1:      -0.496525770451
             Q0:         -37.730066068210
             G0:      -0.000001005518
   RMS gradient:       0.000033425015
     Trial step:       0.453984338965
             Q1:         -37.730066272523
 Quadratic coef:       0.000000252176
 Linear coef   :      -0.000000456490
           Qmin:         -37.730066274794
Quadratic minimum step length (  0.410901616209) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -3.773006606821E+01     3.3425E-05     3.3425E-05    -2.0335E-06
      ideal mu1:      -0.496547828375
    5        -3.773006627480E+01     1.0338E-05     1.0338E-05    -2.0659E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.77300662747967E+01  Eh
     Estimated bandgap           =   2.2740E-01  Eh
     RMS occupancy error         =   1.6988E-14
     [H,K] commutator            =   1.0338E-05
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.5114E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17632989E-01     0.37114187E-02
               2       0.86864483E-04     0.17712734E-04
               3       0.24851777E-08     0.50587423E-09
               4       0.47194228E-14     0.13322676E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28672802E-01     0.62653104E-02
               2       0.22215485E-03     0.46759213E-04
               3       0.15081499E-07     0.31434884E-08
               4       0.38344990E-14     0.80491169E-15
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00075113654186
Trial step length           =               0.314052
Gradient along search dir.  =         -0.22148288398
Functional at step 0        =     -37.73006627479666
Functional at step 1        =     -37.78473743711326
Functional predicted        =     -37.81132029053161
Selected quadratic step     =               0.733727
Conjugate gradients coeff.  =               0.157059
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      30.11079031
     Final electron number for spin 1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002267 (step -0.4954 Ne1=     30.0000)
 RMS occupancy error at iteration   2:  0.000006 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.470945232582
             Q0:         -37.811830650738
             G0:      -0.000635373557
   RMS gradient:       0.000840220577
     Trial step:       0.431906122455
             Q1:         -37.811994200889
 Quadratic coef:       0.000110871579
 Linear coef   :      -0.000274421729
           Qmin:         -37.812000458200
Quadratic minimum step length (  0.534512210203) accepted
    Initial Ne1:      29.99999998
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000009 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -3.781183065074E+01     8.4022E-04     8.4022E-04
      ideal mu1:      -0.473494931312
             Q0:         -37.812000457783
             G0:      -0.000033757610
   RMS gradient:       0.000193676281
     Trial step:       0.480477987127
             Q1:         -37.812009362497
 Quadratic coef:       0.000007315075
 Linear coef   :      -0.000016219789
           Qmin:         -37.812009448858
Quadratic minimum step length (  0.532684337536) accepted
    Initial Ne1:      29.99999996
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -3.781200045778E+01     1.9368E-04     1.9368E-04    -1.6981E-04
      ideal mu1:      -0.473178593260
             Q0:         -37.812009449013
             G0:      -0.000002083520
   RMS gradient:       0.000048113636
     Trial step:       0.505908191546
             Q1:         -37.812009818613
 Quadratic coef:       0.000000684470
 Linear coef   :      -0.000001054070
           Qmin:         -37.812009854825
Quadratic minimum step length (  0.389544136019) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -3.781200944901E+01     4.8114E-05     4.8114E-05    -8.9912E-06
      ideal mu1:      -0.473185268784
             Q0:         -37.812009854827
             G0:      -0.000000281829
   RMS gradient:       0.000017695864
     Trial step:       0.443929689682
             Q1:         -37.812009922544
 Quadratic coef:       0.000000057396
 Linear coef   :      -0.000000125112
           Qmin:         -37.812009923008
Quadratic minimum step length (  0.483840962475) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -3.781200985483E+01     1.7696E-05     1.7696E-05    -4.0581E-07
      ideal mu1:      -0.473208308876
    5        -3.781200992301E+01     4.5331E-06     4.5331E-06    -6.8182E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.78120099230092E+01  Eh
     Estimated bandgap           =   2.2459E-01  Eh
     RMS occupancy error         =   2.5032E-15
     [H,K] commutator            =   4.5331E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0962E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22518372E-01     0.41884742E-02
               2       0.15000612E-03     0.26398921E-04
               3       0.79030762E-08     0.14065531E-08
               4       0.47595743E-14     0.13322676E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15773813E-01     0.29744025E-02
               2       0.73519482E-04     0.13077000E-04
               3       0.18805011E-08     0.32339453E-09
               4       0.43430408E-14     0.11180293E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00030961840938
Trial step length           =               0.480030
Gradient along search dir.  =         -0.03814113388
Functional at step 0        =     -37.81200992300925
Functional at step 1        =     -37.82465459270477
Functional predicted        =     -37.82680523069098
Selected quadratic step     =               0.775819
Conjugate gradients coeff.  =               0.169909
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      30.03976347
     Final electron number for spin 1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000803 (step -0.4980 Ne1=     30.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.469611116040
             Q0:         -37.826818694221
             G0:      -0.000141470194
   RMS gradient:       0.000396470811
     Trial step:       0.463455896852
             Q1:         -37.826849641820
 Quadratic coef:       0.000034617596
 Linear coef   :      -0.000065565196
           Qmin:         -37.826849739089
Quadratic minimum step length (  0.438889174137) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    1        -3.782681869422E+01     3.9647E-04     3.9647E-04
      ideal mu1:      -0.468402976459
             Q0:         -37.826849739269
             G0:      -0.000002536194
   RMS gradient:       0.000053084880
     Trial step:       0.451005294667
             Q1:         -37.826850401289
 Quadratic coef:       0.000000481818
 Linear coef   :      -0.000001143837
           Qmin:         -37.826850418138
Quadratic minimum step length (  0.535343894116) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    2        -3.782684973927E+01     5.3085E-05     5.3085E-05    -3.1045E-05
      ideal mu1:      -0.468471874216
             Q0:         -37.826850418136
             G0:      -0.000000167271
   RMS gradient:       0.000013632970
     Trial step:       0.491368426656
             Q1:         -37.826850445692
 Quadratic coef:       0.000000054636
 Linear coef   :      -0.000000082192
           Qmin:         -37.826850449047
Quadratic minimum step length (  0.369593634942) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    3        -3.782685041814E+01     1.3633E-05     1.3633E-05    -6.7887E-07
      ideal mu1:      -0.468483441727
             Q0:         -37.826850449047
             G0:      -0.000000019481
   RMS gradient:       0.000004652455
     Trial step:       0.426153309155
             Q1:         -37.826850454210
 Quadratic coef:       0.000000003139
 Linear coef   :      -0.000000008302
           Qmin:         -37.826850454536
Quadratic minimum step length (  0.563498026636) accepted
    Initial Ne1:      30.00000000
      Final Ne1:      30.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     30.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     30.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

    4        -3.782685044905E+01     4.6525E-06     4.6525E-06    -3.0911E-08
      ideal mu1:      -0.468484967452
    5        -3.782685045453E+01     1.2270E-06     1.2270E-06    -5.4858E-09
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.78268504545330E+01  Eh
     Estimated bandgap           =   2.2004E-01  Eh
     RMS occupancy error         =   1.0958E-16
     [H,K] commutator            =   1.2270E-06
     Occupancy bounds            = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       27.65026328957439 |
           | Pseudopotential (local)    :     -233.06229823553096 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        4.61764252429680 |
           | Hartree                    :      101.91824006143935 |
           | Exchange-correlation       :      -12.48133382317067 |
           | Ewald                      :       73.53204167666705 |
           | Total                      :      -37.82544450672405 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -233.06229823553116 |
           | Hartree                    :      101.91824006143855 |
           --------------------------------------------------------
           Integrated density           :       29.99999999999996
           Integrated density tr(KS)    :       30.00000000000000
================================================================================

WARNING: maximum number of NGWF CG iterations (   3) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00189534164526    -37.16297887958567   0.805301    -37.73115020484786        
   1     0.00075113654186    -37.73006627479666   0.733727    -37.81132029053161        
   2     0.00030961840938    -37.82685045453304  <-- CG                                 
 
<QC>        [NGWF iterations]:                      3
<QC>           [total_energy]:       -37.826850454533
<QC>           [rms_gradient]:         0.000309618409

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     138.285s on      4 proc(s)                                    
TOTAL TIME:       138.286s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                :    46        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    45        0.00s   0.000%  ------ ||
|| ewald_calculate_energy               :     1        0.00s   0.002%  ------ ||
|| pseudopotentials_nonlocal_mat        :     7        0.00s   0.002%  ------ ||
|| ngwf_gradient_coeffs                 :     3        0.00s   0.003%  ------ ||
|| sparse_init                          :     1        0.01s   0.005%  ------ ||
|| pseudo_make_structure_factor         :     1        0.01s   0.007%  ------ ||
|| palser_mano_kernel_optimise          :     1        0.01s   0.008%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     7        0.01s   0.008%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.03s   0.020%  ------ ||
|| lnv_gradient_norm                    :    20        0.03s   0.022%  ------ ||
|| kernel_purify                        :    62        0.04s   0.027%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.04s   0.029%  ------ ||
|| kernel_fix                           :    20        0.04s   0.030%  ------ ||
|| sparse_trace                         :   646        0.05s   0.034%  ------ ||
|| basis_dot_function_with_box          :  8628        0.05s   0.038%  ------ ||
|| function_ops_brappd_ketppd           :     7        0.06s   0.043%  ------ ||
|| sparse_product                       :   935        0.10s   0.073%  ------ ||
|| basis_add_function_to_box            : 20700        0.11s   0.083%  ------ ||
|| basis_copy_function_to_box           :   975        0.12s   0.090%  ------ ||
|| projectors_init_fftbox_recip         :    10        0.16s   0.115%  ------ ||
|| density_init_guess_real              :     1        0.18s   0.134%  ------ ||
|| projectors_gradient_batch            :     3        0.20s   0.144%  ------ ||
|| ke_density_batch_row_sums            :    40        0.20s   0.144%  ------ ||
|| projectors_func_ovlp_box             :     7        0.20s   0.148%  ------ ||
|| integrals_kinetic                    :     7        0.24s   0.174%  ------ ||
|| energy_and_force_init_cell           :     1        0.26s   0.185%  ------ ||
|| density_batch_row_sums               :    40        0.28s   0.202%  ------ ||
|| fourier_apply_box_pair               :   378        0.33s   0.238% 185.193 ||
|| cell_grid_extract_box_real           :   884        0.45s   0.323%  ------ ||
|| integrals_locpot_mat_els_batch       :    23        0.48s   0.344%  ------ ||
|| cell_grid_deposit_box_real           :   724        0.81s   0.585%  ------ ||
|| hartree_on_grid                      :    41        1.51s   1.095%  ------ ||
|| density_fftbox_deposit_to_cell       :   360        1.53s   1.109%  ------ ||
|| ke_density_fftbox_deposit_to_cell    :   360        1.61s   1.165%  ------ ||
|| ke_density_batch_grad_apply          :    40        1.98s   1.429%  ------ ||
|| hamiltonian_energy_components        :     1        2.98s   2.152%  ------ ||
|| density_fftbox_interpolate_multiply  :   360        3.45s   2.498%  ------ ||
|| ngwf_gradient_build_batch            :     3        4.03s   2.918%  ------ ||
|| ngwf_gradient_batch                  :     3        4.54s   3.280%  ------ ||
|| ngwf_gradient_lnv                    :     3        4.87s   3.519%  ------ ||
|| potential_apply_to_ngwf_batch        :    23        6.27s   4.532%  ------ ||
|| integrals_locpot_dbl_grid            :    23        6.81s   4.926%  ------ ||
|| density_batch_interp_deposit         :    40        9.60s   6.939%  ------ ||
|| density_on_dbl_grid                  :    40       11.01s   7.964%  ------ ||
|| ke_density_fftbox_interpolate_multipl:   360       12.00s   8.675%  ------ ||
|| potential_apply_to_fftbox_batch      :    60       14.59s  10.552%  ------ ||
|| fourier_apply_cell_backward          :  1126       16.46s  11.905%  12.910 ||
|| fourier_apply_box                    :  7175       16.90s  12.224% 229.492 ||
|| fourier_apply_cell_forward           :  1125       18.50s  13.380%  11.476 ||
|| ke_density_batch_interp_deposit      :    40       21.07s  15.233%  ------ ||
|| integrals_div_locpot_grad_functions  :    20       23.58s  17.051%  ------ ||
|| ke_density_on_dbl_grid               :    40       23.85s  17.246%  ------ ||
|| xc_energy_potential                  :    41       60.39s  43.669%  ------ ||
|| nlxc_vdw_energy                      :    80       93.04s  67.283%  ------ ||
|| hamiltonian_lhxc_calculate           :    39       98.15s  70.979%  ------ ||
|| lnv_denskernel_optimise_cg           :     4      120.71s  87.288%  ------ ||
|| ngwf_cg_optimise                     :     1      136.78s  98.913%  ------ ||
|| energy_and_force_calculate           :     1      137.73s  99.600%  ------ ||
|| total_time                           :     1      138.29s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 1 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 3 ms printing in order.

Job completed: 21-09-2022 11:00 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
