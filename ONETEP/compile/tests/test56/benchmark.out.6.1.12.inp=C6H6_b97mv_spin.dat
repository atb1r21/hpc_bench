==================================================================================
It's Wed Sep 21 11:00:53 BST 2022.
*** Starting onetep_launcher (node red470.cluster.local, PIDs 16804 16805 16806 16807)...
    - ONETEP arguments: C6H6_b97mv_spin.dat
    - Current directory: /mainfs/home/ab2g19/onetep_ab/tests/test56
    - Launcher executable directory: /mainfs/home/ab2g19/onetep_ab/utils
    - (-e) ONETEP executable has NOT been specified through command-line
      ... ARCH environment variable has not been set either
      ... resolving onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack -> /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test56/onetep.* -> no matches
      ... resolving /mainfs/home/ab2g19/onetep_ab/tests/test56/../bin/onetep.* -> no matches
      ... trying /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack
          -> looks OK
*** Setting up environment...
    - (-s) Process stack size: unlimited
    - (-t) OMP_NUM_THREADS: 10
    - (-o) OMP_STACKSIZE: 64M
    - (-c) Maximum core file size: 2048000
    - (-d) decfort_dump_flag: n
    - (-m) I_MPI_OFA_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_TRANSLATION_CACHE: 0
    - (-m) I_MPI_DAPL_UD_TRANSLATION_CACHE: 0
*** Starting ONETEP...
    - /mainfs/home/ab2g19/onetep_ab/utils/../bin/onetep.iridis5.intel21.omp.scalapack C6H6_b97mv_spin.dat
=================================================================================
_________________________________________________________________________________
[0] MPI startup(): I_MPI_DAPL_UD_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_OFA_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

[0] MPI startup(): I_MPI_DAPL_TRANSLATION_CACHE variable has been removed from the product, its value is ignored

 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                             Version 6.1.12    |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Jacek Dziedzic, Peter D. Haynes, Nicholas D. M. Hine,        |
 |  Arash A. Mostofi, Mike C. Payne and Chris-Kriton Skylaris    |
 |                                                               |
 |  Contributors:                                                |
 |  J. Aarons, L. Andrinopoulos, P. W. Avraam, R. A. Bell,       |
 |  A. Bhandari, G. A. Bramley, R. J. Charlton, S. J. Clark,     |
 |  R. J. Clements, G. C. Constantinescu, F. Corsetti,           |
 |  N. Corsini, O. Dieguez, S. M. M. Dubois, K. K. B. Duff,      |
 |  J. M. Escartin, A. Greco, H. Helal, Q. O. Hill, L. P. Lee,   |
 |  J.-H. Li, E. B. Linscott, G. Moynihan, D. D. O`Regan,        |
 |  O. K. Okan, M. J. S. Phipps, C. J. Pickard,                  |
 |  J. C. A. Prentice, M. I. J. Probert, L. E. Ratcliff,         |
 |  M. Robinson, A. Ruiz Serrano, J. S. Spencer, E. W. Tait,     |
 |  G. Teobaldi, D. Turban, V. Vitale, K. A. Wilkinson,          |
 |  C. Weber, J. C. Womack, N. Yeung and T. J. Zuehlsdorff       |
 |                                                               |
 |                                   Copyright (c) 2004-2022     |
 |                                                               |
 |  Please cite:                                                 |
 |  "The ONETEP linear-scaling density functional theory program"|
 |   J. Chem. Phys. 152(17) 174111 (2020)                        |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 |  "Accurate ionic forces and geometry optimization in linear-  |
 |   scaling density-functional theory with local orbitals"      |
 |   N. D. M. Hine, M. Robinson, P. D. Haynes, C.-K. Skylaris,   |
 |   M. C. Payne, and A. A. Mostofi.                             |
 |   Phys. Rev. B 83 195102 (2011).                              |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 21-09-2022 11:00 (+0100)
 
Reading parameters from file "C6H6_b97mv_spin.dat" ...... done

If your calculation crashes here, before "Checking processes and threads..."
is displayed, then your stack size is insufficient.
If so, use "ulimit -s unlimited" at runtime.
You can disable this check with "check_stack_size F".

Checking processes and threads...
   Determining the default number of threads...
      No default threads set at compilation time: defaulting to 1.
      OpenMP library call suggests 10 threads.
      Hybrid MPI-OpenMP compilation detected.
      Number of MPI processes > 1.
      OMP_NUM_THREADS environment variable present and
      its value matches the one obtained from the OpenMP library call.
      Using this value as default.
      Default threads: 10
      Default applies to threads_max and threads_num_fftboxes.
      Settings in the input file override this default.
   ... done

   Running with 4 MPI processes.
   There are 4 MPI processes running on the same node as the root process.
   Each MPI process is using: 
               1 threads for simulation cell FFTs.
               1 threads for parallel FFT box operations.
              10 threads for loops over batched FFT box operations.
              10 threads in other parallel regions.
... done

Basic input checks...
BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.
... done

Reading geometry and species blocks from file "C6H6_b97mv_spin.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to SOLVE
    
  Number of PPD points along a3 set to 1.  This is 
  the default value, it may have been provided also in the input file.
... done


--------------------------------------------------------------------------------
---------------------------------- INPUT FILE ----------------------------------
--------------------------------------------------------------------------------

task: SINGLEPOINT                                                               
print_qc: TRUE                                                                  
output_detail: VERBOSE                                                          
maxit_lnv: 5                                                                    
maxit_ngwf_cg: 3                                                                
write_denskern       : FALSE                                                    
write_tightbox_ngwfs : FALSE                                                    
write_xyz            : FALSE                                                    
%block lattice_cart                                                             
ang                                                                             
18.000  0.000  0.000                                                            
0.000 26.000  0.000                                                             
0.000  0.000 22.300                                                             
%endblock lattice_cart                                                          
xc_functional        : B97M-V                                                   
spin_polarized : TRUE                                                           
cutoff_energy: 600 eV                                                           
%block species_pot                                                              
C "../../pseudo/carbon.recpot"                                                  
H "../../pseudo/hydrogen.recpot"                                                
%endblock species_pot                                                           
%block species                                                                  
C      C    6    4   8.00                                                       
H      H    1    1   8.00                                                       
%endblock species                                                               
%block positions_abs                                                            
     Hash =   000006691520887667119518
%endblock positions_abs                                                         

--------------------------------------------------------------------------------
-------------------------------- END INPUT FILE --------------------------------
--------------------------------------------------------------------------------


 
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< Full system >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

-------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          6        24         6
  H          6         6         0
.......   ......    ......    ......
Totals:     12        30         6
--------------------------------------------------------------------------------

=============================== PSINC grid sizes ===============================
                      Simulation cell:   63 x  91 x  75
                              FFT-box:   63 x  91 x  75
                                  PPD:    7 x   7 x   1
Grid space d1=  0.539921752738a0 (KE cutoff=  26.05808Eh = 709.07634eV)
Grid space d2=  0.539921752738a0 (KE cutoff=  26.05808Eh = 709.07634eV)
Grid space d3=  0.561878570683a0 (KE cutoff=  24.06130Eh = 654.74125eV)
================================================================================

********************* Fourier parallelisation information **********************
       Coarse grid (whole simulation cell) dimensions:     63    91    75
          Real-space ('12') slabs/proc (min max mean):     18    19    18
         Recip-space ('23') slabs/proc (min max mean):      8     8     8
********************************************************************************

********************* Fourier parallelisation information **********************
       Double grid (whole simulation cell) dimensions:    126   182   150
          Real-space ('12') slabs/proc (min max mean):     37    38    37
         Recip-space ('23') slabs/proc (min max mean):     16    16    16
********************************************************************************
WARNING in internal_setup_spin (energy_and_force_init_cell):
        even number of electrons in cell and zero spin
        but continuing with spin-polarised calculation
 WARNING: meta-GGA functionality under development.
          Using this functional is experimental.
          Minimum tau threshold, xc_min_tau =   1.00000000E-12
 WARNING: Using alternative XC functional PBE for 
          radial densities (xc_radial).

Atom SCF Calculation for C  : Z (AE atom) =   6 : Z (PS atom) =   4
Config String:
Orbitals (num,occ):  2     2.00 2.00
Orbitals   (num,l):  2        0    1
Real-space Grid (nr,dr,rmax): 1041    0.0076923077    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   41    1  132.2975677952
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
Confining potential (l,width,scale):  1    3.0000000000  100.0000000000
  1         -5.2973663538   -1.3069566731    4.5135277964   -1.4493313812
  2         -5.3720262531   -1.3429710603    4.4750103002   -1.4361589062
  3         -5.3809346257   -1.3617316623    4.4541606084   -1.4305906804
  4         -5.3918644122   -1.3667880799    4.4484682621   -1.4294626934
  5         -5.3955923713   -1.3688493282    4.4461321037   -1.4290707441
  6         -5.3968147690   -1.3696807399    4.4451854602   -1.4289338594
  7         -5.3971923456   -1.3700133504    4.4448055434   -1.4288871609
  8         -5.3972970518   -1.3701455826    4.4446541247   -1.4288720066
  9         -5.3973192509   -1.3701979652    4.4445940066   -1.4288674984
 10         -5.3973196570   -1.3702186713    4.4445701900   -1.4288663801
 11         -5.3973161430   -1.3702268435    4.4445607681   -1.4288662349
 12         -5.3973131343   -1.3702300645    4.4445570451   -1.4288663102
 13         -5.3973116101   -1.3702310787    4.4445558695   -1.4288663816
 14         -5.3973106205   -1.3702316002    4.4445552638   -1.4288664355
 15         -5.3973099970   -1.3702318683    4.4445549518   -1.4288664728
 16         -5.3973096127   -1.3702320059    4.4445547913   -1.4288664974
 17         -5.3973093796   -1.3702320765    4.4445547087   -1.4288665131
 18         -5.3973092400   -1.3702321126    4.4445546663   -1.4288665228
 19         -5.3973091572   -1.3702321311    4.4445546446   -1.4288665288
Atom SCF converged after  19 iterations to a total energy of     -5.39730916

Atom SCF Calculation for H  : Z (AE atom) =   1 : Z (PS atom) =   1
Config String:
Orbitals (num,occ):  1     1.00
Orbitals   (num,l):  1        0
Real-space Grid (nr,dr,rmax): 1041    0.0076923077    8.0000000000
Spherical Bessel Basis (nsws,lmax,cutoff):   41    0  132.2975677952
Confining potential (l,width,scale):  0    3.0000000000  100.0000000000
  1         -0.3193387718   -0.2393850252    0.2820954873   -0.2424203204
  2         -0.3951476166   -0.2377112057    0.2886405187   -0.2475146999
  3         -0.4316904404   -0.2352240293    0.2921334450   -0.2514044523
  4         -0.4470645883   -0.2341888338    0.2934392149   -0.2531007745
  5         -0.4532107906   -0.2338552880    0.2938388567   -0.2537311312
  6         -0.4556567355   -0.2337608805    0.2939448671   -0.2539548182
  7         -0.4566411647   -0.2337373624    0.2939680185   -0.2540339963
  8         -0.4570433341   -0.2337327393    0.2939708343   -0.2540625049
  9         -0.4572099197   -0.2337324607    0.2939698343   -0.2540730322
 10         -0.4572797007   -0.2337328684    0.2939687244   -0.2540770258
 11         -0.4573091815   -0.2337332072    0.2939680368   -0.2540785792
 12         -0.4573217147   -0.2337334043    0.2939676750   -0.2540791963
 13         -0.4573270669   -0.2337335056    0.2939674981   -0.2540794456
 14         -0.4573293600   -0.2337335547    0.2939674150   -0.2540795477
 15         -0.4573303448   -0.2337335777    0.2939673768   -0.2540795899
 16         -0.4573307684   -0.2337335882    0.2939673595   -0.2540796074
 17         -0.4573309509   -0.2337335930    0.2939673518   -0.2540796148
 18         -0.4573310296   -0.2337335952    0.2939673483   -0.2540796179
Atom SCF converged after  18 iterations to a total energy of     -0.45733103

BC: +++++++++++++++ Summary of boundary conditions ++++++++++++++
BC: |       Component       |     Keyword     |   Periodicity   |
BC: |                       |                 |     X  Y  Z [1] |
BC: |-----------------------------------------------------------|
BC: | Ion-ion               | ion_ion_bc [2]  |     P  P  P     |
BC: | Local pseudopotential | pspot_bc [3]    |     P  P  P     |
BC: | Van der Waals         | vdw_bc          |     P  P  P     |
BC: +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
BC: P: Periodic, O: Open.
BC: [1] Not strictly along X, Y, Z but rather along lattice vectors A1, A2, A3.
BC: [2] Also affected by: pbc_correction_cutoff, cutoff_coulomb_type,
BC:     is_smeared_ion_rep, is_implicit_solvent, openbc_ion_ion.
BC: [3] Also affected by: is_smeared_ion_rep, is_implicit_solvent, openbc_pspot.

WARNING: The number of FFT boxes in a batch is not a multiple of the number of
OpenMP threads. Consider changing fftbox_batch_size.

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      9;  min      6;  average      8
... Projector load balancing: max      2;  min      1;  average      2
... done
Calculating Ewald energy ...
              Ewald: real-space energy =           74.905690
        Ewald: reciprocal-space energy =            7.123157
         Ewald: (sum_charge)**2 energy =            4.759591
         Ewald: (sum_charge**2) energy =            3.737214
                          Ewald energy =           73.532042
Basis initialisation ...... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... Tight-boxes gathered
... NGWF basis size (local,global):         27737       117706
... Nonlocal pseudopotential projector initialisation
... done

========================== Sparse matrix information ===========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling: 100.00%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  11.33%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.51250467E+01     0.95124972E+00
               2       0.48819501E+01     0.90686115E+00
               3       0.45640695E+01     0.82922568E+00
               4       0.42087593E+01     0.70805583E+00
               5       0.38506542E+01     0.64909726E+00
               6       0.35209356E+01     0.61938286E+00
               7       0.32051925E+01     0.58853511E+00
               8       0.28193061E+01     0.54216939E+00
               9       0.22820965E+01     0.46264103E+00
              10       0.15669538E+01     0.33934807E+00
              11       0.81127360E+00     0.18699264E+00
              12       0.26952171E+00     0.60909207E-01
              13       0.45167917E-01     0.79391728E-02
              14       0.18723612E-02     0.23698035E-03
              15       0.34986304E-05     0.40874053E-06
              16       0.12239904E-10     0.14261925E-11
              17       0.39095420E-14     0.11102230E-14
================================================================================
 WARNING: xc_energy_potential using alternative initial XC functional PBE.
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -6.69950355112969    0.5047832
               2          -7.47024168162255    0.5196425
               3          -8.07448531654268    0.5555735
               4          -8.42078317268198    0.6000713
               5          -8.57282992176770    0.6075163
               6          -8.64906093714793    0.5697766
               7          -8.70003602291141    0.5247629
               8          -8.72854279508089    0.5031844
               9          -8.73588507282772    0.5000530
              10          -8.73629558536364    0.5000000
              11          -8.73629686068485    0.5000160
              12          -8.73629686069750    0.5000160
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done
Down spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -6.69950355112970    0.5047832
               2          -7.47024168162255    0.5196425
               3          -8.07448531654268    0.5555735
               4          -8.42078317268198    0.6000713
               5          -8.57282992176770    0.6075163
               6          -8.64906093714793    0.5697766
               7          -8.70003602291141    0.5247629
               8          -8.72854279508089    0.5031844
               9          -8.73588507282772    0.5000530
              10          -8.73629558536364    0.5000000
              11          -8.73629686068485    0.4999993
              12          -8.73629686069750    0.4999993
Termination criterion satisfied: band energy change below threshold.
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      15.00000000
   Initial electron number for spin 2:      15.00000000
     Final electron number for spin 1:      15.00000000
     Final electron number for spin 2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.556637493959
      ideal mu2:      -0.556637493959
             Q0:         -37.152865521995
             G0:      -0.044450555771
   RMS gradient:       0.009938763144
     Trial step:       0.500000000000
             Q1:         -37.162415625001
 Quadratic coef:       0.012675174879
 Linear coef   :      -0.022225277886
           Qmin:         -37.162608247082
Quadratic minimum step length (  0.438362351960) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000441 (step -0.4989 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    1        -3.715286552199E+01     9.9388E-03     7.0278E-03
      ideal mu1:      -0.581489260976
      ideal mu2:      -0.581489260976
             Q0:         -37.162640850844
             G0:      -0.001175675122
   RMS gradient:       0.001622234170
     Trial step:       0.468167892940
             Q1:         -37.162959003984
 Quadratic coef:       0.000232260204
 Linear coef   :      -0.000550413345
           Qmin:         -37.162966945074
Quadratic minimum step length (  0.554735274367) accepted
    Initial Ne1:      15.00000182
    Initial Ne2:      15.00000182
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000044 (step -0.4999 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    2        -3.716264085084E+01     1.6222E-03     1.1471E-03    -9.7753E-03
      ideal mu1:      -0.580433924155
      ideal mu2:      -0.580433924155
             Q0:         -37.162967830309
             G0:      -0.000037103331
   RMS gradient:       0.000285000437
     Trial step:       0.509616762421
             Q1:         -37.162978155133
 Quadratic coef:       0.000008583656
 Linear coef   :      -0.000018908480
           Qmin:         -37.162978243431
Quadratic minimum step length (  0.561303853492) accepted
    Initial Ne1:      15.00000011
    Initial Ne2:      15.00000011
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -3.716296783031E+01     2.8500E-04     2.0153E-04    -3.2698E-04
      ideal mu1:      -0.580551461687
      ideal mu2:      -0.580551461687
             Q0:         -37.162978182733
             G0:      -0.000002116435
   RMS gradient:       0.000070911869
     Trial step:       0.534836285746
             Q1:         -37.162978674352
 Quadratic coef:       0.000000640327
 Linear coef   :      -0.000001131946
           Qmin:         -37.162978682986
Quadratic minimum step length (  0.472731683849) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -3.716297818273E+01     7.0912E-05     5.0142E-05    -1.0352E-05
      ideal mu1:      -0.580550352758
      ideal mu2:      -0.580550352758
    5        -3.716297868252E+01     1.7343E-05     1.2264E-05    -4.9979E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.71629786825248E+01  Eh
     Estimated bandgap (UP spin) =   2.1796E-01  Eh
     Estimated bandgap (DN spin) =   2.1807E-01  Eh
     RMS occupancy error         =   1.6293E-13
     [H,K] commutator            =   1.2264E-05
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  1.8963E-03 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.74223529E-02     0.17033786E-02
               2       0.12550528E-04     0.39723901E-05
               3       0.49954459E-10     0.19190649E-10
               4       0.44134265E-14     0.13322676E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.64306858E-01     0.17260731E-01
               2       0.10019009E-02     0.28929462E-03
               3       0.25042062E-06     0.83409846E-07
               4       0.18568270E-13     0.77715612E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00189627768928
Trial step length           =               0.122474
Gradient along search dir.  =         -1.41247175608
Functional at step 0        =     -37.16297868252475
Functional at step 1        =     -37.32273029871025
Functional predicted        =     -37.72804355412903
Selected quadratic step     =               0.800108
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      15.08931547
   Initial electron number for spin 2:      15.08931547
     Final electron number for spin 1:      15.00000000
     Final electron number for spin 2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003708 (step -0.4925 Ne1=     15.0000)
                                                               Ne2=     15.0000
 RMS occupancy error at iteration   2:  0.000020 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.487870399015
      ideal mu2:      -0.487870399015
             Q0:         -37.728514834705
             G0:      -0.008377872799
   RMS gradient:       0.004314799544
     Trial step:       0.502826071266
             Q1:         -37.730264261259
 Quadratic coef:       0.002463186311
 Linear coef   :      -0.004212612865
           Qmin:         -37.730315967964
Quadratic minimum step length (  0.429973885273) accepted
    Initial Ne1:      14.99999991
    Initial Ne2:      14.99999991
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000075 (step -0.4998 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [ -0.000,  1.000]
            Final occupancy bounds spin 2: [ -0.000,  1.000]
================================================================================

    1        -3.772851483471E+01     4.3148E-03     3.0510E-03
      ideal mu1:      -0.497718599762
      ideal mu2:      -0.497718599762
             Q0:         -37.730321847140
             G0:      -0.000136532701
   RMS gradient:       0.000555748487
     Trial step:       0.464975353625
             Q1:         -37.730357251581
 Quadratic coef:       0.000028079899
 Linear coef   :      -0.000063484341
           Qmin:         -37.730357729226
Quadratic minimum step length (  0.525618937225) accepted
    Initial Ne1:      15.00000016
    Initial Ne2:      15.00000016
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000004 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -3.773032184714E+01     5.5575E-04     3.9297E-04    -1.8070E-03
      ideal mu1:      -0.497359289664
      ideal mu2:      -0.497359289664
             Q0:         -37.730357943126
             G0:      -0.000009816067
   RMS gradient:       0.000144095512
     Trial step:       0.494368133286
             Q1:         -37.730360247631
 Quadratic coef:       0.000002548245
 Linear coef   :      -0.000004852750
           Qmin:         -37.730360253459
Quadratic minimum step length (  0.470724930858) accepted
    Initial Ne1:      15.00000001
    Initial Ne2:      15.00000001
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -3.773035794313E+01     1.4410E-04     1.0189E-04    -3.6096E-05
      ideal mu1:      -0.497412011968
      ideal mu2:      -0.497412011968
             Q0:         -37.730360263866
             G0:      -0.000001268773
   RMS gradient:       0.000055788063
     Trial step:       0.482401705386
             Q1:         -37.730360653535
 Quadratic coef:       0.000000222389
 Linear coef   :      -0.000000612058
           Qmin:         -37.730360684992
Quadratic minimum step length (  0.663832146477) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -3.773036026387E+01     5.5788E-05     3.9448E-05    -2.3207E-06
      ideal mu1:      -0.497468202618
      ideal mu2:      -0.497468202618
    5        -3.773036059514E+01     4.8892E-05     3.4572E-05    -3.3128E-07
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.77303605951442E+01  Eh
     Estimated bandgap (UP spin) =   2.2772E-01  Eh
     Estimated bandgap (DN spin) =   2.2733E-01  Eh
     RMS occupancy error         =   1.1340E-13
     [H,K] commutator            =   3.4572E-05
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  7.4663E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17507157E-01     0.36699542E-02
               2       0.85846680E-04     0.17439594E-04
               3       0.24308034E-08     0.49356541E-09
               4       0.45704052E-14     0.11102230E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28467057E-01     0.62073099E-02
               2       0.21940574E-03     0.46076964E-04
               3       0.14721966E-07     0.30656502E-08
               4       0.45654204E-14     0.11102230E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00074663427996
Trial step length           =               0.313038
Gradient along search dir.  =         -0.22039227149
Functional at step 0        =     -37.73036059514421
Functional at step 1        =     -37.78458650876691
Functional predicted        =     -37.81095153457534
Selected quadratic step     =               0.731341
Conjugate gradients coeff.  =               0.155029
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      15.05405610
   Initial electron number for spin 2:      15.05405610
     Final electron number for spin 1:      15.00000000
     Final electron number for spin 2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.002222 (step -0.4955 Ne1=     15.0000)
                                                               Ne2=     15.0000
 RMS occupancy error at iteration   2:  0.000006 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.471476602527
      ideal mu2:      -0.471476602527
             Q0:         -37.811927132943
             G0:      -0.000632985925
   RMS gradient:       0.001186016605
     Trial step:       0.565892003434
             Q1:         -37.812105368095
 Quadratic coef:       0.000179966521
 Linear coef   :      -0.000358201673
           Qmin:         -37.812105372259
Quadratic minimum step length (  0.563169919606) accepted
    Initial Ne1:      14.99999999
    Initial Ne2:      14.99999999
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000010 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -3.781192713294E+01     1.1860E-03     8.3864E-04
      ideal mu1:      -0.474160280977
      ideal mu2:      -0.474160280977
             Q0:         -37.812105426070
             G0:      -0.000036114566
   RMS gradient:       0.000291436036
     Trial step:       0.564529320833
             Q1:         -37.812112552902
 Quadratic coef:       0.000013260899
 Linear coef   :      -0.000020387731
           Qmin:         -37.812113262258
Quadratic minimum step length (  0.433962742998) accepted
    Initial Ne1:      14.99999998
    Initial Ne2:      14.99999998
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -3.781210542607E+01     2.9144E-04     2.0608E-04    -1.7829E-04
      ideal mu1:      -0.473785977010
      ideal mu2:      -0.473785977010
             Q0:         -37.812112893007
             G0:      -0.000002622386
   RMS gradient:       0.000071248348
     Trial step:       0.494959283751
             Q1:         -37.812113102568
 Quadratic coef:       0.000001088414
 Linear coef   :      -0.000001297974
           Qmin:         -37.812113279978
Quadratic minimum step length (  0.295128806643) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -3.781211289301E+01     7.1248E-05     5.0380E-05    -7.4669E-06
      ideal mu1:      -0.473725954606
      ideal mu2:      -0.473725954606
             Q0:         -37.812113191938
             G0:      -0.000000530379
   RMS gradient:       0.000029163692
     Trial step:       0.382199872776
             Q1:         -37.812113287715
 Quadratic coef:       0.000000106934
 Linear coef   :      -0.000000202711
           Qmin:         -37.812113288006
Quadratic minimum step length (  0.362259683116) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -3.781211319194E+01     2.9164E-05     2.0622E-05    -2.9893E-07
      ideal mu1:      -0.473714665343
      ideal mu2:      -0.473714665343
    5        -3.781211328691E+01     1.3371E-05     9.4545E-06    -9.4968E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.78121132869061E+01  Eh
     Estimated bandgap (UP spin) =   2.2436E-01  Eh
     Estimated bandgap (DN spin) =   2.2460E-01  Eh
     RMS occupancy error         =   2.5069E-15
     [H,K] commutator            =   9.4545E-06
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~




################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******

>>> Checking for convergence of NGWFs:   NOT CONVERGED
  ========================================================================
         NGWF RMS gradient =  3.0686E-04 >  2.0000E-06  | above tolerance
  ========================================================================

>>> Improving NGWFs using line search:
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.22408509E-01     0.41688712E-02
               2       0.14873927E-03     0.26176092E-04
               3       0.77796571E-08     0.13860769E-08
               4       0.47418408E-14     0.11102230E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15755215E-01     0.29741454E-02
               2       0.73418877E-04     0.13060986E-04
               3       0.18769982E-08     0.32232850E-09
               4       0.40870763E-14     0.13322676E-14
================================================================================
------------------------------- NGWF line search -------------------------------
RMS gradient                =       0.00030686400937
Trial step length           =               0.478474
Gradient along search dir.  =         -0.03785021907
Functional at step 0        =     -37.81211328690614
Functional at step 1        =     -37.82462861916568
Functional predicted        =     -37.82676850217248
Selected quadratic step     =               0.774379
Conjugate gradients coeff.  =               0.168918
--------------------------- NGWF line search finished --------------------------
                                               

>>> Optimising kernel for current NGWFs:
   Initial electron number for spin 1:      15.01940586
   Initial electron number for spin 2:      15.01940586
     Final electron number for spin 1:      15.00000000
     Final electron number for spin 2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000789 (step -0.4980 Ne1=     15.0000)
                                                               Ne2=     15.0000
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
   iter  |      energy (Eh)       | rms gradient |  commutator  |   dE (Eh)
      ideal mu1:      -0.469795930750
      ideal mu2:      -0.469795930750
             Q0:         -37.826856210925
             G0:      -0.000136803511
   RMS gradient:       0.000551369026
     Trial step:       0.372096230562
             Q1:         -37.826881058453
 Quadratic coef:       0.000026056543
 Linear coef   :      -0.000050904071
           Qmin:         -37.826881072477
Quadratic minimum step length (  0.363463663265) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000001 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    1        -3.782685621092E+01     5.5137E-04     3.8988E-04
      ideal mu1:      -0.468829925843
      ideal mu2:      -0.468829925843
             Q0:         -37.826880969031
             G0:      -0.000007072820
   RMS gradient:       0.000115639843
     Trial step:       0.367754617983
             Q1:         -37.826881696410
 Quadratic coef:       0.000001873684
 Linear coef   :      -0.000002601062
           Qmin:         -37.826881871735
Quadratic minimum step length (  0.255259861444) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    2        -3.782688096903E+01     1.1564E-04     8.1770E-05    -2.4758E-05
      ideal mu1:      -0.468721483300
      ideal mu2:      -0.468721483300
             Q0:         -37.826881706274
             G0:      -0.000001926555
   RMS gradient:       0.000053623837
     Trial step:       0.306386998470
             Q1:         -37.826881831370
 Quadratic coef:       0.000000465175
 Linear coef   :      -0.000000590271
           Qmin:         -37.826881893526
Quadratic minimum step length (  0.194390600937) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    3        -3.782688170627E+01     5.3624E-05     3.7918E-05    -7.3724E-07
      ideal mu1:      -0.468696339521
      ideal mu2:      -0.468696339521
             Q0:         -37.826881840722
             G0:      -0.000000665103
   RMS gradient:       0.000029240115
     Trial step:       0.244046620038
             Q1:         -37.826881906493
 Quadratic coef:       0.000000096545
 Linear coef   :      -0.000000162316
           Qmin:         -37.826881908945
Quadratic minimum step length (  0.205151136796) accepted
    Initial Ne1:      15.00000000
    Initial Ne2:      15.00000000
      Final Ne1:      15.00000000
      Final Ne2:      15.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     15.0000)
                                                               Ne2=     15.0000
            Final RMS occupancy error   :  0.000000 (Ne1=     15.0000)
                                                     Ne2=     15.0000
            Final occupancy bounds spin 1: [  0.000,  1.000]
            Final occupancy bounds spin 2: [  0.000,  1.000]
================================================================================

    4        -3.782688184072E+01     2.9240E-05     2.0676E-05    -1.3445E-07
      ideal mu1:      -0.468694217113
      ideal mu2:      -0.468694217113
    5        -3.782688190363E+01     1.4428E-05     1.0202E-05    -6.2912E-08
Finished density kernel iterations (   5)


>>> Density kernel optimised for the current NGWF basis:
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     Total energy                =  -3.78268819036343E+01  Eh
     Estimated bandgap (UP spin) =   2.2018E-01  Eh
     Estimated bandgap (DN spin) =   2.2030E-01  Eh
     RMS occupancy error         =   8.3116E-16
     [H,K] commutator            =   1.0202E-05
     UP spin occupancy bounds    = [  0.000:  1.000]
     DN spin occupancy bounds    = [  0.000:  1.000]
     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       27.65303919931941 |
           | Pseudopotential (local)    :     -233.07356473688407 |
           | Pseudo (non-coul chg cor)  :        0.00000000000000
           | Pseudopotential (non-local):        4.61843125763281 |
           | Hartree                    :      101.92680054705744 |
           | Exchange-correlation       :      -12.48362984742696 |
           | Ewald                      :       73.53204167666705 |
           | Total                      :      -37.82688190363432 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -233.07356473688083 |
           | Hartree                    :      101.92680054705572 |
           --------------------------------------------------------
           Integrated density           :       29.99999999999986
           Integrated spin density      :        0.00000000000000
           Integrated |spin density|    :        0.00000000000001
           Local density approx. <S^2>  :        0.00000000000000
           Integrated density tr(KS)    :       30.00000000000000
           Integrated spin tr(KS)       :        0.00000000000000
================================================================================

WARNING: maximum number of NGWF CG iterations (   3) exceeded!

                        <<<<< CALCULATION SUMMARY >>>>>                         
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted              
   0     0.00189627768928    -37.16297868252475   0.800108    -37.72804355412903        
   1     0.00074663427996    -37.73036059514421   0.731341    -37.81095153457534        
   2     0.00030686400937    -37.82688190363434  <-- CG                                 
 
<QC>        [NGWF iterations]:                      3
<QC>           [total_energy]:       -37.826881903634
<QC>           [rms_gradient]:         0.000306864009

------------------------------ TIMING INFORMATION ------------------------------
AVERAGE TIME:     220.709s on      4 proc(s)                                    
TOTAL TIME:       220.709s on      4 proc(s)                                    
================= AVERAGE TIMINGS FROM ALL PROCS (CUMULATIVE) ==================
|| TAG                                    #calls    cpu time   %total  Gflops ||
|| onetep.F90 final imbalance           :     1        0.00s   0.000%  ------ ||
|| onetep.F90 main loop imbalance       :     1        0.00s   0.000%  ------ ||
|| basis_extract_function_from_box      :    45        0.00s   0.000%  ------ ||
|| sparse_set_to_garbage                :    64        0.00s   0.000%  ------ ||
|| pseudopotentials_nonlocal_mat        :     7        0.01s   0.003%  ------ ||
|| ngwf_gradient_coeffs                 :     3        0.01s   0.004%  ------ ||
|| ewald_calculate_energy               :     1        0.01s   0.005%  ------ ||
|| pseudo_make_structure_factor         :     1        0.01s   0.005%  ------ ||
|| sparse_init                          :     1        0.01s   0.006%  ------ ||
|| sparse_embed_hotelling_invert_embed  :     7        0.02s   0.007%  ------ ||
|| palser_mano_kernel_optimise          :     2        0.02s   0.009%  ------ ||
|| pseudopotentials_local_on_grid       :     1        0.03s   0.013%  ------ ||
|| ngwfs_initialise_from_radial         :     1        0.04s   0.020%  ------ ||
|| lnv_gradient_norm                    :    20        0.06s   0.026%  ------ ||
|| sparse_trace                         :  1269        0.07s   0.031%  ------ ||
|| kernel_fix                           :    20        0.07s   0.031%  ------ ||
|| function_ops_brappd_ketppd           :     7        0.07s   0.031%  ------ ||
|| kernel_purify                        :    62        0.08s   0.035%  ------ ||
|| basis_dot_function_with_box          : 15903        0.10s   0.043%  ------ ||
|| projectors_init_fftbox_recip         :    10        0.16s   0.074%  ------ ||
|| energy_and_force_init_cell           :     1        0.18s   0.080%  ------ ||
|| sparse_product                       :  1782        0.18s   0.081%  ------ ||
|| basis_copy_function_to_box           :  1890        0.20s   0.089%  ------ ||
|| projectors_func_ovlp_box             :     7        0.21s   0.093%  ------ ||
|| integrals_kinetic                    :     7        0.24s   0.107%  ------ ||
|| basis_add_function_to_box            : 41400        0.24s   0.109%  ------ ||
|| ke_density_batch_row_sums            :    40        0.34s   0.154%  ------ ||
|| density_init_guess_real              :     1        0.34s   0.156%  ------ ||
|| projectors_gradient_batch            :     3        0.35s   0.157%  ------ ||
|| density_batch_row_sums               :    40        0.52s   0.233%  ------ ||
|| fourier_apply_box_pair               :   728        0.63s   0.287% 184.755 ||
|| cell_grid_extract_box_real           :  1758        0.90s   0.407%  ------ ||
|| integrals_locpot_mat_els_batch       :    45        1.06s   0.481%  ------ ||
|| cell_grid_deposit_box_real           :  1448        1.49s   0.675%  ------ ||
|| hartree_on_grid                      :    41        1.64s   0.743%  ------ ||
|| ke_density_fftbox_deposit_to_cell    :   720        2.91s   1.319%  ------ ||
|| density_fftbox_deposit_to_cell       :   720        2.96s   1.339%  ------ ||
|| ke_density_batch_grad_apply          :    40        3.60s   1.630%  ------ ||
|| hamiltonian_energy_components        :     1        4.56s   2.066%  ------ ||
|| density_fftbox_interpolate_multiply  :   720        6.51s   2.952%  ------ ||
|| ngwf_gradient_build_batch            :     3        7.64s   3.460%  ------ ||
|| ngwf_gradient_batch                  :     3        8.68s   3.932%  ------ ||
|| ngwf_gradient_lnv                    :     3        9.12s   4.134%  ------ ||
|| potential_apply_to_ngwf_batch        :    45       11.42s   5.173%  ------ ||
|| integrals_locpot_dbl_grid            :    45       12.57s   5.695%  ------ ||
|| density_batch_interp_deposit         :    40       17.17s   7.780%  ------ ||
|| density_on_dbl_grid                  :    40       19.26s   8.725%  ------ ||
|| fourier_apply_cell_backward          :  1410       21.62s   9.798%  12.307 ||
|| fourier_apply_cell_forward           :  1409       22.98s  10.410%  11.575 ||
|| ke_density_fftbox_interpolate_multipl:   720       23.50s  10.648%  ------ ||
|| potential_apply_to_fftbox_batch      :   120       29.10s  13.183%  ------ ||
|| fourier_apply_box                    : 14296       34.16s  15.479% 226.526 ||
|| ke_density_batch_interp_deposit      :    40       39.79s  18.028%  ------ ||
|| ke_density_on_dbl_grid               :    40       45.21s  20.485%  ------ ||
|| integrals_div_locpot_grad_functions  :    40       47.78s  21.648%  ------ ||
|| xc_energy_potential                  :    41       71.84s  32.549%  ------ ||
|| nlxc_vdw_energy                      :    80      106.72s  48.352%  ------ ||
|| hamiltonian_lhxc_calculate           :    39      143.58s  65.052%  ------ ||
|| lnv_denskernel_optimise_cg           :     4      192.29s  87.124%  ------ ||
|| ngwf_cg_optimise                     :     1      218.43s  98.968%  ------ ||
|| energy_and_force_calculate           :     1      220.04s  99.698%  ------ ||
|| total_time                           :     1      220.71s 100.000%  ------ ||
================================================================================
Overhead of generating timer report: 
- 1 ms averaging over threads,
- 0 ms ensuring consistency across MPI ranks,
- 3 ms printing in order.

Job completed: 21-09-2022 11:04 (+0100)

onetep_launcher: ONETEP seems to have finished correctly (zero exit code).
